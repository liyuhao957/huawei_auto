2025-03-18 09:41:01,889 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-18 09:41:01,889 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 09:41:01,889 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 09:41:01,889 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 09:41:01,889 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 09:41:02,013 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 09:41:02,165 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 09:41:02,165 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 09:41:02,166 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 09:41:02,166 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 09:41:02,444 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-18 09:41:02,445 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-18 09:41:02,445 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-18 09:41:02,445 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-18 09:41:02,445 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-18 09:41:04,636 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 09:41:04,884 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 09:41:04,884 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-18 09:41:04,885 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 09:41:04,885 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 09:41:06,322 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:41:06,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:41:07,523 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 09:41:07,523 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 09:41:07,523 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 09:41:07,523 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 09:41:07,524 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 09:41:07,701 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 09:41:07,702 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 09:41:07,702 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 09:41:07,702 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 09:41:09,099 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:41:09,100 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:41:10,341 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 09:41:10,341 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 09:41:10,342 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 09:41:10,342 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:41:10,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:41:11,422 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 09:41:11,423 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 09:41:11,536 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 09:41:13,542 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 09:41:13,542 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 09:41:14,660 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 09:41:14,661 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 09:41:14,661 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 09:41:14,661 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 09:41:14,743 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 09:41:16,748 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 09:41:16,749 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 09:41:18,905 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 09:41:18,906 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 09:41:20,983 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 09:41:20,984 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 09:41:22,078 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 09:41:22,079 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 09:41:22,079 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 09:41:22,079 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 09:41:22,144 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 09:41:24,151 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 09:41:24,152 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 09:41:26,316 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 09:41:26,318 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 09:41:27,731 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 09:41:29,197 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 09:41:29,198 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 09:41:30,361 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 09:41:30,361 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 09:41:31,463 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 09:41:31,464 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 09:41:33,638 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 09:41:33,640 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 09:41:33,640 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 09:41:33,640 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:41:33,640 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:41:34,798 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 09:41:34,799 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 09:41:34,909 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 09:41:39,914 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 09:41:39,915 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 09:41:42,127 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 09:41:42,128 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 09:41:47,267 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 09:41:47,268 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 09:41:49,422 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 09:41:54,425 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 09:41:54,425 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 09:41:54,426 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 09:41:54,426 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 09:41:55,613 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 09:41:55,613 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 09:41:55,614 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 09:41:55,614 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 09:41:55,698 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 09:41:57,708 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 09:41:57,709 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 09:41:57,709 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 09:42:00,003 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 09:42:00,003 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 09:42:08,157 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 09:42:08,158 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 09:42:08,158 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 09:42:08,158 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:08,459 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 09:42:08,460 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:08,697 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 09:42:08,698 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:08,927 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 09:42:08,928 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:09,149 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 09:42:09,150 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:09,362 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 09:42:09,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:09,599 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 09:42:09,600 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:09,841 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 09:42:09,842 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:10,102 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 09:42:10,103 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:10,441 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 09:42:10,442 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:42:12,667 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 09:42:12,668 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 09:42:12,668 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 09:42:12,822 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9a812ba u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t189}
    * Task{2c3a8c8 #189 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 09:42:12,823 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 09:42:12,823 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 09:42:12,823 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 09:42:12,823 - QuickAppADBTester - INFO - 截图: screenshots/after_swipe_20250318_094212.png
2025-03-18 09:42:14,545 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_swipe_20250318_094212.png
2025-03-18 09:42:14,546 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_swipe_20250318_094212.png
2025-03-18 09:42:17,986 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_swipe_20250318_094212.png
2025-03-18 09:42:17,989 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 09:42:17,990 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:42:17,990 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:42:28,159 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 09:42:28,160 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 09:42:28,160 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 09:42:28,317 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9a812ba u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t189}
    * Task{2c3a8c8 #189 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 09:42:28,317 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 09:42:28,318 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 09:42:28,318 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 09:42:28,318 - QuickAppADBTester - INFO - 截图: screenshots/after_home_20250318_094228.png
2025-03-18 09:42:30,083 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_home_20250318_094228.png
2025-03-18 09:42:30,084 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_home_20250318_094228.png
2025-03-18 09:42:32,018 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_home_20250318_094228.png
2025-03-18 09:42:32,021 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 09:42:32,022 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 09:42:32,022 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 09:42:32,023 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 09:42:32,416 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 09:42:33,420 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 09:42:33,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:42:33,421 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:42:34,520 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 09:42:34,521 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 09:42:34,521 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 09:42:36,620 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 09:42:36,621 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 09:42:37,808 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 09:42:37,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:42:37,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:42:38,949 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 09:42:38,951 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 09:42:38,951 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 09:42:38,952 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 09:41:07\n- 结束时间: 2025-03-18 09:42:38\n- 测试设备: 华为设备\n\n**✅ 成功执行了所有测试流程:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ✅ 成功\n   - 拉回测试: ✅ 成功\n5. 清空手机里的全部应用: ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_swipe_20250318_094212.png"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_home_20250318_094228.png"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 09:42:38"}]}]}}
2025-03-18 09:42:40,439 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 09:42:40,440 - QuickAppADBTester - INFO - 测试完成
2025-03-18 09:42:40,440 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-18 09:51:00,425 - QuickAppADBTester - INFO - 用户中断，定时测试任务已停止
2025-03-18 09:51:00,426 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-18 09:51:01,169 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-18 09:51:01,169 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 09:51:01,169 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 09:51:01,169 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 09:51:01,169 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 09:51:01,267 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 09:51:01,402 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 09:51:01,402 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 09:51:01,402 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 09:51:01,402 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 09:51:01,655 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 09:51:01,656 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 09:51:01,656 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 09:51:01,656 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 09:51:03,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:51:03,130 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:51:04,394 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 09:51:04,394 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 09:51:04,394 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 09:51:04,394 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 09:51:04,394 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 09:51:04,554 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 09:51:04,554 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 09:51:04,554 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 09:51:04,554 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 09:51:05,954 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:51:05,955 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:51:07,213 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 09:51:07,213 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 09:51:07,213 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 09:51:07,213 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:51:07,213 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:51:08,294 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 09:51:08,295 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 09:51:08,407 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 09:51:10,413 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 09:51:10,414 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 09:51:11,496 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 09:51:11,498 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 09:51:11,498 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 09:51:11,498 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 09:51:11,563 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 09:51:13,573 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 09:51:13,574 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 09:51:15,743 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 09:51:15,744 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 09:51:17,831 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 09:51:17,832 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 09:51:18,927 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 09:51:18,929 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 09:51:18,929 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 09:51:18,929 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 09:51:19,003 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 09:51:21,013 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 09:51:21,014 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 09:51:23,232 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 09:51:23,233 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 09:51:24,647 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 09:51:26,138 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 09:51:26,139 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 09:51:27,329 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 09:51:27,329 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 09:51:28,417 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 09:51:28,418 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 09:51:30,606 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 09:51:30,607 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 09:51:30,607 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 09:51:30,607 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:51:30,607 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:51:31,758 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 09:51:31,759 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 09:51:31,878 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 09:51:36,881 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 09:51:36,881 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 09:51:39,086 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 09:51:39,087 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 09:51:44,232 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 09:51:44,233 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 09:51:46,374 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 09:51:51,379 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 09:51:51,379 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 09:51:51,380 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 09:51:51,380 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 09:51:52,538 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 09:51:52,539 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 09:51:52,539 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 09:51:52,539 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 09:51:52,643 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 09:51:54,647 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 09:51:54,647 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 09:51:54,647 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 09:51:56,924 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 09:51:56,925 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 09:52:05,105 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 09:52:05,106 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 09:52:05,106 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 09:52:05,106 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:05,412 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 09:52:05,413 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:05,662 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 09:52:05,663 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:05,914 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 09:52:05,914 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:06,129 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 09:52:06,130 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:06,399 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 09:52:06,400 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:06,653 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 09:52:06,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:06,902 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 09:52:06,903 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:07,134 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 09:52:07,135 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:07,373 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 09:52:07,374 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 09:52:09,587 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 09:52:09,588 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 09:52:09,589 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 09:52:09,708 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{6f18739 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t194}
    * Task{5eb9f2c #194 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 09:52:09,709 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 09:52:09,709 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 09:52:09,709 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 09:52:09,709 - QuickAppADBTester - INFO - 截图: screenshots/after_swipe_20250318_095209.png
2025-03-18 09:52:11,659 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_swipe_20250318_095209.png
2025-03-18 09:52:11,659 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_swipe_20250318_095209.png
2025-03-18 09:52:12,991 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_swipe_20250318_095209.png
2025-03-18 09:52:12,994 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 09:52:12,994 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:52:12,994 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:52:23,121 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 09:52:23,121 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 09:52:23,121 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 09:52:23,231 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{6f18739 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t194}
    * Task{5eb9f2c #194 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 09:52:23,232 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 09:52:23,232 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 09:52:23,232 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 09:52:23,232 - QuickAppADBTester - INFO - 截图: screenshots/after_home_20250318_095223.png
2025-03-18 09:52:25,238 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_home_20250318_095223.png
2025-03-18 09:52:25,239 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_home_20250318_095223.png
2025-03-18 09:52:26,974 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_home_20250318_095223.png
2025-03-18 09:52:26,977 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 09:52:26,977 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 09:52:26,978 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 09:52:26,978 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 09:52:27,375 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 09:52:28,381 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 09:52:28,381 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:52:28,382 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:52:29,489 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 09:52:29,489 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 09:52:29,489 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 09:52:31,575 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 09:52:31,576 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 09:52:32,744 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 09:52:32,744 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 09:52:32,745 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 09:52:33,835 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 09:52:33,836 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 09:52:33,836 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 09:52:33,837 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 09:51:04\n- 结束时间: 2025-03-18 09:52:33\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_swipe_20250318_095209.png"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_home_20250318_095223.png"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 09:52:33"}]}]}}
2025-03-18 09:52:34,299 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 09:52:34,302 - QuickAppADBTester - INFO - 测试完成
2025-03-18 09:52:34,302 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-18 10:05:30,461 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-18 10:05:30,461 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 10:05:30,461 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 10:05:30,461 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 10:05:30,461 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 10:05:30,522 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 10:05:30,591 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 10:05:30,592 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 10:05:30,592 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:05:30,592 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:05:30,753 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:05:30,754 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:05:30,754 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:05:30,754 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:05:32,137 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:05:32,138 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:05:33,361 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:05:33,362 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 10:05:33,362 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 10:05:33,362 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:05:33,362 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:05:33,526 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:05:33,526 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:05:33,527 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:05:33,527 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:05:34,932 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:05:34,933 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:05:36,140 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:05:36,141 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 10:05:36,141 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:05:36,141 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:05:36,141 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:05:37,221 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 10:05:37,221 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 10:05:37,313 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 10:05:39,316 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 10:05:39,316 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 10:05:40,397 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 10:05:40,397 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 10:05:40,397 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:05:40,398 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 10:05:40,472 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:05:42,474 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 10:05:42,475 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 10:05:44,606 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 10:05:44,607 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 10:05:46,680 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 10:05:46,681 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 10:05:47,779 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 10:05:47,780 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 10:05:47,780 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:05:47,781 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 10:05:47,858 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:05:49,867 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 10:05:49,868 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 10:05:52,061 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 10:05:52,061 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 10:05:53,471 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 10:05:54,941 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 10:05:54,942 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 10:05:56,108 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 10:05:56,109 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 10:05:57,205 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 10:05:57,206 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 10:05:59,387 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 10:05:59,388 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 10:05:59,388 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:05:59,388 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:05:59,388 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:06:00,511 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 10:06:00,512 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 10:06:00,632 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 10:06:05,636 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 10:06:05,637 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 10:06:07,812 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 10:06:07,812 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 10:06:12,965 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 10:06:12,966 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 10:06:15,136 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 10:06:20,139 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 10:06:20,140 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 10:06:20,140 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 10:06:20,140 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 10:06:21,304 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 10:06:21,305 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 10:06:21,305 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:06:21,305 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 10:06:21,378 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:06:23,387 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 10:06:23,387 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 10:06:23,388 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 10:06:25,654 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 10:06:25,655 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 10:06:33,848 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 10:06:33,848 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 10:06:33,849 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 10:06:33,849 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:34,210 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 10:06:34,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:34,429 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 10:06:34,430 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:34,695 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 10:06:34,696 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:34,906 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 10:06:34,907 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:35,158 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 10:06:35,159 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:35,387 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 10:06:35,388 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:35,622 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 10:06:35,623 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:35,835 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 10:06:35,836 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:36,054 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 10:06:36,055 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:06:38,264 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 10:06:38,265 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:06:38,265 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:06:38,419 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8f2e4c8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t212}
    * Task{6ac947 #212 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:06:38,420 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:06:38,421 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 10:06:38,421 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 10:06:38,421 - QuickAppADBTester - INFO - 截图: screenshots/after_swipe_20250318_100638.png
2025-03-18 10:06:39,892 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_swipe_20250318_100638.png
2025-03-18 10:06:39,892 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_swipe_20250318_100638.png
2025-03-18 10:06:41,184 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_swipe_20250318_100638.png
2025-03-18 10:06:41,186 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 10:06:41,187 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:06:41,187 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:06:51,312 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 10:06:51,312 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:06:51,312 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:06:51,396 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8f2e4c8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t212}
    * Task{6ac947 #212 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:06:51,396 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:06:51,396 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 10:06:51,396 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 10:06:51,396 - QuickAppADBTester - INFO - 截图: screenshots/after_home_20250318_100651.png
2025-03-18 10:06:52,754 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_home_20250318_100651.png
2025-03-18 10:06:52,754 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_home_20250318_100651.png
2025-03-18 10:06:54,138 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_home_20250318_100651.png
2025-03-18 10:06:54,140 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 10:06:54,141 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 10:06:54,141 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 10:06:54,141 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 10:06:54,530 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 10:06:55,536 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 10:06:55,536 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:06:55,537 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:06:56,642 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 10:06:56,643 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 10:06:56,643 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 10:06:58,741 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 10:06:58,742 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 10:06:59,913 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 10:06:59,914 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:06:59,914 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:07:01,030 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 10:07:01,030 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 10:07:01,030 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 10:07:01,031 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 10:05:33\n- 结束时间: 2025-03-18 10:07:01\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_swipe_20250318_100638.png"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_home_20250318_100651.png"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 10:07:01"}]}]}}
2025-03-18 10:07:01,480 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 10:07:01,482 - QuickAppADBTester - INFO - 测试完成
2025-03-18 10:07:01,482 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-18 10:08:11,087 - QuickAppADBTester - INFO - 用户中断，定时测试任务已停止
2025-03-18 10:08:11,089 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-18 10:08:43,103 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-18 10:08:43,103 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 10:08:43,103 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 10:08:43,103 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 10:08:43,103 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 10:08:43,196 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 10:08:43,336 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 10:08:43,337 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 10:08:43,337 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:08:43,337 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:08:43,566 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:08:43,566 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:08:43,566 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:08:43,566 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:08:45,005 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:08:45,005 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:08:46,244 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:08:46,244 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 10:08:46,244 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 10:08:46,245 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:08:46,245 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:08:46,412 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:08:46,413 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:08:46,413 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:08:46,413 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:08:47,804 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:08:47,805 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:08:49,060 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:08:49,060 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 10:08:49,060 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:08:49,060 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:08:49,060 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:08:50,143 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 10:08:50,144 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 10:08:50,255 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 10:08:52,256 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 10:08:52,257 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 10:08:53,337 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 10:08:53,338 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 10:08:53,338 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:08:53,338 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 10:08:53,396 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:08:55,405 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 10:08:55,406 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 10:08:57,595 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 10:08:57,596 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 10:08:59,672 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 10:08:59,673 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 10:09:00,767 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 10:09:00,767 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 10:09:00,768 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:09:00,768 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 10:09:00,833 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:09:02,839 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 10:09:02,840 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 10:09:04,996 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 10:09:04,997 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 10:09:06,415 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 10:09:07,878 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 10:09:07,879 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 10:09:09,028 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 10:09:09,029 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 10:09:10,141 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 10:09:10,142 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 10:09:12,328 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 10:09:12,328 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 10:09:12,328 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:09:12,329 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:09:12,329 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:09:13,498 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 10:09:13,499 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 10:09:13,615 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 10:09:18,620 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 10:09:18,620 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 10:09:20,784 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 10:09:20,785 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 10:09:25,906 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 10:09:25,907 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 10:09:28,062 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 10:09:33,067 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 10:09:33,068 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 10:09:33,068 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 10:09:33,068 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 10:09:34,272 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 10:09:34,273 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 10:09:34,274 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:09:34,275 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 10:09:34,376 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:09:36,379 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 10:09:36,380 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 10:09:36,380 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 10:09:38,661 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 10:09:38,662 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 10:09:46,821 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 10:09:46,822 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 10:09:46,822 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 10:09:46,823 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:47,162 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 10:09:47,163 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:47,418 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 10:09:47,419 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:47,644 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 10:09:47,645 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:47,859 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 10:09:47,860 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:48,109 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 10:09:48,110 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:48,370 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 10:09:48,371 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:48,596 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 10:09:48,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:48,820 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 10:09:48,821 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:49,065 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 10:09:49,065 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:09:51,349 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 10:09:51,350 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:09:51,350 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:09:51,517 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f7fd8b0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t217}
    * Task{d799c4f #217 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:09:51,518 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:09:51,518 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 10:09:51,518 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 10:09:51,518 - QuickAppADBTester - INFO - 截图: screenshots/after_swipe_20250318_100951.png
2025-03-18 10:09:53,327 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_swipe_20250318_100951.png
2025-03-18 10:09:53,328 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_swipe_20250318_100951.png
2025-03-18 10:09:54,700 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_swipe_20250318_100951.png
2025-03-18 10:09:54,703 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 10:09:54,704 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:09:54,704 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:10:04,865 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 10:10:04,865 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:10:04,866 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:10:05,015 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f7fd8b0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t217}
    * Task{d799c4f #217 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:10:05,016 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:10:05,016 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 10:10:05,016 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 10:10:05,017 - QuickAppADBTester - INFO - 截图: screenshots/after_home_20250318_101005.png
2025-03-18 10:10:06,789 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_home_20250318_101005.png
2025-03-18 10:10:06,790 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_home_20250318_101005.png
2025-03-18 10:10:08,323 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_home_20250318_101005.png
2025-03-18 10:10:08,326 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 10:10:08,326 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 10:10:08,326 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 10:10:08,327 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 10:10:08,754 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 10:10:09,760 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 10:10:09,760 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:10:09,760 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:10:10,860 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 10:10:10,861 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 10:10:10,861 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 10:10:12,958 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 10:10:12,959 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 10:10:14,112 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 10:10:14,113 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:10:14,114 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:10:15,239 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 10:10:15,240 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 10:10:15,240 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 10:10:15,240 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 10:08:46\n- 结束时间: 2025-03-18 10:10:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_swipe_20250318_100951.png"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_home_20250318_101005.png"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 10:10:15"}]}]}}
2025-03-18 10:10:15,662 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 10:10:15,664 - QuickAppADBTester - INFO - 测试完成
2025-03-18 10:10:15,665 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-18 10:11:15,859 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 10:11:15,859 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 10:11:15,859 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 10:11:15,860 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 10:11:15,985 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 10:11:16,116 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 10:11:16,117 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 10:11:16,117 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:11:16,117 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:11:16,382 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:11:16,383 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:11:16,383 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:11:16,383 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:11:17,842 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:11:17,843 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:11:19,030 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:11:19,030 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 10:11:19,030 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 10:11:19,030 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:11:19,031 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:11:19,188 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:11:19,190 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:11:19,190 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:11:19,190 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:11:20,586 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:11:20,586 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:11:21,844 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:11:21,845 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 10:11:21,845 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:11:21,845 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:11:21,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:11:22,931 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 10:11:22,932 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 10:11:23,045 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 10:11:25,047 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 10:11:25,047 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 10:11:26,137 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 10:11:26,138 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 10:11:26,138 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:11:26,138 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 10:11:26,213 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:11:28,222 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 10:11:28,223 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 10:11:30,393 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 10:11:30,394 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 10:11:32,516 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 10:11:32,517 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 10:11:33,694 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 10:11:33,695 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 10:11:33,695 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:11:33,695 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 10:11:33,881 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:11:35,885 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 10:11:35,886 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 10:11:38,023 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 10:11:38,023 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 10:11:39,422 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 10:11:40,866 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 10:11:40,867 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 10:11:42,069 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 10:11:42,069 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 10:11:43,166 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 10:11:43,166 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 10:11:45,343 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 10:11:45,343 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 10:11:45,344 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:11:45,344 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:11:45,344 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:11:46,501 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 10:11:46,502 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 10:11:46,643 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 10:11:51,648 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 10:11:51,648 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 10:11:53,810 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 10:11:53,810 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 10:11:58,935 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 10:11:58,935 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 10:12:01,092 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 10:12:06,093 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 10:12:06,094 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 10:12:06,094 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 10:12:06,094 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 10:12:07,293 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 10:12:07,293 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 10:12:07,293 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:12:07,293 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 10:12:07,389 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:12:09,398 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 10:12:09,400 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 10:12:09,401 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 10:12:11,723 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 10:12:11,724 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 10:12:19,924 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 10:12:19,925 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 10:12:19,925 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 10:12:19,925 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:20,210 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 10:12:20,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:20,441 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 10:12:20,442 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:20,728 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 10:12:20,729 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:20,963 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 10:12:20,965 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:21,198 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 10:12:21,198 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:21,434 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 10:12:21,435 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:21,665 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 10:12:21,666 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:21,891 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 10:12:21,892 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:22,120 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 10:12:22,120 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:12:24,334 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 10:12:24,334 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:12:24,335 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:12:24,499 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{dceda13 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t222}
    * Task{db14b4e #222 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:12:24,499 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:12:24,499 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 10:12:24,499 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 10:12:24,500 - QuickAppADBTester - INFO - 截图: screenshots/after_swipe_20250318_101224.png
2025-03-18 10:12:26,288 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_swipe_20250318_101224.png
2025-03-18 10:12:26,289 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_swipe_20250318_101224.png
2025-03-18 10:12:27,624 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_swipe_20250318_101224.png
2025-03-18 10:12:27,626 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 10:12:27,626 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:12:27,626 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:12:37,766 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 10:12:37,767 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:12:37,767 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:12:37,859 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{dceda13 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t222}
    * Task{db14b4e #222 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:12:37,859 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:12:37,860 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 10:12:37,860 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 10:12:37,860 - QuickAppADBTester - INFO - 截图: screenshots/after_home_20250318_101237.png
2025-03-18 10:12:39,616 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_home_20250318_101237.png
2025-03-18 10:12:39,617 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_home_20250318_101237.png
2025-03-18 10:12:40,976 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_home_20250318_101237.png
2025-03-18 10:12:40,979 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 10:12:40,979 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 10:12:40,979 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 10:12:40,979 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 10:12:41,342 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 10:12:42,347 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 10:12:42,347 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:12:42,347 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:12:43,451 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 10:12:43,452 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 10:12:43,452 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 10:12:45,550 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 10:12:45,551 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 10:12:46,708 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 10:12:46,709 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:12:46,709 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:12:47,833 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 10:12:47,833 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 10:12:47,834 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 10:12:47,834 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 10:11:19\n- 结束时间: 2025-03-18 10:12:47\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_swipe_20250318_101224.png"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_home_20250318_101237.png"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 10:12:47"}]}]}}
2025-03-18 10:12:48,257 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 10:12:48,259 - QuickAppADBTester - INFO - 测试完成
2025-03-18 10:13:48,465 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 10:13:48,465 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 10:13:48,466 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 10:13:48,466 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 10:13:48,605 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 10:13:48,761 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 10:13:48,762 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 10:13:48,762 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:13:48,762 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:13:49,024 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:13:49,024 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:13:49,025 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:13:49,025 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:13:50,528 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:13:50,529 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:13:51,771 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:13:51,772 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 10:13:51,772 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 10:13:51,772 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:13:51,772 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:13:51,944 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:13:51,945 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:13:51,945 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:13:51,945 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:13:53,354 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:13:53,355 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:13:54,569 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 10:13:54,570 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 10:13:54,570 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:13:54,571 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:13:54,571 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:13:55,666 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 10:13:55,667 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 10:13:55,785 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 10:13:57,789 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 10:13:57,789 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 10:13:58,866 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 10:13:58,867 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 10:13:58,867 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:13:58,867 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 10:13:58,931 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:14:00,937 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 10:14:00,938 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 10:14:03,089 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 10:14:03,090 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 10:14:05,211 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 10:14:05,211 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 10:14:06,337 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 10:14:06,338 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 10:14:06,338 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:14:06,338 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 10:14:06,485 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:14:08,495 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 10:14:08,496 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 10:14:10,662 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 10:14:10,663 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 10:14:12,075 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 10:14:13,530 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 10:14:13,531 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 10:14:14,680 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 10:14:14,681 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 10:14:15,787 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 10:14:15,788 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 10:14:17,969 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 10:14:17,970 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 10:14:17,970 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 10:14:17,970 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:14:17,970 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:14:19,148 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 10:14:19,149 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 10:14:19,263 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 10:14:24,268 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 10:14:24,268 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 10:14:26,443 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 10:14:26,444 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 10:14:31,601 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 10:14:31,602 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 10:14:33,779 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 10:14:38,783 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 10:14:38,784 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 10:14:38,784 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 10:14:38,784 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 10:14:39,975 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 10:14:39,975 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 10:14:39,975 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 10:14:39,975 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 10:14:40,065 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 10:14:42,070 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 10:14:42,070 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 10:14:42,071 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 10:14:44,360 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 10:14:44,361 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 10:14:52,544 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 10:14:52,545 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 10:14:52,547 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 10:14:52,548 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:52,783 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 10:14:52,783 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:53,005 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 10:14:53,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:53,225 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 10:14:53,226 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:53,451 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 10:14:53,451 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:53,698 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 10:14:53,698 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:53,972 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 10:14:53,973 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:54,215 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 10:14:54,215 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:54,452 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 10:14:54,453 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:54,680 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 10:14:54,681 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 10:14:56,935 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 10:14:56,936 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:14:56,937 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:14:57,073 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7b187fb u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t227}
    * Task{a4fda71 #227 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:14:57,074 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:14:57,074 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 10:14:57,074 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 10:14:57,074 - QuickAppADBTester - INFO - 截图: screenshots/after_swipe_20250318_101457.png
2025-03-18 10:14:58,970 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_swipe_20250318_101457.png
2025-03-18 10:14:58,970 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_swipe_20250318_101457.png
2025-03-18 10:15:00,339 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_swipe_20250318_101457.png
2025-03-18 10:15:00,342 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 10:15:00,342 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:15:00,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:15:10,492 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 10:15:10,492 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 10:15:10,493 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 10:15:10,637 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7b187fb u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t227}
    * Task{a4fda71 #227 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 10:15:10,637 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 10:15:10,637 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 10:15:10,637 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 10:15:10,638 - QuickAppADBTester - INFO - 截图: screenshots/after_home_20250318_101510.png
2025-03-18 10:15:12,551 - QuickAppADBTester - INFO - 上传截图到图床: screenshots/after_home_20250318_101510.png
2025-03-18 10:15:12,552 - QuickAppADBTester - INFO - 开始上传图片到Stardots空间'huawei': screenshots/after_home_20250318_101510.png
2025-03-18 10:15:13,906 - QuickAppADBTester - INFO - 图片上传成功: https://i.stardots.io/huawei/after_home_20250318_101510.png
2025-03-18 10:15:13,910 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 10:15:13,910 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 10:15:13,910 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 10:15:13,910 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 10:15:14,268 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 10:15:15,270 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 10:15:15,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:15:15,270 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:15:16,372 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 10:15:16,372 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 10:15:16,373 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 10:15:18,513 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 10:15:18,515 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 10:15:19,639 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 10:15:19,640 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:15:19,640 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:15:20,760 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 10:15:20,761 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 10:15:20,762 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 10:15:20,762 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 10:13:51\n- 结束时间: 2025-03-18 10:15:20\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_swipe_20250318_101457.png"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://i.stardots.io/huawei/after_home_20250318_101510.png"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 10:15:20"}]}]}}
2025-03-18 10:15:21,183 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 10:15:21,186 - QuickAppADBTester - INFO - 测试完成
2025-03-18 10:16:21,380 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 10:16:21,381 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 10:16:21,381 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 10:16:21,381 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 10:16:21,505 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 10:16:21,633 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 10:16:21,634 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 10:16:21,634 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 10:16:21,634 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 10:16:21,861 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 10:16:21,861 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 10:16:21,861 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 10:16:21,861 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 10:16:23,320 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 10:16:23,320 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 10:16:23,847 - QuickAppADBTester - INFO - 用户中断，定时测试任务已停止
2025-03-18 10:16:23,848 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-18 12:01:20,716 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-18 12:01:20,716 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 12:01:20,716 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 12:01:20,717 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 12:01:20,717 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 12:01:20,961 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 12:01:21,095 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 12:01:21,095 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 12:01:21,095 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 12:01:21,095 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 12:01:21,334 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 12:01:21,335 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 12:01:21,335 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 12:01:21,335 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 12:01:22,800 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:01:22,801 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:01:24,005 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 12:01:24,006 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 12:01:24,008 - QuickAppADBTester - INFO - 开始录制测试流程视频: test_flow_20250318_120124.mp4
2025-03-18 12:01:24,008 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 12:01:24,008 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 12:01:24,008 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 12:01:24,161 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 12:01:24,161 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 12:01:24,161 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 12:01:24,161 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 12:01:25,547 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:01:25,548 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:01:26,803 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 12:01:26,803 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 12:01:26,803 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 12:01:26,803 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:01:26,803 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:01:27,883 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 12:01:27,883 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 12:01:27,982 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 12:01:29,987 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 12:01:29,988 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 12:01:31,123 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 12:01:31,124 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 12:01:31,124 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 12:01:31,124 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 12:01:31,207 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 12:01:33,215 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 12:01:33,216 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 12:01:35,393 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 12:01:35,394 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 12:01:37,474 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 12:01:37,475 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 12:01:38,572 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 12:01:38,573 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 12:01:38,573 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 12:01:38,573 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 12:01:38,641 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 12:01:40,648 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 12:01:40,649 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 12:01:42,824 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 12:01:42,825 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 12:01:44,240 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 12:01:45,682 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 12:01:45,683 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 12:01:46,864 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 12:01:46,865 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 12:01:47,969 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 12:01:47,970 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 12:01:50,132 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 12:01:50,133 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 12:01:50,133 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 12:01:50,133 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:01:50,133 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:01:51,277 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 12:01:51,278 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 12:01:51,379 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 12:01:56,385 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 12:01:56,386 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 12:01:58,565 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 12:01:58,566 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 12:02:03,701 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 12:02:03,702 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 12:02:05,827 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 12:02:10,830 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 12:02:10,831 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 12:02:10,831 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 12:02:10,831 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 12:02:11,946 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 12:02:11,947 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 12:02:11,947 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 12:02:11,947 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 12:02:12,040 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 12:02:14,049 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 12:02:14,049 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 12:02:14,049 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 12:02:16,322 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 12:02:16,323 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 12:02:24,519 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 12:02:24,520 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 12:02:24,521 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 12:02:24,521 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:24,851 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 12:02:24,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:25,122 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 12:02:25,123 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:25,349 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 12:02:25,350 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:25,566 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 12:02:25,567 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:25,778 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 12:02:25,779 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:26,016 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 12:02:26,016 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:26,266 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 12:02:26,267 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:26,513 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 12:02:26,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:26,753 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 12:02:26,753 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 12:02:28,979 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 12:02:28,980 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 12:02:28,980 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 12:02:29,097 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4c4fb8a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t232}
    * Task{1655871 #232 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 12:02:29,097 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 12:02:29,097 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 12:02:29,098 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 12:02:29,098 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_120229_20250318_120229.png
2025-03-18 12:02:30,665 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_120229_20250318_120229.png
2025-03-18 12:02:30,666 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_120229_20250318_120229.png
2025-03-18 12:02:30,666 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 12:02:37,531 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_1.jpg
2025-03-18 12:02:37,535 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_1.jpg
2025-03-18 12:02:37,536 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 12:02:37,536 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:02:37,536 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:02:47,662 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 12:02:47,663 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 12:02:47,663 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 12:02:47,748 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4c4fb8a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t232}
    * Task{1655871 #232 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 12:02:47,749 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 12:02:47,749 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 12:02:47,749 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 12:02:47,749 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_120247_20250318_120247.png
2025-03-18 12:02:49,374 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_120247_20250318_120247.png
2025-03-18 12:02:49,374 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_120247_20250318_120247.png
2025-03-18 12:02:49,374 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 12:02:53,966 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_1.jpg
2025-03-18 12:02:53,971 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_1.jpg
2025-03-18 12:02:53,971 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 12:02:53,971 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 12:02:53,972 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 12:02:53,972 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 12:02:54,361 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 12:02:55,365 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 12:02:55,367 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:02:55,367 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:02:56,462 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 12:02:56,463 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 12:02:56,463 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 12:02:58,563 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 12:02:58,563 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 12:02:59,741 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 12:02:59,741 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 12:02:59,741 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 12:03:00,865 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 12:03:00,869 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 12:03:00,869 - QuickAppADBTester - INFO - 测试完成，处理录屏视频...
2025-03-18 12:03:00,869 - QuickAppADBTester - INFO - 尝试获取录制的视频: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_120124.mp4
2025-03-18 12:03:01,037 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 12:03:01,038 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 12:01:24\n- 结束时间: 2025-03-18 12:03:01\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_1.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_1.jpg"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 12:03:01"}]}]}}
2025-03-18 12:03:01,560 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 12:03:01,564 - QuickAppADBTester - INFO - 测试完成
2025-03-18 12:03:01,564 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-18 12:03:09,727 - QuickAppADBTester - INFO - 用户中断，定时测试任务已停止
2025-03-18 12:03:09,727 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-18 15:33:33,598 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-18 15:33:33,598 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:33:33,598 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:33:33,598 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:33:33,598 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:33:33,813 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:33:33,950 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:33:33,950 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:33:33,950 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:33:33,950 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:33:34,186 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:33:34,187 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:33:34,187 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:33:34,187 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:33:35,647 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:33:35,647 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:33:36,893 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:33:36,893 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:33:36,893 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_153336.mp4
2025-03-18 15:33:36,911 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:33:37,917 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153336.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h265 --max-fps=15
2025-03-18 15:33:37,923 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153336.mp4
2025-03-18 15:33:39,927 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:33:39,928 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:33:39,928 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:33:40,159 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:33:40,159 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:33:40,159 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:33:40,159 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:33:41,600 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:33:41,601 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:33:42,843 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:33:42,843 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:33:42,843 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:33:42,843 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:33:42,843 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:33:43,927 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 15:33:43,928 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 15:33:44,044 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 15:33:46,050 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 15:33:46,051 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 15:33:47,167 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 15:33:47,167 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 15:33:47,168 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:33:47,168 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 15:33:47,305 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:33:49,314 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 15:33:49,314 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 15:33:51,466 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 15:33:51,466 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 15:33:53,546 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 15:33:53,546 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 15:33:54,649 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 15:33:54,650 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 15:33:54,650 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:33:54,651 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 15:33:54,725 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:33:56,732 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 15:33:56,732 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 15:33:58,868 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 15:33:58,869 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 15:34:00,278 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 15:34:01,721 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 15:34:01,722 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 15:34:02,862 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 15:34:02,863 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 15:34:03,962 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 15:34:03,963 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 15:34:06,117 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 15:34:06,118 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 15:34:06,118 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:34:06,118 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:34:06,118 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:34:07,258 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 15:34:07,259 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 15:34:07,380 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 15:34:12,381 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 15:34:12,382 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 15:34:14,506 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 15:34:14,507 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 15:34:19,641 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 15:34:19,642 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 15:34:21,778 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 15:34:26,782 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 15:34:26,782 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 15:34:26,782 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 15:34:26,782 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 15:34:27,911 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 15:34:27,912 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 15:34:27,912 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:34:27,912 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 15:34:28,001 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:34:30,008 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 15:34:30,008 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 15:34:30,008 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 15:34:32,266 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 15:34:32,266 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 15:34:40,450 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 15:34:40,451 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 15:34:40,451 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 15:34:40,451 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:40,752 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 15:34:40,752 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:40,948 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 15:34:40,949 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:41,166 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 15:34:41,166 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:41,384 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 15:34:41,384 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:41,698 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 15:34:41,699 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:41,962 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 15:34:41,963 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:42,187 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 15:34:42,188 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:42,408 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 15:34:42,409 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:42,625 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 15:34:42,626 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:34:44,863 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 15:34:44,864 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 15:34:44,864 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 15:34:44,986 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3963780 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t238}
    * Task{8dbd9fe #238 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 15:34:44,987 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 15:34:44,987 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 15:34:44,987 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 15:34:44,987 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_153444_20250318_153444.png
2025-03-18 15:34:47,050 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_153444_20250318_153444.png
2025-03-18 15:34:47,050 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_153444_20250318_153444.png
2025-03-18 15:34:47,050 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 15:34:54,169 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_4.jpg
2025-03-18 15:34:54,175 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_4.jpg
2025-03-18 15:34:54,175 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 15:34:54,175 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:34:54,175 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:35:04,311 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 15:35:04,312 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 15:35:04,312 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 15:35:04,414 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3963780 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t238}
    * Task{8dbd9fe #238 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 15:35:04,414 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 15:35:04,414 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 15:35:04,415 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 15:35:04,415 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_153504_20250318_153504.png
2025-03-18 15:35:06,576 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_153504_20250318_153504.png
2025-03-18 15:35:06,576 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_153504_20250318_153504.png
2025-03-18 15:35:06,577 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 15:35:11,504 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_4.jpg
2025-03-18 15:35:11,508 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_4.jpg
2025-03-18 15:35:11,508 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 15:35:11,508 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 15:35:11,508 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 15:35:11,508 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 15:35:11,970 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 15:35:12,972 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 15:35:12,972 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:35:12,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:35:14,063 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 15:35:14,064 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 15:35:14,064 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 15:35:16,168 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 15:35:16,169 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 15:35:17,330 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 15:35:17,330 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:35:17,330 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:35:18,457 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 15:35:18,458 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 15:35:18,459 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:35:18,459 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 15:35:18,459 - QuickAppADBTester - INFO - 已发送终止信号到录制进程
2025-03-18 15:35:21,462 - QuickAppADBTester - INFO - 录制进程未响应终止信号，尝试强制终止...
2025-03-18 15:35:22,465 - QuickAppADBTester - INFO - 录制成功: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153336.mp4 (大小: 9.25MB)
2025-03-18 15:35:22,466 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 15:35:22,466 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153336.mp4
2025-03-18 15:35:22,466 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 15:35:35,163 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_5.mp4
2025-03-18 15:35:35,168 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_5.mp4
2025-03-18 15:35:35,191 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:35:36,197 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_5.mp4
2025-03-18 15:35:36,198 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-18 15:35:36,198 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 15:33:36\n- 结束时间: 2025-03-18 15:35:36\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_4.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_4.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "查看截图 3"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_5.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 15:35:36"}]}]}}
2025-03-18 15:35:36,750 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 15:35:36,752 - QuickAppADBTester - INFO - 测试完成
2025-03-18 15:35:36,753 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-18 15:36:36,953 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:36:36,954 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:36:36,954 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:36:36,954 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:36:37,070 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:36:37,230 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:36:37,230 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:36:37,230 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:36:37,230 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:36:37,480 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:36:37,481 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:36:37,481 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:36:37,481 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:36:38,953 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:36:38,954 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:36:40,180 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:36:40,180 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:36:40,180 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_153640.mp4
2025-03-18 15:36:40,201 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:36:41,206 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153640.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h265 --max-fps=15
2025-03-18 15:36:41,209 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153640.mp4
2025-03-18 15:36:43,210 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:36:43,211 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:36:43,211 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:36:43,438 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:36:43,438 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:36:43,438 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:36:43,438 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:36:44,906 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:36:44,908 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:36:46,165 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:36:46,165 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:36:46,165 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:36:46,165 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:36:46,165 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:36:47,258 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 15:36:47,258 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 15:36:47,262 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:36:47,262 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 15:36:47,262 - QuickAppADBTester - INFO - 已发送终止信号到录制进程
2025-03-18 15:36:50,265 - QuickAppADBTester - INFO - 录制成功: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153640.mp4 (大小: 0.36MB)
2025-03-18 15:36:50,265 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 15:36:50,265 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_153640.mp4
2025-03-18 15:36:50,265 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 15:36:55,846 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_6.mp4
2025-03-18 15:36:55,852 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_6.mp4
2025-03-18 15:36:55,878 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:36:56,879 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_6.mp4
2025-03-18 15:36:56,880 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-18 15:36:56,880 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-18 15:36:40\n- 结束时间: 2025-03-18 15:36:56\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_6.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 15:36:56"}]}]}}
2025-03-18 15:36:57,325 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-18 15:36:57,327 - QuickAppADBTester - INFO - 用户中断，定时测试任务已停止
2025-03-18 15:36:57,328 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-18 15:42:40,924 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:42:40,924 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:42:40,924 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:42:40,924 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:42:41,020 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:42:41,125 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:42:41,125 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:42:41,125 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:42:41,126 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:42:41,353 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:42:41,354 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:42:41,354 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:42:41,354 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:42:42,788 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:42:42,788 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:42:44,029 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:42:44,030 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:42:44,030 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_154244.mp4
2025-03-18 15:42:44,042 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:42:45,047 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154244.mp4 --no-playback --video-bit-rate=4M --max-size=720 --video-codec=h264 --max-fps=30 --no-audio --prefer-text --power-off-on-close
2025-03-18 15:42:45,049 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154244.mp4
2025-03-18 15:42:47,055 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:42:47,056 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:42:47,056 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:42:47,315 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:42:47,316 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:42:47,316 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:42:47,316 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:42:48,750 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:42:48,750 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:42:49,964 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:42:49,965 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:42:49,965 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:42:49,965 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:42:49,965 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:42:51,045 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 15:42:51,046 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 15:42:51,169 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 15:42:53,170 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 15:42:53,170 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 15:42:54,241 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 15:42:54,242 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 15:42:54,242 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:42:54,242 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 15:42:54,303 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:42:56,309 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 15:42:56,309 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 15:42:58,454 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 15:42:58,454 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 15:43:00,514 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 15:43:00,514 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 15:43:01,596 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 15:43:01,596 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 15:43:01,596 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:43:01,596 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 15:43:01,656 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:43:03,658 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 15:43:03,659 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 15:43:05,822 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 15:43:05,822 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 15:43:07,236 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 15:43:08,666 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 15:43:08,666 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 15:43:09,882 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 15:43:09,883 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 15:43:10,969 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 15:43:10,969 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 15:43:13,116 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 15:43:13,117 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 15:43:13,117 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:43:13,117 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:43:13,117 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:43:14,257 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 15:43:14,257 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 15:43:14,362 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 15:43:19,367 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 15:43:19,368 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 15:43:21,519 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 15:43:21,520 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 15:43:26,648 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 15:43:26,648 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 15:43:28,788 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 15:43:33,789 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 15:43:33,789 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 15:43:33,789 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 15:43:33,789 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 15:43:34,942 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 15:43:34,943 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 15:43:34,943 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:43:34,944 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 15:43:35,021 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:43:37,027 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 15:43:37,027 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 15:43:37,027 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 15:43:39,295 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 15:43:39,296 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 15:43:47,465 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 15:43:47,467 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 15:43:47,467 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 15:43:47,467 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:47,779 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 15:43:47,779 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:48,020 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 15:43:48,020 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:48,231 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 15:43:48,231 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:48,454 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 15:43:48,455 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:48,663 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 15:43:48,664 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:48,903 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 15:43:48,904 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:49,130 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 15:43:49,131 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:49,353 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 15:43:49,353 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:49,571 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 15:43:49,572 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:43:51,798 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 15:43:51,799 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 15:43:51,799 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 15:43:51,934 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b486407 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t243}
    * Task{21304d2 #243 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 15:43:51,934 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 15:43:51,935 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 15:43:51,935 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 15:43:51,935 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_154351_20250318_154351.png
2025-03-18 15:43:53,901 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_154351_20250318_154351.png
2025-03-18 15:43:53,901 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_154351_20250318_154351.png
2025-03-18 15:43:53,901 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 15:44:01,202 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_7.jpg
2025-03-18 15:44:01,206 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_7.jpg
2025-03-18 15:44:01,206 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 15:44:01,206 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:44:01,206 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:44:11,320 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 15:44:11,321 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 15:44:11,321 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 15:44:11,449 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b486407 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t243}
    * Task{21304d2 #243 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 15:44:11,450 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 15:44:11,450 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 15:44:11,450 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 15:44:11,450 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_154411_20250318_154411.png
2025-03-18 15:44:13,419 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_154411_20250318_154411.png
2025-03-18 15:44:13,420 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_154411_20250318_154411.png
2025-03-18 15:44:13,420 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 15:44:19,539 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_8.jpg
2025-03-18 15:44:19,543 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_8.jpg
2025-03-18 15:44:19,543 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 15:44:19,543 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 15:44:19,543 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 15:44:19,544 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 15:44:19,952 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 15:44:20,956 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 15:44:20,956 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:44:20,956 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:44:22,047 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 15:44:22,047 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 15:44:22,047 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 15:44:24,136 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 15:44:24,136 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 15:44:25,237 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 15:44:25,238 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:44:25,238 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:44:26,319 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 15:44:26,321 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 15:44:26,321 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:44:26,321 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 15:44:26,321 - QuickAppADBTester - INFO - 发送SIGINT信号到scrcpy进程
2025-03-18 15:44:31,343 - QuickAppADBTester - INFO - SIGINT未能终止进程，发送SIGTERM信号
2025-03-18 15:44:34,344 - QuickAppADBTester - INFO - 录制进程未响应终止信号，尝试强制终止...
2025-03-18 15:44:35,348 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154244.mp4 (大小: 9.50MB)
2025-03-18 15:44:44,299 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 15:44:44,299 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 15:44:44,344 - QuickAppADBTester - WARNING - 视频修复过程出错: Command '['ffmpeg', '-v', 'warning', '-i', '/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154244.mp4', '-c:v', 'copy', '-c:a', 'copy', '-y', '/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154244_fixed.mp4']' returned non-zero exit status 183.
2025-03-18 15:44:44,344 - QuickAppADBTester - INFO - 尝试直接使用原始视频文件...
2025-03-18 15:44:44,344 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 15:44:44,344 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154244.mp4
2025-03-18 15:44:44,344 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 15:44:53,145 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_9.mp4
2025-03-18 15:44:53,149 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_9.mp4
2025-03-18 15:44:53,163 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:44:54,168 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_9.mp4
2025-03-18 15:44:54,168 - QuickAppADBTester - INFO - 测试完成
2025-03-18 15:46:31,470 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:46:31,470 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:46:31,470 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:46:31,470 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:46:31,563 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:46:31,703 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:46:31,704 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:46:31,704 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:46:31,704 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:46:31,962 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:46:31,962 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:46:31,962 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:46:31,962 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:46:33,460 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:46:33,460 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:46:34,710 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:46:34,710 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:46:34,710 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_154634.mp4
2025-03-18 15:46:34,729 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:46:35,735 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4 --no-playback --video-bit-rate=4M --max-size=720 --video-codec=h264 --max-fps=30 --no-audio --prefer-text
2025-03-18 15:46:35,735 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4 --no-playback --video-bit-rate=4M --max-size=720 --video-codec=h264 --max-fps=30 --no-audio --prefer-text
2025-03-18 15:46:35,744 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4
2025-03-18 15:46:37,749 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:46:37,750 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:46:37,750 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:46:37,988 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:46:37,989 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:46:37,989 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:46:37,989 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:46:39,457 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:46:39,458 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:46:40,667 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:46:40,668 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:46:40,668 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:46:40,669 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:46:40,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:46:41,747 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 15:46:41,748 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 15:46:41,877 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 15:46:43,883 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 15:46:43,883 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 15:46:44,969 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 15:46:44,970 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 15:46:44,970 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:46:44,970 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 15:46:45,054 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:46:47,057 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 15:46:47,058 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 15:46:49,235 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 15:46:49,236 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 15:46:51,315 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 15:46:51,315 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 15:46:52,419 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 15:46:52,420 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 15:46:52,420 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:46:52,420 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 15:46:52,486 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:46:54,492 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 15:46:54,493 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 15:46:56,659 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 15:46:56,660 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 15:46:58,059 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 15:46:59,546 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 15:46:59,546 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 15:47:00,665 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 15:47:00,666 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 15:47:01,768 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 15:47:01,768 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 15:47:03,948 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 15:47:03,949 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 15:47:03,949 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:47:03,949 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:47:03,949 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:47:05,136 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 15:47:05,136 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 15:47:05,242 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 15:47:10,248 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 15:47:10,248 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 15:47:12,453 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 15:47:12,454 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 15:47:17,582 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 15:47:17,583 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 15:47:19,731 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 15:47:24,736 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 15:47:24,736 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 15:47:24,737 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 15:47:24,737 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 15:47:25,927 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 15:47:25,927 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 15:47:25,927 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:47:25,928 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 15:47:26,024 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:47:28,027 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 15:47:28,027 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 15:47:28,027 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 15:47:30,282 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 15:47:30,283 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 15:47:38,417 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 15:47:38,418 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 15:47:38,419 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 15:47:38,419 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:38,811 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 15:47:38,811 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:39,038 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 15:47:39,039 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:39,267 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 15:47:39,267 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:39,507 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 15:47:39,508 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:39,743 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 15:47:39,743 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:39,984 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 15:47:39,985 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:40,210 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 15:47:40,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:40,411 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 15:47:40,411 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:40,656 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 15:47:40,656 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 15:47:42,885 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 15:47:42,887 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 15:47:42,887 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 15:47:43,039 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{28bf705 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t248}
    * Task{ad27a68 #248 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 15:47:43,040 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 15:47:43,040 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 15:47:43,040 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 15:47:43,040 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_154743_20250318_154743.png
2025-03-18 15:47:44,339 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_154743_20250318_154743.png
2025-03-18 15:47:44,339 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_154743_20250318_154743.png
2025-03-18 15:47:44,340 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 15:47:49,947 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_10.jpg
2025-03-18 15:47:49,952 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_10.jpg
2025-03-18 15:47:49,952 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 15:47:49,952 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:47:49,952 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:48:00,105 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 15:48:00,106 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 15:48:00,106 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 15:48:00,218 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{28bf705 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t248}
    * Task{ad27a68 #248 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 15:48:00,219 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 15:48:00,219 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 15:48:00,219 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 15:48:00,219 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_154800_20250318_154800.png
2025-03-18 15:48:01,561 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_154800_20250318_154800.png
2025-03-18 15:48:01,561 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_154800_20250318_154800.png
2025-03-18 15:48:01,562 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 15:48:06,118 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_10.jpg
2025-03-18 15:48:06,121 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_10.jpg
2025-03-18 15:48:06,121 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 15:48:06,121 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 15:48:06,121 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 15:48:06,121 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 15:48:06,529 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 15:48:07,534 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 15:48:07,534 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:48:07,534 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:48:08,630 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 15:48:08,631 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 15:48:08,631 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 15:48:10,725 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 15:48:10,726 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 15:48:11,888 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 15:48:11,888 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:48:11,888 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:48:13,005 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 15:48:13,007 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 15:48:13,008 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:48:13,008 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 15:48:13,008 - QuickAppADBTester - INFO - 发送SIGINT信号到scrcpy进程
2025-03-18 15:48:18,042 - QuickAppADBTester - INFO - SIGINT未能终止进程，发送SIGTERM信号
2025-03-18 15:48:21,048 - QuickAppADBTester - INFO - 录制进程未响应终止信号，尝试强制终止...
2025-03-18 15:48:22,053 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4 (大小: 8.75MB)
2025-03-18 15:48:22,157 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 15:48:22,157 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 15:48:22,157 - QuickAppADBTester - INFO - 尝试策略1: 重新封装视频 ffmpeg -v warning -err_detect ignore_err -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4 -c:v copy -c:a copy -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634_fixed.mp4
2025-03-18 15:48:22,201 - QuickAppADBTester - WARNING - 策略1失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x13b804080] moov atom not found
[in#0 @ 0x600002a64000] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 15:48:22,201 - QuickAppADBTester - WARNING - 尝试策略2: 完全重新编码视频
2025-03-18 15:48:22,201 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4 -c:v h264 -preset ultrafast -crf 23 -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634_fixed.mp4
2025-03-18 15:48:22,242 - QuickAppADBTester - WARNING - 策略2失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x127e06af0] moov atom not found
[in#0 @ 0x600000ef0600] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 15:48:22,242 - QuickAppADBTester - WARNING - 视频修复过程出错: 所有修复策略都失败
2025-03-18 15:48:22,242 - QuickAppADBTester - INFO - 尝试直接使用原始视频文件...
2025-03-18 15:48:22,242 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 15:48:22,242 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154634.mp4
2025-03-18 15:48:22,242 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 15:48:30,754 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_11.mp4
2025-03-18 15:48:30,761 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_11.mp4
2025-03-18 15:48:30,790 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:48:31,796 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_11.mp4
2025-03-18 15:48:31,797 - QuickAppADBTester - INFO - 测试完成
2025-03-18 15:49:30,369 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:49:30,369 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:49:30,369 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:49:30,369 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:49:30,458 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:49:30,531 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:49:30,531 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:49:30,531 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:49:30,531 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:49:30,762 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:49:30,762 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:49:30,763 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:49:30,763 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:49:32,257 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:49:32,258 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:49:33,510 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:49:33,511 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:49:33,511 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_154933.mp4
2025-03-18 15:49:33,527 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:49:34,533 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933.mp4 --no-playback --video-bit-rate=4M --max-size=720 --video-codec=h264 --max-fps=30 --no-audio --prefer-text
2025-03-18 15:49:34,533 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933.mp4 --no-playback --video-bit-rate=4M --max-size=720 --video-codec=h264 --max-fps=30 --no-audio --prefer-text
2025-03-18 15:49:34,539 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933.mp4
2025-03-18 15:49:36,563 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:49:36,565 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:49:36,566 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:49:36,798 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:49:36,798 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:49:36,798 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:49:36,798 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:49:38,277 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:49:38,279 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:49:39,528 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:49:39,528 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:49:39,528 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:49:39,528 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:49:39,528 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:49:40,029 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:49:40,030 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 15:49:40,030 - QuickAppADBTester - INFO - 发送SIGINT信号到scrcpy进程
2025-03-18 15:49:40,535 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933.mp4 (大小: 0.20MB)
2025-03-18 15:49:40,642 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 15:49:40,642 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 15:49:40,642 - QuickAppADBTester - INFO - 尝试策略1: 重新封装视频 ffmpeg -v warning -err_detect ignore_err -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933.mp4 -c:v copy -c:a copy -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933_fixed.mp4
2025-03-18 15:49:40,689 - QuickAppADBTester - INFO - 策略1成功: 视频重新封装完成
2025-03-18 15:49:40,689 - QuickAppADBTester - INFO - 视频修复成功: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933_fixed.mp4 (大小: 0.20MB)
2025-03-18 15:49:40,689 - QuickAppADBTester - INFO - 已用修复后的文件替换原始文件
2025-03-18 15:49:40,689 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 15:49:40,689 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_154933.mp4
2025-03-18 15:49:40,689 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 15:49:45,636 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_12.mp4
2025-03-18 15:49:45,640 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_12.mp4
2025-03-18 15:49:45,663 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:49:46,667 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_12.mp4
2025-03-18 15:53:25,275 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:53:25,275 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:53:25,275 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:53:25,275 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:53:25,384 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:53:25,498 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:53:25,499 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:53:25,499 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:53:25,499 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:53:25,738 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:53:25,739 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:53:25,739 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:53:25,739 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:53:27,212 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:53:27,213 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:53:28,472 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:53:28,472 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:53:28,472 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_155328.mp4
2025-03-18 15:53:28,491 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:53:29,495 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_155328.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=movflags=faststart --max-fps=20 --no-audio --prefer-text
2025-03-18 15:53:29,495 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_155328.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=movflags=faststart --max-fps=20 --no-audio --prefer-text
2025-03-18 15:53:29,500 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_155328.mp4
2025-03-18 15:53:31,503 - QuickAppADBTester - ERROR - scrcpy录制进程启动失败，返回码: 1
2025-03-18 15:53:31,504 - QuickAppADBTester - ERROR - 错误输出: 2025-03-18 15:53:29.598 scrcpy[34808:2586540] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 66.2 MB/s (90640 bytes in 0.001s)
[server] ERROR: For input string: "faststart"
java.lang.NumberFormatException: For input string: "faststart"
	at java.lang.Integer.parseInt(Integer.java:615)
	at java.lang.Integer.parseInt(Integer.java:650)
	at com.genymobile.scrcpy.util.CodecOption.parseOption(CodecOption.java:95)
	at com.genymobile.scrcpy.util.CodecOption.parse(CodecOption.java:63)
	at com.genymobile.scrcpy.Options.parse(Options.java:397)
	at com.genymobile.scrcpy.Server.internalMain(Server.java:218)
	at com.genymobile.scrcpy.Server.main(Server.java:201)
	at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
	at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:392)
ERROR: Server connection failed

2025-03-18 15:53:31,504 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-18 15:53:31,504 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:53:31,504 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:53:31,504 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:53:31,738 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:53:31,739 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:53:31,739 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:53:31,739 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:53:33,221 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:53:33,222 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:53:34,469 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:53:34,469 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:53:34,469 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:53:34,469 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:53:34,470 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:53:35,549 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 15:53:35,549 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 15:53:35,665 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 15:53:37,671 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 15:53:37,671 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 15:53:38,750 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 15:53:38,750 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 15:53:38,750 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:53:38,750 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 15:53:38,797 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:53:40,808 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 15:53:40,809 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 15:53:42,972 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 15:53:42,972 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 15:53:45,070 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 15:53:45,070 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 15:53:46,201 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 15:53:46,202 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 15:53:46,202 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:53:46,202 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 15:53:46,350 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:53:48,357 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 15:53:48,358 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 15:53:50,526 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 15:53:50,526 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 15:53:50,747 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:53:50,747 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-18 15:53:50,747 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-18 15:53:54,094 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-18 15:53:54,094 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 15:53:54,094 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 15:53:54,094 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 15:53:54,148 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 15:53:54,212 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 15:53:54,212 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 15:53:54,213 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:53:54,213 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:53:54,347 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:53:54,347 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:53:54,347 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:53:54,347 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:53:55,732 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:53:55,732 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:53:56,992 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:53:56,992 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 15:53:56,993 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_155356.mp4
2025-03-18 15:53:57,008 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:53:58,013 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_155356.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=movflags=faststart --max-fps=20 --no-audio --prefer-text
2025-03-18 15:53:58,014 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_155356.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=movflags=faststart --max-fps=20 --no-audio --prefer-text
2025-03-18 15:53:58,020 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_155356.mp4
2025-03-18 15:54:00,026 - QuickAppADBTester - ERROR - scrcpy录制进程启动失败，返回码: 1
2025-03-18 15:54:00,027 - QuickAppADBTester - ERROR - 错误输出: 2025-03-18 15:53:58.104 scrcpy[35212:2588225] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 192.3 MB/s (90640 bytes in 0.000s)
[server] ERROR: For input string: "faststart"
java.lang.NumberFormatException: For input string: "faststart"
	at java.lang.Integer.parseInt(Integer.java:615)
	at java.lang.Integer.parseInt(Integer.java:650)
	at com.genymobile.scrcpy.util.CodecOption.parseOption(CodecOption.java:95)
	at com.genymobile.scrcpy.util.CodecOption.parse(CodecOption.java:63)
	at com.genymobile.scrcpy.Options.parse(Options.java:397)
	at com.genymobile.scrcpy.Server.internalMain(Server.java:218)
	at com.genymobile.scrcpy.Server.main(Server.java:201)
	at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
	at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:392)
ERROR: Server connection failed

2025-03-18 15:54:00,027 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-18 15:54:00,027 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 15:54:00,027 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 15:54:00,028 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 15:54:00,281 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 15:54:00,282 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 15:54:00,282 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 15:54:00,282 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 15:54:01,770 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:54:01,771 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:54:03,008 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 15:54:03,008 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 15:54:03,008 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 15:54:03,008 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 15:54:03,008 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 15:54:04,088 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 15:54:04,088 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 15:54:04,202 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 15:54:06,207 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 15:54:06,208 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 15:54:07,297 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 15:54:07,297 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 15:54:07,297 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 15:54:07,297 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 15:54:07,373 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 15:54:07,816 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 15:54:07,817 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-18 15:54:07,817 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-18 15:57:24,247 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:57:24,247 - QuickAppADBTester - INFO - 开始测试scrcpy录制功能
2025-03-18 15:57:24,247 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:58:14,412 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:58:14,412 - QuickAppADBTester - INFO - 开始测试scrcpy录制功能
2025-03-18 15:58:14,412 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:59:08,914 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:59:08,914 - QuickAppADBTester - INFO - 开始测试scrcpy录制功能
2025-03-18 15:59:08,914 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:59:08,932 - QuickAppADBTester - INFO - 开始录制，时长: 10 秒
2025-03-18 15:59:08,946 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:59:09,947 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 15:59:09,947 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 15:59:09,951 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4
2025-03-18 15:59:11,952 - QuickAppADBTester - INFO - 录制中... 10秒
2025-03-18 15:59:21,956 - QuickAppADBTester - INFO - 停止录制
2025-03-18 15:59:21,958 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 15:59:21,958 - QuickAppADBTester - INFO - 尝试模拟HOME键来温和终止scrcpy
2025-03-18 15:59:23,145 - QuickAppADBTester - INFO - 发送SIGINT信号到scrcpy进程
2025-03-18 15:59:28,185 - QuickAppADBTester - INFO - 尝试使用ADB命令终止scrcpy服务器端
2025-03-18 15:59:29,316 - QuickAppADBTester - INFO - SIGINT未能终止进程，发送SIGTERM信号
2025-03-18 15:59:32,318 - QuickAppADBTester - INFO - 录制进程未响应终止信号，尝试强制终止...
2025-03-18 15:59:33,321 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 (大小: 0.50MB)
2025-03-18 15:59:33,406 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 15:59:33,407 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 15:59:33,407 - QuickAppADBTester - INFO - 尝试策略1: 重新封装视频 ffmpeg -v warning -err_detect ignore_err -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908_fixed.mp4
2025-03-18 15:59:33,453 - QuickAppADBTester - WARNING - 策略1失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x159e302e0] moov atom not found
[in#0 @ 0x159e30070] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 15:59:33,453 - QuickAppADBTester - WARNING - 尝试策略2: 尝试修复视频损坏部分
2025-03-18 15:59:33,454 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -analyzeduration 2147483647 -probesize 2147483647 -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 -c:v copy -c:a copy -movflags faststart+frag_keyframe+empty_moov -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908_fixed.mp4
2025-03-18 15:59:33,494 - QuickAppADBTester - WARNING - 策略2失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x141706710] moov atom not found
[in#0 @ 0x1417064b0] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 15:59:33,494 - QuickAppADBTester - WARNING - 尝试策略3: 完全重新编码视频
2025-03-18 15:59:33,494 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 -c:v h264 -preset ultrafast -crf 23 -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908_fixed.mp4
2025-03-18 15:59:33,535 - QuickAppADBTester - WARNING - 策略3失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x1347066e0] moov atom not found
[in#0 @ 0x134706480] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 15:59:33,535 - QuickAppADBTester - WARNING - 视频修复过程出错: 所有修复策略都失败
2025-03-18 15:59:33,535 - QuickAppADBTester - INFO - 尝试直接使用原始视频文件...
2025-03-18 15:59:33,546 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 15:59:34,550 - QuickAppADBTester - INFO - 录制完成: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 (大小: 0.50MB)
2025-03-18 15:59:34,550 - QuickAppADBTester - INFO - 尝试使用ffmpeg修复视频...
2025-03-18 15:59:34,550 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908_fixed.mp4
2025-03-18 15:59:34,610 - QuickAppADBTester - ERROR - 视频修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x145f06690] moov atom not found
[in#0 @ 0x145f06440] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_155908.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 15:59:34,610 - QuickAppADBTester - INFO - ==================================================
2025-03-18 15:59:34,610 - QuickAppADBTester - INFO - 测试完成，原始视频可用但修复失败
2025-03-18 15:59:34,610 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:13:59,044 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:13:59,045 - QuickAppADBTester - INFO - 开始测试scrcpy录制功能
2025-03-18 16:13:59,045 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:13:59,064 - QuickAppADBTester - INFO - 开始录制，时长: 10 秒
2025-03-18 16:13:59,081 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:14:00,082 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:14:00,082 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:14:00,086 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4
2025-03-18 16:14:02,088 - QuickAppADBTester - INFO - 录制中... 10秒
2025-03-18 16:14:12,092 - QuickAppADBTester - INFO - 停止录制
2025-03-18 16:14:12,093 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 16:14:12,093 - QuickAppADBTester - INFO - 使用SIGINT优雅终止scrcpy (模拟CTRL+C)
2025-03-18 16:14:12,093 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0/10秒)
2025-03-18 16:14:12,599 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0.5/10秒)
2025-03-18 16:14:13,105 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.0/10秒)
2025-03-18 16:14:13,610 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.5/10秒)
2025-03-18 16:14:14,115 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.0/10秒)
2025-03-18 16:14:14,619 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.5/10秒)
2025-03-18 16:14:15,125 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.0/10秒)
2025-03-18 16:14:15,629 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.5/10秒)
2025-03-18 16:14:16,134 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.0/10秒)
2025-03-18 16:14:16,636 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.5/10秒)
2025-03-18 16:14:17,138 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.0/10秒)
2025-03-18 16:14:17,638 - QuickAppADBTester - INFO - scrcpy进程已终止，退出码: 0
2025-03-18 16:14:17,639 - QuickAppADBTester - INFO - scrcpy stderr输出: 2025-03-18 16:14:00.174 scrcpy[48654:2670817] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.4 MB/s (90640 bytes in 0.001s)
2025-03-18 16:14:00.978 scrcpy[48654:2670817] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:14:00.978 scrcpy[48654:2670817] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 16:14:17,639 - QuickAppADBTester - INFO - 等待2秒确保文件写入完成...
2025-03-18 16:14:19,643 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4 (大小: 0.53MB)
2025-03-18 16:14:19,766 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 16:14:19,766 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 16:14:19,766 - QuickAppADBTester - INFO - 使用ffprobe分析文件: ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4
2025-03-18 16:14:20,665 - QuickAppADBTester - INFO - 视频文件正常，时长: 16.019178秒
2025-03-18 16:14:20,666 - QuickAppADBTester - INFO - 视频文件完好，添加faststart标记: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359_fixed.mp4
2025-03-18 16:14:20,713 - QuickAppADBTester - INFO - 视频修复成功: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359_fixed.mp4 (大小: 0.53MB)
2025-03-18 16:14:20,713 - QuickAppADBTester - INFO - 已用修复后的文件替换原始文件 (原始文件备份为: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4.bak)
2025-03-18 16:14:20,724 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:14:21,729 - QuickAppADBTester - INFO - 录制完成: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4 (大小: 0.53MB)
2025-03-18 16:14:21,729 - QuickAppADBTester - INFO - 尝试使用ffmpeg修复视频...
2025-03-18 16:14:21,730 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359_fixed.mp4
2025-03-18 16:14:21,794 - QuickAppADBTester - INFO - 视频修复成功: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161359_fixed.mp4 (大小: 0.53MB)
2025-03-18 16:14:21,794 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:14:21,794 - QuickAppADBTester - INFO - 测试完成，scrcpy录制功能正常
2025-03-18 16:14:21,794 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:15:30,253 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:15:30,253 - QuickAppADBTester - INFO - 开始测试scrcpy录制功能
2025-03-18 16:15:30,253 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:15:30,267 - QuickAppADBTester - INFO - 开始录制，时长: 80 秒
2025-03-18 16:15:30,278 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:15:31,284 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:15:31,285 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:15:31,291 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4
2025-03-18 16:15:33,294 - QuickAppADBTester - INFO - 录制中... 80秒
2025-03-18 16:16:53,298 - QuickAppADBTester - INFO - 停止录制
2025-03-18 16:16:53,300 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 16:16:53,301 - QuickAppADBTester - INFO - 使用SIGINT优雅终止scrcpy (模拟CTRL+C)
2025-03-18 16:16:53,301 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0/10秒)
2025-03-18 16:16:53,803 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0.5/10秒)
2025-03-18 16:16:54,308 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.0/10秒)
2025-03-18 16:16:54,810 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.5/10秒)
2025-03-18 16:16:55,313 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.0/10秒)
2025-03-18 16:16:55,818 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.5/10秒)
2025-03-18 16:16:56,320 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.0/10秒)
2025-03-18 16:16:56,825 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.5/10秒)
2025-03-18 16:16:57,330 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.0/10秒)
2025-03-18 16:16:57,835 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.5/10秒)
2025-03-18 16:16:58,339 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.0/10秒)
2025-03-18 16:16:58,844 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.5/10秒)
2025-03-18 16:16:59,348 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (6.0/10秒)
2025-03-18 16:16:59,853 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (6.5/10秒)
2025-03-18 16:17:00,354 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (7.0/10秒)
2025-03-18 16:17:00,859 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (7.5/10秒)
2025-03-18 16:17:01,363 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (8.0/10秒)
2025-03-18 16:17:01,868 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (8.5/10秒)
2025-03-18 16:17:02,373 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (9.0/10秒)
2025-03-18 16:17:02,877 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (9.5/10秒)
2025-03-18 16:17:03,379 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试使用SIGTERM
2025-03-18 16:17:03,884 - QuickAppADBTester - INFO - scrcpy进程已终止，退出码: 0
2025-03-18 16:17:03,884 - QuickAppADBTester - INFO - scrcpy stderr输出: 2025-03-18 16:15:31.394 scrcpy[49713:2675108] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 111.3 MB/s (90640 bytes in 0.001s)
2025-03-18 16:15:32.133 scrcpy[49713:2675108] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:15:32.133 scrcpy[49713:2675108] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 16:17:03,884 - QuickAppADBTester - INFO - 等待2秒确保文件写入完成...
2025-03-18 16:17:05,889 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4 (大小: 2.13MB)
2025-03-18 16:17:05,992 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 16:17:05,992 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 16:17:05,992 - QuickAppADBTester - INFO - 使用ffprobe分析文件: ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4
2025-03-18 16:17:06,039 - QuickAppADBTester - INFO - 视频文件正常，时长: 91.065267秒
2025-03-18 16:17:06,039 - QuickAppADBTester - INFO - 视频文件完好，添加faststart标记: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530_fixed.mp4
2025-03-18 16:17:06,090 - QuickAppADBTester - INFO - 视频修复成功: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530_fixed.mp4 (大小: 2.13MB)
2025-03-18 16:17:06,090 - QuickAppADBTester - INFO - 已用修复后的文件替换原始文件 (原始文件备份为: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4.bak)
2025-03-18 16:17:06,101 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:17:07,102 - QuickAppADBTester - INFO - 录制完成: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4 (大小: 2.13MB)
2025-03-18 16:17:07,103 - QuickAppADBTester - INFO - 尝试使用ffmpeg修复视频...
2025-03-18 16:17:07,103 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530_fixed.mp4
2025-03-18 16:17:07,179 - QuickAppADBTester - INFO - 视频修复成功: /Users/ct/Desktop/huawei_auto/videos/test_scrcpy_20250318_161530_fixed.mp4 (大小: 2.13MB)
2025-03-18 16:17:07,179 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:17:07,179 - QuickAppADBTester - INFO - 测试完成，scrcpy录制功能正常
2025-03-18 16:17:07,179 - QuickAppADBTester - INFO - ==================================================
2025-03-18 16:20:29,883 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:20:29,883 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:20:29,883 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:20:29,975 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:20:30,088 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:20:30,088 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:20:30,088 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:20:30,088 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_162030.mp4
2025-03-18 16:20:30,103 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:20:31,107 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162030.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:20:31,107 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162030.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:20:31,112 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162030.mp4
2025-03-18 16:20:51,189 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:20:51,189 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:20:51,189 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:20:51,281 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:20:51,415 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:20:51,415 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:20:51,415 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:20:51,415 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_162051.mp4
2025-03-18 16:20:51,432 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:20:52,438 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:20:52,438 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:20:52,444 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4
2025-03-18 16:20:54,447 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:20:54,447 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:20:54,448 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:20:54,655 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:20:54,655 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:20:54,655 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:20:54,655 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:20:56,104 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:20:56,104 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:20:57,365 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 16:20:57,365 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 16:20:57,365 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:20:57,365 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:20:57,365 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:20:58,460 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 16:20:58,461 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 16:20:58,595 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 16:21:00,596 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 16:21:00,597 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 16:21:01,745 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 16:21:01,745 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 16:21:01,745 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:21:01,745 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 16:21:01,809 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:21:03,816 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 16:21:03,816 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 16:21:05,891 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 16:21:05,891 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 16:21:07,991 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 16:21:07,992 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 16:21:09,147 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 16:21:09,148 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 16:21:09,148 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:21:09,148 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 16:21:09,282 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:21:11,291 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 16:21:11,292 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 16:21:13,464 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 16:21:13,465 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 16:21:14,880 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 16:21:16,319 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 16:21:16,320 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 16:21:17,482 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 16:21:17,482 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 16:21:18,587 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 16:21:18,587 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 16:21:20,731 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 16:21:20,732 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 16:21:20,732 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:21:20,732 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:21:20,732 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:21:21,876 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 16:21:21,877 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 16:21:21,982 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 16:21:26,986 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 16:21:26,987 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 16:21:29,163 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 16:21:29,164 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 16:21:34,296 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 16:21:34,296 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 16:21:36,461 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 16:21:41,466 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 16:21:41,467 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 16:21:41,467 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 16:21:41,467 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 16:21:42,657 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 16:21:42,657 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 16:21:42,657 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:21:42,657 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 16:21:42,756 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:21:44,763 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 16:21:44,763 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 16:21:44,763 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 16:21:47,051 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 16:21:47,106 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 16:21:55,313 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 16:21:55,315 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 16:21:55,315 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 16:21:55,315 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:55,602 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 16:21:55,603 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:55,848 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 16:21:55,848 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:56,070 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 16:21:56,070 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:56,304 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 16:21:56,304 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:56,518 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 16:21:56,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:56,756 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 16:21:56,757 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:56,968 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 16:21:56,968 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:57,206 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 16:21:57,207 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:57,460 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 16:21:57,460 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:21:59,695 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 16:21:59,695 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:21:59,695 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:21:59,838 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{122fa06 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t254}
    * Task{9683ef4 #254 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:21:59,838 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:21:59,838 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 16:21:59,838 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 16:21:59,839 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_162159_20250318_162159.png
2025-03-18 16:22:02,350 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_162159_20250318_162159.png
2025-03-18 16:22:02,351 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_162159_20250318_162159.png
2025-03-18 16:22:02,351 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:22:10,032 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_13.jpg
2025-03-18 16:22:10,038 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_13.jpg
2025-03-18 16:22:10,038 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 16:22:10,038 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:22:10,039 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:22:20,245 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 16:22:20,246 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:22:20,246 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:22:20,340 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{122fa06 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t254}
    * Task{9683ef4 #254 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:22:20,340 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:22:20,340 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 16:22:20,340 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 16:22:20,341 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_162220_20250318_162220.png
2025-03-18 16:22:22,772 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_162220_20250318_162220.png
2025-03-18 16:22:22,772 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_162220_20250318_162220.png
2025-03-18 16:22:22,772 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:22:27,664 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_13.jpg
2025-03-18 16:22:27,668 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_13.jpg
2025-03-18 16:22:27,669 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 16:22:27,669 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 16:22:27,669 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 16:22:27,669 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 16:22:27,998 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 16:22:29,004 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 16:22:29,004 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:22:29,005 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:22:30,088 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 16:22:30,088 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 16:22:30,088 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 16:22:32,184 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 16:22:32,184 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 16:22:33,322 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 16:22:33,323 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:22:33,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:22:34,445 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 16:22:34,447 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 16:22:34,447 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:22:34,447 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 16:22:34,447 - QuickAppADBTester - INFO - 使用SIGINT优雅终止scrcpy (模拟CTRL+C)
2025-03-18 16:22:34,447 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0/10秒)
2025-03-18 16:22:34,949 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0.5/10秒)
2025-03-18 16:22:35,450 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.0/10秒)
2025-03-18 16:22:35,952 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.5/10秒)
2025-03-18 16:22:36,454 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.0/10秒)
2025-03-18 16:22:36,960 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.5/10秒)
2025-03-18 16:22:37,477 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.0/10秒)
2025-03-18 16:22:37,981 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.5/10秒)
2025-03-18 16:22:38,484 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.0/10秒)
2025-03-18 16:22:38,989 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.5/10秒)
2025-03-18 16:22:39,500 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.0/10秒)
2025-03-18 16:22:40,004 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.5/10秒)
2025-03-18 16:22:40,506 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (6.0/10秒)
2025-03-18 16:22:41,007 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (6.5/10秒)
2025-03-18 16:22:41,511 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (7.0/10秒)
2025-03-18 16:22:42,016 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (7.5/10秒)
2025-03-18 16:22:42,520 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (8.0/10秒)
2025-03-18 16:22:43,021 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (8.5/10秒)
2025-03-18 16:22:43,525 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (9.0/10秒)
2025-03-18 16:22:44,030 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (9.5/10秒)
2025-03-18 16:22:44,531 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试使用SIGTERM
2025-03-18 16:22:49,634 - QuickAppADBTester - INFO - SIGTERM未能终止进程，强制终止 (SIGKILL)
2025-03-18 16:22:49,652 - QuickAppADBTester - INFO - scrcpy进程已终止，退出码: -9
2025-03-18 16:22:49,810 - QuickAppADBTester - INFO - scrcpy stderr输出: 2025-03-18 16:20:52.540 scrcpy[53431:2690071] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 167.9 MB/s (90640 bytes in 0.001s)
2025-03-18 16:20:53.269 scrcpy[53431:2690071] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:20:53.269 scrcpy[53431:2690071] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 16:22:49,811 - QuickAppADBTester - INFO - 等待2秒确保文件写入完成...
2025-03-18 16:22:51,815 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4 (大小: 6.25MB)
2025-03-18 16:22:51,960 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 16:22:51,960 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 16:22:51,960 - QuickAppADBTester - INFO - 使用ffprobe分析文件: ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4
2025-03-18 16:22:52,039 - QuickAppADBTester - WARNING - ffprobe分析失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x125104550] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4: Invalid data found when processing input

2025-03-18 16:22:52,039 - QuickAppADBTester - INFO - 尝试策略2: 使用ffmpeg直接重编码视频
2025-03-18 16:22:52,039 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -err_detect ignore_err -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4 -c:v libx264 -preset ultrafast -crf 23 -movflags faststart -f mp4 -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051_fixed.mp4
2025-03-18 16:22:52,086 - QuickAppADBTester - WARNING - 策略2失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x139f048d0] moov atom not found
[in#0 @ 0x600003b34900] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 16:22:52,086 - QuickAppADBTester - WARNING - 视频修复失败，将使用原始视频文件
2025-03-18 16:22:52,086 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 16:22:52,086 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162051.mp4
2025-03-18 16:22:52,086 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 16:22:59,893 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_14.mp4
2025-03-18 16:22:59,898 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_14.mp4
2025-03-18 16:22:59,925 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:23:00,983 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_14.mp4
2025-03-18 16:23:00,983 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-18 16:23:00,984 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 16:20:51\n- 结束时间: 2025-03-18 16:23:00\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_13.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_13.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "查看截图 3"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_14.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:23:00"}]}]}}
2025-03-18 16:23:01,457 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 16:26:28,655 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:26:28,655 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:26:28,655 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:26:28,761 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:26:28,894 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:26:28,894 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:26:28,895 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:26:28,895 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_162628.mp4
2025-03-18 16:26:28,945 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:26:29,951 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162628.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=profile=baseline,level=3.0 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:26:29,951 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162628.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=profile=baseline,level=3.0 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:26:29,956 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162628.mp4
2025-03-18 16:26:31,959 - QuickAppADBTester - ERROR - scrcpy录制进程启动失败，返回码: 1
2025-03-18 16:26:31,960 - QuickAppADBTester - ERROR - 错误输出: 2025-03-18 16:26:30.053 scrcpy[57463:2707905] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 61.9 MB/s (90640 bytes in 0.001s)
[server] ERROR: For input string: "baseline"
java.lang.NumberFormatException: For input string: "baseline"
	at java.lang.Integer.parseInt(Integer.java:615)
	at java.lang.Integer.parseInt(Integer.java:650)
	at com.genymobile.scrcpy.util.CodecOption.parseOption(CodecOption.java:95)
	at com.genymobile.scrcpy.util.CodecOption.parse(CodecOption.java:50)
	at com.genymobile.scrcpy.Options.parse(Options.java:397)
	at com.genymobile.scrcpy.Server.internalMain(Server.java:218)
	at com.genymobile.scrcpy.Server.main(Server.java:201)
	at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
	at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:392)
ERROR: Server connection failed

2025-03-18 16:26:31,960 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-18 16:26:31,961 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:26:31,961 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:26:31,961 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:26:32,227 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:26:32,228 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:26:32,228 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:26:32,228 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:26:33,721 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:26:33,722 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:26:34,988 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 16:26:34,988 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 16:26:34,988 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:26:34,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:26:34,988 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:26:36,086 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 16:26:36,087 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 16:26:36,216 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 16:26:38,221 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 16:26:38,221 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 16:26:39,308 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 16:26:39,310 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 16:26:39,310 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:26:39,310 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 16:26:39,395 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:26:41,405 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 16:26:41,405 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 16:26:43,587 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 16:26:43,587 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 16:26:45,668 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 16:26:45,668 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 16:26:46,769 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 16:26:46,770 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 16:26:46,770 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:26:46,770 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 16:26:46,860 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:26:48,870 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 16:26:48,870 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 16:26:51,038 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 16:26:51,039 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 16:26:52,452 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 16:26:53,931 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 16:26:53,931 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 16:26:55,063 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 16:26:55,064 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 16:26:56,167 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 16:26:56,167 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 16:26:58,335 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 16:26:58,336 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 16:26:58,336 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:26:58,336 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:26:58,336 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:26:59,514 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 16:26:59,514 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 16:26:59,678 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 16:27:04,680 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 16:27:04,682 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 16:27:06,901 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 16:27:06,902 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 16:27:12,013 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 16:27:12,014 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 16:27:14,187 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 16:27:19,193 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 16:27:19,194 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 16:27:19,194 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 16:27:19,194 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 16:27:20,394 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 16:27:20,394 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 16:27:20,395 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:27:20,395 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 16:27:20,481 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:27:22,486 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 16:27:22,486 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 16:27:22,487 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 16:27:24,745 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 16:27:24,746 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 16:27:32,954 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 16:27:32,955 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 16:27:32,955 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 16:27:32,955 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:33,270 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 16:27:33,270 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:33,520 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 16:27:33,520 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:33,779 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 16:27:33,779 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:34,008 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 16:27:34,008 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:34,230 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 16:27:34,230 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:34,469 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 16:27:34,470 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:34,704 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 16:27:34,705 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:34,958 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 16:27:34,959 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:35,204 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 16:27:35,204 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:27:37,445 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 16:27:37,445 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:27:37,445 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:27:37,536 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7a8e4ae u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t259}
    * Task{3ce8ddc #259 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:27:37,537 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:27:37,537 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 16:27:37,537 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 16:27:37,537 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_162737_20250318_162737.png
2025-03-18 16:27:39,125 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_162737_20250318_162737.png
2025-03-18 16:27:39,125 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_162737_20250318_162737.png
2025-03-18 16:27:39,126 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:27:44,871 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_15.jpg
2025-03-18 16:27:44,875 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_15.jpg
2025-03-18 16:27:44,875 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 16:27:44,875 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:27:44,875 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:27:55,060 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 16:27:55,061 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:27:55,061 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:27:55,176 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7a8e4ae u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t259}
    * Task{3ce8ddc #259 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:27:55,176 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:27:55,177 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 16:27:55,177 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 16:27:55,177 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_162755_20250318_162755.png
2025-03-18 16:27:56,721 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_162755_20250318_162755.png
2025-03-18 16:27:56,721 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_162755_20250318_162755.png
2025-03-18 16:27:56,722 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:28:01,437 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_15.jpg
2025-03-18 16:28:01,439 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_15.jpg
2025-03-18 16:28:01,440 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 16:28:01,440 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 16:28:01,440 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 16:28:01,440 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 16:28:01,748 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 16:28:02,752 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 16:28:02,752 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:28:02,753 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:28:03,862 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 16:28:03,862 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 16:28:03,862 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 16:28:05,964 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 16:28:05,965 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 16:28:07,119 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 16:28:07,120 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:28:07,120 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:28:08,270 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 16:28:08,271 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 16:28:08,271 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:28:08,272 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-18 16:28:08,272 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-18 16:28:08,272 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-18 16:28:08,272 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 16:26:28\n- 结束时间: 2025-03-18 16:28:08\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_15.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_15.jpg"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:28:08"}]}]}}
2025-03-18 16:28:08,772 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 16:28:41,850 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:28:41,850 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:28:41,850 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:28:41,913 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:28:42,048 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:28:42,048 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:28:42,048 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:28:42,048 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_162842.mp4
2025-03-18 16:28:42,063 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:28:43,069 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162842.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=profile=baseline,level=3.0 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:28:43,069 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162842.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=profile=baseline,level=3.0 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:28:43,075 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_162842.mp4
2025-03-18 16:28:45,080 - QuickAppADBTester - ERROR - scrcpy录制进程启动失败，返回码: 1
2025-03-18 16:28:45,081 - QuickAppADBTester - ERROR - 错误输出: 2025-03-18 16:28:43.164 scrcpy[59031:2714199] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 164.6 MB/s (90640 bytes in 0.001s)
[server] ERROR: For input string: "baseline"
java.lang.NumberFormatException: For input string: "baseline"
	at java.lang.Integer.parseInt(Integer.java:615)
	at java.lang.Integer.parseInt(Integer.java:650)
	at com.genymobile.scrcpy.util.CodecOption.parseOption(CodecOption.java:95)
	at com.genymobile.scrcpy.util.CodecOption.parse(CodecOption.java:50)
	at com.genymobile.scrcpy.Options.parse(Options.java:397)
	at com.genymobile.scrcpy.Server.internalMain(Server.java:218)
	at com.genymobile.scrcpy.Server.main(Server.java:201)
	at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
	at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:392)
ERROR: Server connection failed

2025-03-18 16:28:45,082 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-18 16:28:45,082 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:28:45,082 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:28:45,082 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:28:45,318 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:28:45,318 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:28:45,319 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:28:45,319 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:28:45,915 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:28:45,916 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-18 16:28:45,916 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-18 16:28:45,916 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-18 16:28:45,916 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-18 16:28:42\n- 结束时间: 2025-03-18 16:28:45\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:28:45"}]}]}}
2025-03-18 16:28:46,382 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-18 16:30:15,622 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:30:15,623 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:30:15,623 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:30:15,723 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:30:15,842 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:30:15,842 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:30:15,842 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:30:15,842 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_163015.mp4
2025-03-18 16:30:15,860 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:30:16,863 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163015.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=profile=0,level=30 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:30:16,863 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163015.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --video-codec-options=profile=0,level=30 --max-fps=20 --no-audio --prefer-text
2025-03-18 16:30:16,869 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163015.mp4
2025-03-18 16:30:18,883 - QuickAppADBTester - ERROR - scrcpy录制进程启动失败，返回码: 2
2025-03-18 16:30:18,884 - QuickAppADBTester - ERROR - 错误输出: 2025-03-18 16:30:16.957 scrcpy[60288:2719462] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 83.7 MB/s (90640 bytes in 0.001s)
2025-03-18 16:30:17.730 scrcpy[60288:2719462] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:30:17.730 scrcpy[60288:2719462] +[IMKInputSession subclass]: chose IMKInputSession_Modern
[server] ERROR: Capture/encoding error: android.media.MediaCodec$CodecException: Error 0xffffffc3
WARN: Device disconnected
ERROR: Recording failed to /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163015.mp4
[server] ERROR: Exception on thread Thread[video,5,main]
android.media.MediaCodec$CodecException: Error 0xffffffc3
	at android.media.MediaCodec.native_configure(Native Method)
	at android.media.MediaCodec.configure(MediaCodec.java:2176)
	at android.media.MediaCodec.configure(MediaCodec.java:2092)
	at com.genymobile.scrcpy.video.SurfaceEncoder.streamCapture(SurfaceEncoder.java:92)
	at com.genymobile.scrcpy.video.SurfaceEncoder.lambda$start$0$com-genymobile-scrcpy-video-SurfaceEncoder(SurfaceEncoder.java:296)
	at com.genymobile.scrcpy.video.SurfaceEncoder$$ExternalSyntheticLambda0.run(D8$$SyntheticClass:0)
	at java.lang.Thread.run(Thread.java:930)

2025-03-18 16:30:18,893 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-18 16:30:18,893 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:30:18,894 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:30:18,894 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:30:19,124 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:30:19,125 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:30:19,125 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:30:19,125 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:30:20,603 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:30:20,604 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:30:21,843 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 16:30:21,844 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 16:30:21,844 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:30:21,844 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:30:21,844 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:30:22,925 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 16:30:22,927 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 16:30:23,037 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 16:30:25,043 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 16:30:25,043 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 16:30:26,128 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 16:30:26,129 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 16:30:26,129 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:30:26,129 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 16:30:26,212 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:30:27,040 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:30:27,040 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-18 16:30:27,041 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-18 16:30:27,041 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-18 16:30:27,041 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-18 16:30:15\n- 结束时间: 2025-03-18 16:30:27\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:30:27"}]}]}}
2025-03-18 16:30:27,491 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-18 16:31:09,985 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:31:09,985 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:31:09,985 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:31:10,099 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:31:10,233 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:31:10,233 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:31:10,233 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:31:10,233 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_163110.mp4
2025-03-18 16:31:10,251 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:31:11,257 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --video-buffer=100 --no-audio --prefer-text
2025-03-18 16:31:11,258 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --video-buffer=100 --no-audio --prefer-text
2025-03-18 16:31:11,267 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4
2025-03-18 16:31:13,273 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:31:13,273 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:31:13,273 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:31:13,509 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:31:13,510 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:31:13,510 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:31:13,510 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:31:14,955 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:31:14,955 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:31:16,184 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 16:31:16,185 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 16:31:16,185 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:31:16,185 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:31:16,185 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:31:17,278 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 16:31:17,279 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 16:31:17,395 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 16:31:19,400 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 16:31:19,400 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 16:31:20,527 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 16:31:20,528 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 16:31:20,528 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:31:20,528 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 16:31:20,606 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:31:22,612 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 16:31:22,612 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 16:31:24,673 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 16:31:24,674 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 16:31:26,761 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 16:31:26,761 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 16:31:27,938 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 16:31:27,938 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 16:31:27,939 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:31:27,939 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 16:31:28,071 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:31:30,079 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 16:31:30,080 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 16:31:32,273 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 16:31:32,274 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 16:31:33,684 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 16:31:35,167 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 16:31:35,168 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 16:31:36,330 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 16:31:36,331 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 16:31:37,425 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 16:31:37,425 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 16:31:39,555 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 16:31:39,556 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 16:31:39,556 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:31:39,556 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:31:39,557 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:31:40,740 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 16:31:40,741 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 16:31:40,854 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 16:31:45,857 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 16:31:45,859 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 16:31:48,041 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 16:31:48,042 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 16:31:53,166 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 16:31:53,167 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 16:31:55,318 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 16:32:00,319 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 16:32:00,321 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 16:32:00,321 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 16:32:00,321 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 16:32:01,475 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 16:32:01,475 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 16:32:01,475 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:32:01,475 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 16:32:01,578 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:32:03,584 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 16:32:03,585 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 16:32:03,585 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 16:32:05,862 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 16:32:05,864 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 16:32:14,050 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 16:32:14,051 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 16:32:14,051 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 16:32:14,051 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:14,349 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 16:32:14,350 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:14,596 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 16:32:14,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:14,813 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 16:32:14,814 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:15,070 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 16:32:15,071 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:15,312 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 16:32:15,312 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:15,557 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 16:32:15,558 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:15,787 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 16:32:15,788 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:16,018 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 16:32:16,018 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:16,262 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 16:32:16,263 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:32:18,527 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 16:32:18,527 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:32:18,527 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:32:18,663 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3991aa0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t264}
    * Task{ec421e #264 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:32:18,664 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:32:18,664 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 16:32:18,665 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 16:32:18,665 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_163218_20250318_163218.png
2025-03-18 16:32:20,520 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_163218_20250318_163218.png
2025-03-18 16:32:20,521 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_163218_20250318_163218.png
2025-03-18 16:32:20,522 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:32:26,492 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_16.jpg
2025-03-18 16:32:26,496 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_16.jpg
2025-03-18 16:32:26,496 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 16:32:26,498 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:32:26,498 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:32:36,668 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 16:32:36,670 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:32:36,670 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:32:36,834 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3991aa0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t264}
    * Task{ec421e #264 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:32:36,834 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:32:36,834 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 16:32:36,834 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 16:32:36,834 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_163236_20250318_163236.png
2025-03-18 16:32:38,671 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_163236_20250318_163236.png
2025-03-18 16:32:38,671 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_163236_20250318_163236.png
2025-03-18 16:32:38,671 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:32:44,042 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_16.jpg
2025-03-18 16:32:44,046 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_16.jpg
2025-03-18 16:32:44,046 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 16:32:44,046 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 16:32:44,046 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 16:32:44,046 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 16:32:44,451 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 16:32:45,456 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 16:32:45,456 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:32:45,456 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:32:46,546 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 16:32:46,546 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 16:32:46,547 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 16:32:48,644 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 16:32:48,644 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 16:32:49,764 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 16:32:49,764 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:32:49,764 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:32:50,882 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 16:32:50,882 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 16:32:50,882 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:32:50,883 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 16:32:50,883 - QuickAppADBTester - INFO - 先尝试按下HOME键，让scrcpy服务端自然结束录制
2025-03-18 16:32:52,017 - QuickAppADBTester - INFO - 使用SIGINT优雅终止scrcpy (模拟CTRL+C)
2025-03-18 16:32:52,018 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0/10秒)
2025-03-18 16:32:52,522 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0.5/10秒)
2025-03-18 16:32:53,025 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.0/10秒)
2025-03-18 16:32:53,528 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.5/10秒)
2025-03-18 16:32:54,034 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.0/10秒)
2025-03-18 16:32:54,538 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.5/10秒)
2025-03-18 16:32:55,039 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.0/10秒)
2025-03-18 16:32:55,543 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.5/10秒)
2025-03-18 16:32:56,047 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.0/10秒)
2025-03-18 16:32:56,549 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.5/10秒)
2025-03-18 16:32:57,056 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.0/10秒)
2025-03-18 16:32:57,559 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (5.5/10秒)
2025-03-18 16:32:58,088 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (6.0/10秒)
2025-03-18 16:32:58,614 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (6.5/10秒)
2025-03-18 16:32:59,117 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (7.0/10秒)
2025-03-18 16:32:59,622 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (7.5/10秒)
2025-03-18 16:33:00,123 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (8.0/10秒)
2025-03-18 16:33:00,625 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (8.5/10秒)
2025-03-18 16:33:01,127 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (9.0/10秒)
2025-03-18 16:33:01,631 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (9.5/10秒)
2025-03-18 16:33:02,135 - QuickAppADBTester - INFO - 尝试通过设备命令让scrcpy-server自然退出
2025-03-18 16:33:03,269 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试使用SIGTERM
2025-03-18 16:33:08,307 - QuickAppADBTester - INFO - SIGTERM未能终止进程，强制终止 (SIGKILL)
2025-03-18 16:33:08,317 - QuickAppADBTester - INFO - scrcpy进程已终止，退出码: -9
2025-03-18 16:33:08,443 - QuickAppADBTester - INFO - scrcpy stderr输出: 2025-03-18 16:31:11.362 scrcpy[60982:2722506] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 182.5 MB/s (90640 bytes in 0.000s)
2025-03-18 16:31:12.141 scrcpy[60982:2722506] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:31:12.141 scrcpy[60982:2722506] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 16:33:08,443 - QuickAppADBTester - INFO - 等待2秒确保文件写入完成...
2025-03-18 16:33:10,446 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4 (大小: 7.50MB)
2025-03-18 16:33:10,546 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 16:33:10,546 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 16:33:10,546 - QuickAppADBTester - INFO - 使用ffprobe分析文件: ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4
2025-03-18 16:33:10,591 - QuickAppADBTester - WARNING - ffprobe分析失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x121606af0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4: Invalid data found when processing input

2025-03-18 16:33:10,591 - QuickAppADBTester - INFO - 尝试策略2: 使用ffmpeg直接重编码视频
2025-03-18 16:33:10,591 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -err_detect ignore_err -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4 -c:v libx264 -preset ultrafast -crf 23 -movflags faststart -f mp4 -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110_fixed.mp4
2025-03-18 16:33:10,634 - QuickAppADBTester - WARNING - 策略2失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06b90] moov atom not found
[in#0 @ 0x6000006c8400] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 16:33:10,634 - QuickAppADBTester - WARNING - 视频修复失败，将使用原始视频文件
2025-03-18 16:33:10,634 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 16:33:10,634 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163110.mp4
2025-03-18 16:33:10,634 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 16:33:18,797 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_17.mp4
2025-03-18 16:33:18,801 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_17.mp4
2025-03-18 16:33:18,818 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:33:19,823 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_17.mp4
2025-03-18 16:33:19,824 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-18 16:33:19,824 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 16:31:10\n- 结束时间: 2025-03-18 16:33:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_16.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_16.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "查看截图 3"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_17.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:33:19"}]}]}}
2025-03-18 16:33:20,252 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 16:33:35,088 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:33:35,088 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:33:35,088 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:33:35,181 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:33:35,324 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:33:35,324 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:33:35,324 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:33:35,325 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_163335.mp4
2025-03-18 16:33:35,339 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:33:36,345 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --video-buffer=100 --no-audio --prefer-text
2025-03-18 16:33:36,345 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --video-buffer=100 --no-audio --prefer-text
2025-03-18 16:33:36,352 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4
2025-03-18 16:33:38,354 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:33:38,355 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:33:38,355 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:33:38,593 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:33:38,593 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:33:38,593 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:33:38,593 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:33:39,967 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:33:39,969 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:33:41,208 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 16:33:41,209 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 16:33:41,209 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:33:41,209 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:33:41,209 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:33:42,302 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 16:33:42,303 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 16:33:42,420 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 16:33:42,749 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:33:42,750 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 16:33:42,750 - QuickAppADBTester - INFO - 先尝试按下HOME键，让scrcpy服务端自然结束录制
2025-03-18 16:33:43,882 - QuickAppADBTester - INFO - 使用SIGINT优雅终止scrcpy (模拟CTRL+C)
2025-03-18 16:33:43,883 - QuickAppADBTester - INFO - scrcpy进程已终止，退出码: 2
2025-03-18 16:33:43,883 - QuickAppADBTester - INFO - scrcpy stderr输出: 2025-03-18 16:33:36.440 scrcpy[62675:2729240] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 163.2 MB/s (90640 bytes in 0.001s)
2025-03-18 16:33:37.195 scrcpy[62675:2729240] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:33:37.195 scrcpy[62675:2729240] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-18 16:33:43,884 - QuickAppADBTester - INFO - 等待2秒确保文件写入完成...
2025-03-18 16:33:45,886 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4 (大小: 1.27MB)
2025-03-18 16:33:45,986 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 16:33:45,986 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 16:33:45,986 - QuickAppADBTester - INFO - 使用ffprobe分析文件: ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4
2025-03-18 16:33:46,035 - QuickAppADBTester - INFO - 视频文件正常，时长: 5.504222秒
2025-03-18 16:33:46,035 - QuickAppADBTester - INFO - 视频文件完好，添加faststart标记: ffmpeg -v warning -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4 -c copy -movflags faststart -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335_fixed.mp4
2025-03-18 16:33:46,079 - QuickAppADBTester - INFO - 视频修复成功: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335_fixed.mp4 (大小: 1.27MB)
2025-03-18 16:33:46,079 - QuickAppADBTester - INFO - 已用修复后的文件替换原始文件 (原始文件备份为: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4.bak)
2025-03-18 16:33:46,079 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 16:33:46,079 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_163335.mp4
2025-03-18 16:33:46,079 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 16:33:52,049 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_18.mp4
2025-03-18 16:33:52,060 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_18.mp4
2025-03-18 16:33:52,100 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:33:53,105 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_18.mp4
2025-03-18 16:33:53,105 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-18 16:33:53,106 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-18 16:33:35\n- 结束时间: 2025-03-18 16:33:53\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_18.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:33:53"}]}]}}
2025-03-18 16:33:53,635 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-18 16:40:18,292 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 16:40:18,292 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 16:40:18,292 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 16:40:18,401 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 16:40:18,540 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 16:40:18,540 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 16:40:18,540 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 16:40:18,540 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_164018.mp4
2025-03-18 16:40:18,557 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:40:19,560 - QuickAppADBTester - INFO - 执行scrcpy录制命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --video-buffer=100 --no-audio --prefer-text
2025-03-18 16:40:19,561 - QuickAppADBTester - INFO - 最终执行的命令字符串: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4 --no-playback --video-bit-rate=2M --max-size=720 --video-codec=h264 --max-fps=20 --video-buffer=100 --no-audio --prefer-text
2025-03-18 16:40:19,570 - QuickAppADBTester - INFO - 开始录制设备屏幕，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4
2025-03-18 16:40:21,585 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 16:40:21,585 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 16:40:21,585 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 16:40:21,820 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 16:40:21,821 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 16:40:21,821 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 16:40:21,821 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 16:40:23,262 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:40:23,262 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:40:24,465 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 16:40:24,467 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 16:40:24,467 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:40:24,467 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:40:24,467 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:40:25,564 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 16:40:25,564 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 16:40:25,674 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 16:40:27,677 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 16:40:27,677 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 16:40:28,802 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 16:40:28,803 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 16:40:28,803 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:40:28,803 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 16:40:28,972 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:40:30,985 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 16:40:30,986 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 16:40:33,150 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 16:40:33,150 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 16:40:35,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 16:40:35,221 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 16:40:36,332 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 16:40:36,332 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 16:40:36,332 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:40:36,333 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 16:40:36,399 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:40:38,403 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 16:40:38,403 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 16:40:40,593 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 16:40:40,593 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 16:40:41,992 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 16:40:43,488 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 16:40:43,488 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 16:40:44,634 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 16:40:44,636 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 16:40:45,738 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 16:40:45,739 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 16:40:47,877 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 16:40:47,878 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 16:40:47,878 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 16:40:47,878 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:40:47,878 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:40:48,989 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 16:40:48,989 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 16:40:49,102 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 16:40:54,113 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 16:40:54,113 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 16:40:56,290 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 16:40:56,290 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 16:41:01,405 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 16:41:01,405 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 16:41:03,550 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 16:41:08,554 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 16:41:08,556 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 16:41:08,556 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 16:41:08,556 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 16:41:09,747 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 16:41:09,747 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 16:41:09,747 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 16:41:09,748 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 16:41:09,842 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 16:41:11,848 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 16:41:11,864 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 16:41:11,864 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 16:41:14,121 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 16:41:14,122 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 16:41:22,315 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 16:41:22,315 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 16:41:22,315 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 16:41:22,315 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:22,619 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 16:41:22,619 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:22,845 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 16:41:22,845 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:23,091 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 16:41:23,091 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:23,307 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 16:41:23,308 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:23,530 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 16:41:23,530 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:23,745 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 16:41:23,746 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:24,031 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 16:41:24,031 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:24,245 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 16:41:24,245 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:24,492 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 16:41:24,493 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 16:41:26,735 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 16:41:26,741 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:41:26,742 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:41:26,865 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4351d9f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t269}
    * Task{e14e2b5 #269 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:41:26,865 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:41:26,865 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 16:41:26,865 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 16:41:26,865 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_164126_20250318_164126.png
2025-03-18 16:41:28,544 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_164126_20250318_164126.png
2025-03-18 16:41:28,544 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_164126_20250318_164126.png
2025-03-18 16:41:28,545 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:41:35,421 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_19.jpg
2025-03-18 16:41:35,429 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_19.jpg
2025-03-18 16:41:35,429 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 16:41:35,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:41:35,430 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:41:45,569 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 16:41:45,570 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 16:41:45,570 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 16:41:45,662 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4351d9f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t269}
    * Task{e14e2b5 #269 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 16:41:45,663 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 16:41:45,663 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 16:41:45,663 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 16:41:45,663 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_164145_20250318_164145.png
2025-03-18 16:41:47,237 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_164145_20250318_164145.png
2025-03-18 16:41:47,238 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_164145_20250318_164145.png
2025-03-18 16:41:47,238 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 16:41:51,917 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_19.jpg
2025-03-18 16:41:51,922 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_19.jpg
2025-03-18 16:41:51,922 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 16:41:51,922 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 16:41:51,922 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 16:41:51,922 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 16:41:52,324 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 16:41:53,326 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 16:41:53,327 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:41:53,327 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:41:54,424 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 16:41:54,426 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 16:41:54,426 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 16:41:56,521 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 16:41:56,522 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 16:41:57,683 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 16:41:57,684 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 16:41:57,684 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 16:41:58,803 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 16:41:58,804 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 16:41:58,805 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 16:41:58,805 - QuickAppADBTester - INFO - 正在停止scrcpy录制进程...
2025-03-18 16:41:58,805 - QuickAppADBTester - INFO - 先尝试按下HOME键，让scrcpy服务端自然结束录制
2025-03-18 16:41:59,936 - QuickAppADBTester - INFO - 使用SIGINT优雅终止scrcpy (模拟CTRL+C)
2025-03-18 16:41:59,940 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0.0/5秒)
2025-03-18 16:42:00,442 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (0.5/5秒)
2025-03-18 16:42:00,943 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.0/5秒)
2025-03-18 16:42:01,449 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (1.5/5秒)
2025-03-18 16:42:01,953 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.0/5秒)
2025-03-18 16:42:02,459 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (2.5/5秒)
2025-03-18 16:42:02,963 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.0/5秒)
2025-03-18 16:42:03,469 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (3.5/5秒)
2025-03-18 16:42:03,972 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.0/5秒)
2025-03-18 16:42:04,473 - QuickAppADBTester - INFO - 等待scrcpy进程退出... (4.5/5秒)
2025-03-18 16:42:04,977 - QuickAppADBTester - INFO - 尝试通过设备命令让scrcpy-server自然退出
2025-03-18 16:42:06,162 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试使用SIGTERM
2025-03-18 16:42:11,200 - QuickAppADBTester - INFO - SIGTERM未能终止进程，强制终止 (SIGKILL)
2025-03-18 16:42:11,226 - QuickAppADBTester - INFO - scrcpy进程已终止，退出码: -9
2025-03-18 16:42:11,335 - QuickAppADBTester - INFO - scrcpy stderr输出: 2025-03-18 16:40:19.666 scrcpy[67627:2749241] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 138.8 MB/s (90640 bytes in 0.001s)
2025-03-18 16:40:20.471 scrcpy[67627:2749241] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 16:40:20.471 scrcpy[67627:2749241] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 16:42:11,335 - QuickAppADBTester - INFO - 等待5秒确保文件写入完成...
2025-03-18 16:42:16,337 - QuickAppADBTester - INFO - 原始录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4 (大小: 7.00MB)
2025-03-18 16:42:16,440 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 16:42:16,440 - QuickAppADBTester - INFO - 正在使用ffmpeg修复视频文件...
2025-03-18 16:42:16,440 - QuickAppADBTester - INFO - 使用ffprobe分析文件: ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4
2025-03-18 16:42:16,480 - QuickAppADBTester - WARNING - ffprobe分析失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x13bf04750] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4: Invalid data found when processing input

2025-03-18 16:42:16,480 - QuickAppADBTester - INFO - 尝试策略2: 使用ffmpeg直接重编码视频
2025-03-18 16:42:16,480 - QuickAppADBTester - INFO - 执行命令: ffmpeg -v warning -err_detect ignore_err -i /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4 -c:v libx264 -preset ultrafast -crf 23 -movflags faststart -f mp4 -y /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018_fixed.mp4
2025-03-18 16:42:16,520 - QuickAppADBTester - WARNING - 策略2失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12a706ba0] moov atom not found
[in#0 @ 0x600002e2c600] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 16:42:16,520 - QuickAppADBTester - WARNING - 视频修复失败，将使用原始视频文件
2025-03-18 16:42:16,520 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 16:42:16,520 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_164018.mp4
2025-03-18 16:42:16,520 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 16:42:24,547 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_20.mp4
2025-03-18 16:42:24,555 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_20.mp4
2025-03-18 16:42:24,584 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 16:42:25,586 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_20.mp4
2025-03-18 16:42:25,587 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-18 16:42:25,588 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 16:40:18\n- 结束时间: 2025-03-18 16:42:25\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_19.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_19.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "查看截图 3"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_20.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 16:42:25"}]}]}}
2025-03-18 16:42:25,995 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 18:28:47,528 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 18:28:47,528 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 18:28:47,528 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 18:28:47,817 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 18:28:47,969 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 18:28:47,970 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 18:28:47,970 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 18:28:47,970 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_182847.mp4
2025-03-18 18:28:47,994 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 18:28:48,997 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_182847.mp4
2025-03-18 18:28:48,997 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_182847.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-18 18:28:51,007 - QuickAppADBTester - INFO - 录制已开始...
2025-03-18 18:28:51,009 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 18:28:51,009 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 18:28:51,009 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 18:28:51,205 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 18:28:51,206 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 18:28:51,206 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 18:28:51,206 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 18:28:52,640 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:28:52,641 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:28:53,841 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 18:28:53,842 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 18:28:53,842 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 18:28:53,842 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:28:53,842 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:28:54,918 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 18:28:54,918 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 18:28:55,044 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 18:28:57,049 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 18:28:57,051 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 18:28:58,152 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 18:28:58,152 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 18:28:58,153 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 18:28:58,153 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 18:28:58,237 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 18:29:00,244 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 18:29:00,245 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 18:29:02,407 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 18:29:02,408 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 18:29:04,482 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 18:29:04,483 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 18:29:05,583 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 18:29:05,584 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 18:29:05,584 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 18:29:05,584 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 18:29:05,657 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 18:29:07,664 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 18:29:07,665 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 18:29:09,832 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 18:29:09,832 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 18:29:11,264 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 18:29:12,740 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 18:29:12,740 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 18:29:13,910 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 18:29:13,911 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 18:29:15,003 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 18:29:15,003 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 18:29:17,150 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 18:29:17,151 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 18:29:17,151 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 18:29:17,151 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:29:17,151 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:29:18,298 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 18:29:18,298 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 18:29:18,413 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 18:29:23,414 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 18:29:23,414 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 18:29:25,574 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 18:29:25,576 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 18:29:30,686 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 18:29:30,687 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 18:29:32,854 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 18:29:37,859 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 18:29:37,859 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 18:29:37,859 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 18:29:37,860 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 18:29:39,006 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 18:29:39,007 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 18:29:39,007 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 18:29:39,007 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 18:29:39,098 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 18:29:41,111 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 18:29:41,112 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 18:29:41,112 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 18:29:43,395 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 18:29:43,396 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 18:29:51,542 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 18:29:51,544 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 18:29:51,544 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 18:29:51,544 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:51,857 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 18:29:51,858 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:52,084 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 18:29:52,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:52,325 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 18:29:52,326 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:52,581 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 18:29:52,582 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:52,841 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 18:29:52,842 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:53,085 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 18:29:53,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:53,310 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 18:29:53,311 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:53,575 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 18:29:53,575 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:53,793 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 18:29:53,793 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:29:56,076 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 18:29:56,076 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 18:29:56,076 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 18:29:56,196 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{453ee45 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t283}
    * Task{94852cb #283 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 18:29:56,196 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 18:29:56,197 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 18:29:56,197 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 18:29:56,197 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_182956_20250318_182956.png
2025-03-18 18:29:57,845 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_182956_20250318_182956.png
2025-03-18 18:29:57,845 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_182956_20250318_182956.png
2025-03-18 18:29:57,845 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 18:30:05,096 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_21.jpg
2025-03-18 18:30:05,103 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_21.jpg
2025-03-18 18:30:05,104 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 18:30:05,104 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:30:05,104 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:30:15,212 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 18:30:15,214 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 18:30:15,214 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 18:30:15,333 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{453ee45 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t283}
    * Task{94852cb #283 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 18:30:15,334 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 18:30:15,334 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 18:30:15,334 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 18:30:15,335 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_183015_20250318_183015.png
2025-03-18 18:30:16,918 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_183015_20250318_183015.png
2025-03-18 18:30:16,918 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_183015_20250318_183015.png
2025-03-18 18:30:16,919 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 18:30:21,502 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_21.jpg
2025-03-18 18:30:21,510 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_21.jpg
2025-03-18 18:30:21,510 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 18:30:21,511 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 18:30:21,511 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 18:30:21,511 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 18:30:21,989 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 18:30:22,990 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 18:30:22,990 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:30:22,991 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:30:24,080 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 18:30:24,081 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 18:30:24,081 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 18:30:26,180 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 18:30:26,181 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 18:30:27,361 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 18:30:27,362 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:30:27,362 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:30:28,485 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 18:30:28,487 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 18:30:28,487 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 18:30:28,488 - QuickAppADBTester - INFO - 停止录制...
2025-03-18 18:30:28,488 - QuickAppADBTester - INFO - 发送HOME键
2025-03-18 18:30:29,625 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-18 18:30:29,626 - QuickAppADBTester - INFO - 等待进程退出... (1/5)
2025-03-18 18:30:30,631 - QuickAppADBTester - INFO - 等待进程退出... (2/5)
2025-03-18 18:30:31,634 - QuickAppADBTester - INFO - 等待进程退出... (3/5)
2025-03-18 18:30:32,635 - QuickAppADBTester - INFO - 等待进程退出... (4/5)
2025-03-18 18:30:33,641 - QuickAppADBTester - INFO - 等待进程退出... (5/5)
2025-03-18 18:30:34,646 - QuickAppADBTester - INFO - SIGINT未能终止进程，使用SIGTERM
2025-03-18 18:30:36,652 - QuickAppADBTester - INFO - SIGTERM未能终止进程，使用SIGKILL
2025-03-18 18:30:37,656 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-18 18:30:37,657 - QuickAppADBTester - INFO - stderr输出: 2025-03-18 18:28:49.103 scrcpy[55228:3079146] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 57.1 MB/s (90640 bytes in 0.002s)
2025-03-18 18:28:49.874 scrcpy[55228:3079146] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 18:28:49.874 scrcpy[55228:3079146] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 18:30:37,657 - QuickAppADBTester - INFO - 等待5秒确保文件写入完成...
2025-03-18 18:30:42,668 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_182847.mp4 (大小: 8.25MB)
2025-03-18 18:30:42,770 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-18 18:30:42,770 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-18 18:30:42,810 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x124e068f0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_182847.mp4: Invalid data found when processing input

2025-03-18 18:30:42,810 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-18 18:30:42,848 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x139f04550] moov atom not found
[in#0 @ 0x600000628700] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_182847.mp4.
Error opening input files: Invalid data found when processing input

2025-03-18 18:30:42,848 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 18:30:42,848 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_182847.mp4
2025-03-18 18:30:42,848 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 18:30:51,300 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_22.mp4
2025-03-18 18:30:51,308 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_22.mp4
2025-03-18 18:30:51,339 - QuickAppADBTester - INFO - 已终止所有scrcpy进程
2025-03-18 18:30:52,346 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_22.mp4
2025-03-18 18:30:52,346 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-18 18:30:52,347 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 18:28:47\n- 结束时间: 2025-03-18 18:30:52\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_21.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_21.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "查看截图 3"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_22.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 18:30:52"}]}]}}
2025-03-18 18:30:52,798 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-18 18:49:25,897 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-18 18:49:25,898 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-18 18:49:25,898 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-18 18:49:25,994 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-18 18:49:26,148 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-18 18:49:26,148 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-18 18:49:26,148 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-18 18:49:26,148 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250318_184926.mp4
2025-03-18 18:49:26,148 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 18:49:26,148 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 18:49:26,398 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-18 18:49:26,398 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-18 18:49:26,399 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-18 18:49:26,399 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-18 18:49:26,399 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-18 18:49:28,558 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 18:49:28,800 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 18:49:28,800 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-18 18:49:28,800 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 18:49:28,800 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 18:49:30,235 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:49:30,235 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:49:31,464 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 18:49:31,464 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-18 18:49:32,600 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-18 18:49:37,821 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-18 18:49:37,824 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-18 18:49:37,862 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-18 18:49:39,001 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_184926.mp4
2025-03-18 18:49:39,001 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_184926.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-18 18:49:41,011 - QuickAppADBTester - INFO - 录制已开始...
2025-03-18 18:49:44,022 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-18 18:49:44,023 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-18 18:49:47,027 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-18 18:49:47,028 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-18 18:49:47,028 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-18 18:49:47,287 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-18 18:49:47,287 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-18 18:49:47,287 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-18 18:49:47,287 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-18 18:49:48,739 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:49:48,739 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:49:49,958 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-18 18:49:49,958 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-18 18:49:49,958 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 18:49:49,958 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:49:49,958 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:49:51,036 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-18 18:49:51,037 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-18 18:49:51,160 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-18 18:49:53,165 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-18 18:49:53,166 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-18 18:49:54,254 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-18 18:49:54,255 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-18 18:49:54,255 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 18:49:54,255 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-18 18:49:54,339 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 18:49:56,346 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-18 18:49:56,348 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-18 18:49:58,508 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-18 18:49:58,508 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-18 18:50:00,577 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-18 18:50:00,577 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-18 18:50:01,755 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-18 18:50:01,756 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-18 18:50:01,756 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 18:50:01,756 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-18 18:50:01,820 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 18:50:03,822 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-18 18:50:03,823 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-18 18:50:05,996 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-18 18:50:05,996 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-18 18:50:07,420 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-18 18:50:08,866 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-18 18:50:08,868 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-18 18:50:10,038 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-18 18:50:10,039 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-18 18:50:11,143 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-18 18:50:11,144 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-18 18:50:13,326 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-18 18:50:13,327 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-18 18:50:13,328 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-18 18:50:13,328 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:50:13,328 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:50:14,120 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-18 18:50:14,495 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-18 18:50:14,495 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-18 18:50:14,622 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-18 18:50:19,623 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-18 18:50:19,624 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-18 18:50:21,793 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-18 18:50:21,794 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-18 18:50:26,945 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-18 18:50:26,947 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-18 18:50:29,114 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-18 18:50:34,118 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-18 18:50:34,118 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-18 18:50:34,118 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-18 18:50:34,119 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-18 18:50:35,278 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-18 18:50:35,278 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-18 18:50:35,279 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-18 18:50:35,279 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-18 18:50:35,375 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-18 18:50:37,386 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-18 18:50:37,386 - QuickAppADBTester - INFO - 按下回车键
2025-03-18 18:50:37,386 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-18 18:50:39,657 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-18 18:50:39,658 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-18 18:50:44,221 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-18 18:50:47,816 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-18 18:50:47,817 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-18 18:50:47,817 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-18 18:50:47,817 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:48,102 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-18 18:50:48,102 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:48,418 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-18 18:50:48,419 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:48,646 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-18 18:50:48,647 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:48,891 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-18 18:50:48,891 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:49,118 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-18 18:50:49,119 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:49,353 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-18 18:50:49,354 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:49,602 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-18 18:50:49,603 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:49,819 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-18 18:50:49,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:50,093 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-18 18:50:50,093 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-18 18:50:52,337 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-18 18:50:52,338 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 18:50:52,338 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 18:50:52,433 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f9ce7b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t288}
    * Task{10bd0f6 #288 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 18:50:52,433 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 18:50:52,433 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-18 18:50:52,433 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-18 18:50:52,434 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_185052_20250318_185052.png
2025-03-18 18:50:53,838 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_185052_20250318_185052.png
2025-03-18 18:50:53,839 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250318_185052_20250318_185052.png
2025-03-18 18:50:53,839 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 18:51:00,935 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_23.jpg
2025-03-18 18:51:00,943 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_23.jpg
2025-03-18 18:51:00,943 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-18 18:51:00,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:51:00,944 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:51:11,078 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-18 18:51:11,080 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-18 18:51:11,081 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-18 18:51:11,169 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f9ce7b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t288}
    * Task{10bd0f6 #288 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-18 18:51:11,169 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-18 18:51:11,170 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-18 18:51:11,170 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-18 18:51:11,171 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_185111_20250318_185111.png
2025-03-18 18:51:12,523 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_185111_20250318_185111.png
2025-03-18 18:51:12,524 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250318_185111_20250318_185111.png
2025-03-18 18:51:12,524 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-18 18:51:14,312 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-18 18:51:18,307 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_24.jpg
2025-03-18 18:51:18,310 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_24.jpg
2025-03-18 18:51:18,310 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-18 18:51:18,311 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-18 18:51:18,311 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-18 18:51:18,311 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-18 18:51:18,656 - QuickAppADBTester - INFO - 命令输出: 
2025-03-18 18:51:19,662 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-18 18:51:19,663 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:51:19,663 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:51:20,775 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-18 18:51:20,776 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-18 18:51:20,776 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-18 18:51:22,878 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-18 18:51:22,880 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-18 18:51:24,040 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-18 18:51:24,041 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:51:24,041 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:51:25,171 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-18 18:51:25,173 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-18 18:51:25,174 - QuickAppADBTester - INFO - 测试完成，按Home键回到桌面...
2025-03-18 18:51:25,174 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:51:25,174 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:51:30,279 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-18 18:51:30,281 - QuickAppADBTester - INFO - 按下Home键
2025-03-18 18:51:30,281 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-18 18:51:32,456 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-18 18:51:32,457 - QuickAppADBTester - INFO - 停止录制...
2025-03-18 18:51:32,457 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-18 18:51:34,411 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-18 18:51:36,549 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-18 18:51:36,550 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-18 18:51:36,550 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-18 18:51:37,551 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-18 18:51:38,552 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-18 18:51:39,558 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-18 18:51:40,562 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时5秒
2025-03-18 18:51:40,562 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-18 18:51:40,563 - QuickAppADBTester - INFO - stderr输出: 2025-03-18 18:49:39.102 scrcpy[71927:3142252] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 30.7 MB/s (90640 bytes in 0.003s)
2025-03-18 18:49:40.468 scrcpy[71927:3142252] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-18 18:49:40.468 scrcpy[71927:3142252] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-18 18:51:40,563 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-18 18:51:50,568 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_184926.mp4 (大小: 9.29MB)
2025-03-18 18:51:50,570 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-18 18:51:50,720 - QuickAppADBTester - INFO - 录制文件完整，时长: 119.452067秒，无需修复
2025-03-18 18:51:50,720 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-18 18:51:50,720 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250318_184926.mp4
2025-03-18 18:51:50,720 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-18 18:51:59,784 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_25.mp4
2025-03-18 18:51:59,792 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_25.mp4
2025-03-18 18:51:59,792 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-18 18:52:01,038 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-18 18:52:06,302 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-18 18:52:06,304 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_25.mp4
2025-03-18 18:52:06,304 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-18 18:52:06,305 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-18 18:49:26\n- 结束时间: 2025-03-18 18:52:06\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_23.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_24.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "查看截图 3"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_25.mp4"}]}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-18 18:52:06"}]}]}}
2025-03-18 18:52:06,748 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
