2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 09:50:30,296 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:30,659 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:32,114 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:32,115 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:33,314 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_095033.mp4
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:33,463 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:34,855 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:34,855 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:36,096 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:36,097 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:50:37,180 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:50:42,431 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:50:42,432 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 09:50:42,477 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 09:50:43,610 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4
2025-03-19 09:50:43,610 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 09:50:45,622 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 09:50:48,627 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 09:50:48,627 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 09:50:51,630 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 09:50:51,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:51,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:51,899 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:51,899 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:51,900 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:51,900 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:53,368 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:53,369 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:54,577 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:54,577 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:55,655 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 09:50:55,656 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 09:50:55,767 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 09:50:57,773 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 09:50:57,773 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 09:50:58,898 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 09:50:58,898 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 09:50:58,899 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:50:58,899 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 09:50:58,971 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:51:00,980 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 09:51:00,980 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 09:51:03,138 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 09:51:03,138 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 09:51:05,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 09:51:05,221 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 09:51:06,317 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 09:51:06,388 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:51:07,283 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 09:51:09,182 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 09:51:11,320 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 09:50:44.022 scrcpy[73813:3514663] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 54.0 MB/s (90640 bytes in 0.002s)
2025-03-19 09:50:44.887 scrcpy[73813:3514663] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 09:50:44.887 scrcpy[73813:3514663] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 09:51:05.940 scrcpy[73813:3514663] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 09:51:21,325 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4 (大小: 1.53MB)
2025-03-19 09:51:21,325 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 09:51:21,537 - QuickAppADBTester - INFO - 录制文件完整，时长: 22.455544秒，无需修复
2025-03-19 09:51:21,537 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:51:22,674 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:51:27,931 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:51:30,104 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 09:51:30,104 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 09:51:30,105 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 09:51:30,105 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 09:51:30,105 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 09:50:33\n- 结束时间: 2025-03-19 09:51:30\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 09:51:30"}]}]}}
2025-03-19 09:51:30,736 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 09:56:40,931 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 09:56:41,334 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 09:56:41,334 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 09:56:43,552 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:43,765 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:56:45,184 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:56:45,185 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:56:46,418 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_095646.mp4
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:56:47,963 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:56:47,965 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:56:49,211 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:56:49,212 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:56:50,341 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:56:55,594 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:56:55,596 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 09:56:55,638 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 09:56:56,772 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4
2025-03-19 09:56:56,772 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 09:56:58,784 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 09:57:01,790 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 09:57:01,791 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 09:57:04,796 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 09:57:04,796 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:57:04,797 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:57:05,049 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:57:06,514 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:06,514 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:07,748 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:08,829 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 09:57:08,829 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 09:57:08,920 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 09:57:10,925 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 09:57:10,926 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 09:57:12,017 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 09:57:12,092 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:57:14,101 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 09:57:14,101 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 09:57:16,179 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 09:57:16,180 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 09:57:18,280 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 09:57:18,281 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 09:57:19,414 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 09:57:19,414 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 09:57:19,415 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:57:19,415 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 09:57:19,513 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 09:57:21,720 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 09:57:23,860 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 09:57:23,860 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 09:56:56.880 scrcpy[80193:3537006] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 180.2 MB/s (90640 bytes in 0.000s)
2025-03-19 09:56:57.557 scrcpy[80193:3537006] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 09:56:57.557 scrcpy[80193:3537006] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 09:57:18.274 scrcpy[80193:3537006] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 09:57:33,864 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4 (大小: 1.58MB)
2025-03-19 09:57:33,865 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 09:57:33,980 - QuickAppADBTester - INFO - 录制文件完整，时长: 22.249744秒，无需修复
2025-03-19 09:57:33,981 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 09:57:33,981 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4
2025-03-19 09:57:33,982 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 09:57:41,619 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_33.mp4
2025-03-19 09:57:41,625 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_33.mp4
2025-03-19 09:57:41,625 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:57:42,815 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:57:48,083 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:50,273 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 09:57:50,274 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 09:57:50,274 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 09:57:50,274 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 09:57:50,275 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 09:56:46\n- 结束时间: 2025-03-19 09:57:50\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 09:57:50"}]}]}}
2025-03-19 09:57:51,013 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:01:22,584 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:22,998 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:01:25,137 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:25,336 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:25,336 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:01:25,337 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:25,337 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:26,745 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:26,746 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:28,027 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100128.mp4
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:29,588 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:29,588 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:30,864 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:30,864 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:01:31,950 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:01:37,172 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:01:37,174 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:01:37,224 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:01:38,357 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4
2025-03-19 10:01:38,357 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:01:40,371 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:01:43,374 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:01:43,375 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:46,633 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:48,115 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:48,115 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:49,387 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:50,487 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:01:50,487 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:01:50,599 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:01:52,604 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:01:52,605 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:01:53,754 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:01:53,826 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:01:55,835 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:01:55,835 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:01:56,496 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:01:58,298 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:02:00,433 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:02:00,435 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:01:38.469 scrcpy[84982:3553737] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.9 MB/s (90640 bytes in 0.001s)
WARN: Device disconnected

2025-03-19 10:02:00,435 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:02:10,440 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4 (大小: 1.42MB)
2025-03-19 10:02:10,441 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 录制文件完整，时长: 17.299778秒，无需修复
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:02:17,073 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:17,080 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:17,081 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:02:18,269 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:02:23,526 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:02:23,528 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:23,528 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:02:23,529 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:02:23\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:02:23"}]}]}}
2025-03-19 10:02:24,133 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:02:24,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:02:24,136 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:02:26,334 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:02:26,335 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:02:26,336 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:02:26,336 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 10:02:26,336 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:01:28\n- 结束时间: 2025-03-19 10:02:26\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:02:26"}]}]}}
2025-03-19 10:02:26,904 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:07:54,476 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:07:54,815 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:07:56,305 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:07:56,306 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:07:57,565 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:07:57,565 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100757.mp4
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:07:57,719 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:07:59,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:07:59,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:00,342 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:08:00,343 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:08:01,479 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:08:06,713 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:08:06,715 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:08:06,751 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:08:07,884 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4
2025-03-19 10:08:07,885 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:08:09,896 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:08:12,900 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:08:12,901 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:08:15,902 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:08:15,902 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:08:15,903 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:08:16,207 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:08:17,679 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:17,679 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:18,897 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:19,974 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:08:19,975 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:08:20,096 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:08:22,101 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:08:22,102 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:08:23,252 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:08:23,336 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:08:25,338 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:08:25,339 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:08:27,420 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:08:27,421 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:08:27,446 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:08:29,293 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:08:31,432 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:08:07.992 scrcpy[91768:3576905] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 134.1 MB/s (90640 bytes in 0.001s)
2025-03-19 10:08:08.729 scrcpy[91768:3576905] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:08:08.729 scrcpy[91768:3576905] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:08:41,439 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4 (大小: 1.49MB)
2025-03-19 10:08:41,439 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:08:41,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 18.504944秒，无需修复
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:08:48,920 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:48,923 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:48,923 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:08:50,167 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:08:55,416 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:08:55,417 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:55,417 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:08:55,418 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:08:55\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:08:55"}]}]}}
2025-03-19 10:08:55,945 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:08:55,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:55,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:58,124 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:08:58,125 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:08:58,125 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:08:58,125 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 10:08:58,126 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:07:57\n- 结束时间: 2025-03-19 10:08:58\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:08:58"}]}]}}
2025-03-19 10:08:58,636 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:09:27,706 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:09:27,766 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:29,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:29,421 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:30,630 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:30,630 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100930.mp4
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:30,815 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:32,219 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:32,220 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:33,435 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:33,435 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:09:34,572 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:09:39,842 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:09:39,843 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:09:39,878 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:09:41,062 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4
2025-03-19 10:09:41,062 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:09:43,071 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:09:46,075 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:09:46,075 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:49,310 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:50,775 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:50,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:53,139 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:09:53,139 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:09:53,264 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:09:55,265 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:09:55,265 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:09:56,339 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:09:56,340 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:09:56,341 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:09:56,341 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:09:56,422 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:09:58,426 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:09:58,426 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:10:00,601 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:10:00,602 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:10:02,729 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:10:02,730 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:10:03,876 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:10:04,026 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:10:06,033 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:10:06,034 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:10:08,194 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:10:08,195 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:10:09,620 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:10:11,100 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:10:11,100 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:10:12,257 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:10:12,258 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:10:13,353 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:10:13,354 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:10:15,526 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:10:16,169 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:10:16,700 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:10:16,700 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:10:16,821 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:10:21,826 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:10:21,827 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:10:23,969 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:10:23,970 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:10:29,123 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:10:29,124 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:10:31,293 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:10:36,299 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:10:37,476 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:10:37,476 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:10:37,477 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:10:37,477 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:10:37,573 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:10:39,578 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:10:39,579 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:10:39,579 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:10:41,843 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:10:41,844 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:10:46,283 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:10:50,032 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,310 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:10:50,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,588 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:10:50,589 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,819 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:10:50,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,067 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:10:51,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,287 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:10:51,288 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,509 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:10:51,510 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,763 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:10:51,763 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:52,009 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:10:52,009 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:52,283 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:10:52,284 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:54,518 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:10:54,520 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:10:54,520 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:10:54,640 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f336ba4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t324}
    * Task{47be4c2 #324 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:11:01,941 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg
2025-03-19 10:11:01,949 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg
2025-03-19 10:11:01,949 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:11:01,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:11:01,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:11:05,773 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:11:07,793 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:09:41.186 scrcpy[93340:3582202] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 139.6 MB/s (90640 bytes in 0.001s)
2025-03-19 10:09:41.924 scrcpy[93340:3582202] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:09:41.924 scrcpy[93340:3582202] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:11:19,989 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4 (大小: 9.13MB)
2025-03-19 10:11:19,991 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:11:20,154 - QuickAppADBTester - INFO - 录制文件完整，时长: 83.779578秒，无需修复
2025-03-19 10:11:20,154 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:11:20,155 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4
2025-03-19 10:11:20,155 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:11:28,422 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:28,429 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:28,429 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:11:29,570 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:11:34,821 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:11:34,822 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:34,822 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:11:34,823 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:11:34\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:11:34"}]}]}}
2025-03-19 10:11:35,363 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:11:35,365 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:11:37,480 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:11:37,481 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:11:37,481 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:11:37,481 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:11:37,482 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:09:30\n- 结束时间: 2025-03-19 10:11:37\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:11:37"}]}]}}
2025-03-19 10:11:38,004 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:16:29,031 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:16:29,139 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:29,342 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:16:31,519 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:31,691 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:33,116 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:33,117 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_101634.mp4
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:34,335 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:34,511 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:35,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:35,916 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:37,178 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:37,178 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:16:38,370 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:16:43,612 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:16:43,614 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:16:43,662 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:16:44,845 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4
2025-03-19 10:16:44,846 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:16:46,858 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:16:49,862 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:16:49,862 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:16:52,867 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:16:52,868 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:52,868 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:53,184 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:54,659 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:54,660 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:55,870 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:56,961 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:16:56,961 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:16:57,085 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:16:59,098 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:16:59,098 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:17:00,311 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:17:00,393 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:02,401 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:17:02,401 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:17:04,478 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:17:04,480 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:17:06,581 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:17:06,582 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:17:07,722 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:17:07,722 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:17:07,728 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:07,733 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:17:07,820 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:09,826 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:17:09,826 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:17:11,993 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:17:11,995 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:17:13,417 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:17:14,865 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:17:14,866 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:17:16,009 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:17:16,009 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:17:17,105 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:17:17,106 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:17:19,284 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:17:19,967 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:17:20,441 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:17:20,442 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:17:20,555 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:17:25,557 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:17:25,557 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:17:27,706 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:17:27,706 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:17:32,860 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:17:32,861 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:17:35,000 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:17:40,002 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:17:41,195 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:17:45,459 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:17:45,460 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:17:50,055 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:17:53,582 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:53,914 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:17:53,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,164 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:17:54,165 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,407 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:17:54,407 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,659 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:17:54,659 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,878 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:17:54,879 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,099 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:17:55,100 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,357 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:17:55,358 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,579 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:17:55,580 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,823 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:17:55,824 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:58,054 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:17:58,055 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:17:58,055 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:17:58,168 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3ca8274 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t334}
    * Task{9cd6012 #334 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:18:06,570 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:18:09,106 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:18:11,029 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:18:13,215 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:18:13,217 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:18:13,217 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:16:44.952 scrcpy[958:3608236] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 169.8 MB/s (90640 bytes in 0.001s)
2025-03-19 10:16:45.772 scrcpy[958:3608236] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:16:45.772 scrcpy[958:3608236] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:18:23,221 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4 (大小: 6.86MB)
2025-03-19 10:18:23,223 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 录制文件完整，时长: 83.310744秒，无需修复
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:18:31,109 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:31,117 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:31,118 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:18:32,255 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:18:37,512 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:18:37,514 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:18:39,643 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:39,644 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-19 10:18:39,645 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:16:34\n- 中断时间: 2025-03-19 10:18:39\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:18:39"}]}]}}
2025-03-19 10:18:40,138 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:19:13,307 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:13,564 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:19:15,684 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:15,852 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:17,278 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:17,279 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:18,495 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_101918.mp4
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:18,667 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:20,084 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:20,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:21,268 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:21,269 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:19:22,406 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:19:27,642 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:19:27,643 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:19:27,681 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:19:28,820 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4
2025-03-19 10:19:28,821 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:19:30,828 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:19:33,834 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:19:33,835 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:19:36,837 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:19:36,838 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:36,838 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:37,014 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:38,427 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:38,428 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:39,629 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:39,629 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:40,719 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:19:40,719 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:19:40,844 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:19:42,848 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:19:42,848 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:19:44,907 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:19:46,992 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:19:46,994 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:19:28.914 scrcpy[3769:3618608] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 180.0 MB/s (90640 bytes in 0.000s)
2025-03-19 10:19:29.574 scrcpy[3769:3618608] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:19:29.574 scrcpy[3769:3618608] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 10:19:40.385 scrcpy[3769:3618608] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 10:19:46,994 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:19:56,998 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4 (大小: 1.08MB)
2025-03-19 10:19:56,999 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.577578秒，无需修复
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:20:03,302 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:03,306 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:03,306 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:20:04,448 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:20:09,693 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:20:09,695 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:20:09,695 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:20:11,830 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:11,832 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:20:11,833 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:19:18\n- 中断时间: 2025-03-19 10:20:11\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:20:11"}]}]}}
2025-03-19 10:20:12,406 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:25:38,535 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:25:38,821 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:25:39,404 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:25:39,404 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:25:57,486 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:25:59,082 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:25:59,083 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_102600.mp4
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:26:00,509 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:26:01,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:01,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:03,157 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:03,158 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:26:04,284 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:26:09,535 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:26:09,536 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:26:09,561 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:26:10,698 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4
2025-03-19 10:26:10,699 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:26:12,708 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:26:15,714 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:26:15,715 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:26:18,984 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:26:20,434 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:20,435 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:21,636 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:22,716 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:26:22,717 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:26:22,828 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:26:24,832 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:26:24,832 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:26:25,932 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:26:26,016 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:26:28,020 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:26:28,020 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:26:30,197 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:26:30,198 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:26:32,282 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:26:32,284 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:26:33,424 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:26:33,424 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:26:33,425 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:26:33,425 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:26:33,599 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:26:35,603 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:26:35,604 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:26:37,808 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:26:37,809 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:26:39,237 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:26:40,668 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:26:40,669 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:26:41,843 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:26:41,844 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:26:42,959 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:26:42,960 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:26:45,123 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:26:45,124 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:45,803 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:26:46,263 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:26:46,263 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:26:46,383 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:26:51,377 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:26:51,378 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:26:53,515 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:26:53,516 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:26:58,661 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:26:58,663 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:27:00,814 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:27:06,965 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:27:06,966 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:27:06,966 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:27:06,967 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:27:07,069 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:27:09,077 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:27:09,078 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:27:09,078 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:27:11,346 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:27:11,346 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:27:15,884 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:27:19,493 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:27:19,493 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:27:19,494 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:27:19,494 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:19,776 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:27:19,777 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,100 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:27:20,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,342 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:27:20,343 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,603 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:27:20,604 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,838 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:27:20,839 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,070 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:27:21,071 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,318 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:27:21,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,565 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:27:21,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,808 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:27:21,809 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:24,046 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:27:24,047 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:27:24,047 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:27:24,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f53a7c7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t346}
    * Task{a079d1d #346 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,863 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,864 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,865 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:27:32,930 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:43,031 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:27:43,032 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:27:43,032 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:27:43,168 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f53a7c7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t346}
    * Task{a079d1d #346 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:27:43,168 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,854 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,855 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,855 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:27:45,990 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-19 10:27:50,826 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg
2025-03-19 10:27:50,834 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:27:51,230 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:27:52,234 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:27:52,235 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:52,235 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:27:55,436 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:27:55,436 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:27:56,557 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:27:56,558 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:56,558 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:57,672 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:27:57,675 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:27:57,675 - QuickAppADBTester - INFO - 测试完成，按Home键回到桌面...
2025-03-19 10:27:57,676 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:57,676 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:28:02,807 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:28:02,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:28:02,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:28:04,993 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:28:04,994 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:28:04,994 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:28:06,946 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:28:09,077 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:28:09,078 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:28:09,078 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:28:10,081 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:28:11,087 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:28:12,088 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时4秒
2025-03-19 10:28:12,089 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 10:28:12,089 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:26:10.805 scrcpy[10339:3641503] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.1 MB/s (90640 bytes in 0.000s)
2025-03-19 10:26:11.547 scrcpy[10339:3641503] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:26:11.547 scrcpy[10339:3641503] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:28:12,090 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:28:22,092 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4 (大小: 10.87MB)
2025-03-19 10:28:22,094 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 录制文件完整，时长: 119.878189秒，无需修复
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:28:30,765 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:30,771 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:30,772 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:28:32,019 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:28:37,268 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:28:37,270 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:37,270 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:28:37,271 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:26:00\n- 结束时间: 2025-03-19 10:28:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:28:37"}]}]}}
2025-03-19 10:28:37,706 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:28:37,709 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:28:37,710 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 10:33:38,696 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:33:38,697 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:33:38,698 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:33:38,698 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:33:38,843 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:33:39,022 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:33:39,023 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:33:39,023 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:33:39,024 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:33:41,484 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:41,685 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:33:43,128 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:33:43,128 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:33:44,344 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_103344.mp4
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:33:45,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:33:45,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:33:47,199 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:33:47,200 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:33:48,334 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:33:53,581 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:33:53,582 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:33:53,633 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:33:54,824 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4
2025-03-19 10:33:54,824 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:33:56,835 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:33:59,839 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:33:59,840 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:34:00,444 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:34:02,402 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:34:04,534 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:33:54.921 scrcpy[18914:3671186] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 165.8 MB/s (90640 bytes in 0.001s)
2025-03-19 10:33:55.636 scrcpy[18914:3671186] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:33:55.636 scrcpy[18914:3671186] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:34:04,534 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:34:14,537 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4 (大小: 0.36MB)
2025-03-19 10:34:14,537 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 录制文件完整，时长: 4.780800秒，无需修复
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:34:23,475 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-19 10:34:23,494 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 229, in upload_to_telegram
    file_path_response = requests.get(file_path_url)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-19 10:34:23,497 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-19 10:34:23,497 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:34:24,738 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:34:29,972 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:34:29,973 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:34:29,973 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:36:55,739 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:36:55,887 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:36:55,887 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:36:55,888 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:36:55,888 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:36:56,155 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:36:56,155 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:36:58,356 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:36:58,544 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:36:59,962 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:36:59,963 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:37:01,327 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:37:01,327 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:37:01,328 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:37:01,328 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:37:02,722 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:02,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:05,063 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:37:05,065 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:37:05,171 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:37:07,176 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:37:07,177 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:37:08,258 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:37:08,259 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:37:08,260 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:37:08,260 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:37:08,334 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:37:10,344 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:37:10,344 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:37:12,498 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:37:12,499 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:37:14,578 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:37:14,579 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:37:15,681 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:37:15,750 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:37:17,758 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:37:17,759 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:37:19,928 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:37:19,929 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:37:21,333 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:37:22,787 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:37:22,788 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:37:23,960 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:37:23,961 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:37:25,064 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:37:25,065 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:37:27,265 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:28,410 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:37:28,411 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:37:28,531 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:37:33,532 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:37:33,533 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:37:35,652 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:37:35,653 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:37:40,809 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:37:40,810 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:37:42,982 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:37:47,988 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:37:47,988 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_103747.mp4
2025-03-19 10:37:47,989 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:37:49,179 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:37:54,432 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:37:54,432 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:37:54,461 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:37:55,595 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4
2025-03-19 10:37:55,596 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:37:57,609 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:38:00,618 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:38:00,620 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:38:03,625 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:38:03,625 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:38:03,626 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:38:04,833 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:38:04,945 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:38:06,954 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:38:06,956 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:38:06,956 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:38:09,039 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:38:09,039 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:38:10,951 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:38:10,951 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:38:10,952 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:38:10,952 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:38:12,865 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:38:15,005 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:38:15,007 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:37:55.705 scrcpy[23091:3685280] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 167.0 MB/s (90640 bytes in 0.001s)
2025-03-19 10:37:56.417 scrcpy[23091:3685280] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:37:56.417 scrcpy[23091:3685280] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:38:15,007 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:38:25,012 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4 (大小: 0.86MB)
2025-03-19 10:38:25,013 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.805856秒，无需修复
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:38:31,818 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:31,824 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:31,825 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:38:32,963 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:38:38,213 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:38:38,214 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:38,214 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:38:38,216 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:37:01\n- 中断时间: 2025-03-19 10:38:38\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:38:38"}]}]}}
2025-03-19 10:38:38,980 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:39:07,017 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:39:07,113 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:39:07,259 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:39:07,497 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:39:08,954 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:08,955 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:10,219 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:39:10,384 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:39:11,795 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:11,796 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:13,077 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:14,214 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:39:14,215 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:39:14,342 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:39:16,343 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:39:16,344 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:39:17,430 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:39:17,509 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:39:19,519 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:39:19,520 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:39:21,709 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:39:21,713 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:39:23,818 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:39:23,819 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:39:24,966 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:39:24,967 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:39:24,967 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:39:24,968 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:39:25,134 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:39:27,138 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:39:27,138 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:39:29,356 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:39:29,358 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:39:30,767 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:39:32,251 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:39:32,252 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:39:33,412 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:39:33,412 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:39:34,521 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:39:34,522 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:39:36,726 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:36,728 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:37,878 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:39:37,879 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:39:37,991 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:39:42,997 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:39:42,999 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:39:45,139 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:39:45,140 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:39:50,281 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:39:50,282 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:39:52,430 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:39:57,435 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:39:57,436 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_103957.mp4
2025-03-19 10:39:57,436 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:39:58,620 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:40:03,858 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:40:03,858 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:40:03,898 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:40:05,087 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4
2025-03-19 10:40:05,088 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:40:07,101 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:40:10,108 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:40:10,108 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:40:13,108 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:40:13,110 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:40:13,110 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:40:14,307 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:40:14,363 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:40:16,907 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:40:18,989 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:40:05.193 scrcpy[25234:3692907] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 202.1 MB/s (90640 bytes in 0.000s)
2025-03-19 10:40:05.910 scrcpy[25234:3692907] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:40:05.910 scrcpy[25234:3692907] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:40:28,996 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4 (大小: 0.80MB)
2025-03-19 10:40:28,998 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 录制文件完整，时长: 9.178711秒，无需修复
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:40:35,055 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:35,059 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:35,059 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:40:36,250 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:40:41,494 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:40:41,495 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:41,495 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:40:41,497 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:39:10\n- 中断时间: 2025-03-19 10:40:41\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:40:41"}]}]}}
2025-03-19 10:40:42,042 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:44:25,624 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:44:25,775 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:44:25,775 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:44:25,776 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:44:25,776 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:44:27,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:27,429 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:28,692 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:44:28,692 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:44:28,855 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:44:30,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:30,271 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:32,611 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:44:32,612 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:44:32,730 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:44:34,735 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:44:34,736 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:44:35,831 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:44:35,831 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:44:35,832 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:44:35,832 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:44:35,914 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:44:37,923 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:44:37,923 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:44:40,100 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:44:40,100 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:44:42,199 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:44:42,200 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:44:43,321 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:44:43,322 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:44:43,323 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:44:43,323 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:44:43,473 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:44:45,481 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:44:45,481 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:44:47,678 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:44:47,679 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:44:49,103 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:44:50,601 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:44:50,602 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:44:51,796 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:44:51,797 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:44:52,910 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:44:52,911 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:44:55,095 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:44:55,096 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:44:55,096 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:44:55,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:55,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:56,242 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:44:56,243 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:44:56,365 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:45:01,369 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:45:01,371 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:45:03,516 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:45:03,517 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:45:08,664 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:45:08,666 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:45:10,831 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:45:15,836 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:45:15,837 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_104515.mp4
2025-03-19 10:45:15,837 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:45:15,838 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:45:21,081 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:45:21,084 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:45:21,123 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:45:22,315 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4
2025-03-19 10:45:22,316 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:45:24,326 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:45:27,331 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:45:27,331 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:45:30,332 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:45:30,333 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:45:30,333 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:45:31,503 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:45:31,602 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:45:33,610 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:45:33,611 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:45:33,611 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:45:35,919 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:45:35,920 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:45:44,124 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,436 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:45:44,437 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,708 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:45:44,709 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,934 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:45:44,935 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,175 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:45:45,175 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,400 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:45:45,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,614 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:45:45,615 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,836 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:45:45,837 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:46,101 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:45:46,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:46,319 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:45:46,320 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:48,558 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:45:48,558 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:45:48,559 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76469ff u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t359}
    * Task{52cf615 #359 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:45:48,675 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,387 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,387 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,388 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:45:57,356 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:45:57,419 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:46:07,533 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:46:07,534 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:46:07,535 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76469ff u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t359}
    * Task{52cf615 #359 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:46:13,998 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:46:14,004 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:46:16,141 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:46:16,141 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:46:18,001 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:46:20,136 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:46:20,137 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:46:20,137 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:46:21,140 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:46:22,141 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:46:23,145 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:46:24,150 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:46:25,155 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:46:26,160 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:46:27,165 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:46:27,534 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:46:28,167 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:46:29,170 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:46:30,170 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:46:31,176 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:46:32,178 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:46:33,184 - QuickAppADBTester - INFO - 等待进程退出... (14/15)
2025-03-19 10:46:34,189 - QuickAppADBTester - INFO - 等待进程退出... (15/15)
2025-03-19 10:46:35,191 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 10:46:35,191 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 10:46:37,331 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 10:46:39,463 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 10:46:41,598 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 10:46:41,598 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 10:46:42,603 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 10:46:43,609 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 10:46:44,614 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 10:46:45,618 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 10:46:46,621 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 10:46:47,625 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 10:46:48,629 - QuickAppADBTester - INFO - 等待SIGTERM生效... (8/10)
2025-03-19 10:46:49,633 - QuickAppADBTester - INFO - 等待SIGTERM生效... (9/10)
2025-03-19 10:46:50,636 - QuickAppADBTester - INFO - 等待SIGTERM生效... (10/10)
2025-03-19 10:46:51,642 - QuickAppADBTester - WARNING - 所有温和的尝试都失败，不得不使用SIGKILL强制终止进程
2025-03-19 10:46:51,643 - QuickAppADBTester - WARNING - 这可能导致录制文件损坏(moov atom丢失)，录制可能无法播放
2025-03-19 10:46:53,644 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-19 10:46:53,645 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:45:22.417 scrcpy[30753:3713110] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 172.7 MB/s (90640 bytes in 0.001s)
2025-03-19 10:45:23.150 scrcpy[30753:3713110] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:45:23.150 scrcpy[30753:3713110] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:46:53,645 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:47:03,648 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4 (大小: 5.50MB)
2025-03-19 10:47:03,649 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:47:03,800 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12c904400] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4: Invalid data found when processing input

2025-03-19 10:47:03,855 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-19 10:47:03,855 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-19 10:47:03,898 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x13a804400] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4: Invalid data found when processing input

2025-03-19 10:47:03,898 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-19 10:47:03,964 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x144904080] moov atom not found
[in#0 @ 0x600003c60000] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4.
Error opening input files: Invalid data found when processing input

2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4
2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:47:11,464 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:11,472 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:11,473 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:47:11,473 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:47:16,699 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:47:16,700 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:16,701 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:47:16,701 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:47:16,702 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:47:17,089 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:47:18,092 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:47:18,092 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:47:18,093 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:47:19,306 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:47:19,307 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:47:19,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:47:21,493 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:47:21,494 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:47:22,673 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:47:22,674 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:47:22,674 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:47:23,105 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:44:28\n- 中断时间: 2025-03-19 10:47:23\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:47:23"}]}]}}
2025-03-19 10:47:23,640 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:49:59,394 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:49:59,464 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:49:59,539 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:49:59,727 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:50:01,191 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:01,191 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:50:02,435 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:50:02,435 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:50:02,595 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:50:03,996 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:03,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:05,310 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:06,412 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:50:06,413 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:50:06,544 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:50:08,548 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:50:08,548 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:50:09,632 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:50:09,717 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:50:11,726 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:50:11,726 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:50:13,895 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:50:13,896 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:50:15,985 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:50:15,986 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:50:17,093 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:50:17,172 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:50:19,178 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:50:19,178 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:50:21,313 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:50:21,314 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:50:22,718 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:50:24,193 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:50:24,194 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:50:25,387 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:50:25,387 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:50:26,480 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:50:26,480 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:50:28,669 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:28,671 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:29,808 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:50:29,808 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:50:29,922 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:50:34,924 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:50:34,925 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:50:37,032 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:50:37,034 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:50:42,169 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:50:42,171 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:50:44,374 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:50:49,380 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_105049.mp4
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:50:54,629 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:50:54,630 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:50:54,669 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:50:55,855 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4
2025-03-19 10:50:55,856 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:50:57,864 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:51:00,872 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:51:00,872 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:51:03,875 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:51:03,876 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:51:03,876 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:51:05,051 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:51:05,052 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:51:05,053 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:51:05,053 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:51:05,146 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:51:07,154 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:51:07,155 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:51:07,155 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:51:09,425 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:51:09,426 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:51:17,615 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:17,909 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:51:17,911 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,161 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:51:18,161 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,391 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:51:18,392 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,611 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:51:18,612 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,828 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:51:18,829 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,065 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:51:19,065 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,296 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:51:19,296 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,511 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:51:19,512 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,736 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:51:19,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:21,953 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:51:21,954 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:51:21,954 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eceabe8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t371}
    * Task{5aa12e7 #371 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:51:22,087 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:51:28,906 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:51:28,913 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:51:30,974 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:51:39,028 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:51:39,029 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:51:39,030 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:51:39,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eceabe8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t371}
    * Task{5aa12e7 #371 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:51:45,199 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:51:45,206 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:51:47,347 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:51:48,352 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:51:49,357 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:51:50,359 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:51:51,359 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:51:52,365 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:51:53,368 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:51:54,372 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:51:55,378 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:51:56,381 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:51:57,384 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:51:58,389 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:51:59,392 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:52:00,400 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时14秒
2025-03-19 10:52:00,422 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 10:52:00,422 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:50:55.958 scrcpy[36257:3732607] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.7 MB/s (90640 bytes in 0.000s)
2025-03-19 10:50:56.662 scrcpy[36257:3732607] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:50:56.662 scrcpy[36257:3732607] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:52:00,423 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:52:10,432 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4 (大小: 3.60MB)
2025-03-19 10:52:10,433 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 63.547256秒，无需修复
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4
2025-03-19 10:52:10,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:52:17,447 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:17,455 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:17,456 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:52:17,456 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:52:22,723 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:52:22,724 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:52:23,131 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:52:24,136 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:52:24,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:24,137 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:25,321 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:52:25,322 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:52:25,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:52:27,510 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:52:27,511 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:52:28,705 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:52:28,705 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:28,706 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:29,897 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:50:02\n- 结束时间: 2025-03-19 10:52:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:52:29"}]}]}}
2025-03-19 10:52:30,856 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:52:30,860 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:52:30,860 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 10:52:50,695 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:52:50,696 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:52:50,696 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 10:52:55,889 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:52:55,889 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:52:55,960 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:52:57,636 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:57,636 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:52:59,048 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:53:00,458 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:00,459 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:02,786 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:53:02,786 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:53:02,901 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:53:04,907 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:53:04,908 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:53:05,991 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:53:05,992 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:53:05,992 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:53:05,993 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:53:06,070 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:53:08,076 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:53:08,077 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:53:10,256 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:53:10,256 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:53:12,330 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:53:12,331 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:53:13,436 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:53:13,436 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:53:13,437 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:53:13,437 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:53:13,519 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:53:15,529 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:53:15,530 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:53:17,693 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:53:17,694 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:53:19,109 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:53:20,553 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:53:20,554 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:53:21,694 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:53:21,695 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:53:22,791 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:53:22,791 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:53:24,970 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:26,151 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:53:26,151 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:53:26,260 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:53:31,266 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:53:31,267 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:53:33,451 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:53:33,452 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:53:38,612 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:53:38,613 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:53:40,770 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:53:45,776 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:53:45,777 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_105345.mp4
2025-03-19 10:53:45,777 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:53:45,778 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:53:51,013 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:53:51,014 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:53:51,060 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:53:52,245 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4
2025-03-19 10:53:52,246 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:53:54,257 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:53:57,261 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:53:57,261 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:54:01,432 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:54:01,524 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:54:05,804 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:54:05,804 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:54:14,003 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,286 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:54:14,287 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,513 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:54:14,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,733 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:54:14,733 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,943 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:54:14,944 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,178 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:54:15,179 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,433 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:54:15,433 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,679 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:54:15,680 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,931 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:54:15,932 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:16,152 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:54:16,153 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:18,393 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:54:18,394 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:54:18,394 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:54:18,518 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ea08245 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t383}
    * Task{9dbeea8 #383 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,290 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,291 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,291 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:54:26,125 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg
2025-03-19 10:54:26,131 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:54:27,358 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:54:36,306 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:54:36,306 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:54:36,307 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ea08245 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t383}
    * Task{9dbeea8 #383 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:54:44,201 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:54:44,209 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:54:44,209 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:54:46,401 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:54:47,407 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:54:48,413 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:54:49,414 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:54:50,415 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:54:51,421 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:54:52,426 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:54:53,431 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:54:54,434 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:54:55,439 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:54:56,441 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:54:57,445 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:54:57,464 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:54:58,452 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:54:59,455 - QuickAppADBTester - INFO - 等待进程退出... (14/15)
2025-03-19 10:55:00,459 - QuickAppADBTester - INFO - 等待进程退出... (15/15)
2025-03-19 10:55:01,462 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 10:55:01,463 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 10:55:03,652 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 10:55:05,839 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 10:55:08,023 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 10:55:08,024 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 10:55:09,030 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 10:55:10,031 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 10:55:11,035 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 10:55:12,041 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 10:55:13,045 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 10:55:14,046 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 10:55:15,052 - QuickAppADBTester - INFO - 等待SIGTERM生效... (8/10)
2025-03-19 10:55:16,057 - QuickAppADBTester - INFO - 等待SIGTERM生效... (9/10)
2025-03-19 10:55:17,058 - QuickAppADBTester - INFO - 等待SIGTERM生效... (10/10)
2025-03-19 10:55:18,063 - QuickAppADBTester - WARNING - 所有温和的尝试都失败，不得不使用SIGKILL强制终止进程
2025-03-19 10:55:18,064 - QuickAppADBTester - WARNING - 这可能导致录制文件损坏(moov atom丢失)，录制可能无法播放
2025-03-19 10:55:20,064 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-19 10:55:20,066 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:53:52.361 scrcpy[39176:3743368] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 178.4 MB/s (90640 bytes in 0.000s)
2025-03-19 10:53:53.063 scrcpy[39176:3743368] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:53:53.063 scrcpy[39176:3743368] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:55:20,066 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:55:30,067 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4 (大小: 3.75MB)
2025-03-19 10:55:30,068 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:55:30,204 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12fe06ab0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4: Invalid data found when processing input

2025-03-19 10:55:30,245 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-19 10:55:30,245 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-19 10:55:30,282 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06af0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4: Invalid data found when processing input

2025-03-19 10:55:30,282 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-19 10:55:30,327 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06b50] moov atom not found
[in#0 @ 0x6000020cc400] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4.
Error opening input files: Invalid data found when processing input

2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4
2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:55:37,016 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:37,023 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:37,023 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:55:37,024 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:55:42,281 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:55:42,673 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:55:43,677 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:55:43,678 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:55:43,678 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:55:44,872 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:55:44,873 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:55:44,873 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:55:47,068 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:55:47,069 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:55:48,261 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:55:48,262 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:55:48,262 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:55:49,438 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:55:49,439 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:55:49,440 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:55:49,440 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:52:58\n- 结束时间: 2025-03-19 10:55:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:55:49"}]}]}}
2025-03-19 10:55:49,917 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:55:49,921 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:55:49,921 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:13:39,266 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:13:39,268 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:13:39,268 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:13:40,768 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:13:40,929 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:13:40,930 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:13:40,931 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:13:40,931 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:13:42,636 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:42,637 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:43,890 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:13:44,064 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:13:45,469 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:45,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:47,794 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:13:47,794 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:13:47,908 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:13:49,914 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:13:49,915 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:13:51,004 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:13:51,005 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:13:51,007 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:13:51,007 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:13:51,090 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:13:53,099 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:13:53,100 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:13:55,279 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:13:55,280 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:13:57,368 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:13:57,369 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:13:58,467 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:13:58,539 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:14:00,549 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:14:00,550 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:14:02,784 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:14:02,785 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:14:04,202 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:14:05,665 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:14:05,666 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:14:06,871 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:14:06,872 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:14:07,988 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:14:07,989 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:14:10,170 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:14:10,172 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:14:11,336 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:14:11,337 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:14:11,447 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:14:16,451 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:14:16,452 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:14:18,649 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:14:18,650 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:14:23,850 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:14:23,852 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:14:26,006 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:14:31,011 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:14:31,012 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_111431.mp4
2025-03-19 11:14:31,012 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:14:31,014 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:14:36,291 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:14:36,292 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:14:36,342 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:14:37,523 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4
2025-03-19 11:14:37,524 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 11:14:39,533 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:14:42,540 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:14:42,541 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:14:45,543 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:14:45,544 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:14:45,544 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:14:46,728 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:14:46,845 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:14:48,848 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:14:48,848 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:14:48,849 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:14:51,126 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:14:51,126 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:14:59,311 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:14:59,615 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:14:59,616 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:14:59,888 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:14:59,889 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,144 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:15:00,144 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,396 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:15:00,397 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,629 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:15:00,630 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,876 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:15:00,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,110 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:15:01,111 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,337 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:15:01,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,569 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:15:01,570 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:03,799 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:15:03,800 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:15:03,801 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:15:03,918 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{72ada14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t395}
    * Task{c3b0803 #395 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,701 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,702 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,703 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:15:12,647 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:15:20,215 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:20,220 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:15:30,381 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:15:30,382 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:15:30,383 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:15:30,515 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{72ada14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t395}
    * Task{c3b0803 #395 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,321 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,321 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,325 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:15:37,140 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:15:39,340 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:15:40,346 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:15:41,348 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:15:42,352 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:15:42,746 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:15:43,357 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:15:44,362 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:15:45,366 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:15:46,367 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:15:47,373 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:15:48,378 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:15:49,381 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:15:50,384 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:15:51,385 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:15:52,387 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:15:53,391 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:15:54,394 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:15:55,398 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:15:56,402 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:15:57,402 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:15:58,407 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:15:59,412 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:16:00,416 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:16:01,439 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时23秒
2025-03-19 11:16:01,440 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:16:01,441 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:14:37.642 scrcpy[59095:3807605] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 32.3 MB/s (90640 bytes in 0.003s)
2025-03-19 11:16:00.462 scrcpy[59095:3807605] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:16:00.462 scrcpy[59095:3807605] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:16:01,441 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:16:11,446 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4 (大小: 4.10MB)
2025-03-19 11:16:11,447 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 录制文件完整，时长: 82.114144秒，无需修复
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:16:18,568 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:16:23,833 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:16:23,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:16:24,211 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:26,416 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:16:26,417 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:16:26,417 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 11:13:43\n- 中断时间: 2025-03-19 11:16:27\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:16:27"}]}]}}
2025-03-19 11:16:28,412 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:16:35,053 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:16:35,157 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:16:35,354 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:16:36,789 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:36,790 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:38,039 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:16:38,209 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:16:39,602 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:39,602 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:40,896 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:41,984 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:16:41,985 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:16:42,114 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:16:44,118 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:16:44,118 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:16:45,276 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:16:45,276 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:16:45,277 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:16:45,277 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:16:45,357 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:16:47,366 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:16:47,367 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:16:49,456 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:16:49,458 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:16:51,560 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:16:51,561 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:16:52,724 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:16:52,856 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:16:54,861 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:16:54,862 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:16:57,082 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:16:57,083 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:16:58,498 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:16:59,974 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:16:59,975 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:17:01,182 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:17:01,183 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:17:02,286 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:17:02,287 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:17:04,472 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:17:05,636 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:17:05,636 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:17:05,763 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:17:10,769 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:17:10,771 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:17:12,937 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:17:12,937 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:17:18,071 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:17:18,072 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:17:20,255 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:17:25,259 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_111725.mp4
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:17:30,537 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:17:30,539 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:17:30,584 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:17:31,774 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4
2025-03-19 11:17:31,775 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 11:17:33,789 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:17:36,796 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:17:36,796 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:17:39,800 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:17:39,802 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:17:39,802 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:17:40,974 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:17:41,071 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:17:43,079 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:17:43,080 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:17:43,080 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:17:45,343 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:17:45,343 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:17:53,548 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:53,817 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:17:53,818 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,053 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:17:54,053 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,305 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:17:54,305 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,530 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:17:54,532 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,773 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:17:54,774 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,023 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:17:55,023 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,252 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:17:55,253 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,486 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:17:55,487 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,744 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:17:55,745 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:57,996 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:17:57,997 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:17:57,998 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:17:58,122 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1ebed33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t405}
    * Task{a970e69 #405 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,993 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,995 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,995 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:18:06,071 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:06,076 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:18:06,894 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:18:16,213 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:18:16,215 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:18:16,216 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:18:16,398 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1ebed33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t405}
    * Task{a970e69 #405 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,284 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,284 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,285 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:18:23,241 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:18:25,392 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:18:25,393 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:18:25,394 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:18:25,394 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:18:26,398 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:18:27,404 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:18:28,409 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:18:29,413 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:18:30,416 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:18:31,421 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:18:32,425 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:18:33,431 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:18:34,437 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:18:35,438 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:18:36,443 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:18:36,988 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:18:37,447 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:18:38,450 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:18:39,453 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:18:40,455 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:18:41,460 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:18:42,467 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:18:43,471 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:18:44,474 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:18:45,476 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:18:46,478 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:18:47,479 - QuickAppADBTester - INFO - 等待进程退出... (23/30)
2025-03-19 11:18:48,484 - QuickAppADBTester - INFO - 等待进程退出... (24/30)
2025-03-19 11:18:49,487 - QuickAppADBTester - INFO - 等待进程退出... (25/30)
2025-03-19 11:18:50,492 - QuickAppADBTester - INFO - 等待进程退出... (26/30)
2025-03-19 11:18:51,495 - QuickAppADBTester - INFO - 等待进程退出... (27/30)
2025-03-19 11:18:52,500 - QuickAppADBTester - INFO - 等待进程退出... (28/30)
2025-03-19 11:18:53,504 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时29秒
2025-03-19 11:18:53,505 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:18:53,505 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:17:31.887 scrcpy[59544:3812654] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 178.8 MB/s (90640 bytes in 0.000s)
2025-03-19 11:17:32.627 scrcpy[59544:3812654] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:17:32.627 scrcpy[59544:3812654] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:18:53,506 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:19:03,513 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4 (大小: 4.41MB)
2025-03-19 11:19:03,514 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:19:03,694 - QuickAppADBTester - INFO - 录制文件完整，时长: 75.279267秒，无需修复
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:19:10,767 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:19:16,001 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:19:16,001 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:19:16,392 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:19:17,398 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:19:17,398 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:19:17,399 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:19:18,599 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:19:18,599 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:19:18,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:19:20,791 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:19:20,791 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:19:23,115 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:19:23,116 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:19:23,117 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:19:23,117 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:16:38\n- 结束时间: 2025-03-19 11:19:23\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:19:23"}]}]}}
2025-03-19 11:19:23,650 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:19:23,651 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:19:23,652 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:19:53,033 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:19:53,034 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:19:53,034 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:22:53,231 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:22:53,551 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:22:54,984 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:54,984 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:22:56,268 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:22:56,268 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:22:56,430 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:22:56,431 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:22:56,431 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:22:56,432 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:22:57,827 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:57,828 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:23:00,125 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:23:00,126 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:23:00,248 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:23:02,250 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:23:02,251 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:03,344 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:23:03,426 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:23:05,430 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:23:05,432 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:23:07,638 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:23:07,639 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:23:09,717 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:23:09,717 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:23:10,815 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:23:10,815 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:23:10,816 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:10,816 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:23:10,888 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:23:12,897 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:23:12,898 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:23:15,073 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:23:15,073 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:23:16,501 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:23:17,980 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:23:17,980 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:23:19,183 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:23:19,183 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:23:20,272 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:23:20,272 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:23:22,465 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:23:22,466 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:23:23,603 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:23:23,605 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:23:23,721 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:23:28,724 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:23:28,724 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:23:30,897 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:23:30,898 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:23:36,009 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:23:36,011 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:23:38,165 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:23:43,168 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:23:43,169 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_112343.mp4
2025-03-19 11:23:43,169 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:23:43,170 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:23:48,439 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:23:48,440 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:23:48,495 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:23:49,677 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4
2025-03-19 11:23:49,679 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:23:51,688 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:23:54,695 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:23:54,695 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:23:57,697 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:23:57,699 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:23:57,701 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:23:58,864 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:23:58,966 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:24:00,971 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:24:00,972 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:24:00,972 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:24:03,250 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:24:03,251 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:24:11,455 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:11,794 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:24:11,795 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,007 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:24:12,007 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,273 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:24:12,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,658 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:24:12,658 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,894 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:24:12,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,108 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:24:13,108 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,386 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:24:13,386 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,641 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:24:13,641 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,981 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:24:13,982 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:16,191 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:24:16,191 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:24:16,192 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{91c5133 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t417}
    * Task{1981269 #417 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:24:16,319 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,004 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,005 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,005 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:24:24,802 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:24,806 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:24:24,808 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:24:34,993 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:24:34,994 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:24:34,994 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{91c5133 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t417}
    * Task{1981269 #417 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:24:35,118 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,838 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,839 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,839 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:24:41,563 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:41,565 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:24:43,732 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:24:43,732 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:24:43,733 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:24:43,733 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:24:44,738 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:24:45,743 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:24:46,746 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:24:47,747 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:24:48,748 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:24:49,753 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:24:50,758 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:24:51,758 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:24:52,762 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:24:53,765 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时12秒
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:23:49.787 scrcpy[60829:3824788] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.8 MB/s (90640 bytes in 0.001s)
2025-03-19 11:23:50.480 scrcpy[60829:3824788] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:23:50.480 scrcpy[60829:3824788] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:24:54,769 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:25:04,772 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4 (大小: 3.99MB)
2025-03-19 11:25:04,774 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 录制文件完整，时长: 58.575511秒，无需修复
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:25:12,288 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:25:17,543 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:25:17,968 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:25:20,068 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:25:20,068 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:25:20,069 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:25:22,171 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:25:22,171 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:25:24,401 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:25:24,403 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:25:24,403 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:25:24,404 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:22:56\n- 结束时间: 2025-03-19 11:25:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:25:24"}]}]}}
2025-03-19 11:25:24,954 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:25:24,956 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:25:24,956 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:26:39,055 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:26:39,056 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:26:39,056 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:26:40,101 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:26:40,242 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:26:40,496 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:26:41,972 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:41,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:43,206 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:26:44,765 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:44,767 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:46,026 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:47,107 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:26:47,108 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:26:47,202 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:26:49,208 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:26:49,208 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:26:50,277 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:26:50,353 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:26:52,358 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:26:52,359 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:26:54,525 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:26:54,526 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:26:56,606 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:26:56,607 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:26:57,709 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:26:57,714 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:26:57,717 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:26:57,718 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:26:57,787 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:26:59,797 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:26:59,798 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:27:02,015 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:27:02,016 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:27:03,443 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:27:04,928 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:27:04,929 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:27:06,109 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:27:06,110 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:27:07,220 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:27:07,221 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:27:09,405 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:27:10,569 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:27:10,569 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:27:10,691 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:27:15,694 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:27:15,695 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:27:17,848 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:27:17,849 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:27:23,005 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:27:23,006 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:27:25,149 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_112730.mp4
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:27:35,410 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:27:35,411 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:27:35,460 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:27:36,652 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4
2025-03-19 11:27:36,652 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:27:38,665 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:27:41,672 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:27:41,672 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:27:44,675 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:27:44,678 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:27:44,678 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:27:45,851 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:27:45,955 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:27:47,963 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:27:47,964 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:27:47,964 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:27:50,209 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:27:50,210 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:27:58,391 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:58,642 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:27:58,642 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:58,875 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:27:58,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,121 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:27:59,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,370 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:27:59,371 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,639 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:27:59,639 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,914 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:27:59,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,145 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:28:00,145 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,397 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:28:00,398 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,625 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:28:00,626 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:02,874 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:28:02,875 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:28:02,876 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:28:02,993 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{daaead9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t423}
    * Task{f8ef37f #423 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:28:02,993 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,848 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,850 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,851 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:28:10,578 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:28:11,772 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:28:20,755 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:28:20,756 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:28:20,756 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{daaead9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t423}
    * Task{f8ef37f #423 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,666 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,666 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,667 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:28:27,393 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:28:29,591 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:28:30,596 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:28:31,601 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:28:32,606 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:28:33,609 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:28:34,614 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:28:35,618 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:28:36,621 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:28:37,626 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:28:38,628 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:28:39,630 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:28:40,635 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:28:41,641 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:28:41,862 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:28:42,645 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:28:43,646 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:28:44,653 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:28:45,657 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:28:46,662 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:28:47,662 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:28:48,663 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:28:49,668 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:28:50,672 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:28:51,673 - QuickAppADBTester - INFO - 等待进程退出... (23/30)
2025-03-19 11:28:52,677 - QuickAppADBTester - INFO - 等待进程退出... (24/30)
2025-03-19 11:28:53,681 - QuickAppADBTester - INFO - 等待进程退出... (25/30)
2025-03-19 11:28:54,685 - QuickAppADBTester - INFO - 等待进程退出... (26/30)
2025-03-19 11:28:55,688 - QuickAppADBTester - INFO - 等待进程退出... (27/30)
2025-03-19 11:28:56,692 - QuickAppADBTester - INFO - 等待进程退出... (28/30)
2025-03-19 11:28:57,695 - QuickAppADBTester - INFO - 等待进程退出... (29/30)
2025-03-19 11:28:58,698 - QuickAppADBTester - INFO - 等待进程退出... (30/30)
2025-03-19 11:28:59,703 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 11:28:59,703 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 11:29:01,886 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 11:29:04,081 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 11:29:06,272 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 11:29:06,273 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 11:29:07,276 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 11:29:08,279 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 11:29:09,284 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 11:29:10,289 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 11:29:11,291 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 11:29:11,952 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-19 11:29:12,294 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 11:29:13,299 - QuickAppADBTester - INFO - 进程在接收SIGTERM后成功退出，用时8秒
2025-03-19 11:29:13,299 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:29:13,300 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:27:36.765 scrcpy[61406:3833302] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.9 MB/s (90640 bytes in 0.001s)
2025-03-19 11:27:37.516 scrcpy[61406:3833302] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:27:37.516 scrcpy[61406:3833302] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:29:13,301 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:29:23,305 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4 (大小: 3.81MB)
2025-03-19 11:29:23,305 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 录制文件完整，时长: 95.415067秒，无需修复
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:29:30,110 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:30,117 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:30,117 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:29:30,118 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:29:35,355 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:29:35,364 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:29:35,982 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:29:36,987 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:29:36,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:29:36,988 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:29:40,423 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:29:40,424 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:29:41,577 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:29:41,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:29:41,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:29:42,723 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:26:43\n- 结束时间: 2025-03-19 11:29:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:29:42"}]}]}}
2025-03-19 11:29:43,203 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:29:43,204 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:29:43,204 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
