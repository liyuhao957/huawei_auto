2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 09:50:30,296 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:30,659 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:32,114 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:32,115 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:33,314 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_095033.mp4
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:33,463 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:34,855 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:34,855 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:36,096 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:36,097 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:50:37,180 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:50:42,431 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:50:42,432 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 09:50:42,477 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 09:50:43,610 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4
2025-03-19 09:50:43,610 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 09:50:45,622 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 09:50:48,627 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 09:50:48,627 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 09:50:51,630 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 09:50:51,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:51,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:51,899 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:51,899 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:51,900 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:51,900 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:53,368 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:53,369 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:54,577 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:54,577 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:55,655 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 09:50:55,656 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 09:50:55,767 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 09:50:57,773 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 09:50:57,773 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 09:50:58,898 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 09:50:58,898 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 09:50:58,899 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:50:58,899 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 09:50:58,971 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:51:00,980 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 09:51:00,980 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 09:51:03,138 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 09:51:03,138 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 09:51:05,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 09:51:05,221 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 09:51:06,317 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 09:51:06,388 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:51:07,283 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 09:51:09,182 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 09:51:11,320 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 09:50:44.022 scrcpy[73813:3514663] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 54.0 MB/s (90640 bytes in 0.002s)
2025-03-19 09:50:44.887 scrcpy[73813:3514663] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 09:50:44.887 scrcpy[73813:3514663] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 09:51:05.940 scrcpy[73813:3514663] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 09:51:21,325 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4 (大小: 1.53MB)
2025-03-19 09:51:21,325 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 09:51:21,537 - QuickAppADBTester - INFO - 录制文件完整，时长: 22.455544秒，无需修复
2025-03-19 09:51:21,537 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:51:22,674 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:51:27,931 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:51:30,104 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 09:51:30,104 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 09:51:30,105 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 09:51:30,105 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 09:51:30,105 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 09:50:33\n- 结束时间: 2025-03-19 09:51:30\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 09:51:30"}]}]}}
2025-03-19 09:51:30,736 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 09:56:40,931 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 09:56:41,334 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 09:56:41,334 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 09:56:43,552 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:43,765 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:56:45,184 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:56:45,185 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:56:46,418 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_095646.mp4
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:56:47,963 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:56:47,965 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:56:49,211 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:56:49,212 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:56:50,341 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:56:55,594 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:56:55,596 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 09:56:55,638 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 09:56:56,772 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4
2025-03-19 09:56:56,772 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 09:56:58,784 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 09:57:01,790 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 09:57:01,791 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 09:57:04,796 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 09:57:04,796 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:57:04,797 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:57:05,049 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:57:06,514 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:06,514 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:07,748 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:08,829 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 09:57:08,829 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 09:57:08,920 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 09:57:10,925 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 09:57:10,926 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 09:57:12,017 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 09:57:12,092 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:57:14,101 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 09:57:14,101 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 09:57:16,179 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 09:57:16,180 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 09:57:18,280 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 09:57:18,281 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 09:57:19,414 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 09:57:19,414 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 09:57:19,415 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:57:19,415 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 09:57:19,513 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 09:57:21,720 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 09:57:23,860 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 09:57:23,860 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 09:56:56.880 scrcpy[80193:3537006] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 180.2 MB/s (90640 bytes in 0.000s)
2025-03-19 09:56:57.557 scrcpy[80193:3537006] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 09:56:57.557 scrcpy[80193:3537006] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 09:57:18.274 scrcpy[80193:3537006] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 09:57:33,864 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4 (大小: 1.58MB)
2025-03-19 09:57:33,865 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 09:57:33,980 - QuickAppADBTester - INFO - 录制文件完整，时长: 22.249744秒，无需修复
2025-03-19 09:57:33,981 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 09:57:33,981 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4
2025-03-19 09:57:33,982 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 09:57:41,619 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_33.mp4
2025-03-19 09:57:41,625 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_33.mp4
2025-03-19 09:57:41,625 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:57:42,815 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:57:48,083 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:50,273 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 09:57:50,274 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 09:57:50,274 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 09:57:50,274 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 09:57:50,275 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 09:56:46\n- 结束时间: 2025-03-19 09:57:50\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 09:57:50"}]}]}}
2025-03-19 09:57:51,013 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:01:22,584 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:22,998 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:01:25,137 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:25,336 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:25,336 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:01:25,337 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:25,337 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:26,745 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:26,746 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:28,027 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100128.mp4
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:29,588 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:29,588 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:30,864 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:30,864 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:01:31,950 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:01:37,172 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:01:37,174 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:01:37,224 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:01:38,357 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4
2025-03-19 10:01:38,357 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:01:40,371 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:01:43,374 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:01:43,375 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:46,633 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:48,115 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:48,115 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:49,387 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:50,487 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:01:50,487 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:01:50,599 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:01:52,604 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:01:52,605 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:01:53,754 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:01:53,826 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:01:55,835 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:01:55,835 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:01:56,496 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:01:58,298 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:02:00,433 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:02:00,435 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:01:38.469 scrcpy[84982:3553737] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.9 MB/s (90640 bytes in 0.001s)
WARN: Device disconnected

2025-03-19 10:02:00,435 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:02:10,440 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4 (大小: 1.42MB)
2025-03-19 10:02:10,441 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 录制文件完整，时长: 17.299778秒，无需修复
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:02:17,073 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:17,080 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:17,081 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:02:18,269 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:02:23,526 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:02:23,528 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:23,528 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:02:23,529 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:02:23\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:02:23"}]}]}}
2025-03-19 10:02:24,133 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:02:24,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:02:24,136 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:02:26,334 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:02:26,335 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:02:26,336 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:02:26,336 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 10:02:26,336 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:01:28\n- 结束时间: 2025-03-19 10:02:26\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:02:26"}]}]}}
2025-03-19 10:02:26,904 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:07:54,476 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:07:54,815 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:07:56,305 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:07:56,306 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:07:57,565 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:07:57,565 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100757.mp4
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:07:57,719 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:07:59,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:07:59,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:00,342 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:08:00,343 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:08:01,479 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:08:06,713 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:08:06,715 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:08:06,751 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:08:07,884 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4
2025-03-19 10:08:07,885 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:08:09,896 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:08:12,900 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:08:12,901 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:08:15,902 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:08:15,902 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:08:15,903 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:08:16,207 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:08:17,679 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:17,679 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:18,897 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:19,974 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:08:19,975 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:08:20,096 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:08:22,101 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:08:22,102 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:08:23,252 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:08:23,336 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:08:25,338 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:08:25,339 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:08:27,420 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:08:27,421 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:08:27,446 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:08:29,293 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:08:31,432 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:08:07.992 scrcpy[91768:3576905] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 134.1 MB/s (90640 bytes in 0.001s)
2025-03-19 10:08:08.729 scrcpy[91768:3576905] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:08:08.729 scrcpy[91768:3576905] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:08:41,439 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4 (大小: 1.49MB)
2025-03-19 10:08:41,439 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:08:41,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 18.504944秒，无需修复
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:08:48,920 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:48,923 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:48,923 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:08:50,167 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:08:55,416 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:08:55,417 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:55,417 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:08:55,418 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:08:55\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:08:55"}]}]}}
2025-03-19 10:08:55,945 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:08:55,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:55,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:58,124 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:08:58,125 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:08:58,125 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:08:58,125 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 10:08:58,126 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:07:57\n- 结束时间: 2025-03-19 10:08:58\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:08:58"}]}]}}
2025-03-19 10:08:58,636 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:09:27,706 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:09:27,766 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:29,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:29,421 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:30,630 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:30,630 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100930.mp4
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:30,815 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:32,219 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:32,220 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:33,435 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:33,435 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:09:34,572 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:09:39,842 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:09:39,843 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:09:39,878 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:09:41,062 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4
2025-03-19 10:09:41,062 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:09:43,071 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:09:46,075 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:09:46,075 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:49,310 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:50,775 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:50,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:53,139 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:09:53,139 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:09:53,264 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:09:55,265 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:09:55,265 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:09:56,339 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:09:56,340 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:09:56,341 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:09:56,341 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:09:56,422 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:09:58,426 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:09:58,426 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:10:00,601 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:10:00,602 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:10:02,729 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:10:02,730 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:10:03,876 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:10:04,026 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:10:06,033 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:10:06,034 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:10:08,194 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:10:08,195 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:10:09,620 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:10:11,100 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:10:11,100 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:10:12,257 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:10:12,258 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:10:13,353 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:10:13,354 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:10:15,526 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:10:16,169 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:10:16,700 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:10:16,700 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:10:16,821 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:10:21,826 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:10:21,827 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:10:23,969 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:10:23,970 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:10:29,123 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:10:29,124 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:10:31,293 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:10:36,299 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:10:37,476 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:10:37,476 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:10:37,477 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:10:37,477 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:10:37,573 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:10:39,578 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:10:39,579 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:10:39,579 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:10:41,843 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:10:41,844 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:10:46,283 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:10:50,032 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,310 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:10:50,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,588 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:10:50,589 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,819 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:10:50,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,067 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:10:51,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,287 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:10:51,288 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,509 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:10:51,510 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,763 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:10:51,763 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:52,009 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:10:52,009 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:52,283 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:10:52,284 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:54,518 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:10:54,520 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:10:54,520 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:10:54,640 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f336ba4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t324}
    * Task{47be4c2 #324 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:11:01,941 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg
2025-03-19 10:11:01,949 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg
2025-03-19 10:11:01,949 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:11:01,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:11:01,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:11:05,773 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:11:07,793 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:09:41.186 scrcpy[93340:3582202] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 139.6 MB/s (90640 bytes in 0.001s)
2025-03-19 10:09:41.924 scrcpy[93340:3582202] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:09:41.924 scrcpy[93340:3582202] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:11:19,989 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4 (大小: 9.13MB)
2025-03-19 10:11:19,991 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:11:20,154 - QuickAppADBTester - INFO - 录制文件完整，时长: 83.779578秒，无需修复
2025-03-19 10:11:20,154 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:11:20,155 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4
2025-03-19 10:11:20,155 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:11:28,422 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:28,429 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:28,429 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:11:29,570 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:11:34,821 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:11:34,822 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:34,822 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:11:34,823 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:11:34\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:11:34"}]}]}}
2025-03-19 10:11:35,363 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:11:35,365 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:11:37,480 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:11:37,481 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:11:37,481 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:11:37,481 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:11:37,482 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:09:30\n- 结束时间: 2025-03-19 10:11:37\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:11:37"}]}]}}
2025-03-19 10:11:38,004 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:16:29,031 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:16:29,139 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:29,342 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:16:31,519 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:31,691 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:33,116 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:33,117 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_101634.mp4
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:34,335 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:34,511 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:35,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:35,916 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:37,178 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:37,178 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:16:38,370 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:16:43,612 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:16:43,614 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:16:43,662 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:16:44,845 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4
2025-03-19 10:16:44,846 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:16:46,858 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:16:49,862 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:16:49,862 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:16:52,867 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:16:52,868 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:52,868 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:53,184 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:54,659 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:54,660 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:55,870 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:56,961 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:16:56,961 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:16:57,085 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:16:59,098 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:16:59,098 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:17:00,311 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:17:00,393 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:02,401 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:17:02,401 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:17:04,478 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:17:04,480 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:17:06,581 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:17:06,582 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:17:07,722 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:17:07,722 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:17:07,728 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:07,733 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:17:07,820 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:09,826 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:17:09,826 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:17:11,993 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:17:11,995 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:17:13,417 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:17:14,865 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:17:14,866 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:17:16,009 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:17:16,009 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:17:17,105 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:17:17,106 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:17:19,284 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:17:19,967 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:17:20,441 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:17:20,442 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:17:20,555 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:17:25,557 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:17:25,557 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:17:27,706 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:17:27,706 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:17:32,860 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:17:32,861 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:17:35,000 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:17:40,002 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:17:41,195 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:17:45,459 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:17:45,460 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:17:50,055 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:17:53,582 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:53,914 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:17:53,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,164 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:17:54,165 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,407 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:17:54,407 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,659 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:17:54,659 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,878 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:17:54,879 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,099 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:17:55,100 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,357 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:17:55,358 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,579 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:17:55,580 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,823 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:17:55,824 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:58,054 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:17:58,055 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:17:58,055 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:17:58,168 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3ca8274 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t334}
    * Task{9cd6012 #334 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:18:06,570 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:18:09,106 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:18:11,029 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:18:13,215 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:18:13,217 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:18:13,217 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:16:44.952 scrcpy[958:3608236] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 169.8 MB/s (90640 bytes in 0.001s)
2025-03-19 10:16:45.772 scrcpy[958:3608236] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:16:45.772 scrcpy[958:3608236] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:18:23,221 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4 (大小: 6.86MB)
2025-03-19 10:18:23,223 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 录制文件完整，时长: 83.310744秒，无需修复
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:18:31,109 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:31,117 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:31,118 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:18:32,255 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:18:37,512 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:18:37,514 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:18:39,643 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:39,644 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-19 10:18:39,645 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:16:34\n- 中断时间: 2025-03-19 10:18:39\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:18:39"}]}]}}
2025-03-19 10:18:40,138 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:19:13,307 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:13,564 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:19:15,684 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:15,852 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:17,278 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:17,279 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:18,495 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_101918.mp4
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:18,667 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:20,084 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:20,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:21,268 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:21,269 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:19:22,406 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:19:27,642 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:19:27,643 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:19:27,681 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:19:28,820 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4
2025-03-19 10:19:28,821 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:19:30,828 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:19:33,834 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:19:33,835 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:19:36,837 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:19:36,838 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:36,838 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:37,014 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:38,427 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:38,428 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:39,629 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:39,629 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:40,719 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:19:40,719 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:19:40,844 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:19:42,848 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:19:42,848 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:19:44,907 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:19:46,992 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:19:46,994 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:19:28.914 scrcpy[3769:3618608] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 180.0 MB/s (90640 bytes in 0.000s)
2025-03-19 10:19:29.574 scrcpy[3769:3618608] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:19:29.574 scrcpy[3769:3618608] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 10:19:40.385 scrcpy[3769:3618608] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 10:19:46,994 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:19:56,998 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4 (大小: 1.08MB)
2025-03-19 10:19:56,999 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.577578秒，无需修复
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:20:03,302 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:03,306 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:03,306 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:20:04,448 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:20:09,693 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:20:09,695 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:20:09,695 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:20:11,830 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:11,832 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:20:11,833 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:19:18\n- 中断时间: 2025-03-19 10:20:11\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:20:11"}]}]}}
2025-03-19 10:20:12,406 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:25:38,535 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:25:38,821 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:25:39,404 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:25:39,404 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:25:57,486 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:25:59,082 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:25:59,083 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_102600.mp4
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:26:00,509 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:26:01,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:01,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:03,157 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:03,158 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:26:04,284 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:26:09,535 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:26:09,536 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:26:09,561 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:26:10,698 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4
2025-03-19 10:26:10,699 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:26:12,708 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:26:15,714 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:26:15,715 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:26:18,984 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:26:20,434 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:20,435 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:21,636 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:22,716 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:26:22,717 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:26:22,828 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:26:24,832 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:26:24,832 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:26:25,932 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:26:26,016 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:26:28,020 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:26:28,020 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:26:30,197 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:26:30,198 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:26:32,282 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:26:32,284 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:26:33,424 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:26:33,424 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:26:33,425 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:26:33,425 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:26:33,599 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:26:35,603 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:26:35,604 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:26:37,808 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:26:37,809 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:26:39,237 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:26:40,668 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:26:40,669 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:26:41,843 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:26:41,844 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:26:42,959 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:26:42,960 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:26:45,123 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:26:45,124 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:45,803 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:26:46,263 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:26:46,263 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:26:46,383 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:26:51,377 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:26:51,378 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:26:53,515 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:26:53,516 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:26:58,661 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:26:58,663 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:27:00,814 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:27:06,965 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:27:06,966 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:27:06,966 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:27:06,967 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:27:07,069 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:27:09,077 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:27:09,078 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:27:09,078 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:27:11,346 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:27:11,346 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:27:15,884 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:27:19,493 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:27:19,493 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:27:19,494 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:27:19,494 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:19,776 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:27:19,777 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,100 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:27:20,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,342 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:27:20,343 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,603 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:27:20,604 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,838 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:27:20,839 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,070 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:27:21,071 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,318 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:27:21,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,565 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:27:21,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,808 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:27:21,809 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:24,046 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:27:24,047 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:27:24,047 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:27:24,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f53a7c7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t346}
    * Task{a079d1d #346 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,863 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,864 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,865 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:27:32,930 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:43,031 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:27:43,032 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:27:43,032 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:27:43,168 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f53a7c7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t346}
    * Task{a079d1d #346 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:27:43,168 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,854 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,855 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,855 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:27:45,990 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-19 10:27:50,826 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg
2025-03-19 10:27:50,834 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:27:51,230 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:27:52,234 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:27:52,235 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:52,235 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:27:55,436 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:27:55,436 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:27:56,557 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:27:56,558 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:56,558 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:57,672 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:27:57,675 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:27:57,675 - QuickAppADBTester - INFO - 测试完成，按Home键回到桌面...
2025-03-19 10:27:57,676 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:57,676 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:28:02,807 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:28:02,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:28:02,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:28:04,993 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:28:04,994 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:28:04,994 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:28:06,946 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:28:09,077 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:28:09,078 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:28:09,078 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:28:10,081 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:28:11,087 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:28:12,088 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时4秒
2025-03-19 10:28:12,089 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 10:28:12,089 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:26:10.805 scrcpy[10339:3641503] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.1 MB/s (90640 bytes in 0.000s)
2025-03-19 10:26:11.547 scrcpy[10339:3641503] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:26:11.547 scrcpy[10339:3641503] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:28:12,090 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:28:22,092 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4 (大小: 10.87MB)
2025-03-19 10:28:22,094 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 录制文件完整，时长: 119.878189秒，无需修复
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:28:30,765 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:30,771 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:30,772 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:28:32,019 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:28:37,268 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:28:37,270 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:37,270 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:28:37,271 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:26:00\n- 结束时间: 2025-03-19 10:28:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:28:37"}]}]}}
2025-03-19 10:28:37,706 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:28:37,709 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:28:37,710 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 10:33:38,696 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:33:38,697 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:33:38,698 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:33:38,698 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:33:38,843 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:33:39,022 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:33:39,023 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:33:39,023 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:33:39,024 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:33:41,484 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:41,685 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:33:43,128 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:33:43,128 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:33:44,344 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_103344.mp4
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:33:45,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:33:45,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:33:47,199 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:33:47,200 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:33:48,334 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:33:53,581 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:33:53,582 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:33:53,633 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:33:54,824 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4
2025-03-19 10:33:54,824 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:33:56,835 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:33:59,839 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:33:59,840 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:34:00,444 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:34:02,402 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:34:04,534 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:33:54.921 scrcpy[18914:3671186] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 165.8 MB/s (90640 bytes in 0.001s)
2025-03-19 10:33:55.636 scrcpy[18914:3671186] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:33:55.636 scrcpy[18914:3671186] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:34:04,534 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:34:14,537 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4 (大小: 0.36MB)
2025-03-19 10:34:14,537 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 录制文件完整，时长: 4.780800秒，无需修复
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:34:23,475 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-19 10:34:23,494 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 229, in upload_to_telegram
    file_path_response = requests.get(file_path_url)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-19 10:34:23,497 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-19 10:34:23,497 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:34:24,738 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:34:29,972 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:34:29,973 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:34:29,973 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:36:55,739 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:36:55,887 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:36:55,887 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:36:55,888 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:36:55,888 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:36:56,155 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:36:56,155 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:36:58,356 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:36:58,544 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:36:59,962 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:36:59,963 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:37:01,327 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:37:01,327 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:37:01,328 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:37:01,328 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:37:02,722 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:02,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:05,063 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:37:05,065 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:37:05,171 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:37:07,176 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:37:07,177 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:37:08,258 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:37:08,259 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:37:08,260 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:37:08,260 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:37:08,334 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:37:10,344 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:37:10,344 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:37:12,498 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:37:12,499 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:37:14,578 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:37:14,579 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:37:15,681 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:37:15,750 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:37:17,758 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:37:17,759 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:37:19,928 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:37:19,929 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:37:21,333 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:37:22,787 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:37:22,788 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:37:23,960 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:37:23,961 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:37:25,064 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:37:25,065 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:37:27,265 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:28,410 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:37:28,411 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:37:28,531 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:37:33,532 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:37:33,533 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:37:35,652 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:37:35,653 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:37:40,809 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:37:40,810 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:37:42,982 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:37:47,988 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:37:47,988 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_103747.mp4
2025-03-19 10:37:47,989 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:37:49,179 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:37:54,432 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:37:54,432 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:37:54,461 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:37:55,595 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4
2025-03-19 10:37:55,596 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:37:57,609 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:38:00,618 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:38:00,620 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:38:03,625 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:38:03,625 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:38:03,626 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:38:04,833 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:38:04,945 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:38:06,954 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:38:06,956 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:38:06,956 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:38:09,039 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:38:09,039 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:38:10,951 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:38:10,951 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:38:10,952 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:38:10,952 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:38:12,865 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:38:15,005 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:38:15,007 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:37:55.705 scrcpy[23091:3685280] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 167.0 MB/s (90640 bytes in 0.001s)
2025-03-19 10:37:56.417 scrcpy[23091:3685280] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:37:56.417 scrcpy[23091:3685280] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:38:15,007 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:38:25,012 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4 (大小: 0.86MB)
2025-03-19 10:38:25,013 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.805856秒，无需修复
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:38:31,818 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:31,824 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:31,825 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:38:32,963 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:38:38,213 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:38:38,214 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:38,214 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:38:38,216 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:37:01\n- 中断时间: 2025-03-19 10:38:38\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:38:38"}]}]}}
2025-03-19 10:38:38,980 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:39:07,017 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:39:07,113 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:39:07,259 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:39:07,497 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:39:08,954 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:08,955 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:10,219 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:39:10,384 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:39:11,795 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:11,796 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:13,077 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:14,214 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:39:14,215 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:39:14,342 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:39:16,343 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:39:16,344 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:39:17,430 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:39:17,509 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:39:19,519 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:39:19,520 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:39:21,709 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:39:21,713 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:39:23,818 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:39:23,819 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:39:24,966 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:39:24,967 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:39:24,967 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:39:24,968 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:39:25,134 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:39:27,138 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:39:27,138 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:39:29,356 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:39:29,358 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:39:30,767 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:39:32,251 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:39:32,252 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:39:33,412 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:39:33,412 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:39:34,521 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:39:34,522 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:39:36,726 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:36,728 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:37,878 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:39:37,879 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:39:37,991 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:39:42,997 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:39:42,999 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:39:45,139 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:39:45,140 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:39:50,281 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:39:50,282 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:39:52,430 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:39:57,435 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:39:57,436 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_103957.mp4
2025-03-19 10:39:57,436 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:39:58,620 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:40:03,858 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:40:03,858 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:40:03,898 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:40:05,087 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4
2025-03-19 10:40:05,088 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:40:07,101 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:40:10,108 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:40:10,108 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:40:13,108 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:40:13,110 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:40:13,110 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:40:14,307 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:40:14,363 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:40:16,907 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:40:18,989 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:40:05.193 scrcpy[25234:3692907] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 202.1 MB/s (90640 bytes in 0.000s)
2025-03-19 10:40:05.910 scrcpy[25234:3692907] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:40:05.910 scrcpy[25234:3692907] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:40:28,996 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4 (大小: 0.80MB)
2025-03-19 10:40:28,998 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 录制文件完整，时长: 9.178711秒，无需修复
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:40:35,055 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:35,059 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:35,059 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:40:36,250 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:40:41,494 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:40:41,495 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:41,495 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:40:41,497 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:39:10\n- 中断时间: 2025-03-19 10:40:41\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:40:41"}]}]}}
2025-03-19 10:40:42,042 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:44:25,624 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:44:25,775 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:44:25,775 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:44:25,776 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:44:25,776 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:44:27,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:27,429 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:28,692 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:44:28,692 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:44:28,855 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:44:30,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:30,271 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:32,611 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:44:32,612 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:44:32,730 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:44:34,735 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:44:34,736 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:44:35,831 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:44:35,831 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:44:35,832 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:44:35,832 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:44:35,914 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:44:37,923 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:44:37,923 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:44:40,100 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:44:40,100 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:44:42,199 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:44:42,200 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:44:43,321 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:44:43,322 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:44:43,323 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:44:43,323 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:44:43,473 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:44:45,481 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:44:45,481 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:44:47,678 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:44:47,679 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:44:49,103 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:44:50,601 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:44:50,602 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:44:51,796 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:44:51,797 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:44:52,910 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:44:52,911 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:44:55,095 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:44:55,096 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:44:55,096 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:44:55,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:55,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:56,242 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:44:56,243 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:44:56,365 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:45:01,369 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:45:01,371 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:45:03,516 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:45:03,517 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:45:08,664 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:45:08,666 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:45:10,831 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:45:15,836 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:45:15,837 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_104515.mp4
2025-03-19 10:45:15,837 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:45:15,838 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:45:21,081 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:45:21,084 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:45:21,123 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:45:22,315 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4
2025-03-19 10:45:22,316 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:45:24,326 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:45:27,331 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:45:27,331 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:45:30,332 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:45:30,333 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:45:30,333 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:45:31,503 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:45:31,602 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:45:33,610 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:45:33,611 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:45:33,611 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:45:35,919 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:45:35,920 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:45:44,124 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,436 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:45:44,437 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,708 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:45:44,709 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,934 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:45:44,935 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,175 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:45:45,175 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,400 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:45:45,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,614 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:45:45,615 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,836 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:45:45,837 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:46,101 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:45:46,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:46,319 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:45:46,320 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:48,558 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:45:48,558 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:45:48,559 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76469ff u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t359}
    * Task{52cf615 #359 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:45:48,675 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,387 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,387 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,388 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:45:57,356 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:45:57,419 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:46:07,533 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:46:07,534 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:46:07,535 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76469ff u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t359}
    * Task{52cf615 #359 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:46:13,998 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:46:14,004 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:46:16,141 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:46:16,141 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:46:18,001 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:46:20,136 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:46:20,137 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:46:20,137 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:46:21,140 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:46:22,141 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:46:23,145 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:46:24,150 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:46:25,155 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:46:26,160 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:46:27,165 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:46:27,534 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:46:28,167 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:46:29,170 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:46:30,170 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:46:31,176 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:46:32,178 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:46:33,184 - QuickAppADBTester - INFO - 等待进程退出... (14/15)
2025-03-19 10:46:34,189 - QuickAppADBTester - INFO - 等待进程退出... (15/15)
2025-03-19 10:46:35,191 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 10:46:35,191 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 10:46:37,331 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 10:46:39,463 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 10:46:41,598 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 10:46:41,598 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 10:46:42,603 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 10:46:43,609 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 10:46:44,614 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 10:46:45,618 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 10:46:46,621 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 10:46:47,625 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 10:46:48,629 - QuickAppADBTester - INFO - 等待SIGTERM生效... (8/10)
2025-03-19 10:46:49,633 - QuickAppADBTester - INFO - 等待SIGTERM生效... (9/10)
2025-03-19 10:46:50,636 - QuickAppADBTester - INFO - 等待SIGTERM生效... (10/10)
2025-03-19 10:46:51,642 - QuickAppADBTester - WARNING - 所有温和的尝试都失败，不得不使用SIGKILL强制终止进程
2025-03-19 10:46:51,643 - QuickAppADBTester - WARNING - 这可能导致录制文件损坏(moov atom丢失)，录制可能无法播放
2025-03-19 10:46:53,644 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-19 10:46:53,645 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:45:22.417 scrcpy[30753:3713110] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 172.7 MB/s (90640 bytes in 0.001s)
2025-03-19 10:45:23.150 scrcpy[30753:3713110] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:45:23.150 scrcpy[30753:3713110] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:46:53,645 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:47:03,648 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4 (大小: 5.50MB)
2025-03-19 10:47:03,649 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:47:03,800 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12c904400] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4: Invalid data found when processing input

2025-03-19 10:47:03,855 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-19 10:47:03,855 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-19 10:47:03,898 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x13a804400] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4: Invalid data found when processing input

2025-03-19 10:47:03,898 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-19 10:47:03,964 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x144904080] moov atom not found
[in#0 @ 0x600003c60000] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4.
Error opening input files: Invalid data found when processing input

2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4
2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:47:11,464 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:11,472 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:11,473 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:47:11,473 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:47:16,699 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:47:16,700 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:16,701 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:47:16,701 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:47:16,702 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:47:17,089 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:47:18,092 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:47:18,092 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:47:18,093 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:47:19,306 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:47:19,307 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:47:19,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:47:21,493 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:47:21,494 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:47:22,673 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:47:22,674 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:47:22,674 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:47:23,105 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:44:28\n- 中断时间: 2025-03-19 10:47:23\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:47:23"}]}]}}
2025-03-19 10:47:23,640 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:49:59,394 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:49:59,464 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:49:59,539 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:49:59,727 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:50:01,191 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:01,191 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:50:02,435 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:50:02,435 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:50:02,595 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:50:03,996 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:03,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:05,310 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:06,412 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:50:06,413 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:50:06,544 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:50:08,548 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:50:08,548 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:50:09,632 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:50:09,717 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:50:11,726 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:50:11,726 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:50:13,895 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:50:13,896 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:50:15,985 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:50:15,986 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:50:17,093 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:50:17,172 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:50:19,178 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:50:19,178 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:50:21,313 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:50:21,314 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:50:22,718 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:50:24,193 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:50:24,194 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:50:25,387 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:50:25,387 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:50:26,480 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:50:26,480 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:50:28,669 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:28,671 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:29,808 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:50:29,808 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:50:29,922 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:50:34,924 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:50:34,925 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:50:37,032 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:50:37,034 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:50:42,169 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:50:42,171 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:50:44,374 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:50:49,380 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_105049.mp4
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:50:54,629 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:50:54,630 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:50:54,669 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:50:55,855 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4
2025-03-19 10:50:55,856 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:50:57,864 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:51:00,872 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:51:00,872 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:51:03,875 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:51:03,876 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:51:03,876 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:51:05,051 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:51:05,052 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:51:05,053 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:51:05,053 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:51:05,146 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:51:07,154 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:51:07,155 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:51:07,155 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:51:09,425 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:51:09,426 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:51:17,615 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:17,909 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:51:17,911 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,161 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:51:18,161 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,391 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:51:18,392 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,611 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:51:18,612 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,828 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:51:18,829 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,065 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:51:19,065 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,296 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:51:19,296 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,511 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:51:19,512 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,736 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:51:19,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:21,953 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:51:21,954 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:51:21,954 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eceabe8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t371}
    * Task{5aa12e7 #371 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:51:22,087 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:51:28,906 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:51:28,913 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:51:30,974 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:51:39,028 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:51:39,029 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:51:39,030 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:51:39,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eceabe8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t371}
    * Task{5aa12e7 #371 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:51:45,199 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:51:45,206 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:51:47,347 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:51:48,352 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:51:49,357 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:51:50,359 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:51:51,359 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:51:52,365 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:51:53,368 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:51:54,372 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:51:55,378 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:51:56,381 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:51:57,384 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:51:58,389 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:51:59,392 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:52:00,400 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时14秒
2025-03-19 10:52:00,422 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 10:52:00,422 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:50:55.958 scrcpy[36257:3732607] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.7 MB/s (90640 bytes in 0.000s)
2025-03-19 10:50:56.662 scrcpy[36257:3732607] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:50:56.662 scrcpy[36257:3732607] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:52:00,423 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:52:10,432 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4 (大小: 3.60MB)
2025-03-19 10:52:10,433 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 63.547256秒，无需修复
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4
2025-03-19 10:52:10,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:52:17,447 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:17,455 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:17,456 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:52:17,456 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:52:22,723 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:52:22,724 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:52:23,131 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:52:24,136 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:52:24,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:24,137 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:25,321 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:52:25,322 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:52:25,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:52:27,510 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:52:27,511 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:52:28,705 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:52:28,705 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:28,706 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:29,897 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:50:02\n- 结束时间: 2025-03-19 10:52:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:52:29"}]}]}}
2025-03-19 10:52:30,856 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:52:30,860 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:52:30,860 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 10:52:50,695 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:52:50,696 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:52:50,696 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 10:52:55,889 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:52:55,889 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:52:55,960 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:52:57,636 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:57,636 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:52:59,048 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:53:00,458 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:00,459 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:02,786 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:53:02,786 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:53:02,901 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:53:04,907 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:53:04,908 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:53:05,991 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:53:05,992 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:53:05,992 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:53:05,993 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:53:06,070 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:53:08,076 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:53:08,077 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:53:10,256 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:53:10,256 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:53:12,330 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:53:12,331 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:53:13,436 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:53:13,436 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:53:13,437 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:53:13,437 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:53:13,519 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:53:15,529 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:53:15,530 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:53:17,693 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:53:17,694 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:53:19,109 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:53:20,553 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:53:20,554 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:53:21,694 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:53:21,695 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:53:22,791 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:53:22,791 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:53:24,970 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:26,151 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:53:26,151 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:53:26,260 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:53:31,266 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:53:31,267 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:53:33,451 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:53:33,452 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:53:38,612 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:53:38,613 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:53:40,770 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:53:45,776 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:53:45,777 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_105345.mp4
2025-03-19 10:53:45,777 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:53:45,778 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:53:51,013 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:53:51,014 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:53:51,060 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:53:52,245 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4
2025-03-19 10:53:52,246 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:53:54,257 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:53:57,261 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:53:57,261 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:54:01,432 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:54:01,524 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:54:05,804 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:54:05,804 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:54:14,003 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,286 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:54:14,287 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,513 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:54:14,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,733 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:54:14,733 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,943 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:54:14,944 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,178 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:54:15,179 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,433 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:54:15,433 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,679 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:54:15,680 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,931 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:54:15,932 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:16,152 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:54:16,153 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:18,393 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:54:18,394 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:54:18,394 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:54:18,518 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ea08245 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t383}
    * Task{9dbeea8 #383 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,290 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,291 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,291 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:54:26,125 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg
2025-03-19 10:54:26,131 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:54:27,358 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:54:36,306 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:54:36,306 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:54:36,307 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ea08245 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t383}
    * Task{9dbeea8 #383 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:54:44,201 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:54:44,209 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:54:44,209 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:54:46,401 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:54:47,407 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:54:48,413 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:54:49,414 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:54:50,415 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:54:51,421 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:54:52,426 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:54:53,431 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:54:54,434 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:54:55,439 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:54:56,441 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:54:57,445 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:54:57,464 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:54:58,452 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:54:59,455 - QuickAppADBTester - INFO - 等待进程退出... (14/15)
2025-03-19 10:55:00,459 - QuickAppADBTester - INFO - 等待进程退出... (15/15)
2025-03-19 10:55:01,462 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 10:55:01,463 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 10:55:03,652 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 10:55:05,839 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 10:55:08,023 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 10:55:08,024 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 10:55:09,030 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 10:55:10,031 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 10:55:11,035 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 10:55:12,041 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 10:55:13,045 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 10:55:14,046 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 10:55:15,052 - QuickAppADBTester - INFO - 等待SIGTERM生效... (8/10)
2025-03-19 10:55:16,057 - QuickAppADBTester - INFO - 等待SIGTERM生效... (9/10)
2025-03-19 10:55:17,058 - QuickAppADBTester - INFO - 等待SIGTERM生效... (10/10)
2025-03-19 10:55:18,063 - QuickAppADBTester - WARNING - 所有温和的尝试都失败，不得不使用SIGKILL强制终止进程
2025-03-19 10:55:18,064 - QuickAppADBTester - WARNING - 这可能导致录制文件损坏(moov atom丢失)，录制可能无法播放
2025-03-19 10:55:20,064 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-19 10:55:20,066 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:53:52.361 scrcpy[39176:3743368] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 178.4 MB/s (90640 bytes in 0.000s)
2025-03-19 10:53:53.063 scrcpy[39176:3743368] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:53:53.063 scrcpy[39176:3743368] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:55:20,066 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:55:30,067 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4 (大小: 3.75MB)
2025-03-19 10:55:30,068 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:55:30,204 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12fe06ab0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4: Invalid data found when processing input

2025-03-19 10:55:30,245 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-19 10:55:30,245 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-19 10:55:30,282 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06af0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4: Invalid data found when processing input

2025-03-19 10:55:30,282 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-19 10:55:30,327 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06b50] moov atom not found
[in#0 @ 0x6000020cc400] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4.
Error opening input files: Invalid data found when processing input

2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4
2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:55:37,016 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:37,023 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:37,023 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:55:37,024 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:55:42,281 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:55:42,673 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:55:43,677 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:55:43,678 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:55:43,678 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:55:44,872 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:55:44,873 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:55:44,873 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:55:47,068 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:55:47,069 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:55:48,261 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:55:48,262 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:55:48,262 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:55:49,438 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:55:49,439 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:55:49,440 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:55:49,440 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:52:58\n- 结束时间: 2025-03-19 10:55:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:55:49"}]}]}}
2025-03-19 10:55:49,917 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:55:49,921 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:55:49,921 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:13:39,266 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:13:39,268 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:13:39,268 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:13:40,768 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:13:40,929 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:13:40,930 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:13:40,931 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:13:40,931 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:13:42,636 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:42,637 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:43,890 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:13:44,064 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:13:45,469 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:45,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:47,794 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:13:47,794 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:13:47,908 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:13:49,914 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:13:49,915 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:13:51,004 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:13:51,005 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:13:51,007 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:13:51,007 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:13:51,090 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:13:53,099 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:13:53,100 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:13:55,279 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:13:55,280 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:13:57,368 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:13:57,369 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:13:58,467 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:13:58,539 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:14:00,549 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:14:00,550 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:14:02,784 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:14:02,785 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:14:04,202 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:14:05,665 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:14:05,666 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:14:06,871 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:14:06,872 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:14:07,988 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:14:07,989 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:14:10,170 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:14:10,172 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:14:11,336 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:14:11,337 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:14:11,447 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:14:16,451 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:14:16,452 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:14:18,649 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:14:18,650 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:14:23,850 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:14:23,852 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:14:26,006 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:14:31,011 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:14:31,012 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_111431.mp4
2025-03-19 11:14:31,012 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:14:31,014 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:14:36,291 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:14:36,292 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:14:36,342 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:14:37,523 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4
2025-03-19 11:14:37,524 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 11:14:39,533 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:14:42,540 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:14:42,541 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:14:45,543 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:14:45,544 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:14:45,544 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:14:46,728 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:14:46,845 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:14:48,848 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:14:48,848 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:14:48,849 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:14:51,126 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:14:51,126 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:14:59,311 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:14:59,615 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:14:59,616 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:14:59,888 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:14:59,889 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,144 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:15:00,144 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,396 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:15:00,397 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,629 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:15:00,630 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,876 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:15:00,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,110 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:15:01,111 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,337 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:15:01,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,569 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:15:01,570 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:03,799 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:15:03,800 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:15:03,801 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:15:03,918 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{72ada14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t395}
    * Task{c3b0803 #395 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,701 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,702 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,703 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:15:12,647 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:15:20,215 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:20,220 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:15:30,381 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:15:30,382 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:15:30,383 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:15:30,515 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{72ada14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t395}
    * Task{c3b0803 #395 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,321 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,321 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,325 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:15:37,140 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:15:39,340 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:15:40,346 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:15:41,348 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:15:42,352 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:15:42,746 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:15:43,357 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:15:44,362 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:15:45,366 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:15:46,367 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:15:47,373 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:15:48,378 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:15:49,381 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:15:50,384 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:15:51,385 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:15:52,387 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:15:53,391 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:15:54,394 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:15:55,398 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:15:56,402 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:15:57,402 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:15:58,407 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:15:59,412 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:16:00,416 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:16:01,439 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时23秒
2025-03-19 11:16:01,440 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:16:01,441 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:14:37.642 scrcpy[59095:3807605] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 32.3 MB/s (90640 bytes in 0.003s)
2025-03-19 11:16:00.462 scrcpy[59095:3807605] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:16:00.462 scrcpy[59095:3807605] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:16:01,441 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:16:11,446 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4 (大小: 4.10MB)
2025-03-19 11:16:11,447 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 录制文件完整，时长: 82.114144秒，无需修复
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:16:18,568 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:16:23,833 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:16:23,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:16:24,211 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:26,416 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:16:26,417 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:16:26,417 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 11:13:43\n- 中断时间: 2025-03-19 11:16:27\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:16:27"}]}]}}
2025-03-19 11:16:28,412 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:16:35,053 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:16:35,157 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:16:35,354 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:16:36,789 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:36,790 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:38,039 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:16:38,209 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:16:39,602 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:39,602 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:40,896 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:41,984 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:16:41,985 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:16:42,114 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:16:44,118 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:16:44,118 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:16:45,276 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:16:45,276 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:16:45,277 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:16:45,277 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:16:45,357 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:16:47,366 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:16:47,367 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:16:49,456 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:16:49,458 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:16:51,560 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:16:51,561 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:16:52,724 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:16:52,856 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:16:54,861 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:16:54,862 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:16:57,082 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:16:57,083 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:16:58,498 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:16:59,974 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:16:59,975 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:17:01,182 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:17:01,183 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:17:02,286 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:17:02,287 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:17:04,472 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:17:05,636 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:17:05,636 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:17:05,763 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:17:10,769 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:17:10,771 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:17:12,937 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:17:12,937 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:17:18,071 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:17:18,072 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:17:20,255 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:17:25,259 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_111725.mp4
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:17:30,537 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:17:30,539 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:17:30,584 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:17:31,774 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4
2025-03-19 11:17:31,775 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 11:17:33,789 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:17:36,796 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:17:36,796 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:17:39,800 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:17:39,802 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:17:39,802 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:17:40,974 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:17:41,071 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:17:43,079 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:17:43,080 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:17:43,080 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:17:45,343 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:17:45,343 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:17:53,548 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:53,817 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:17:53,818 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,053 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:17:54,053 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,305 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:17:54,305 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,530 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:17:54,532 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,773 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:17:54,774 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,023 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:17:55,023 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,252 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:17:55,253 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,486 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:17:55,487 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,744 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:17:55,745 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:57,996 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:17:57,997 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:17:57,998 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:17:58,122 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1ebed33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t405}
    * Task{a970e69 #405 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,993 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,995 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,995 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:18:06,071 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:06,076 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:18:06,894 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:18:16,213 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:18:16,215 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:18:16,216 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:18:16,398 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1ebed33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t405}
    * Task{a970e69 #405 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,284 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,284 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,285 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:18:23,241 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:18:25,392 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:18:25,393 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:18:25,394 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:18:25,394 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:18:26,398 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:18:27,404 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:18:28,409 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:18:29,413 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:18:30,416 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:18:31,421 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:18:32,425 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:18:33,431 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:18:34,437 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:18:35,438 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:18:36,443 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:18:36,988 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:18:37,447 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:18:38,450 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:18:39,453 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:18:40,455 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:18:41,460 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:18:42,467 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:18:43,471 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:18:44,474 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:18:45,476 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:18:46,478 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:18:47,479 - QuickAppADBTester - INFO - 等待进程退出... (23/30)
2025-03-19 11:18:48,484 - QuickAppADBTester - INFO - 等待进程退出... (24/30)
2025-03-19 11:18:49,487 - QuickAppADBTester - INFO - 等待进程退出... (25/30)
2025-03-19 11:18:50,492 - QuickAppADBTester - INFO - 等待进程退出... (26/30)
2025-03-19 11:18:51,495 - QuickAppADBTester - INFO - 等待进程退出... (27/30)
2025-03-19 11:18:52,500 - QuickAppADBTester - INFO - 等待进程退出... (28/30)
2025-03-19 11:18:53,504 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时29秒
2025-03-19 11:18:53,505 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:18:53,505 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:17:31.887 scrcpy[59544:3812654] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 178.8 MB/s (90640 bytes in 0.000s)
2025-03-19 11:17:32.627 scrcpy[59544:3812654] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:17:32.627 scrcpy[59544:3812654] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:18:53,506 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:19:03,513 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4 (大小: 4.41MB)
2025-03-19 11:19:03,514 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:19:03,694 - QuickAppADBTester - INFO - 录制文件完整，时长: 75.279267秒，无需修复
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:19:10,767 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:19:16,001 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:19:16,001 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:19:16,392 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:19:17,398 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:19:17,398 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:19:17,399 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:19:18,599 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:19:18,599 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:19:18,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:19:20,791 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:19:20,791 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:19:23,115 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:19:23,116 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:19:23,117 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:19:23,117 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:16:38\n- 结束时间: 2025-03-19 11:19:23\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:19:23"}]}]}}
2025-03-19 11:19:23,650 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:19:23,651 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:19:23,652 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:19:53,033 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:19:53,034 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:19:53,034 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:22:53,231 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:22:53,551 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:22:54,984 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:54,984 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:22:56,268 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:22:56,268 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:22:56,430 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:22:56,431 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:22:56,431 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:22:56,432 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:22:57,827 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:57,828 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:23:00,125 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:23:00,126 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:23:00,248 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:23:02,250 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:23:02,251 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:03,344 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:23:03,426 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:23:05,430 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:23:05,432 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:23:07,638 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:23:07,639 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:23:09,717 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:23:09,717 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:23:10,815 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:23:10,815 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:23:10,816 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:10,816 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:23:10,888 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:23:12,897 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:23:12,898 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:23:15,073 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:23:15,073 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:23:16,501 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:23:17,980 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:23:17,980 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:23:19,183 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:23:19,183 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:23:20,272 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:23:20,272 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:23:22,465 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:23:22,466 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:23:23,603 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:23:23,605 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:23:23,721 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:23:28,724 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:23:28,724 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:23:30,897 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:23:30,898 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:23:36,009 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:23:36,011 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:23:38,165 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:23:43,168 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:23:43,169 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_112343.mp4
2025-03-19 11:23:43,169 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:23:43,170 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:23:48,439 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:23:48,440 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:23:48,495 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:23:49,677 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4
2025-03-19 11:23:49,679 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:23:51,688 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:23:54,695 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:23:54,695 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:23:57,697 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:23:57,699 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:23:57,701 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:23:58,864 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:23:58,966 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:24:00,971 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:24:00,972 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:24:00,972 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:24:03,250 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:24:03,251 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:24:11,455 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:11,794 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:24:11,795 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,007 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:24:12,007 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,273 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:24:12,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,658 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:24:12,658 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,894 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:24:12,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,108 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:24:13,108 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,386 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:24:13,386 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,641 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:24:13,641 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,981 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:24:13,982 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:16,191 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:24:16,191 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:24:16,192 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{91c5133 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t417}
    * Task{1981269 #417 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:24:16,319 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,004 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,005 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,005 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:24:24,802 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:24,806 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:24:24,808 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:24:34,993 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:24:34,994 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:24:34,994 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{91c5133 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t417}
    * Task{1981269 #417 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:24:35,118 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,838 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,839 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,839 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:24:41,563 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:41,565 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:24:43,732 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:24:43,732 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:24:43,733 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:24:43,733 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:24:44,738 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:24:45,743 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:24:46,746 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:24:47,747 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:24:48,748 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:24:49,753 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:24:50,758 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:24:51,758 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:24:52,762 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:24:53,765 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时12秒
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:23:49.787 scrcpy[60829:3824788] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.8 MB/s (90640 bytes in 0.001s)
2025-03-19 11:23:50.480 scrcpy[60829:3824788] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:23:50.480 scrcpy[60829:3824788] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:24:54,769 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:25:04,772 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4 (大小: 3.99MB)
2025-03-19 11:25:04,774 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 录制文件完整，时长: 58.575511秒，无需修复
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:25:12,288 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:25:17,543 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:25:17,968 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:25:20,068 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:25:20,068 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:25:20,069 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:25:22,171 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:25:22,171 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:25:24,401 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:25:24,403 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:25:24,403 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:25:24,404 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:22:56\n- 结束时间: 2025-03-19 11:25:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:25:24"}]}]}}
2025-03-19 11:25:24,954 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:25:24,956 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:25:24,956 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:26:39,055 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:26:39,056 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:26:39,056 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:26:40,101 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:26:40,242 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:26:40,496 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:26:41,972 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:41,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:43,206 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:26:44,765 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:44,767 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:46,026 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:47,107 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:26:47,108 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:26:47,202 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:26:49,208 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:26:49,208 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:26:50,277 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:26:50,353 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:26:52,358 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:26:52,359 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:26:54,525 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:26:54,526 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:26:56,606 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:26:56,607 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:26:57,709 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:26:57,714 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:26:57,717 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:26:57,718 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:26:57,787 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:26:59,797 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:26:59,798 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:27:02,015 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:27:02,016 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:27:03,443 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:27:04,928 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:27:04,929 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:27:06,109 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:27:06,110 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:27:07,220 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:27:07,221 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:27:09,405 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:27:10,569 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:27:10,569 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:27:10,691 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:27:15,694 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:27:15,695 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:27:17,848 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:27:17,849 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:27:23,005 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:27:23,006 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:27:25,149 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_112730.mp4
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:27:35,410 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:27:35,411 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:27:35,460 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:27:36,652 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4
2025-03-19 11:27:36,652 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:27:38,665 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:27:41,672 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:27:41,672 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:27:44,675 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:27:44,678 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:27:44,678 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:27:45,851 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:27:45,955 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:27:47,963 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:27:47,964 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:27:47,964 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:27:50,209 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:27:50,210 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:27:58,391 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:58,642 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:27:58,642 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:58,875 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:27:58,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,121 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:27:59,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,370 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:27:59,371 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,639 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:27:59,639 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,914 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:27:59,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,145 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:28:00,145 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,397 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:28:00,398 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,625 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:28:00,626 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:02,874 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:28:02,875 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:28:02,876 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:28:02,993 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{daaead9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t423}
    * Task{f8ef37f #423 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:28:02,993 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,848 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,850 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,851 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:28:10,578 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:28:11,772 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:28:20,755 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:28:20,756 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:28:20,756 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{daaead9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t423}
    * Task{f8ef37f #423 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,666 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,666 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,667 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:28:27,393 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:28:29,591 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:28:30,596 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:28:31,601 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:28:32,606 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:28:33,609 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:28:34,614 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:28:35,618 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:28:36,621 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:28:37,626 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:28:38,628 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:28:39,630 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:28:40,635 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:28:41,641 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:28:41,862 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:28:42,645 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:28:43,646 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:28:44,653 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:28:45,657 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:28:46,662 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:28:47,662 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:28:48,663 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:28:49,668 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:28:50,672 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:28:51,673 - QuickAppADBTester - INFO - 等待进程退出... (23/30)
2025-03-19 11:28:52,677 - QuickAppADBTester - INFO - 等待进程退出... (24/30)
2025-03-19 11:28:53,681 - QuickAppADBTester - INFO - 等待进程退出... (25/30)
2025-03-19 11:28:54,685 - QuickAppADBTester - INFO - 等待进程退出... (26/30)
2025-03-19 11:28:55,688 - QuickAppADBTester - INFO - 等待进程退出... (27/30)
2025-03-19 11:28:56,692 - QuickAppADBTester - INFO - 等待进程退出... (28/30)
2025-03-19 11:28:57,695 - QuickAppADBTester - INFO - 等待进程退出... (29/30)
2025-03-19 11:28:58,698 - QuickAppADBTester - INFO - 等待进程退出... (30/30)
2025-03-19 11:28:59,703 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 11:28:59,703 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 11:29:01,886 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 11:29:04,081 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 11:29:06,272 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 11:29:06,273 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 11:29:07,276 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 11:29:08,279 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 11:29:09,284 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 11:29:10,289 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 11:29:11,291 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 11:29:11,952 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-19 11:29:12,294 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 11:29:13,299 - QuickAppADBTester - INFO - 进程在接收SIGTERM后成功退出，用时8秒
2025-03-19 11:29:13,299 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:29:13,300 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:27:36.765 scrcpy[61406:3833302] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.9 MB/s (90640 bytes in 0.001s)
2025-03-19 11:27:37.516 scrcpy[61406:3833302] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:27:37.516 scrcpy[61406:3833302] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:29:13,301 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:29:23,305 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4 (大小: 3.81MB)
2025-03-19 11:29:23,305 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 录制文件完整，时长: 95.415067秒，无需修复
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:29:30,110 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:30,117 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:30,117 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:29:30,118 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:29:35,355 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:29:35,364 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:29:35,982 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:29:36,987 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:29:36,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:29:36,988 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:29:40,423 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:29:40,424 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:29:41,577 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:29:41,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:29:41,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:29:42,723 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:26:43\n- 结束时间: 2025-03-19 11:29:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:29:42"}]}]}}
2025-03-19 11:29:43,203 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:29:43,204 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:29:43,204 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:42:27,593 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:42:27,595 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:42:27,595 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:46:25,500 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:46:27,241 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:27,242 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:46:30,080 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:30,080 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:31,314 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:32,396 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:46:32,396 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:46:32,502 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:46:34,506 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:46:34,507 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:46:35,682 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:46:37,689 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:46:37,690 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:46:39,819 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:46:39,820 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:46:41,895 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:46:41,896 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:46:42,999 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:46:42,999 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:46:43,000 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:46:43,000 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:46:43,066 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:46:45,075 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:46:45,076 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:46:47,253 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:46:47,255 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:46:48,667 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:46:50,108 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:46:50,109 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:46:51,263 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:46:51,264 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:46:52,369 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:46:52,369 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:46:54,506 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:46:54,507 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:46:54,507 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:46:54,507 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:54,508 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:55,690 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:46:55,691 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:46:55,809 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:47:00,812 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:47:00,813 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:47:02,974 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:47:02,974 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:47:08,141 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:47:08,143 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:47:10,293 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:47:15,298 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:47:15,300 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_114715.mp4
2025-03-19 11:47:15,300 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:47:15,300 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:47:20,568 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:47:20,570 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:47:20,618 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:47:21,810 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4
2025-03-19 11:47:21,811 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:47:23,823 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:47:26,829 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:47:26,830 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:47:29,835 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:47:29,835 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:47:29,835 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:47:31,020 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:47:31,021 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:47:31,021 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:47:31,021 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:47:31,129 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:47:33,139 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:47:33,140 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:47:33,140 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:47:35,439 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:47:35,440 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:47:43,618 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:47:43,619 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:47:43,619 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:47:43,619 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,003 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:47:44,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,262 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:47:44,263 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,497 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:47:44,498 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,731 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:47:44,732 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,980 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:47:44,981 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,208 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:47:45,209 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,454 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:47:45,454 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,683 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:47:45,684 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,936 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:47:45,937 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:48,169 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:47:48,170 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:47:48,170 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:47:48,340 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c89ed01 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t429}
    * Task{8127594 #429 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:47:48,341 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:47:48,341 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:47:48,341 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:47:48,342 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_114748_20250319_114748.png
2025-03-19 11:47:50,059 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_114748_20250319_114748.png
2025-03-19 11:47:50,060 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_114748_20250319_114748.png
2025-03-19 11:47:50,060 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:47:56,934 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:47:56,987 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:47:56,989 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:47:56,989 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:47:56,989 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:47:56,990 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:07,168 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:48:07,171 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:48:07,171 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:48:07,310 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c89ed01 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t429}
    * Task{8127594 #429 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:48:07,310 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:48:07,311 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:48:07,311 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:48:07,311 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_114807_20250319_114807.png
2025-03-19 11:48:09,127 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_114807_20250319_114807.png
2025-03-19 11:48:09,128 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_114807_20250319_114807.png
2025-03-19 11:48:09,129 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:48:13,974 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:16,153 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:48:16,154 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:48:16,155 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:48:16,155 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:48:17,158 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 42.9 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:48:28,171 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4 (大小: 3.56MB)
2025-03-19 11:48:28,172 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.447178秒，无需修复
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:48:35,257 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4
2025-03-19 11:48:35,259 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4
2025-03-19 11:48:35,259 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:48:35,259 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:48:40,477 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:48:40,809 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:48:41,814 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:48:41,815 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:48:41,815 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:42,919 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:48:42,919 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:48:42,919 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:48:45,016 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:48:45,017 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:48:46,206 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:48:46,207 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:48:46,207 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:47,338 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:48:47,340 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:48:47,341 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:48:47,341 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:46:28\n- 结束时间: 2025-03-19 11:48:47\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:48:47"}]}]}}
2025-03-19 11:48:47,778 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:48:47,782 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:48:47,782 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:51:40,913 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:51:40,914 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:51:40,914 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:51:42,159 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:51:42,317 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:51:42,317 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:51:42,317 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:51:42,318 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:51:42,583 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:51:42,584 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:51:42,584 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:51:42,584 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:51:44,044 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:51:44,045 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:51:45,435 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:51:45,435 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:51:45,435 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:51:45,436 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:51:46,838 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:51:46,839 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:51:49,175 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:51:49,175 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:51:49,283 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:51:51,289 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:51:51,290 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:51:52,378 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:51:52,381 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:51:52,381 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:51:52,382 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:51:52,466 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:51:54,472 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:51:54,473 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:51:56,654 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:51:56,655 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:51:58,738 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:51:58,739 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:51:59,845 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:51:59,849 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:51:59,849 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:51:59,849 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:51:59,940 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:52:01,943 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:52:01,944 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:52:04,085 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:52:04,086 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:52:05,507 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:52:06,998 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:52:06,999 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:52:08,211 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:52:08,212 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:52:09,316 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:52:09,317 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:52:12,683 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:52:12,684 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:52:12,804 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:52:17,808 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:52:17,810 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:52:19,964 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:52:19,965 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:52:25,116 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:52:25,117 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:52:27,268 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:52:32,273 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:52:32,275 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_115232.mp4
2025-03-19 11:52:32,276 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:52:32,276 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:52:37,540 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:52:37,541 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:52:37,593 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:52:38,782 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4
2025-03-19 11:52:38,783 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:52:40,796 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:52:43,804 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:52:43,805 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:52:46,808 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:52:46,808 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:52:46,809 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:52:47,998 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:52:47,999 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:52:47,999 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:52:47,999 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:52:48,108 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:52:50,118 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:52:50,119 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:52:50,119 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:52:52,446 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:52:52,447 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:53:00,641 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:53:00,643 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:53:00,643 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:53:00,643 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:00,988 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:53:00,989 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,210 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:53:01,212 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,443 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:53:01,444 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,701 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:53:01,702 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,955 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:53:01,956 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,201 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:53:02,202 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,434 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:53:02,435 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,689 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:53:02,690 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,997 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:53:02,998 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:05,264 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:53:05,265 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:53:05,265 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:53:05,460 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c781865 u0 com.huawei.fastapp/.app.processManager.DeepLinkActivity t437}
    * Task{90529c7 #437 type=standard A=10148:rpk.loader.entry U=0 visible=true mode=fullscreen translucent=true sz=1}

2025-03-19 11:53:05,461 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:53:05,461 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:53:05,462 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:53:05,462 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115305_20250319_115305.png
2025-03-19 11:53:07,186 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115305_20250319_115305.png
2025-03-19 11:53:07,187 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115305_20250319_115305.png
2025-03-19 11:53:07,187 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:53:12,486 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_63.jpg
2025-03-19 11:53:12,494 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_63.jpg
2025-03-19 11:53:12,495 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:53:12,495 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:53:12,495 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:53:13,893 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:53:22,585 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:53:22,586 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:53:22,586 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:53:22,729 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:53:22,729 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-19 11:53:22,730 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-19 11:53:22,730 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:53:22,730 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115322_20250319_115322.png
2025-03-19 11:53:24,073 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115322_20250319_115322.png
2025-03-19 11:53:24,074 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115322_20250319_115322.png
2025-03-19 11:53:24,074 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:53:29,185 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_64.jpg
2025-03-19 11:53:29,193 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_64.jpg
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:53:31,378 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:53:31,379 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:53:31,379 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:53:31,379 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:53:32,381 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:53:33,385 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:53:33,386 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:53:33,387 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 126.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 11:53:33,387 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:53:43,389 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4 (大小: 8.66MB)
2025-03-19 11:53:43,390 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:53:43,556 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.742567秒，无需修复
2025-03-19 11:53:43,556 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:53:43,557 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4
2025-03-19 11:53:43,557 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:53:51,151 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4
2025-03-19 11:53:51,158 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4
2025-03-19 11:53:51,158 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:53:51,158 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:53:56,433 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:53:56,434 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4
2025-03-19 11:53:56,434 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:53:56,434 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:53:56,435 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:53:56,785 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:53:57,790 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:53:57,791 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:53:57,791 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:53:58,975 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:53:58,976 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:53:58,976 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:54:01,089 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:54:01,090 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:54:02,254 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:54:02,255 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:02,256 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:03,398 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:54:03,399 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-19 11:54:03,400 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:54:03,400 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用拉回测试失败**\n\n- 开始时间: 2025-03-19 11:51:45\n- 结束时间: 2025-03-19 11:54:03\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ✅ 成功\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_63.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_64.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:54:03"}]}]}}
2025-03-19 11:54:03,928 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:54:03,931 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:54:03,931 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:54:19,933 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:54:19,935 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:54:19,935 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:54:21,043 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:54:21,194 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:54:21,194 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:54:21,195 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:54:21,195 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:54:22,925 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:22,926 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:24,174 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:54:24,332 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:54:24,333 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:54:24,333 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:54:24,333 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:54:25,735 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:25,735 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:27,008 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:28,096 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:54:28,096 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:54:28,206 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:54:30,211 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:54:30,211 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:54:31,305 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:54:31,305 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:54:31,306 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:54:31,306 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:54:31,383 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:54:33,394 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:54:33,394 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:54:35,580 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:54:35,581 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:54:37,674 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:54:37,675 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:54:38,779 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:54:38,780 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:54:38,781 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:54:38,781 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:54:38,853 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:54:40,862 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:54:40,863 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:54:43,027 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:54:43,029 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:54:44,458 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:54:45,927 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:54:45,929 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:54:47,107 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:54:47,128 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:54:48,218 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:54:48,220 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:54:50,390 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:54:50,391 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:54:50,391 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:54:50,391 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:50,392 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:51,517 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:54:51,518 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:54:51,643 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:54:56,646 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:54:56,646 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:54:58,782 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:54:58,782 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:55:03,916 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:55:03,917 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:55:06,075 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:55:11,078 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:55:11,080 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_115511.mp4
2025-03-19 11:55:11,080 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:55:11,080 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:55:16,346 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:55:16,347 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:55:16,401 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:55:17,592 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4
2025-03-19 11:55:17,594 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:55:19,604 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:55:22,612 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:55:22,612 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:55:25,616 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:55:25,617 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:55:25,617 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:55:26,797 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:55:26,798 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:55:26,798 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:55:26,798 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:55:26,904 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:55:28,912 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:55:28,912 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:55:28,913 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:55:31,191 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:55:31,193 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:55:39,408 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:55:39,409 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:55:39,409 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:55:39,409 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:39,686 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:55:39,687 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:39,920 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:55:39,921 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:40,180 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:55:40,181 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:40,411 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:55:40,412 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:40,748 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:55:40,748 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,077 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:55:41,078 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,340 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:55:41,340 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,620 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:55:41,621 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,906 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:55:41,906 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:44,140 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:55:44,141 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:55:44,141 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-19 11:55:44,218 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115544_20250319_115544.png
2025-03-19 11:55:45,382 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115544_20250319_115544.png
2025-03-19 11:55:45,382 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115544_20250319_115544.png
2025-03-19 11:55:45,382 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:55:50,662 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_66.jpg
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_66.jpg
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:55:52,715 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:56:00,834 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:56:00,835 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:56:00,835 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-19 11:56:00,969 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115600_20250319_115600.png
2025-03-19 11:56:02,321 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115600_20250319_115600.png
2025-03-19 11:56:02,321 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115600_20250319_115600.png
2025-03-19 11:56:02,321 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:56:07,890 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_67.jpg
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_67.jpg
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:56:11,024 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:56:12,031 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:56:12,031 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:56:12,032 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 118.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 11:56:12,032 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:56:22,035 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4 (大小: 4.90MB)
2025-03-19 11:56:22,036 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:56:22,226 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.498833秒，无需修复
2025-03-19 11:56:22,227 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:56:22,227 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4
2025-03-19 11:56:22,227 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:56:29,438 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4
2025-03-19 11:56:29,450 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4
2025-03-19 11:56:29,450 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:56:29,450 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:56:34,720 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:56:35,117 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:56:36,119 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:56:36,120 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:56:36,120 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:56:37,311 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:56:37,313 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:56:37,313 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:56:39,411 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:56:39,412 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:56:40,585 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:56:40,586 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:56:40,586 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:56:41,702 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:56:41,704 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-19 11:56:41,704 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:56:41,705 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-19 11:54:24\n- 结束时间: 2025-03-19 11:56:41\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_66.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_67.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:56:41"}]}]}}
2025-03-19 11:56:42,180 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:56:42,183 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:56:42,183 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:56:58,140 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:56:58,141 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:56:58,141 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:56:59,055 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:56:59,148 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:56:59,242 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:56:59,243 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:56:59,243 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:56:59,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:57:00,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:00,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:02,151 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:57:02,151 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:57:02,152 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:57:02,152 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:57:02,152 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:57:02,302 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:57:02,302 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:57:02,302 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:57:02,303 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:57:03,717 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:03,717 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:06,068 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:57:06,069 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:57:06,189 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:57:08,191 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:57:08,201 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:57:09,292 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:57:09,295 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:57:09,295 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:57:09,295 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:57:09,387 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:57:11,393 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:57:11,393 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:57:13,531 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:57:13,532 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:57:15,616 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:57:15,617 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:57:16,724 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:57:16,725 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:57:16,725 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:57:16,725 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:57:16,795 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:57:18,801 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:57:18,802 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:57:21,005 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:57:21,005 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:57:22,422 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:57:23,981 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:57:23,982 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:57:25,368 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:57:25,369 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:57:26,466 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:57:26,466 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:57:28,652 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:29,787 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:57:29,788 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:57:29,923 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:57:34,926 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:57:34,927 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:57:37,041 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:57:37,041 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:57:42,186 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:57:42,187 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:57:44,350 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:57:49,366 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:57:49,367 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_115749.mp4
2025-03-19 11:57:49,367 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:57:49,367 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:57:54,631 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:57:54,632 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:57:54,679 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:57:55,870 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4
2025-03-19 11:57:55,871 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:57:57,884 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:58:00,890 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:58:00,890 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:58:03,898 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:58:03,899 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:58:03,899 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:58:05,099 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:58:05,100 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:58:05,100 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:58:05,100 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:58:05,197 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:58:07,208 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:58:07,209 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:58:07,209 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:58:09,502 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:58:09,502 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,010 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:58:18,010 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,241 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:58:18,242 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,476 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:58:18,477 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,709 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:58:18,710 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,952 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:58:18,953 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,177 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:58:19,178 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,409 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:58:19,409 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,626 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:58:19,627 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,889 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:58:19,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:22,134 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:58:22,135 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:58:22,135 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:58:22,295 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2abdc49 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t450}
    * Task{70f5a6f #450 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115822_20250319_115822.png
2025-03-19 11:58:23,787 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115822_20250319_115822.png
2025-03-19 11:58:23,787 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115822_20250319_115822.png
2025-03-19 11:58:23,788 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:58:29,092 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_69.jpg
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_69.jpg
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:58:31,019 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:58:39,288 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:58:39,289 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:58:39,289 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:58:39,414 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2abdc49 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t450}
    * Task{70f5a6f #450 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:58:39,415 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:58:39,416 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:58:39,416 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:58:39,416 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115839_20250319_115839.png
2025-03-19 11:58:40,911 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115839_20250319_115839.png
2025-03-19 11:58:40,912 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115839_20250319_115839.png
2025-03-19 11:58:40,912 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:58:46,434 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_70.jpg
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_70.jpg
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:58:48,625 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:58:48,625 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:58:48,626 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:58:48,626 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:58:49,631 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:58:50,634 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:58:50,635 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:58:50,635 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 133.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 11:58:50,635 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:59:00,639 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4 (大小: 3.40MB)
2025-03-19 11:59:00,640 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:59:00,746 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.851856秒，无需修复
2025-03-19 11:59:00,747 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:59:00,747 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4
2025-03-19 11:59:00,747 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:59:07,365 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4
2025-03-19 11:59:07,370 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4
2025-03-19 11:59:07,370 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:59:07,370 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:59:12,632 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:59:13,052 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:59:14,058 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:59:14,058 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:59:14,058 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:59:15,168 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:59:15,169 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:59:15,169 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:59:17,274 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:59:17,275 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:59:18,427 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:59:18,428 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:59:18,428 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:59:19,559 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:59:19,559 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:59:19,559 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:59:19,560 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:57:02\n- 结束时间: 2025-03-19 11:59:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_69.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_70.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:59:19"}]}]}}
2025-03-19 11:59:20,155 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:59:20,158 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:59:20,158 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 12:04:20,179 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:04:20,180 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:04:20,180 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:04:20,180 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:04:20,325 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:04:20,428 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:04:20,429 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:04:20,429 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:04:20,429 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:04:20,662 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:04:20,662 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:04:20,663 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:04:20,663 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:04:22,144 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:22,145 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:04:23,519 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:04:23,520 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:04:23,520 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:04:23,520 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:04:24,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:24,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:26,190 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:27,292 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:04:27,293 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:04:27,424 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:04:29,430 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:04:29,431 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:04:30,528 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:04:30,529 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:04:30,529 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:04:30,529 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:04:30,596 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:04:32,605 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:04:32,606 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:04:34,798 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:04:34,799 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:04:36,882 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:04:36,883 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:04:37,986 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:04:37,987 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:04:37,987 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:04:37,987 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:04:38,062 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:04:40,070 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:04:40,070 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:04:42,258 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:04:42,262 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:04:43,682 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:04:45,178 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:04:45,179 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:04:46,354 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:04:46,355 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:04:47,463 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:04:47,464 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:04:49,648 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:50,837 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:04:50,838 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:04:50,966 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:04:55,969 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:04:55,969 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:04:58,120 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:04:58,121 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:05:03,255 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:05:03,256 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:05:05,415 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:05:10,420 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:05:10,421 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_120510.mp4
2025-03-19 12:05:10,421 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:05:10,421 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:05:15,691 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:05:15,692 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:05:15,741 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:05:16,931 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4
2025-03-19 12:05:16,932 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:05:18,941 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:05:21,944 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:05:21,945 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:05:24,950 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:05:24,952 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:05:24,952 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:05:26,139 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:05:26,140 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:05:26,140 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:05:26,141 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:05:26,245 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:05:28,255 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:05:28,255 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:05:28,255 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:05:30,509 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:05:30,510 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:05:38,681 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:05:38,682 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:05:38,682 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:05:38,682 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,006 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:05:39,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,252 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:05:39,254 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,497 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:05:39,498 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,740 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:05:39,741 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,992 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:05:39,993 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,213 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:05:40,214 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,448 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:05:40,448 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,685 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:05:40,686 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,939 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:05:40,940 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:43,226 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:05:43,226 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:05:43,227 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c4edf17 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t456}
    * Task{cf76ced #456 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_120543_20250319_120543.png
2025-03-19 12:05:45,174 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_120543_20250319_120543.png
2025-03-19 12:05:45,175 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_120543_20250319_120543.png
2025-03-19 12:05:45,175 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:05:52,054 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:05:52,576 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:05:52,582 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:05:52,582 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:05:52,582 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:05:52,583 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:02,701 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:06:02,702 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:06:02,702 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c4edf17 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t456}
    * Task{cf76ced #456 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:06:02,823 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_120602_20250319_120602.png
2025-03-19 12:06:04,643 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_120602_20250319_120602.png
2025-03-19 12:06:04,644 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_120602_20250319_120602.png
2025-03-19 12:06:04,645 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:06:09,584 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:06:09,591 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:06:09,591 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:06:09,592 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:06:09,592 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:06:09,592 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:11,699 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:06:11,700 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:06:11,700 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:06:11,700 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:06:12,705 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:06:13,711 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:06:13,712 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:06:13,712 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 126.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:06:13,712 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:06:23,718 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4 (大小: 4.66MB)
2025-03-19 12:06:23,718 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:06:23,812 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.832400秒，无需修复
2025-03-19 12:06:23,813 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:06:23,813 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4
2025-03-19 12:06:23,813 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:06:31,018 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4
2025-03-19 12:06:31,024 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4
2025-03-19 12:06:31,024 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:06:31,024 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:06:36,285 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:06:36,663 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:06:37,668 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:06:37,669 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:06:37,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:38,772 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:06:38,773 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:06:38,773 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:06:40,887 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:06:40,888 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:06:42,051 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:06:42,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:06:42,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:43,210 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:06:43,211 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:06:43,211 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:06:43,211 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:04:23\n- 结束时间: 2025-03-19 12:06:43\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:06:43"}]}]}}
2025-03-19 12:06:43,648 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:06:43,652 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:11:43,709 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:11:43,710 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:11:43,710 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:11:43,710 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:11:43,856 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:11:44,233 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:11:44,234 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:11:44,234 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:11:44,234 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:11:45,687 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:11:45,688 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:11:47,136 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:11:47,136 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:11:47,137 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:11:47,137 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:11:48,546 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:11:48,546 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:11:50,905 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:11:50,906 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:11:51,020 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:11:53,022 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:11:53,023 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:11:54,112 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:11:54,113 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:11:54,113 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:11:54,113 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:11:54,195 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:11:56,206 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:11:56,207 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:11:58,392 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:11:58,393 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:12:00,458 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:12:00,459 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:12:01,568 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:12:01,569 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:12:01,569 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:12:01,569 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:12:01,649 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:12:03,656 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:12:03,657 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:12:05,857 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:12:05,858 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:12:07,281 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:12:08,743 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:12:08,744 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:12:09,931 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:12:09,932 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:12:11,029 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:12:11,030 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:12:13,219 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:12:14,377 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:12:14,378 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:12:14,500 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:12:19,504 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:12:19,505 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:12:21,646 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:12:21,646 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:12:26,793 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:12:26,793 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:12:28,965 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:12:33,968 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:12:33,969 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_121233.mp4
2025-03-19 12:12:33,969 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:12:33,969 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:12:39,229 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:12:39,230 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:12:39,284 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:12:40,475 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4
2025-03-19 12:12:40,475 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:12:42,483 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:12:45,489 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:12:45,489 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:12:48,491 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:12:48,492 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:12:48,492 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:12:49,679 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:12:49,680 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:12:49,680 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:12:49,680 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:12:49,765 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:12:51,770 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:12:51,771 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:12:51,772 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:12:54,093 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:12:54,094 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:13:02,272 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:13:02,273 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:13:02,273 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:13:02,273 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:02,569 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:13:02,570 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:02,801 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:13:02,802 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,089 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:13:03,090 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,366 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:13:03,367 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,623 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:13:03,624 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,851 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:13:03,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:04,090 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:13:04,091 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:04,333 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:13:04,334 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:04,582 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:13:04,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:06,834 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:13:06,835 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:13:06,835 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:13:06,948 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{88f0c29 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t462}
    * Task{11adcdc #462 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:13:06,948 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:13:06,949 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:13:06,949 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:13:06,949 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_121306_20250319_121306.png
2025-03-19 12:13:08,234 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_121306_20250319_121306.png
2025-03-19 12:13:08,235 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_121306_20250319_121306.png
2025-03-19 12:13:08,235 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:13:15,024 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_74.jpg
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_74.jpg
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:13:15,631 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:13:25,127 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:13:25,127 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:13:25,127 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:13:25,241 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{88f0c29 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t462}
    * Task{11adcdc #462 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_121325_20250319_121325.png
2025-03-19 12:13:26,606 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_121325_20250319_121325.png
2025-03-19 12:13:26,607 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_121325_20250319_121325.png
2025-03-19 12:13:26,607 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:13:32,965 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_75.jpg
2025-03-19 12:13:32,970 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_75.jpg
2025-03-19 12:13:32,970 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:13:32,970 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:13:32,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:13:32,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:13:35,154 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:13:35,155 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:13:35,155 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:13:35,155 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:13:36,159 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:13:37,165 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:13:37,165 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:13:37,166 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 107.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:13:37,166 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:13:47,172 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4 (大小: 3.49MB)
2025-03-19 12:13:47,172 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.797256秒，无需修复
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:13:54,425 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4
2025-03-19 12:13:54,431 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4
2025-03-19 12:13:54,431 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:13:54,431 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:13:59,691 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:14:00,068 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:14:01,071 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:14:01,071 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:14:01,071 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:14:02,166 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:14:02,167 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:14:02,167 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:14:04,268 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:14:04,268 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:14:05,431 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:14:05,432 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:14:05,432 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:14:06,566 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:14:06,567 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:14:06,567 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:14:06,568 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:11:46\n- 结束时间: 2025-03-19 12:14:06\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_74.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_75.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:14:06"}]}]}}
2025-03-19 12:14:06,977 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:14:06,979 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:19:07,006 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:19:07,008 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:19:07,008 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:19:07,008 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:19:07,146 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:19:07,290 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:19:07,291 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:19:07,291 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:19:07,291 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:19:07,537 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:19:07,538 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:19:07,538 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:19:07,538 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:19:08,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:08,989 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:10,270 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:19:10,419 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:19:10,420 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:19:10,420 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:19:10,420 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:19:11,825 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:11,826 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:14,186 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:19:14,187 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:19:14,308 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:19:16,314 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:19:16,315 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:19:17,469 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:19:19,476 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:19:19,477 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:19:21,646 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:19:21,647 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:19:23,730 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:19:23,731 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:19:24,833 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:19:24,834 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:19:24,834 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:19:24,834 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:19:24,907 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:19:26,913 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:19:26,914 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:19:29,088 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:19:29,089 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:19:30,502 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:19:31,953 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:19:31,954 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:19:33,113 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:19:33,114 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:19:34,214 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:19:34,215 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:19:36,415 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:19:36,415 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:19:36,416 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:19:36,416 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:36,416 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:37,596 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:19:37,597 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:19:37,723 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:19:42,725 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:19:42,725 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:19:44,866 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:19:44,867 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:19:50,015 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:19:50,015 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:19:52,162 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:19:57,168 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:19:57,168 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_121957.mp4
2025-03-19 12:19:57,169 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:19:57,169 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:20:02,427 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:20:02,428 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:20:02,473 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:20:03,611 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4
2025-03-19 12:20:03,612 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:20:05,619 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:20:08,621 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:20:08,621 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:20:11,624 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:20:11,625 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:20:11,625 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:20:12,800 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:20:12,801 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:20:12,801 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:20:12,801 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:20:12,907 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:20:14,915 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:20:14,916 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:20:14,916 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:20:17,201 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:20:17,202 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:20:25,393 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:20:25,393 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:20:25,394 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:20:25,394 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:25,638 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:20:25,639 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:25,938 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:20:25,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,203 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:20:26,204 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,457 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:20:26,458 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,721 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:20:26,721 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,957 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:20:26,957 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:27,186 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:20:27,187 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:27,411 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:20:27,412 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:27,647 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:20:27,647 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:29,883 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:20:29,884 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:20:29,884 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:20:30,005 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e754ba8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t468}
    * Task{48a05a7 #468 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122030_20250319_122030.png
2025-03-19 12:20:31,196 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122030_20250319_122030.png
2025-03-19 12:20:31,197 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122030_20250319_122030.png
2025-03-19 12:20:31,197 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:20:37,492 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:37,497 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:37,497 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:20:37,498 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:20:37,498 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:20:38,714 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:20:47,627 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:20:47,628 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:20:47,628 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:20:47,771 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e754ba8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t468}
    * Task{48a05a7 #468 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122047_20250319_122047.png
2025-03-19 12:20:48,965 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122047_20250319_122047.png
2025-03-19 12:20:48,965 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122047_20250319_122047.png
2025-03-19 12:20:48,965 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:20:53,440 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:53,445 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:53,445 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:20:53,446 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:20:53,446 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:20:53,446 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:20:56,639 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:20:57,644 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:20:57,645 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:20:57,645 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 155.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:20:57,645 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:21:07,651 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4 (大小: 3.16MB)
2025-03-19 12:21:07,651 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:21:07,763 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.132889秒，无需修复
2025-03-19 12:21:07,763 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:21:07,764 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4
2025-03-19 12:21:07,764 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:21:15,089 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4
2025-03-19 12:21:15,094 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4
2025-03-19 12:21:15,095 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:21:15,095 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:21:20,355 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:21:20,673 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:21:21,679 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:21:21,679 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:21:21,679 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:21:22,791 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:21:22,792 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:21:22,793 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:21:24,909 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:21:24,910 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:21:26,068 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:21:26,068 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:21:26,068 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:21:27,192 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:21:27,192 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:21:27,193 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:21:27,193 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:19:10\n- 结束时间: 2025-03-19 12:21:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:21:27"}]}]}}
2025-03-19 12:21:27,604 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:21:27,606 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:26:28,608 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:26:28,609 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:26:28,609 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:26:28,609 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:26:28,710 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:26:28,855 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:26:28,855 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:26:28,856 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:26:28,856 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:26:30,535 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:30,535 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:31,814 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:26:33,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:33,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:34,597 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:35,677 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:26:35,677 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:26:35,787 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:26:37,791 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:26:37,792 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:26:38,942 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:26:40,945 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:26:40,945 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:26:43,124 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:26:43,125 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:26:45,211 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:26:45,212 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:26:46,312 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:26:46,313 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:26:46,313 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:26:46,313 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:26:46,389 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:26:48,398 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:26:48,399 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:26:50,561 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:26:50,562 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:26:51,982 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:26:53,424 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:26:53,425 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:26:54,600 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:26:54,601 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:26:55,713 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:26:55,713 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:26:57,859 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:26:57,860 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:26:57,860 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:26:57,860 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:57,861 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:59,042 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:26:59,043 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:26:59,166 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:27:04,168 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:27:04,169 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:27:06,299 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:27:06,300 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:27:11,442 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:27:11,442 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:27:13,570 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:27:18,574 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:27:18,575 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_122718.mp4
2025-03-19 12:27:18,575 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:27:18,576 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:27:23,844 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:27:23,845 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:27:23,878 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:27:25,054 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4
2025-03-19 12:27:25,055 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:27:27,064 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:27:30,070 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:27:30,071 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:27:33,075 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:27:33,076 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:27:33,076 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:27:34,242 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:27:34,243 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:27:34,243 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:27:34,243 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:27:34,350 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:27:36,359 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:27:36,359 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:27:36,360 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:27:38,669 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:27:38,670 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:27:46,834 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:27:46,836 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:27:46,836 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:27:46,836 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,115 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:27:47,116 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,362 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:27:47,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,595 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:27:47,596 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,851 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:27:47,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,096 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:27:48,097 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,360 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:27:48,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,597 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:27:48,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,818 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:27:48,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:49,089 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:27:49,090 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:51,331 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:27:51,332 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:27:51,332 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:27:51,426 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9667dde u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t474}
    * Task{5d899ea #474 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122751_20250319_122751.png
2025-03-19 12:27:52,825 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122751_20250319_122751.png
2025-03-19 12:27:52,825 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122751_20250319_122751.png
2025-03-19 12:27:52,826 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:27:59,312 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:27:59,317 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:27:59,318 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:27:59,318 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:27:59,318 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:00,168 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:28:09,465 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:28:09,466 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:28:09,466 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:28:09,577 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9667dde u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t474}
    * Task{5d899ea #474 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:28:09,577 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:28:09,577 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:28:09,578 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:28:09,578 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122809_20250319_122809.png
2025-03-19 12:28:10,954 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122809_20250319_122809.png
2025-03-19 12:28:10,955 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122809_20250319_122809.png
2025-03-19 12:28:10,955 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:28:15,541 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:17,706 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:28:17,706 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:28:17,706 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:28:17,707 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:28:18,709 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:28:19,713 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:28:19,713 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:28:19,714 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 164.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:28:19,714 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:28:29,719 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4 (大小: 3.18MB)
2025-03-19 12:28:29,719 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:28:29,834 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.884578秒，无需修复
2025-03-19 12:28:29,835 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:28:29,835 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4
2025-03-19 12:28:29,835 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:28:37,387 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4
2025-03-19 12:28:37,394 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4
2025-03-19 12:28:37,395 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:28:37,395 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:28:42,634 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:28:43,014 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:28:44,020 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:28:44,020 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:28:44,021 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:45,112 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:28:45,112 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:28:45,113 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:28:47,206 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:28:47,207 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:28:48,385 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:28:48,386 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:28:48,386 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:49,526 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:28:49,527 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:28:49,528 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:28:49,528 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:26:31\n- 结束时间: 2025-03-19 12:28:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:28:49"}]}]}}
2025-03-19 12:28:49,996 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:28:49,997 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:48:56,387 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:48:56,388 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:48:56,388 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:48:56,388 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:48:56,503 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:48:56,645 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:48:56,646 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:48:56,646 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:48:56,646 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:48:58,328 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:48:58,328 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:48:59,544 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:48:59,705 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:48:59,706 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:48:59,706 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:48:59,706 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:49:01,128 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:49:01,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:49:02,413 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:49:02,414 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:49:02,415 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:49:02,415 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:49:02,415 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:49:03,502 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:49:03,503 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:49:03,627 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:49:05,633 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:49:05,634 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:49:06,726 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:49:06,726 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:49:06,727 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:49:06,727 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:49:06,806 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:49:08,815 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:49:08,816 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:49:11,011 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:49:11,012 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:49:13,101 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:49:13,101 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:49:14,206 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:49:14,207 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:49:14,207 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:49:14,207 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:49:14,283 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:49:16,300 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:49:16,300 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:49:18,528 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:49:18,529 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:49:19,944 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:49:21,416 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:49:21,417 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:49:22,552 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:49:22,552 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:49:23,660 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:49:23,660 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:49:25,813 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:49:26,975 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:49:26,976 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:49:27,102 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:49:32,111 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:49:32,112 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:49:34,251 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:49:34,252 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:49:39,386 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:49:39,387 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:49:41,542 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:49:46,546 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:49:46,547 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_124946.mp4
2025-03-19 12:49:46,547 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:49:46,548 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:49:51,841 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:49:51,843 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:49:51,896 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:49:53,053 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4
2025-03-19 12:49:53,054 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:49:55,069 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:49:58,079 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:49:58,081 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:50:01,085 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:50:01,086 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:50:01,086 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:50:02,290 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:50:02,291 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:50:02,292 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:50:02,292 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:50:02,393 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:50:04,408 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:50:04,409 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:50:04,409 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:50:06,724 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:50:06,725 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:50:14,918 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:50:14,918 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:50:14,918 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:50:14,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:15,254 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:50:15,255 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:15,524 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:50:15,525 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:15,751 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:50:15,751 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,004 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:50:16,005 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,230 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:50:16,231 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,481 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:50:16,481 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,694 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:50:16,695 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,953 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:50:16,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:17,189 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:50:17,190 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:19,449 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:50:19,450 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:50:19,450 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:50:19,590 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f98068d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t480}
    * Task{c619853 #480 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125019_20250319_125019.png
2025-03-19 12:50:21,414 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125019_20250319_125019.png
2025-03-19 12:50:21,414 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125019_20250319_125019.png
2025-03-19 12:50:21,415 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:50:28,304 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:50:29,317 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_81.jpg
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_81.jpg
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:50:39,446 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:50:39,447 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:50:39,447 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:50:39,572 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f98068d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t480}
    * Task{c619853 #480 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:50:39,572 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:50:39,572 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:50:39,573 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:50:39,573 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125039_20250319_125039.png
2025-03-19 12:50:41,397 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125039_20250319_125039.png
2025-03-19 12:50:41,397 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125039_20250319_125039.png
2025-03-19 12:50:41,397 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:50:47,284 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_82.jpg
2025-03-19 12:50:47,290 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_82.jpg
2025-03-19 12:50:47,290 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:50:47,290 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:50:47,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:50:47,291 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:50:49,406 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:50:49,407 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:50:49,408 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:50:49,408 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:50:50,418 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:50:51,421 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:50:51,421 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:50:51,421 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 173.0 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-19 12:50:51,422 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:51:01,430 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4 (大小: 4.04MB)
2025-03-19 12:51:01,431 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.505978秒，无需修复
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:51:08,833 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4
2025-03-19 12:51:08,838 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4
2025-03-19 12:51:08,838 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:51:08,838 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:51:14,106 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:51:14,476 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:51:15,484 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:51:15,484 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:51:15,484 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:51:16,592 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:51:16,593 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:51:16,594 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:51:18,716 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:51:18,717 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:51:19,883 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:51:19,883 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:51:19,883 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:51:21,022 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:51:21,023 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:51:21,023 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:51:21,023 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:48:59\n- 结束时间: 2025-03-19 12:51:21\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_81.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_82.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:51:21"}]}]}}
2025-03-19 12:51:21,430 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:51:21,434 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:56:21,713 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:56:21,714 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:56:21,715 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:56:21,715 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:56:21,842 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:56:21,995 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:56:21,996 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:56:21,996 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:56:21,996 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:56:22,238 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:56:22,239 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:56:22,239 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:56:22,239 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:56:23,718 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:23,719 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:24,970 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:56:24,970 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:56:24,970 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:56:24,971 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:56:24,971 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:56:25,113 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:56:25,114 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:56:25,114 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:56:25,114 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:56:26,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:26,511 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:28,884 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:56:28,885 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:56:29,002 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:56:31,009 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:56:31,009 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:56:32,105 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:56:32,106 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:56:32,106 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:56:32,106 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:56:32,186 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:56:34,201 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:56:34,201 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:56:36,377 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:56:36,378 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:56:38,469 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:56:38,469 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:56:39,578 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:56:39,579 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:56:39,579 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:56:39,579 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:56:39,655 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:56:41,669 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:56:41,670 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:56:43,827 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:56:43,828 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:56:45,238 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:56:46,715 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:56:46,716 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:56:47,870 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:56:47,871 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:56:48,978 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:56:48,979 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:56:51,115 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:56:51,115 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:56:51,115 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:56:51,116 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:51,116 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:52,268 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:56:52,269 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:56:52,382 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:56:57,391 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:56:57,392 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:56:59,543 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:56:59,544 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:57:04,682 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:57:04,683 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:57:06,845 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:57:11,856 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:57:11,856 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_125711.mp4
2025-03-19 12:57:11,856 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:57:11,857 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:57:17,149 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:57:17,150 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:57:17,197 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:57:18,357 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4
2025-03-19 12:57:18,358 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:57:20,375 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:57:23,383 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:57:23,384 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:57:26,393 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:57:26,394 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:57:26,394 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:57:27,582 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:57:27,583 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:57:27,583 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:57:27,584 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:57:27,683 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:57:29,699 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:57:29,700 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:57:29,700 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:57:31,967 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:57:31,968 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:57:40,165 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:57:40,166 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:57:40,166 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:57:40,167 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:40,459 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:57:40,460 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:40,731 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:57:40,732 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:40,992 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:57:40,993 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,249 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:57:41,250 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,514 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:57:41,515 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,764 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:57:41,765 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,999 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:57:42,000 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:42,305 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:57:42,306 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:42,551 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:57:42,551 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:44,813 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:57:44,814 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:57:44,815 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:57:44,963 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fa6b2b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t486}
    * Task{6f7a3f7 #486 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125744_20250319_125744.png
2025-03-19 12:57:46,713 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125744_20250319_125744.png
2025-03-19 12:57:46,714 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125744_20250319_125744.png
2025-03-19 12:57:46,714 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:57:53,615 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:57:54,432 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:04,631 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:58:04,631 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:58:04,632 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fa6b2b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t486}
    * Task{6f7a3f7 #486 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125804_20250319_125804.png
2025-03-19 12:58:06,000 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125804_20250319_125804.png
2025-03-19 12:58:06,000 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125804_20250319_125804.png
2025-03-19 12:58:06,000 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:58:11,387 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_85.jpg
2025-03-19 12:58:11,393 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_85.jpg
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:13,564 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:58:13,565 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:58:13,566 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:58:13,566 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:58:14,575 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:58:15,582 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:58:15,583 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:58:15,583 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 152.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:58:15,583 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:58:25,591 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4 (大小: 3.74MB)
2025-03-19 12:58:25,591 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.288244秒，无需修复
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:58:34,457 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4
2025-03-19 12:58:34,464 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4
2025-03-19 12:58:34,464 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:58:34,464 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:58:39,689 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:58:40,186 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:58:41,195 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:58:41,196 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:58:41,196 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:42,308 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:58:42,309 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:58:42,309 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:58:44,413 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:58:44,414 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:58:45,589 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:58:45,590 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:58:45,590 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:46,737 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:58:46,738 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:58:46,739 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:58:46,739 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:56:24\n- 结束时间: 2025-03-19 12:58:46\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_85.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:58:46"}]}]}}
2025-03-19 12:58:47,130 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:58:47,134 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:03:47,248 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:03:47,250 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:03:47,250 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:03:47,250 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:03:47,385 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:03:47,540 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:03:47,541 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:03:47,541 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:03:47,541 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:03:47,755 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:03:47,755 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:03:47,756 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:03:47,756 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:03:49,231 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:03:49,232 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:03:50,511 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:03:50,663 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:03:50,664 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:03:50,664 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:03:50,664 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:03:52,076 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:03:52,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:03:53,352 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:03:54,453 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:03:54,454 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:03:54,565 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:03:56,572 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:03:56,573 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:03:57,665 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:03:57,666 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:03:57,666 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:03:57,666 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:03:57,744 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:03:59,763 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:03:59,765 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:04:01,920 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:04:01,921 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:04:04,013 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:04:04,014 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:04:05,120 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:04:05,121 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:04:05,121 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:04:05,121 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:04:05,203 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:04:07,218 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:04:07,219 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:04:09,387 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:04:09,387 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:04:10,808 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:04:12,296 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:04:12,297 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:04:13,466 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:04:13,467 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:04:14,569 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:04:14,570 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:04:16,722 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:04:16,722 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:04:16,723 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:04:16,723 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:04:16,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:04:17,879 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:04:17,880 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:04:18,005 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:04:23,013 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:04:23,014 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:04:25,168 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:04:25,169 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:04:30,321 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:04:30,322 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:04:32,481 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:04:37,486 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:04:37,487 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_130437.mp4
2025-03-19 13:04:37,487 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:04:37,487 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:04:42,780 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:04:42,781 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:04:42,828 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:04:43,991 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4
2025-03-19 13:04:43,992 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:04:46,006 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:04:49,015 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:04:49,016 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:04:52,021 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:04:52,021 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:04:52,022 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:04:53,208 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:04:53,209 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:04:53,209 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:04:53,209 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:04:53,309 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:04:55,320 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:04:55,321 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:04:55,321 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:04:57,644 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:04:57,645 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:05:05,845 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:05:05,846 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:05:05,846 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:05:05,847 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,119 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:05:06,120 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,383 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:05:06,384 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,612 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:05:06,613 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,859 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:05:06,860 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,102 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:05:07,103 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,344 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:05:07,345 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,594 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:05:07,595 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,822 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:05:07,822 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:08,083 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:05:08,084 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:10,327 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:05:10,329 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:05:10,329 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:05:10,488 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bb9912c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t492}
    * Task{a501bfb #492 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:05:10,488 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:05:10,489 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:05:10,489 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:05:10,489 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_130510_20250319_130510.png
2025-03-19 13:05:11,984 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_130510_20250319_130510.png
2025-03-19 13:05:11,984 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_130510_20250319_130510.png
2025-03-19 13:05:11,985 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:05:19,217 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:05:19,390 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:19,396 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:19,397 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:05:19,397 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:05:19,397 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:05:29,562 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:05:29,563 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:05:29,563 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:05:29,690 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bb9912c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t492}
    * Task{a501bfb #492 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:05:29,690 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:05:29,691 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:05:29,691 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:05:29,691 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_130529_20250319_130529.png
2025-03-19 13:05:31,204 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_130529_20250319_130529.png
2025-03-19 13:05:31,205 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_130529_20250319_130529.png
2025-03-19 13:05:31,205 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:05:35,714 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:05:38,905 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:05:39,911 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:05:39,911 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:05:39,911 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 109.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:05:39,912 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:05:49,922 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4 (大小: 3.52MB)
2025-03-19 13:05:49,924 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.032389秒，无需修复
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:05:57,286 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4
2025-03-19 13:05:57,292 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4
2025-03-19 13:05:57,292 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:05:57,292 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:06:02,520 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:06:02,522 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4
2025-03-19 13:06:02,522 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:06:02,522 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:06:02,523 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:06:02,869 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:06:03,876 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:06:03,877 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:06:03,877 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:06:04,998 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:06:04,999 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:06:04,999 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:06:07,107 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:06:07,108 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:06:08,274 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:06:08,275 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:06:08,275 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:06:09,416 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:06:09,417 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:06:09,418 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:06:09,418 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:03:50\n- 结束时间: 2025-03-19 13:06:09\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:06:09"}]}]}}
2025-03-19 13:06:09,786 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:06:09,789 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:11:09,995 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:11:09,997 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:11:09,997 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:11:09,997 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:11:10,133 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:11:10,274 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:11:10,275 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:11:10,275 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:11:10,275 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:11:10,522 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:11:10,523 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:11:10,523 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:11:10,524 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:11:12,006 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:12,007 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:13,275 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:11:13,428 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:11:13,429 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:11:13,429 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:11:13,429 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:11:14,844 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:14,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:16,096 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:11:16,096 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:11:16,097 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:11:16,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:16,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:17,191 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:11:17,192 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:11:17,309 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:11:19,315 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:11:19,316 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:11:20,410 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:11:20,411 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:11:20,411 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:11:20,411 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:11:20,491 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:11:22,507 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:11:22,508 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:11:24,704 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:11:24,705 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:11:26,796 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:11:26,797 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:11:27,908 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:11:27,913 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:11:27,914 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:11:27,914 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:11:27,991 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:11:30,005 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:11:30,006 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:11:32,165 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:11:32,166 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:11:33,590 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:11:35,061 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:11:35,062 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:11:36,257 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:11:36,258 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:11:37,361 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:11:37,361 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:11:39,548 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:40,728 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:11:40,728 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:11:40,857 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:11:45,864 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:11:45,865 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:11:48,017 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:11:48,018 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:11:53,177 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:11:53,179 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:11:55,332 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:12:00,337 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:12:00,338 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_131200.mp4
2025-03-19 13:12:00,338 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:12:00,338 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:12:05,630 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:12:05,632 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:12:05,677 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:12:06,837 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4
2025-03-19 13:12:06,838 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:12:08,847 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:12:11,857 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:12:11,857 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:12:14,864 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:12:14,865 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:12:14,865 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:12:16,072 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:12:16,073 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:12:16,073 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:12:16,073 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:12:16,172 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:12:18,188 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:12:18,189 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:12:18,189 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:12:20,478 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:12:20,479 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:12:28,667 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:12:28,668 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:12:28,668 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:12:28,668 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:28,895 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:12:28,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,182 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:12:29,183 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,448 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:12:29,449 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,676 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:12:29,676 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,918 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:12:29,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,146 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:12:30,147 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,381 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:12:30,382 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,618 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:12:30,618 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,847 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:12:30,848 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:33,102 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:12:33,102 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:12:33,102 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:12:33,258 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{55b4044 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t498}
    * Task{dfa5a62 #498 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131233_20250319_131233.png
2025-03-19 13:12:34,621 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131233_20250319_131233.png
2025-03-19 13:12:34,621 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131233_20250319_131233.png
2025-03-19 13:12:34,621 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:12:41,541 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_89.jpg
2025-03-19 13:12:41,547 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_89.jpg
2025-03-19 13:12:41,547 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:12:41,548 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:12:41,548 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:12:42,072 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:12:51,669 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:12:51,670 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:12:51,670 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:12:51,819 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{55b4044 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t498}
    * Task{dfa5a62 #498 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_131251_20250319_131251.png
2025-03-19 13:12:53,175 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_131251_20250319_131251.png
2025-03-19 13:12:53,175 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_131251_20250319_131251.png
2025-03-19 13:12:53,175 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:12:58,997 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_90.jpg
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_90.jpg
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:13:01,186 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:13:01,187 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:13:01,188 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:13:01,188 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:13:02,195 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:13:03,202 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:13:03,203 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:13:03,203 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 122.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:13:03,203 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:13:13,211 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4 (大小: 3.22MB)
2025-03-19 13:13:13,212 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.518422秒，无需修复
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:13:20,581 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4
2025-03-19 13:13:20,588 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4
2025-03-19 13:13:20,588 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:13:20,588 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:13:25,869 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:13:26,227 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:13:27,236 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:13:27,237 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:13:27,237 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:13:28,344 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:13:28,345 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:13:28,345 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:13:30,454 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:13:30,454 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:13:31,638 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:13:31,639 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:13:31,639 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:13:32,786 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:13:32,787 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:13:32,787 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:13:32,788 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:11:13\n- 结束时间: 2025-03-19 13:13:32\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_89.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_90.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:13:32"}]}]}}
2025-03-19 13:13:33,244 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:13:33,246 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:18:33,471 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:18:33,473 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:18:33,473 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:18:33,474 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:18:33,599 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:18:33,761 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:18:33,762 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:18:33,762 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:18:33,762 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:18:33,989 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:18:33,990 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:18:33,990 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:18:33,990 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:18:35,468 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:18:35,469 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:18:36,722 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:18:36,865 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:18:36,865 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:18:36,866 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:18:36,866 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:18:38,273 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:18:38,274 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:18:40,622 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:18:40,623 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:18:40,754 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:18:42,758 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:18:42,758 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:18:43,851 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:18:43,852 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:18:43,852 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:18:43,853 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:18:43,929 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:18:45,948 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:18:45,949 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:18:48,127 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:18:48,128 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:18:50,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:18:50,220 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:18:51,319 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:18:51,320 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:18:51,320 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:18:51,320 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:18:51,384 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:18:53,397 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:18:53,398 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:18:55,567 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:18:55,568 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:18:56,993 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:18:58,472 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:18:58,473 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:18:59,627 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:18:59,628 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:19:00,741 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:19:00,741 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:19:02,951 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:19:04,135 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:19:04,136 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:19:04,251 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:19:09,254 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:19:09,254 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:19:11,424 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:19:11,425 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:19:16,583 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:19:16,584 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:19:18,756 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:19:23,765 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:19:23,766 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_131923.mp4
2025-03-19 13:19:23,766 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:19:23,766 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:19:29,055 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:19:29,056 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:19:29,102 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:19:30,316 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4
2025-03-19 13:19:30,317 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:19:32,333 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:19:35,344 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:19:35,345 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:19:38,349 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:19:38,350 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:19:38,350 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:19:39,546 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:19:39,547 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:19:39,547 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:19:39,547 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:19:39,650 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:19:41,665 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:19:41,665 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:19:41,666 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:19:43,967 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:19:43,968 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:19:52,171 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:19:52,172 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:19:52,172 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:19:52,172 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:52,482 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:19:52,482 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:52,774 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:19:52,775 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,006 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:19:53,007 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,224 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:19:53,225 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,454 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:19:53,455 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,697 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:19:53,698 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,928 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:19:53,929 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:54,194 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:19:54,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:54,423 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:19:54,424 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:56,675 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:19:56,676 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:19:56,676 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:19:56,790 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ed9ed98 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t504}
    * Task{4ccc457 #504 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131956_20250319_131956.png
2025-03-19 13:19:57,910 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131956_20250319_131956.png
2025-03-19 13:19:57,910 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131956_20250319_131956.png
2025-03-19 13:19:57,910 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:20:04,102 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_92.jpg
2025-03-19 13:20:04,108 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_92.jpg
2025-03-19 13:20:04,109 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:20:04,109 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:04,109 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:05,573 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:20:14,299 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:20:14,299 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:20:14,300 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:20:14,411 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ed9ed98 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t504}
    * Task{4ccc457 #504 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_132014_20250319_132014.png
2025-03-19 13:20:15,465 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_132014_20250319_132014.png
2025-03-19 13:20:15,466 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_132014_20250319_132014.png
2025-03-19 13:20:15,466 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:20:21,212 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_93.jpg
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_93.jpg
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:23,369 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:20:23,370 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:20:23,370 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:20:23,370 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:20:24,371 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:20:25,381 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:20:25,381 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:20:25,382 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 120.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:20:25,382 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:20:35,390 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4 (大小: 2.77MB)
2025-03-19 13:20:35,392 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.215833秒，无需修复
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:20:42,902 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4
2025-03-19 13:20:42,907 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4
2025-03-19 13:20:42,908 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:20:42,909 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:20:48,153 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:20:48,155 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4
2025-03-19 13:20:48,155 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:20:48,155 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:20:48,157 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:20:48,535 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:20:49,540 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:20:49,541 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:49,541 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:50,643 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:20:50,643 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:20:50,643 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:20:52,737 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:20:52,738 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:20:53,890 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:20:53,891 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:53,891 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:55,022 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:20:55,024 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:20:55,024 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:20:55,024 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:18:36\n- 结束时间: 2025-03-19 13:20:55\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_92.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_93.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:20:55"}]}]}}
2025-03-19 13:20:55,406 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:20:55,409 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:30:22,898 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:30:22,900 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:30:22,905 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:30:22,907 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:30:23,058 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:30:23,442 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:30:23,442 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:30:23,442 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:30:23,444 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:30:25,157 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:25,158 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:26,405 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:30:26,567 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:30:26,568 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:30:26,568 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:30:26,568 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:30:27,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:27,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:29,228 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:30,449 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:30:30,449 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:30:30,564 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:30:32,566 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:30:32,567 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:30:33,649 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:30:33,650 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:30:33,650 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:30:33,650 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:30:33,710 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:30:35,720 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:30:35,721 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:30:37,897 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:30:37,897 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:30:39,976 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:30:39,977 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:30:41,080 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:30:41,081 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:30:41,081 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:30:41,081 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:30:41,162 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:30:43,171 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:30:43,172 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:30:45,369 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:30:45,370 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:30:46,781 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:30:48,269 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:30:48,269 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:30:49,390 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:30:49,391 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:30:50,490 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:30:50,491 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:30:52,666 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:53,844 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:30:53,845 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:30:53,963 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:30:58,967 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:30:58,968 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:31:01,111 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:31:01,112 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:31:06,249 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:31:06,251 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:31:08,430 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:31:13,434 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:31:13,435 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_133113.mp4
2025-03-19 13:31:13,435 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:31:13,436 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:31:18,715 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:31:18,716 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:31:18,762 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:31:19,949 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4
2025-03-19 13:31:19,949 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:31:21,956 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:31:24,959 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:31:24,959 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:31:27,964 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:31:27,965 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:31:27,965 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:31:29,166 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:31:29,167 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:31:29,167 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:31:29,167 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:31:29,277 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:31:31,287 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:31:31,288 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:31:31,288 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:31:33,586 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:31:33,586 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:31:41,735 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:31:41,736 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:31:41,736 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:31:41,736 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,004 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:31:42,005 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,230 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:31:42,231 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,488 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:31:42,489 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,710 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:31:42,711 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,940 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:31:42,941 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,161 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:31:43,162 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,407 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:31:43,408 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,633 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:31:43,634 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,875 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:31:43,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:46,124 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:31:46,125 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:31:46,126 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ac4feb5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t510}
    * Task{86b70bb #510 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133146_20250319_133146.png
2025-03-19 13:31:48,041 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133146_20250319_133146.png
2025-03-19 13:31:48,042 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133146_20250319_133146.png
2025-03-19 13:31:48,042 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:31:55,057 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:31:55,895 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:31:55,903 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:31:55,904 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:31:55,904 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:31:55,904 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:06,048 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:32:06,050 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:32:06,050 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:32:06,187 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ac4feb5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t510}
    * Task{86b70bb #510 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:32:06,187 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:32:06,188 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:32:06,188 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:32:06,188 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133206_20250319_133206.png
2025-03-19 13:32:07,908 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133206_20250319_133206.png
2025-03-19 13:32:07,908 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133206_20250319_133206.png
2025-03-19 13:32:07,908 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:32:14,592 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:32:14,599 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:16,736 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:32:16,737 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:32:16,737 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:32:16,738 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:32:17,740 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:32:18,746 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:32:18,747 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:32:18,747 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 130.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:32:18,747 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:32:28,752 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4 (大小: 3.92MB)
2025-03-19 13:32:28,754 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:32:28,900 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.903556秒，无需修复
2025-03-19 13:32:28,901 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:32:28,901 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4
2025-03-19 13:32:28,901 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:32:41,564 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4
2025-03-19 13:32:41,566 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4
2025-03-19 13:32:41,566 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:32:41,566 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:32:46,741 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:32:47,158 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:32:48,163 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:32:48,163 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:32:48,163 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:49,253 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:32:49,254 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:32:49,254 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:32:51,369 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:32:51,370 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:32:52,524 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:32:52,525 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:32:52,525 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:53,643 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:32:53,644 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:32:53,645 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:32:53,646 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:30:26\n- 结束时间: 2025-03-19 13:32:53\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:32:53"}]}]}}
2025-03-19 13:32:54,327 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:32:54,330 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:37:54,351 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:37:54,353 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:37:54,354 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:37:54,354 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:37:54,488 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:37:54,621 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:37:54,622 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:37:54,622 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:37:54,622 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:37:54,870 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:37:54,871 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:37:54,871 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:37:54,871 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:37:56,385 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:37:56,386 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:37:57,613 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:37:57,613 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:37:57,614 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:37:57,614 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:37:57,614 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:37:59,149 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:37:59,150 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:38:01,506 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:38:01,507 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:38:01,634 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:38:03,639 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:38:03,639 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:38:04,700 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:38:04,701 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:38:04,702 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:38:04,702 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:38:04,780 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:38:06,791 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:38:06,791 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:38:08,938 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:38:08,939 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:38:11,021 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:38:11,022 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:38:12,119 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:38:12,119 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:38:12,120 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:38:12,120 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:38:12,181 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:38:14,189 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:38:14,189 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:38:16,373 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:38:16,376 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:38:17,802 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:38:19,281 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:38:19,281 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:38:20,455 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:38:20,456 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:38:21,568 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:38:21,568 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:38:23,746 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:38:23,747 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:38:23,748 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:38:23,748 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:38:23,749 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:38:24,912 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:38:24,912 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:38:25,024 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:38:30,029 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:38:30,029 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:38:32,165 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:38:32,166 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:38:37,313 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:38:37,314 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:38:39,479 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:38:44,485 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:38:44,485 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_133844.mp4
2025-03-19 13:38:44,486 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:38:44,486 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:38:49,752 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:38:49,753 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:38:49,799 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:38:50,930 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4
2025-03-19 13:38:50,932 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:38:52,942 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:38:55,948 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:38:55,948 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:38:58,951 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:38:58,952 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:38:58,952 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:39:00,221 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:39:02,230 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:39:02,231 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:39:02,231 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:39:04,514 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:39:04,517 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:39:12,749 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:39:12,751 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:39:12,751 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:39:12,751 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,049 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:39:13,050 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,267 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:39:13,268 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,504 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:39:13,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,736 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:39:13,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,954 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:39:13,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,208 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:39:14,209 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,438 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:39:14,439 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,672 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:39:14,673 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,921 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:39:14,922 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:17,180 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:39:17,181 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:39:17,182 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c0e905a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t516}
    * Task{59f6f68 #516 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:39:17,310 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133917_20250319_133917.png
2025-03-19 13:39:18,760 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133917_20250319_133917.png
2025-03-19 13:39:18,761 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133917_20250319_133917.png
2025-03-19 13:39:18,761 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:39:25,658 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:25,663 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:25,664 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:39:25,664 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:39:25,664 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:39:26,064 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:39:35,856 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:39:35,857 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:39:35,857 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:39:35,972 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c0e905a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t516}
    * Task{59f6f68 #516 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133935_20250319_133935.png
2025-03-19 13:39:37,443 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133935_20250319_133935.png
2025-03-19 13:39:37,443 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133935_20250319_133935.png
2025-03-19 13:39:37,443 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:39:42,006 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:42,010 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:39:44,146 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:39:44,147 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:39:44,147 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:39:44,148 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:39:45,150 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:39:46,154 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:39:46,156 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:39:46,157 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 138.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:39:46,157 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:39:56,159 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4 (大小: 3.26MB)
2025-03-19 13:39:56,160 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.300389秒，无需修复
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:40:03,594 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4
2025-03-19 13:40:03,595 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4
2025-03-19 13:40:03,596 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:40:03,596 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:40:08,834 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:40:09,174 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:40:10,179 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:40:10,180 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:40:10,180 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:40:11,274 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:40:11,274 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:40:11,275 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:40:13,372 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:40:13,372 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:40:14,548 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:40:14,548 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:40:14,548 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:40:15,681 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:40:15,682 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:40:15,683 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:40:15,683 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:37:57\n- 结束时间: 2025-03-19 13:40:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:40:15"}]}]}}
2025-03-19 13:40:16,155 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:40:16,157 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:45:16,207 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:45:16,208 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:45:16,209 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:45:16,209 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:45:16,331 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:45:16,497 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:45:16,499 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:45:16,499 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:45:16,499 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:45:16,741 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:45:16,741 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:45:16,742 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:45:16,742 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:45:18,218 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:18,219 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:45:19,664 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:45:19,664 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:45:19,665 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:45:19,665 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:45:21,087 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:21,088 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:23,453 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:45:23,453 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:45:23,568 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:45:25,573 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:45:25,573 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:45:26,648 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:45:26,649 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:45:26,649 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:45:26,649 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:45:26,716 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:45:28,722 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:45:28,722 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:45:30,904 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:45:30,904 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:45:32,987 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:45:32,987 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:45:34,094 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:45:34,095 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:45:34,095 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:45:34,095 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:45:34,168 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:45:36,171 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:45:36,171 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:45:38,342 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:45:38,343 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:45:39,758 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:45:41,246 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:45:41,247 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:45:42,378 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:45:42,379 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:45:43,491 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:45:43,492 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:45:45,679 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:46,848 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:45:46,849 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:45:46,972 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:45:51,975 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:45:51,975 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:45:54,115 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:45:54,115 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:45:59,225 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:45:59,225 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:46:01,375 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_134606.mp4
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:46:11,629 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:46:11,629 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:46:11,655 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:46:12,844 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4
2025-03-19 13:46:12,845 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:46:14,853 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:46:17,857 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:46:17,858 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:46:20,861 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:46:20,861 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:46:20,862 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:46:22,028 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:46:22,029 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:46:22,029 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:46:22,029 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:46:22,131 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:46:24,139 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:46:24,140 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:46:24,140 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:46:26,381 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:46:26,382 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:46:34,502 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:46:34,503 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:46:34,503 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:46:34,503 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:34,774 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:46:34,775 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,007 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:46:35,008 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,254 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:46:35,255 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,502 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:46:35,503 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,752 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:46:35,754 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,973 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:46:35,973 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:36,223 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:46:36,224 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:36,490 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:46:36,491 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:36,741 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:46:36,742 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:38,978 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:46:38,979 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:46:38,979 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:46:39,101 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2fa2e7f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t522}
    * Task{f0d339b #522 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_134639_20250319_134639.png
2025-03-19 13:46:41,188 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_134639_20250319_134639.png
2025-03-19 13:46:41,190 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_134639_20250319_134639.png
2025-03-19 13:46:41,190 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:46:47,948 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:46:48,775 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:46:48,781 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:46:48,782 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:46:48,782 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:46:48,782 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:46:58,899 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:46:58,900 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:46:58,900 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:46:59,029 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2fa2e7f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t522}
    * Task{f0d339b #522 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_134659_20250319_134659.png
2025-03-19 13:47:01,091 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_134659_20250319_134659.png
2025-03-19 13:47:01,096 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_134659_20250319_134659.png
2025-03-19 13:47:01,096 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:47:07,062 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:47:07,065 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:47:07,065 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:47:07,066 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:47:07,066 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:47:07,066 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:47:09,179 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:47:09,180 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:47:09,180 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:47:09,180 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:47:10,184 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:47:11,186 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:47:11,187 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:47:11,187 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:47:11,187 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:47:21,190 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4 (大小: 3.70MB)
2025-03-19 13:47:21,192 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.450222秒，无需修复
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:47:28,635 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4
2025-03-19 13:47:28,642 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4
2025-03-19 13:47:28,642 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:47:28,642 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:47:33,902 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:47:34,282 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:47:35,287 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:47:35,288 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:47:35,288 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:47:36,396 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:47:36,397 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:47:36,397 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:47:38,510 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:47:38,511 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:47:39,687 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:47:39,689 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:47:39,689 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:47:40,816 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:47:40,817 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:47:40,817 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:47:40,818 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:45:19\n- 结束时间: 2025-03-19 13:47:40\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:47:40"}]}]}}
2025-03-19 13:47:41,411 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:47:41,414 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:52:41,447 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:52:41,450 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:52:41,451 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:52:41,451 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:52:41,596 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:52:43,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:52:43,430 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:52:44,717 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:52:44,867 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:52:44,868 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:52:44,868 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:52:44,868 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:52:46,280 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:52:46,281 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:52:48,669 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:52:48,669 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:52:48,794 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:52:50,799 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:52:50,799 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:52:51,876 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:52:51,877 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:52:51,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:52:51,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:52:51,957 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:52:53,968 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:52:53,969 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:52:56,163 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:52:56,164 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:52:58,263 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:52:58,264 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:52:59,367 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:52:59,368 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:52:59,368 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:52:59,369 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:52:59,449 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:53:01,458 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:53:01,459 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:53:03,679 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:53:03,680 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:53:05,066 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:53:06,516 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:53:06,517 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:53:07,712 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:53:07,712 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:53:08,821 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:53:08,822 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:53:11,016 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:53:11,017 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:53:11,017 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:53:11,018 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:53:11,018 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:53:12,215 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:53:12,217 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:53:12,347 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:53:17,353 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:53:17,354 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:53:19,518 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:53:19,519 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:53:24,669 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:53:24,669 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:53:26,821 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:53:31,827 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:53:31,827 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_135331.mp4
2025-03-19 13:53:31,828 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:53:31,828 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:53:37,100 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:53:37,103 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:53:37,146 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:53:38,329 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4
2025-03-19 13:53:38,329 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:53:40,340 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:53:43,343 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:53:43,345 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:53:46,346 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:53:46,346 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:53:46,347 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:53:47,532 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:53:47,533 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:53:47,533 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:53:47,533 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:53:47,612 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:53:49,621 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:53:49,622 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:53:49,622 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:53:51,880 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:53:51,880 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:54:00,066 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:54:00,066 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:54:00,066 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:54:00,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:00,309 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:54:00,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:00,545 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:54:00,546 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:00,790 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:54:00,791 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,038 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:54:01,038 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,278 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:54:01,279 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,504 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:54:01,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,740 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:54:01,741 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,967 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:54:01,968 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:02,215 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:54:02,216 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:04,447 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:54:04,448 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:54:04,448 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:54:04,605 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{de1f706 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t528}
    * Task{71e371d #528 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_135404_20250319_135404.png
2025-03-19 13:54:06,451 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_135404_20250319_135404.png
2025-03-19 13:54:06,452 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_135404_20250319_135404.png
2025-03-19 13:54:06,452 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:54:13,431 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:54:13,555 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_101.jpg
2025-03-19 13:54:13,564 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_101.jpg
2025-03-19 13:54:13,565 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:54:13,565 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:54:13,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:54:23,693 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:54:23,696 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:54:23,696 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:54:23,802 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{de1f706 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t528}
    * Task{71e371d #528 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_135423_20250319_135423.png
2025-03-19 13:54:25,708 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_135423_20250319_135423.png
2025-03-19 13:54:25,708 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_135423_20250319_135423.png
2025-03-19 13:54:25,708 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:54:32,048 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_102.jpg
2025-03-19 13:54:32,053 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_102.jpg
2025-03-19 13:54:32,053 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:54:32,053 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:54:32,054 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:54:32,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:54:34,193 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:54:34,194 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:54:34,194 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:54:34,194 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:54:35,198 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:54:36,199 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:54:36,200 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:54:36,200 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 137.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:54:36,200 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:54:46,203 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4 (大小: 4.26MB)
2025-03-19 13:54:46,203 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.115589秒，无需修复
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:54:53,715 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4
2025-03-19 13:54:53,720 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4
2025-03-19 13:54:53,720 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:54:53,720 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:54:59,043 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:54:59,044 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4
2025-03-19 13:54:59,044 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:54:59,045 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:54:59,045 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:54:59,425 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:55:00,426 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:55:00,426 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:55:00,427 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:55:01,537 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:55:01,538 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:55:01,538 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:55:03,629 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:55:03,630 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:55:04,778 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:55:04,779 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:55:04,779 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:55:05,921 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:55:05,922 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:55:05,922 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:55:05,923 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:52:44\n- 结束时间: 2025-03-19 13:55:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_101.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_102.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:55:05"}]}]}}
2025-03-19 13:55:06,435 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:55:06,437 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:00:06,488 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:00:06,491 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:00:06,491 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:00:06,491 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:00:06,635 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:00:06,769 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:00:06,769 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:00:06,770 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:00:06,770 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:00:07,013 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:00:07,014 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:00:07,014 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:00:07,015 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:00:08,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:08,505 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:09,763 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:00:09,932 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:00:09,933 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:00:09,933 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:00:09,933 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:00:11,347 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:11,348 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:12,624 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:00:12,624 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:00:12,624 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:00:12,625 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:12,625 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:13,712 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:00:13,713 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:00:13,832 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:00:15,838 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:00:15,838 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:00:16,925 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:00:16,926 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:00:16,927 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:00:16,927 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:00:17,007 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:00:19,015 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:00:19,015 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:00:21,215 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:00:21,216 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:00:23,303 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:00:23,304 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:00:24,408 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:00:24,409 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:00:24,409 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:00:24,409 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:00:24,487 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:00:26,497 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:00:26,497 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:00:28,725 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:00:28,726 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:00:30,149 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:00:31,591 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:00:31,591 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:00:32,789 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:00:32,791 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:00:33,904 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:00:33,905 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:00:36,092 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:00:36,092 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:00:36,092 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:00:36,093 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:36,093 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:37,226 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:00:37,227 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:00:37,356 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:00:42,360 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:00:42,361 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:00:44,538 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:00:44,539 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:00:49,730 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:00:49,732 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:00:51,899 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:00:56,904 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:00:56,905 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_140056.mp4
2025-03-19 14:00:56,906 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:00:56,906 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:01:02,157 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:01:02,158 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:01:02,206 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:01:03,397 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4
2025-03-19 14:01:03,398 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:01:05,408 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:01:08,413 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:01:08,414 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:01:11,420 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:01:11,421 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:01:11,421 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:01:12,606 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:01:12,607 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:01:12,607 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:01:12,608 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:01:12,718 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:01:14,727 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:01:14,727 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:01:14,727 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:01:17,015 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:01:17,016 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:01:25,193 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:01:25,193 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:01:25,194 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:01:25,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:25,468 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:01:25,468 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:25,758 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:01:25,759 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,005 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:01:26,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,254 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:01:26,254 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,495 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:01:26,496 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,749 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:01:26,750 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:27,004 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:01:27,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:27,279 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:01:27,279 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:27,503 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:01:27,504 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:29,745 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:01:29,746 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:01:29,746 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:01:29,858 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4185d03 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t534}
    * Task{b031efe #534 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:01:29,858 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:01:29,858 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:01:29,859 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:01:29,859 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140129_20250319_140129.png
2025-03-19 14:01:31,442 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140129_20250319_140129.png
2025-03-19 14:01:31,442 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140129_20250319_140129.png
2025-03-19 14:01:31,443 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:01:38,514 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:01:38,642 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:38,646 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:38,647 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:01:38,647 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:01:38,647 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:01:48,766 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:01:48,767 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:01:48,767 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:01:48,893 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4185d03 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t534}
    * Task{b031efe #534 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140148_20250319_140148.png
2025-03-19 14:01:50,581 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140148_20250319_140148.png
2025-03-19 14:01:50,582 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140148_20250319_140148.png
2025-03-19 14:01:50,582 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:01:55,269 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:55,275 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:01:57,394 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:01:57,395 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:01:57,395 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:01:57,395 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:01:58,398 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:02:09,406 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4 (大小: 3.74MB)
2025-03-19 14:02:09,407 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.185700秒，无需修复
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:02:16,317 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4
2025-03-19 14:02:16,322 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4
2025-03-19 14:02:16,322 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:02:16,322 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:02:21,582 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:02:21,583 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4
2025-03-19 14:02:21,584 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:02:21,584 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:02:21,584 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:02:21,901 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:02:22,904 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:02:22,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:02:22,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:02:24,024 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:02:24,025 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:02:24,025 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:02:26,144 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:02:26,145 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:02:27,297 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:02:27,298 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:02:27,298 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:02:28,419 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:02:28,420 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:02:28,421 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:02:28,421 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:00:09\n- 结束时间: 2025-03-19 14:02:28\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:02:28"}]}]}}
2025-03-19 14:02:28,871 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:02:28,874 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:07:28,896 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:07:28,899 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:07:28,899 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:07:28,899 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:07:29,034 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:07:29,194 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:07:29,195 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:07:29,195 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:07:29,195 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:07:29,410 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:07:29,410 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:07:29,410 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:07:29,411 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:07:30,908 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:30,908 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:32,180 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:07:32,180 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:07:32,181 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:07:32,181 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:07:32,181 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:07:32,333 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:07:32,334 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:07:32,334 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:07:32,334 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:07:33,744 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:33,745 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:35,005 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:36,110 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:07:36,126 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:07:36,240 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:07:38,245 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:07:38,245 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:07:39,339 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:07:39,340 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:07:39,340 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:07:39,340 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:07:39,432 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:07:41,441 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:07:41,442 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:07:43,633 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:07:43,634 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:07:45,734 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:07:45,735 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:07:46,843 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:07:46,844 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:07:46,844 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:07:46,844 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:07:46,920 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:07:48,929 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:07:48,929 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:07:51,114 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:07:51,115 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:07:52,535 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:07:54,007 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:07:54,008 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:07:55,183 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:07:55,184 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:07:56,299 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:07:56,300 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:07:58,490 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:07:58,491 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:07:58,492 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:07:58,492 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:58,492 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:59,666 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:07:59,667 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:07:59,800 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:08:04,806 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:08:04,807 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:08:06,960 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:08:06,961 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:08:12,166 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:08:12,168 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:08:14,318 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:08:19,322 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:08:19,323 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_140819.mp4
2025-03-19 14:08:19,323 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:08:19,323 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:08:24,547 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:08:24,547 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:08:24,583 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:08:25,771 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4
2025-03-19 14:08:25,771 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:08:27,783 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:08:30,789 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:08:30,789 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:08:33,792 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:08:33,792 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:08:33,792 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:08:34,945 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:08:34,946 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:08:34,946 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:08:34,946 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:08:35,042 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:08:37,049 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:08:37,049 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:08:37,049 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:08:39,312 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:08:39,313 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:08:47,499 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:08:47,503 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:08:47,503 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:08:47,503 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:47,843 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:08:47,844 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,084 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:08:48,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,317 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:08:48,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,554 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:08:48,555 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,857 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:08:48,858 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,116 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:08:49,116 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,368 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:08:49,369 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,629 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:08:49,629 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,859 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:08:49,859 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:52,113 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:08:52,114 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:08:52,114 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:08:52,417 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{13ef717 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t540}
    * Task{c38bf22 #540 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140852_20250319_140852.png
2025-03-19 14:08:54,205 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140852_20250319_140852.png
2025-03-19 14:08:54,213 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140852_20250319_140852.png
2025-03-19 14:08:54,213 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:09:00,930 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:09:01,241 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:11,421 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:09:11,422 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:09:11,422 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:09:11,564 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{13ef717 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t540}
    * Task{c38bf22 #540 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:09:11,564 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:09:11,565 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:09:11,565 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:09:11,565 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140911_20250319_140911.png
2025-03-19 14:09:12,995 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140911_20250319_140911.png
2025-03-19 14:09:12,995 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140911_20250319_140911.png
2025-03-19 14:09:12,995 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:09:17,570 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:19,706 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:09:19,708 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:09:19,708 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:09:19,708 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:09:20,712 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:09:21,715 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:09:21,715 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:09:21,716 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:09:21,716 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:09:31,720 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4 (大小: 3.04MB)
2025-03-19 14:09:31,721 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.079967秒，无需修复
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:09:39,271 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4
2025-03-19 14:09:39,277 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4
2025-03-19 14:09:39,277 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:09:39,277 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:09:44,536 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:09:44,537 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4
2025-03-19 14:09:44,538 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:09:44,538 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:09:44,538 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:09:44,910 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:09:45,914 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:09:45,914 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:45,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:47,026 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:09:47,027 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:09:47,027 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:09:49,124 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:09:49,125 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:09:50,281 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:09:50,282 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:50,282 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:51,425 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:09:51,426 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:09:51,426 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:09:51,427 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:07:32\n- 结束时间: 2025-03-19 14:09:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:09:51"}]}]}}
2025-03-19 14:09:51,883 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:09:51,885 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:14:51,943 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:14:51,946 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:14:51,947 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:14:51,947 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:14:52,078 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:14:52,457 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:14:52,459 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:14:52,459 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:14:52,460 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:14:53,949 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:14:53,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:14:55,228 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:14:55,228 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:14:55,229 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:14:55,229 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:14:55,229 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:14:55,390 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:14:55,391 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:14:55,391 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:14:55,391 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:14:56,805 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:14:56,806 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:14:58,052 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:14:59,145 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:14:59,145 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:14:59,263 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:15:01,268 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:15:01,269 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:15:02,368 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:15:02,369 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:15:02,369 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:15:02,369 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:15:02,432 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:15:04,442 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:15:04,443 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:15:06,637 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:15:06,638 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:15:08,724 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:15:08,725 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:15:09,829 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:15:09,830 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:15:09,830 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:15:09,830 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:15:09,903 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:15:11,913 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:15:11,914 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:15:14,098 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:15:14,099 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:15:15,514 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:15:16,986 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:15:16,986 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:15:18,100 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:15:18,104 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:15:19,209 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:15:19,210 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:15:21,355 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:15:22,512 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:15:22,513 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:15:22,625 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:15:27,628 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:15:27,629 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:15:29,789 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:15:29,790 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:15:34,938 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:15:34,938 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:15:37,092 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:15:42,097 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:15:42,098 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_141542.mp4
2025-03-19 14:15:42,098 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:15:42,098 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:15:47,361 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:15:47,362 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:15:47,407 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:15:48,598 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4
2025-03-19 14:15:48,598 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:15:50,610 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:15:53,612 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:15:53,613 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:15:56,614 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:15:56,615 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:15:56,615 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:15:57,803 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:15:57,804 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:15:57,804 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:15:57,804 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:15:57,887 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:15:59,895 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:15:59,896 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:15:59,896 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:16:02,197 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:16:02,198 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:16:10,394 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:16:10,395 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:16:10,395 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:16:10,395 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:10,710 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:16:10,711 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:10,953 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:16:10,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,194 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:16:11,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,427 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:16:11,428 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,657 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:16:11,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,901 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:16:11,902 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:12,129 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:16:12,130 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:12,401 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:16:12,402 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:12,637 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:16:12,638 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:14,886 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:16:14,887 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:16:14,887 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:16:15,033 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1bc8599 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t546}
    * Task{f5eec3f #546 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:16:15,033 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:16:15,034 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:16:15,034 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:16:15,034 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_141615_20250319_141615.png
2025-03-19 14:16:16,603 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_141615_20250319_141615.png
2025-03-19 14:16:16,603 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_141615_20250319_141615.png
2025-03-19 14:16:16,604 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:16:23,712 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:16:23,966 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_108.jpg
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_108.jpg
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:16:34,102 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:16:34,104 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:16:34,104 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1bc8599 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t546}
    * Task{f5eec3f #546 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_141634_20250319_141634.png
2025-03-19 14:16:35,643 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_141634_20250319_141634.png
2025-03-19 14:16:35,643 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_141634_20250319_141634.png
2025-03-19 14:16:35,643 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:16:41,766 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_109.jpg
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_109.jpg
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:16:43,895 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:16:43,895 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:16:43,896 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:16:43,896 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:16:44,899 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:16:45,901 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:16:45,902 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:16:45,902 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:16:45,902 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:16:55,906 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4 (大小: 3.62MB)
2025-03-19 14:16:55,906 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.424422秒，无需修复
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:17:03,183 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4
2025-03-19 14:17:03,189 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4
2025-03-19 14:17:03,189 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:17:03,189 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:17:08,465 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:17:08,467 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4
2025-03-19 14:17:08,467 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:17:08,467 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:17:08,468 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:17:08,900 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:17:09,906 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:17:09,906 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:17:09,906 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:17:11,010 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:17:11,011 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:17:11,011 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:17:13,111 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:17:13,111 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:17:14,299 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:17:14,299 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:17:14,300 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:17:15,437 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:17:15,437 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:17:15,438 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:17:15,438 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:14:55\n- 结束时间: 2025-03-19 14:17:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_108.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_109.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:17:15"}]}]}}
2025-03-19 14:17:15,857 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:17:15,859 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:22:16,323 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:22:16,325 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:22:16,325 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:22:16,325 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:22:16,463 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:22:16,838 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:22:16,839 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:22:16,839 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:22:16,839 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:22:18,334 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:18,336 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:19,608 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:22:19,783 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:22:19,784 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:22:19,784 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:22:19,784 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:22:21,193 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:21,194 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:22,454 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:23,555 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:22:23,556 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:22:23,681 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:22:25,689 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:22:25,690 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:22:26,772 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:22:26,773 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:22:26,773 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:22:26,773 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:22:26,856 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:22:28,876 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:22:28,876 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:22:31,060 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:22:31,061 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:22:33,143 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:22:33,144 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:22:34,257 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:22:34,258 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:22:34,258 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:22:34,258 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:22:34,320 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:22:36,340 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:22:36,340 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:22:38,518 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:22:38,518 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:22:39,950 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:22:41,400 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:22:41,401 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:22:42,588 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:22:42,589 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:22:43,698 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:22:43,699 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:22:45,883 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:47,063 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:22:47,065 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:22:47,189 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:22:52,199 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:22:52,200 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:22:54,363 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:22:54,363 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:22:59,528 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:22:59,529 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:23:01,701 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:23:06,708 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:23:06,710 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_142306.mp4
2025-03-19 14:23:06,710 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:23:06,710 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:23:11,987 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:23:11,988 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:23:12,033 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:23:13,184 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4
2025-03-19 14:23:13,185 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:23:15,200 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:23:18,204 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:23:18,204 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:23:21,213 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:23:21,213 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:23:21,213 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:23:22,384 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:23:22,384 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:23:22,385 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:23:22,385 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:23:22,487 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:23:24,504 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:23:24,504 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:23:24,504 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:23:26,743 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:23:26,743 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:23:34,948 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:23:34,949 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:23:34,949 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:23:34,949 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:35,268 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:23:35,269 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:35,590 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:23:35,591 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:35,848 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:23:35,849 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,086 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:23:36,087 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,314 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:23:36,314 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,563 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:23:36,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,805 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:23:36,806 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:37,049 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:23:37,049 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:37,299 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:23:37,300 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:39,559 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:23:39,560 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:23:39,560 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:23:39,687 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eeaf5d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t552}
    * Task{e19f5a3 #552 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_142339_20250319_142339.png
2025-03-19 14:23:41,183 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_142339_20250319_142339.png
2025-03-19 14:23:41,184 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_142339_20250319_142339.png
2025-03-19 14:23:41,184 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:23:46,000 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:23:46,003 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:23:46,003 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:23:46,004 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:23:46,004 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:23:48,409 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:23:56,126 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:23:56,126 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:23:56,126 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:23:56,230 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eeaf5d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t552}
    * Task{e19f5a3 #552 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:23:56,230 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:23:56,230 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:23:56,231 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:23:56,231 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_142356_20250319_142356.png
2025-03-19 14:23:57,721 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_142356_20250319_142356.png
2025-03-19 14:23:57,722 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_142356_20250319_142356.png
2025-03-19 14:23:57,722 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:24:02,759 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:24:04,921 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:24:04,923 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:24:04,923 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:24:04,923 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:24:05,927 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:24:06,932 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:24:06,933 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:24:06,933 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 173.6 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-19 14:24:06,933 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:24:16,936 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4 (大小: 3.26MB)
2025-03-19 14:24:16,938 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.908044秒，无需修复
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:24:25,009 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4
2025-03-19 14:24:25,015 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4
2025-03-19 14:24:25,015 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:24:25,015 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:24:30,268 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:24:30,269 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4
2025-03-19 14:24:30,270 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:24:30,270 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:24:30,270 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:24:30,697 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:24:31,701 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:24:31,701 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:24:31,701 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:24:32,803 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:24:32,805 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:24:32,805 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:24:34,912 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:24:34,912 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:24:36,128 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:24:36,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:24:36,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:24:37,275 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:24:37,275 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:24:37,275 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:24:37,276 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:22:19\n- 结束时间: 2025-03-19 14:24:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:24:37"}]}]}}
2025-03-19 14:24:37,695 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:24:37,698 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:29:37,728 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:29:37,730 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:29:37,730 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:29:37,731 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:29:37,873 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:29:38,318 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:29:38,319 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:29:38,319 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:29:38,319 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:29:39,799 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:29:39,800 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:29:41,074 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:29:41,074 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:29:41,075 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:29:41,075 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:29:41,075 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:29:41,236 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:29:41,237 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:29:41,237 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:29:41,237 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:29:42,635 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:29:42,636 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:29:43,916 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:29:45,013 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:29:45,014 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:29:45,141 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:29:47,146 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:29:47,147 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:29:48,242 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:29:48,242 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:29:48,242 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:29:48,243 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:29:48,328 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:29:50,334 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:29:50,335 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:29:52,502 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:29:52,503 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:29:54,591 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:29:54,592 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:29:55,704 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:29:55,705 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:29:55,705 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:29:55,705 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:29:55,778 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:29:57,785 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:29:57,785 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:29:59,936 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:29:59,936 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:30:01,368 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:30:02,844 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:30:02,845 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:30:04,029 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:30:04,029 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:30:05,130 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:30:05,131 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:30:07,300 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:30:08,420 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:30:08,420 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:30:08,550 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:30:13,555 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:30:13,557 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:30:15,730 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:30:15,731 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:30:20,881 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:30:20,882 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:30:23,048 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:30:28,050 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:30:28,052 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_143028.mp4
2025-03-19 14:30:28,053 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:30:28,053 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:30:33,301 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:30:33,303 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:30:33,348 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:30:34,488 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4
2025-03-19 14:30:34,491 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:30:36,503 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:30:39,506 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:30:39,508 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:30:42,514 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:30:42,515 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:30:42,515 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:30:43,692 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:30:43,693 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:30:43,693 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:30:43,693 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:30:43,805 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:30:45,812 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:30:45,813 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:30:45,813 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:30:48,107 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:30:48,109 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:30:56,289 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:30:56,291 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:30:56,291 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:30:56,291 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:56,559 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:30:56,559 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:56,806 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:30:56,807 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,068 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:30:57,068 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,308 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:30:57,309 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,540 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:30:57,541 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,776 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:30:57,777 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:58,035 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:30:58,036 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:58,254 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:30:58,255 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:58,513 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:30:58,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:31:00,743 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:31:00,744 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:31:00,744 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:31:00,881 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a074010 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t558}
    * Task{900332f #558 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143100_20250319_143100.png
2025-03-19 14:31:03,396 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143100_20250319_143100.png
2025-03-19 14:31:03,397 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143100_20250319_143100.png
2025-03-19 14:31:03,397 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:31:09,612 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:31:11,054 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:11,062 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:11,062 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:31:11,063 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:31:11,063 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:31:21,193 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:31:21,194 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:31:21,194 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:31:21,290 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a074010 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t558}
    * Task{900332f #558 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143121_20250319_143121.png
2025-03-19 14:31:23,747 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143121_20250319_143121.png
2025-03-19 14:31:23,748 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143121_20250319_143121.png
2025-03-19 14:31:23,748 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:31:33,980 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:31:36,099 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:31:36,100 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:31:36,100 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:31:36,100 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:31:37,105 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:31:38,110 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:31:38,111 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:31:38,111 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 92.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:31:38,111 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:31:48,115 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4 (大小: 5.13MB)
2025-03-19 14:31:48,118 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:31:48,245 - QuickAppADBTester - INFO - 录制文件完整，时长: 60.683222秒，无需修复
2025-03-19 14:31:48,245 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:31:48,245 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4
2025-03-19 14:31:48,246 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:32:01,022 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4
2025-03-19 14:32:01,029 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4
2025-03-19 14:32:01,029 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:32:01,029 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:32:06,293 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:32:06,294 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4
2025-03-19 14:32:06,294 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:32:06,295 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:32:06,295 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:32:06,624 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:32:07,625 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:32:07,626 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:32:07,626 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:32:08,720 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:32:08,721 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:32:08,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:32:10,835 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:32:10,836 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:32:12,028 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:32:12,028 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:32:12,029 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:32:13,172 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:32:13,173 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:32:13,174 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:32:13,175 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:29:41\n- 结束时间: 2025-03-19 14:32:13\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:32:13"}]}]}}
2025-03-19 14:32:13,643 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:32:13,646 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:37:13,709 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:37:13,713 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:37:13,713 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:37:13,713 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:37:13,830 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:37:13,988 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:37:13,989 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:37:13,989 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:37:13,989 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:37:15,694 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:15,694 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:16,938 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:37:17,084 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:37:17,085 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:37:17,085 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:37:17,085 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:37:18,483 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:18,484 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:19,737 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:20,831 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:37:20,832 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:37:20,948 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:37:22,953 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:37:22,953 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:37:24,048 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:37:24,049 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:37:24,050 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:37:24,050 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:37:24,130 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:37:26,139 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:37:26,140 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:37:28,328 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:37:28,329 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:37:30,421 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:37:30,422 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:37:31,526 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:37:31,527 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:37:31,527 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:37:31,527 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:37:31,606 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:37:33,616 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:37:33,616 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:37:35,778 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:37:35,779 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:37:37,204 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:37:38,690 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:37:38,691 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:37:39,841 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:37:39,842 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:37:40,954 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:37:40,955 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:37:43,145 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:37:43,146 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:37:43,147 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:37:43,147 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:43,147 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:44,323 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:37:44,324 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:37:44,447 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:37:49,452 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:37:49,453 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:37:51,644 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:37:51,645 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:37:56,799 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:37:56,800 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:37:58,975 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:38:03,980 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:38:03,981 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_143803.mp4
2025-03-19 14:38:03,981 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:38:03,981 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:38:09,212 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:38:09,215 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:38:09,269 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:38:10,460 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4
2025-03-19 14:38:10,461 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:38:12,473 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:38:15,476 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:38:15,476 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:38:18,478 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:38:18,478 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:38:18,478 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:38:19,755 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:38:21,764 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:38:21,764 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:38:21,764 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:38:24,069 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:38:24,073 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:38:32,292 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:38:32,293 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:38:32,293 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:38:32,293 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:32,637 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:38:32,637 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:32,919 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:38:32,920 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,143 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:38:33,144 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,395 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:38:33,395 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,622 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:38:33,622 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,876 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:38:33,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:34,122 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:38:34,123 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:34,357 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:38:34,358 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:34,562 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:38:34,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:36,792 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:38:36,793 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:38:36,793 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{24503a3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t564}
    * Task{980a259 #564 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:38:36,909 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143836_20250319_143836.png
2025-03-19 14:38:38,433 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143836_20250319_143836.png
2025-03-19 14:38:38,433 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143836_20250319_143836.png
2025-03-19 14:38:38,433 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:38:45,593 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:38:45,617 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:38:45,624 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:38:45,624 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:38:45,624 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:38:45,625 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:38:55,780 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:38:55,780 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:38:55,780 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:38:55,909 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{24503a3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t564}
    * Task{980a259 #564 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143855_20250319_143855.png
2025-03-19 14:38:57,369 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143855_20250319_143855.png
2025-03-19 14:38:57,370 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143855_20250319_143855.png
2025-03-19 14:38:57,370 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:39:01,936 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:39:04,077 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:39:04,077 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:39:04,078 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:39:04,078 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:39:05,083 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:39:06,089 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:39:06,090 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:39:06,090 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 125.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:39:06,090 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:39:16,095 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4 (大小: 3.81MB)
2025-03-19 14:39:16,095 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.737589秒，无需修复
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:39:23,615 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4
2025-03-19 14:39:23,619 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4
2025-03-19 14:39:23,619 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:39:23,619 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:39:28,871 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:39:29,284 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:39:30,290 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:39:30,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:39:30,291 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:39:31,399 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:39:31,399 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:39:31,400 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:39:33,497 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:39:33,497 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:39:34,658 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:39:34,658 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:39:34,658 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:39:35,792 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:39:35,793 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:39:35,793 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:39:35,794 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:37:16\n- 结束时间: 2025-03-19 14:39:35\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:39:35"}]}]}}
2025-03-19 14:39:36,220 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:39:36,224 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:44:37,226 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:44:37,228 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:44:37,228 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:44:37,228 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:44:37,383 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:44:37,552 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:44:37,552 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:44:37,553 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:44:37,553 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:44:37,811 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:44:37,812 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:44:37,812 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:44:37,812 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:44:39,293 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:44:39,294 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:44:40,735 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:44:40,736 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:44:40,736 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:44:40,736 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:44:42,131 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:44:42,132 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:44:43,382 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:44:44,482 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:44:44,483 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:44:44,600 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:44:46,606 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:44:46,607 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:44:47,700 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:44:47,701 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:44:47,701 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:44:47,701 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:44:47,780 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:44:49,787 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:44:49,788 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:44:51,982 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:44:51,983 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:44:54,051 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:44:54,051 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:44:55,161 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:44:55,162 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:44:55,162 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:44:55,162 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:44:55,239 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:44:57,249 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:44:57,249 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:44:59,437 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:44:59,438 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:45:00,860 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:45:02,338 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:45:02,339 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:45:03,505 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:45:03,505 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:45:04,604 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:45:04,605 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:45:06,784 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:45:06,785 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:45:06,785 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:45:06,786 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:45:06,786 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:45:07,953 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:45:07,954 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:45:08,055 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:45:13,061 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:45:13,062 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:45:15,205 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:45:15,206 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:45:20,354 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:45:20,354 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:45:22,505 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:45:27,511 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:45:27,513 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_144527.mp4
2025-03-19 14:45:27,514 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:45:27,514 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:45:32,774 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:45:32,776 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:45:32,817 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:45:34,003 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4
2025-03-19 14:45:34,004 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:45:36,012 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:45:39,015 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:45:39,016 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:45:42,020 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:45:42,020 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:45:42,021 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:45:43,197 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:45:43,198 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:45:43,198 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:45:43,198 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:45:43,301 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:45:45,311 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:45:45,311 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:45:45,312 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:45:47,604 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:45:47,605 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:45:55,798 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:45:55,800 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:45:55,800 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:45:55,800 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,096 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:45:56,097 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,337 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:45:56,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,576 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:45:56,577 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,804 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:45:56,805 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,045 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:45:57,046 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,273 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:45:57,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,541 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:45:57,542 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,772 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:45:57,773 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:58,047 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:45:58,047 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:46:00,346 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:46:00,348 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:46:00,348 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:46:00,474 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f5a9206 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t570}
    * Task{fa596f4 #570 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_144600_20250319_144600.png
2025-03-19 14:46:02,548 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_144600_20250319_144600.png
2025-03-19 14:46:02,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_144600_20250319_144600.png
2025-03-19 14:46:02,548 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:46:09,125 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:46:09,859 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:09,865 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:09,866 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:46:09,866 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:09,866 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:46:20,017 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:46:20,018 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:46:20,018 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f5a9206 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t570}
    * Task{fa596f4 #570 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_144620_20250319_144620.png
2025-03-19 14:46:22,136 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_144620_20250319_144620.png
2025-03-19 14:46:22,137 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_144620_20250319_144620.png
2025-03-19 14:46:22,137 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:46:26,782 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:26,784 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:26,784 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:46:26,785 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:46:26,785 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:26,785 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:46:28,933 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:46:28,934 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:46:28,935 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:46:28,935 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:46:29,939 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:46:30,942 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:46:30,943 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:46:30,943 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 115.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:46:30,944 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:46:40,948 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4 (大小: 4.22MB)
2025-03-19 14:46:40,950 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.088467秒，无需修复
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:46:48,185 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4
2025-03-19 14:46:48,193 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4
2025-03-19 14:46:48,193 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:46:48,194 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:46:53,458 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:46:53,900 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:46:54,905 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:46:54,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:54,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:46:56,016 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:46:56,017 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:46:56,018 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:46:58,129 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:46:58,130 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:46:59,280 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:46:59,281 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:59,281 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:47:00,418 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:47:00,419 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:47:00,419 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:47:00,419 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:44:40\n- 结束时间: 2025-03-19 14:47:00\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:47:00"}]}]}}
2025-03-19 14:47:00,882 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:47:00,885 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:52:01,226 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:52:01,227 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:52:01,227 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:52:01,227 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:52:01,365 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:52:01,519 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:52:01,520 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:52:01,521 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:52:01,521 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:52:01,773 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:52:01,774 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:52:01,774 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:52:01,774 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:52:03,252 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:03,253 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:04,491 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:52:04,640 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:52:04,641 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:52:04,641 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:52:04,641 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:52:06,058 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:06,059 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:08,414 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:52:08,416 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:52:08,543 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:52:10,553 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:52:10,553 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:52:11,655 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:52:11,656 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:52:11,656 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:52:11,656 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:52:11,732 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:52:13,752 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:52:13,752 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:52:15,951 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:52:15,951 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:52:18,036 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:52:18,037 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:52:19,143 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:52:19,144 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:52:19,144 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:52:19,144 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:52:19,217 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:52:21,225 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:52:21,225 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:52:23,426 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:52:23,427 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:52:24,847 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:52:26,294 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:52:26,295 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:52:27,477 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:52:27,477 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:52:28,577 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:52:28,577 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:52:30,752 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:31,925 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:52:31,926 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:52:32,042 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:52:37,051 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:52:37,052 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:52:39,211 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:52:39,212 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:52:44,383 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:52:44,383 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:52:46,543 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:52:51,553 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:52:51,554 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_145251.mp4
2025-03-19 14:52:51,554 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:52:51,555 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:52:56,835 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:52:56,836 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:52:56,887 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:52:58,105 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4
2025-03-19 14:52:58,105 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:53:00,119 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:53:03,125 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:53:03,126 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:53:06,132 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:53:06,132 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:53:06,132 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:53:07,352 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:53:07,352 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:53:07,353 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:53:07,353 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:53:07,459 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:53:09,473 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:53:09,474 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:53:09,474 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:53:11,727 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:53:11,727 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:53:19,946 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:53:19,946 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:53:19,947 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:53:19,947 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,203 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:53:20,204 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,468 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:53:20,468 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,704 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:53:20,704 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,933 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:53:20,934 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,202 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:53:21,203 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,440 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:53:21,440 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,701 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:53:21,704 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,938 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:53:21,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:22,176 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:53:22,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:24,431 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:53:24,432 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:53:24,432 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:53:24,570 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1816dd2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t576}
    * Task{e675a0 #576 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:53:24,570 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:53:24,571 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:53:24,571 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:53:24,571 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_145324_20250319_145324.png
2025-03-19 14:53:26,578 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_145324_20250319_145324.png
2025-03-19 14:53:26,578 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_145324_20250319_145324.png
2025-03-19 14:53:26,578 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:53:33,344 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:53:34,416 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_118.jpg
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_118.jpg
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:53:44,559 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:53:44,560 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:53:44,560 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:53:44,673 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1816dd2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t576}
    * Task{e675a0 #576 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:53:44,673 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:53:44,673 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:53:44,674 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:53:44,674 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_145344_20250319_145344.png
2025-03-19 14:53:46,696 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_145344_20250319_145344.png
2025-03-19 14:53:46,696 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_145344_20250319_145344.png
2025-03-19 14:53:46,696 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:53:51,555 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:53:53,693 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:53:53,694 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:53:53,694 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:53:53,694 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:53:54,700 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:53:55,703 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:53:55,704 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:53:55,704 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:53:55,705 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:54:05,710 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4 (大小: 3.85MB)
2025-03-19 14:54:05,711 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.794122秒，无需修复
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:54:18,128 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4
2025-03-19 14:54:18,135 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4
2025-03-19 14:54:18,135 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:54:18,135 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:54:23,382 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:54:23,744 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:54:24,750 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:54:24,750 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:54:24,750 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:54:25,852 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:54:25,853 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:54:25,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:54:27,952 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:54:27,953 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:54:29,126 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:54:29,127 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:54:29,127 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:54:30,267 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:54:30,267 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:54:30,267 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:54:30,268 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:52:04\n- 结束时间: 2025-03-19 14:54:30\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_118.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:54:30"}]}]}}
2025-03-19 14:54:32,076 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:54:32,078 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:54:35,720 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 14:54:35,720 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 14:54:35,721 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:01:51,387 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:01:51,646 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:01:51,647 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:01:51,647 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:01:51,647 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:01:53,079 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:01:53,080 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:01:54,338 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:01:54,507 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:01:54,507 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:01:54,507 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:01:54,508 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:01:55,900 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:01:55,900 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:01:57,137 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:01:58,228 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:01:58,229 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:01:58,368 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:02:00,374 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:02:00,374 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:02:01,453 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:02:01,454 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:02:01,455 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:02:01,455 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:02:01,543 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:02:03,553 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:02:03,554 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:02:05,763 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:02:05,764 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:02:07,878 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:02:07,879 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:02:08,978 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:02:08,979 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:02:08,979 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:02:08,979 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:02:09,088 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:02:11,095 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:02:11,095 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:02:13,292 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:02:13,293 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:02:14,708 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:02:16,176 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:02:16,177 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:02:17,337 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:02:17,338 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:02:18,453 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:02:18,454 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:02:20,618 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:02:20,619 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:02:20,619 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:02:20,619 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:02:20,620 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:02:21,800 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:02:21,801 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:02:21,930 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:02:26,935 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:02:26,936 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:02:29,116 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:02:29,117 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:02:34,264 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:02:34,265 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:02:36,448 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:02:41,453 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:02:41,454 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_150241.mp4
2025-03-19 15:02:41,454 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:02:41,454 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:02:46,711 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:02:46,712 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:02:46,751 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:02:47,888 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4
2025-03-19 15:02:47,889 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:02:49,900 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:02:52,904 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:02:52,904 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:02:55,905 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:02:55,905 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:02:55,906 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:02:57,092 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:02:57,093 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:02:57,093 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:02:57,093 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:02:57,194 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:02:59,201 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:02:59,202 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:02:59,202 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:03:01,470 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:03:01,471 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:03:09,654 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:03:09,655 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:03:09,655 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:03:09,655 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:09,915 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:03:09,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,203 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:03:10,203 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,446 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:03:10,447 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,674 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:03:10,674 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,905 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:03:10,914 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,131 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:03:11,132 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,366 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:03:11,366 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,597 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:03:11,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,868 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:03:11,869 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:14,121 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:03:14,122 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:03:14,122 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:03:14,292 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{36b31a4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t582}
    * Task{756b0d3 #582 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:03:14,292 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:03:14,292 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:03:14,293 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:03:14,293 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_150314_20250319_150314.png
2025-03-19 15:03:15,835 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_150314_20250319_150314.png
2025-03-19 15:03:15,835 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_150314_20250319_150314.png
2025-03-19 15:03:15,835 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:03:22,838 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_120.jpg
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_120.jpg
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:03:23,008 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:03:33,001 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:03:33,001 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:03:33,002 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{36b31a4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t582}
    * Task{756b0d3 #582 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:03:33,114 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_150333_20250319_150333.png
2025-03-19 15:03:34,552 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_150333_20250319_150333.png
2025-03-19 15:03:34,552 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_150333_20250319_150333.png
2025-03-19 15:03:34,553 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:03:40,623 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_121.jpg
2025-03-19 15:03:40,626 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_121.jpg
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:03:42,759 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:03:42,760 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:03:42,760 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:03:42,760 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:03:43,766 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:03:44,772 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:03:44,772 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:03:44,773 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 160.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:03:44,773 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:03:54,779 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4 (大小: 3.76MB)
2025-03-19 15:03:54,779 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.973033秒，无需修复
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:04:01,924 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4
2025-03-19 15:04:01,936 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4
2025-03-19 15:04:01,937 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:04:01,937 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:04:07,187 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:04:07,188 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4
2025-03-19 15:04:07,188 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:04:07,189 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:04:07,189 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:04:07,536 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:04:08,542 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:04:08,542 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:04:08,542 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:04:09,656 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:04:09,657 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:04:09,657 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:04:11,759 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:04:11,760 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:04:12,942 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:04:12,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:04:12,944 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:04:14,081 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:04:14,082 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:04:14,082 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:04:14,083 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:01:54\n- 结束时间: 2025-03-19 15:04:14\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_120.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_121.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:04:14"}]}]}}
2025-03-19 15:04:14,594 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:04:14,597 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:04:14,598 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 15:09:14,663 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:09:14,667 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:09:14,667 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:09:14,667 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:09:14,797 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:09:15,195 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:09:15,196 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:09:15,196 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:09:15,196 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:09:16,652 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:16,652 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:09:18,045 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:09:18,046 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:09:18,046 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:09:18,046 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:09:19,451 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:19,452 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:21,816 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:09:21,816 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:09:21,937 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:09:23,939 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:09:23,939 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:09:25,064 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:09:25,065 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:09:25,065 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:09:25,065 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:09:25,150 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:09:27,158 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:09:27,158 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:09:29,325 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:09:29,326 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:09:31,415 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:09:31,415 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:09:32,598 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:09:34,604 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:09:34,605 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:09:36,764 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:09:36,765 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:09:38,175 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:09:39,661 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:09:39,662 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:09:40,823 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:09:40,823 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:09:41,930 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:09:41,931 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:09:44,124 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:09:44,124 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:09:44,125 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:09:44,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:44,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:45,314 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:09:45,315 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:09:45,439 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:09:50,445 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:09:50,446 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:09:52,604 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:09:52,605 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:09:57,767 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:09:57,768 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:09:59,927 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:10:04,932 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:10:04,933 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_151004.mp4
2025-03-19 15:10:04,933 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:10:04,933 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:10:10,211 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:10:10,213 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:10:10,262 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:10:11,401 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4
2025-03-19 15:10:11,402 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:10:13,417 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:10:16,422 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:10:16,423 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:10:19,424 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:10:19,424 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:10:19,425 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:10:20,609 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:10:20,610 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:10:20,610 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:10:20,610 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:10:20,718 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:10:22,728 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:10:22,729 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:10:22,729 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:10:25,036 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:10:25,037 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:10:33,242 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:10:33,243 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:10:33,243 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:10:33,243 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:33,608 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:10:33,609 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:33,875 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:10:33,875 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,122 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:10:34,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,321 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:10:34,322 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,570 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:10:34,571 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,790 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:10:34,790 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:35,066 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:10:35,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:35,312 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:10:35,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:35,563 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:10:35,564 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:37,798 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:10:37,798 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:10:37,799 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{53c4356 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t588}
    * Task{cd13ee2 #588 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151037_20250319_151037.png
2025-03-19 15:10:39,774 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151037_20250319_151037.png
2025-03-19 15:10:39,775 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151037_20250319_151037.png
2025-03-19 15:10:39,776 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:10:46,533 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:10:47,139 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:10:57,290 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:10:57,292 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:10:57,292 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:10:57,404 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{53c4356 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t588}
    * Task{cd13ee2 #588 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151057_20250319_151057.png
2025-03-19 15:10:59,273 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151057_20250319_151057.png
2025-03-19 15:10:59,274 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151057_20250319_151057.png
2025-03-19 15:10:59,274 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:11:04,021 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:11:04,025 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:11:06,147 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:11:06,148 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:11:06,148 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:11:06,148 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:11:07,151 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:11:08,154 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:11:08,154 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:11:08,154 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:11:08,155 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:11:18,159 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4 (大小: 3.92MB)
2025-03-19 15:11:18,162 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:11:18,276 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.906711秒，无需修复
2025-03-19 15:11:18,277 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:11:18,277 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4
2025-03-19 15:11:18,277 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:11:25,798 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4
2025-03-19 15:11:25,804 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4
2025-03-19 15:11:25,804 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:11:25,804 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:11:31,071 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:11:31,072 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4
2025-03-19 15:11:31,073 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:11:31,073 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:11:31,073 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:11:31,484 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:11:32,489 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:11:32,490 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:11:32,490 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:11:33,605 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:11:33,606 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:11:33,607 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:11:35,721 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:11:35,721 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:11:36,873 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:11:36,874 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:11:36,874 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:11:38,007 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:11:38,008 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:11:38,008 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:11:38,009 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:09:17\n- 结束时间: 2025-03-19 15:11:38\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:11:38"}]}]}}
2025-03-19 15:11:38,425 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:11:38,429 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:16:38,463 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:16:38,466 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:16:38,466 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:16:38,466 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:16:38,612 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:16:38,788 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:16:38,789 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:16:38,789 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:16:38,789 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:16:39,032 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:16:39,033 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:16:39,033 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:16:39,033 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:16:40,509 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:16:40,510 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:16:41,771 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:16:41,771 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:16:41,772 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:16:41,772 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:16:41,772 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:16:41,920 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:16:41,921 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:16:41,922 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:16:41,922 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:16:43,338 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:16:43,339 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:16:44,593 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:16:45,685 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:16:45,686 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:16:45,802 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:16:47,803 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:16:47,803 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:16:48,894 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:16:48,895 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:16:48,895 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:16:48,895 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:16:48,978 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:16:50,985 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:16:50,986 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:16:53,161 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:16:53,162 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:16:55,250 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:16:55,251 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:16:56,353 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:16:56,356 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:16:56,356 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:16:56,356 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:16:56,460 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:16:58,468 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:16:58,468 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:17:00,630 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:17:00,634 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:17:02,056 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:17:03,530 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:17:03,531 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:17:04,711 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:17:04,712 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:17:05,826 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:17:05,827 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:17:08,014 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:17:09,152 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:17:09,153 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:17:09,282 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:17:14,285 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:17:14,285 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:17:16,451 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:17:16,452 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:17:21,564 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:17:21,565 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:17:23,725 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_151728.mp4
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:17:33,997 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:17:33,998 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:17:34,047 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:17:35,182 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4
2025-03-19 15:17:35,183 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:17:37,191 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:17:40,198 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:17:40,198 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:17:43,201 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:17:43,202 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:17:43,202 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:17:44,372 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:17:44,373 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:17:44,373 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:17:44,373 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:17:44,484 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:17:46,492 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:17:46,492 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:17:46,492 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:17:48,763 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:17:48,764 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:57,342 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:17:57,342 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:57,589 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:17:57,590 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:57,818 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:17:57,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,053 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:17:58,054 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,284 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:17:58,285 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,518 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:17:58,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,749 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:17:58,750 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,969 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:17:58,970 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:59,207 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:17:59,208 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:18:01,443 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:18:01,444 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:18:01,444 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5360b5c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t594}
    * Task{27dbfeb #594 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151801_20250319_151801.png
2025-03-19 15:18:03,651 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151801_20250319_151801.png
2025-03-19 15:18:03,652 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151801_20250319_151801.png
2025-03-19 15:18:03,653 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:18:10,321 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:18:11,052 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:11,056 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:11,057 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:18:11,057 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:18:11,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:18:21,164 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:18:21,165 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:18:21,165 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:18:21,265 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5360b5c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t594}
    * Task{27dbfeb #594 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151821_20250319_151821.png
2025-03-19 15:18:23,437 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151821_20250319_151821.png
2025-03-19 15:18:23,438 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151821_20250319_151821.png
2025-03-19 15:18:23,438 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:18:28,869 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:28,877 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:18:31,025 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:18:31,026 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:18:31,026 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:18:31,026 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:18:32,031 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:18:33,033 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:18:33,033 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:18:33,034 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 159.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:18:33,034 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:18:43,035 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4 (大小: 3.97MB)
2025-03-19 15:18:43,036 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.871600秒，无需修复
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:18:50,475 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4
2025-03-19 15:18:50,482 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4
2025-03-19 15:18:50,483 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:18:50,483 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:18:55,749 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:18:55,750 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4
2025-03-19 15:18:55,751 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:18:55,751 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:18:55,751 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:18:56,161 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:18:57,166 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:18:57,166 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:18:57,166 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:18:58,268 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:18:58,269 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:18:58,269 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:19:00,388 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:19:00,389 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:19:01,551 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:19:01,552 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:19:01,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:19:02,699 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:19:02,700 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:19:02,701 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:19:02,701 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:16:41\n- 结束时间: 2025-03-19 15:19:02\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:19:02"}]}]}}
2025-03-19 15:19:03,176 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:19:03,178 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:24:03,803 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:24:03,805 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:24:03,805 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:24:03,805 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:24:03,924 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:24:04,074 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:24:04,075 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:24:04,075 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:24:04,075 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:24:04,323 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:24:04,323 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:24:04,324 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:24:04,324 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:24:05,807 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:05,808 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:07,075 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:24:07,075 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:24:07,076 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:24:07,076 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:24:07,076 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:24:07,246 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:24:07,247 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:24:07,247 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:24:07,247 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:24:08,656 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:08,657 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:09,930 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:11,031 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:24:11,031 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:24:11,152 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:24:13,156 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:24:13,157 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:24:14,255 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:24:14,256 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:24:14,257 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:24:14,257 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:24:14,337 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:24:16,343 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:24:16,344 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:24:18,525 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:24:18,526 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:24:20,615 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:24:20,617 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:24:21,727 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:24:21,728 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:24:21,728 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:24:21,728 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:24:21,804 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:24:23,809 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:24:23,810 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:24:25,988 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:24:25,990 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:24:27,400 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:24:28,862 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:24:28,863 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:24:30,056 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:24:30,057 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:24:31,158 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:24:31,159 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:24:33,355 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:34,517 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:24:34,518 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:24:34,622 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:24:39,627 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:24:39,629 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:24:41,785 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:24:41,785 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:24:46,922 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:24:46,922 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:24:49,067 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:24:54,073 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:24:54,074 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_152454.mp4
2025-03-19 15:24:54,074 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:24:54,074 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:24:59,321 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:24:59,322 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:24:59,371 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:25:00,559 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4
2025-03-19 15:25:00,560 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:25:02,568 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:25:05,571 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:25:05,572 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:25:08,573 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:25:08,574 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:25:08,574 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:25:09,742 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:25:09,743 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:25:09,743 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:25:09,744 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:25:09,851 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:25:11,858 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:25:11,859 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:25:11,859 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:25:14,149 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:25:14,150 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:25:22,310 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:25:22,312 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:25:22,312 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:25:22,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:22,604 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:25:22,604 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:22,851 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:25:22,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,087 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:25:23,087 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,313 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:25:23,314 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,594 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:25:23,594 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,814 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:25:23,815 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:24,050 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:25:24,051 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:24,281 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:25:24,282 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:24,498 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:25:24,498 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:26,774 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:25:26,774 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:25:26,774 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:25:26,944 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{10b34bf u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t600}
    * Task{e0d9ed5 #600 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:25:26,944 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:25:26,945 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:25:26,945 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:25:26,945 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_152526_20250319_152526.png
2025-03-19 15:25:28,211 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_152526_20250319_152526.png
2025-03-19 15:25:28,212 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_152526_20250319_152526.png
2025-03-19 15:25:28,212 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:25:34,738 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_127.jpg
2025-03-19 15:25:34,745 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_127.jpg
2025-03-19 15:25:34,745 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:25:34,746 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:25:34,746 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:25:35,672 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:25:44,880 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:25:44,882 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:25:44,882 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:25:45,012 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{10b34bf u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t600}
    * Task{e0d9ed5 #600 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_152545_20250319_152545.png
2025-03-19 15:25:46,251 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_152545_20250319_152545.png
2025-03-19 15:25:46,251 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_152545_20250319_152545.png
2025-03-19 15:25:46,251 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:25:51,884 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_128.jpg
2025-03-19 15:25:51,890 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_128.jpg
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:25:54,037 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:25:54,038 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:25:54,038 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:25:54,038 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:25:55,039 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:25:56,045 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:25:56,045 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:25:56,045 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 162.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:25:56,046 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:26:06,048 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4 (大小: 2.92MB)
2025-03-19 15:26:06,049 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.609944秒，无需修复
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:26:13,587 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4
2025-03-19 15:26:13,592 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4
2025-03-19 15:26:13,592 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:26:13,592 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:26:18,791 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:26:19,224 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:26:20,230 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:26:20,230 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:26:20,231 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:26:21,338 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:26:21,339 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:26:21,339 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:26:23,442 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:26:23,443 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:26:24,607 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:26:24,608 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:26:24,608 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:26:25,718 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:26:25,719 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:26:25,719 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:26:25,720 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:24:07\n- 结束时间: 2025-03-19 15:26:25\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_127.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_128.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:26:25"}]}]}}
2025-03-19 15:26:26,328 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:26:26,332 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:31:26,391 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:31:26,395 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:31:26,395 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:31:26,395 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:31:26,538 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:31:26,650 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:31:26,651 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:31:26,651 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:31:26,651 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:31:26,914 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:31:26,914 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:31:26,914 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:31:26,915 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:31:28,391 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:28,392 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:29,681 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:31:29,849 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:31:29,850 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:31:29,850 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:31:29,850 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:31:31,263 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:31,264 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:32,538 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:31:32,539 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:31:32,539 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:31:32,539 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:32,540 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:33,634 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:31:33,635 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:31:33,763 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:31:35,768 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:31:35,769 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:31:36,876 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:31:36,878 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:31:36,878 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:31:36,878 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:31:36,963 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:31:38,974 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:31:38,974 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:31:41,152 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:31:41,153 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:31:43,246 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:31:43,247 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:31:44,357 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:31:44,358 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:31:44,358 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:31:44,359 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:31:44,441 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:31:46,448 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:31:46,449 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:31:48,603 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:31:48,604 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:31:50,030 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:31:51,512 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:31:51,513 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:31:52,675 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:31:52,676 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:31:53,785 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:31:53,785 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:31:55,979 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:57,110 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:31:57,111 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:31:57,233 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:32:02,236 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:32:02,236 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:32:04,378 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:32:04,379 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:32:09,521 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:32:09,522 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:32:11,684 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:32:16,686 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:32:16,686 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_153216.mp4
2025-03-19 15:32:16,687 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:32:16,687 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:32:21,954 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:32:21,955 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:32:22,004 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:32:23,197 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4
2025-03-19 15:32:23,198 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:32:25,209 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:32:28,213 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:32:28,214 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:32:31,216 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:32:31,217 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:32:31,217 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:32:32,429 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:32:32,430 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:32:32,430 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:32:32,430 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:32:32,536 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:32:34,539 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:32:34,539 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:32:34,539 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:32:36,816 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:32:36,817 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:32:45,024 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:32:45,024 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:32:45,025 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:32:45,025 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:45,324 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:32:45,325 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:45,588 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:32:45,589 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:45,817 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:32:45,818 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,055 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:32:46,056 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,287 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:32:46,287 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,504 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:32:46,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,714 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:32:46,714 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,960 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:32:46,961 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:47,210 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:32:47,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:49,488 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:32:49,489 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:32:49,489 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:32:49,617 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{646fea2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t606}
    * Task{f4f2869 #606 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:32:49,617 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:32:49,618 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:32:49,618 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:32:49,618 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_153249_20250319_153249.png
2025-03-19 15:32:51,977 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_153249_20250319_153249.png
2025-03-19 15:32:51,978 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_153249_20250319_153249.png
2025-03-19 15:32:51,979 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:32:58,324 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:33:00,004 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:00,012 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:00,013 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:33:00,013 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:00,013 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:10,125 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:33:10,126 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:33:10,126 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:33:10,257 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{646fea2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t606}
    * Task{f4f2869 #606 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_153310_20250319_153310.png
2025-03-19 15:33:12,534 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_153310_20250319_153310.png
2025-03-19 15:33:12,534 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_153310_20250319_153310.png
2025-03-19 15:33:12,535 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:33:17,435 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:17,442 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:19,570 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:33:19,571 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:33:19,572 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:33:19,572 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:33:20,576 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:33:21,580 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:33:21,581 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:33:21,581 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 138.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:33:21,582 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:33:31,586 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4 (大小: 4.64MB)
2025-03-19 15:33:31,586 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.438667秒，无需修复
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:33:39,764 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4
2025-03-19 15:33:39,771 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4
2025-03-19 15:33:39,771 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:33:39,771 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:33:45,020 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:33:45,418 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:33:46,424 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:33:46,424 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:46,424 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:47,513 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:33:47,514 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:33:47,514 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:33:49,622 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:33:49,623 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:33:50,780 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:33:50,781 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:50,781 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:51,901 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:33:51,902 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:33:51,902 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:33:51,903 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:31:29\n- 结束时间: 2025-03-19 15:33:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:33:51"}]}]}}
2025-03-19 15:33:52,509 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:33:52,514 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:38:52,517 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:38:52,520 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:38:52,520 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:38:52,520 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:38:52,663 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:38:52,803 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:38:52,804 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:38:52,804 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:38:52,804 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:38:53,057 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:38:53,058 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:38:53,058 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:38:53,058 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:38:54,537 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:38:54,538 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:38:55,818 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:38:55,967 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:38:55,967 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:38:55,968 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:38:55,968 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:38:57,371 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:38:57,373 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:38:58,623 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:38:59,715 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:38:59,715 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:38:59,838 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:39:01,840 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:39:01,841 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:39:02,931 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:39:02,932 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:39:02,932 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:39:02,932 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:39:03,012 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:39:05,019 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:39:05,020 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:39:07,210 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:39:07,211 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:39:09,300 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:39:09,301 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:39:10,393 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:39:10,393 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:39:10,394 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:39:10,394 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:39:10,469 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:39:12,477 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:39:12,478 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:39:14,631 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:39:14,632 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:39:16,058 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:39:17,544 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:39:17,545 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:39:18,690 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:39:18,691 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:39:19,806 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:39:19,807 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:39:21,986 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:39:23,175 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:39:23,175 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:39:23,303 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:39:28,309 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:39:28,309 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:39:30,461 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:39:30,464 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:39:35,624 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:39:35,625 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:39:37,780 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:39:42,784 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:39:42,785 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_153942.mp4
2025-03-19 15:39:42,785 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:39:42,785 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:39:48,059 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:39:48,060 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:39:48,113 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:39:49,250 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4
2025-03-19 15:39:49,251 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:39:51,262 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:39:54,269 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:39:54,269 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:39:57,275 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:39:57,275 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:39:57,275 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:39:58,483 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:39:58,484 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:39:58,484 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:39:58,484 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:39:58,580 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:40:00,589 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:40:00,589 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:40:00,590 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:40:02,877 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:40:02,878 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:40:11,050 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:40:11,051 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:40:11,051 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:40:11,051 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:11,346 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:40:11,346 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:11,619 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:40:11,620 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:11,912 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:40:11,912 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,150 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:40:12,151 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,392 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:40:12,394 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,653 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:40:12,655 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,924 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:40:12,925 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:13,170 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:40:13,171 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:13,424 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:40:13,425 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:15,672 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:40:15,673 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:40:15,673 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:40:15,821 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e4f0bd3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t612}
    * Task{eade09 #612 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154015_20250319_154015.png
2025-03-19 15:40:17,471 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154015_20250319_154015.png
2025-03-19 15:40:17,471 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154015_20250319_154015.png
2025-03-19 15:40:17,472 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:40:24,376 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:40:24,596 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:24,603 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:24,603 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:40:24,604 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:40:24,604 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:40:34,734 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:40:34,735 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:40:34,735 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:40:34,837 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e4f0bd3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t612}
    * Task{eade09 #612 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154034_20250319_154034.png
2025-03-19 15:40:36,468 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154034_20250319_154034.png
2025-03-19 15:40:36,469 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154034_20250319_154034.png
2025-03-19 15:40:36,469 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:40:41,192 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:41,196 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:40:43,318 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:40:43,319 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:40:43,319 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:40:43,320 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:40:44,323 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:40:45,329 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:40:45,329 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:40:45,329 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:40:45,330 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:40:55,333 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4 (大小: 3.76MB)
2025-03-19 15:40:55,334 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:40:55,503 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.215967秒，无需修复
2025-03-19 15:40:55,504 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:40:55,504 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4
2025-03-19 15:40:55,504 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:41:02,927 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4
2025-03-19 15:41:02,930 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4
2025-03-19 15:41:02,931 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:41:02,931 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:41:08,175 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:41:08,176 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4
2025-03-19 15:41:08,176 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:41:08,177 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:41:08,177 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:41:08,562 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:41:09,567 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:41:09,567 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:41:09,567 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:41:10,668 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:41:10,668 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:41:10,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:41:12,779 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:41:12,779 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:41:13,955 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:41:13,956 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:41:13,956 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:41:15,091 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:41:15,093 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:41:15,093 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:41:15,094 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:38:55\n- 结束时间: 2025-03-19 15:41:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:41:15"}]}]}}
2025-03-19 15:41:15,631 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:41:15,636 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:46:15,686 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:46:15,691 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:46:15,692 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:46:15,693 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:46:15,857 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:46:16,158 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:46:16,159 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:46:16,159 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:46:16,159 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:46:17,637 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:17,638 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:18,868 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:46:20,431 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:20,431 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:21,689 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:46:21,689 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:46:21,689 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:46:21,690 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:21,690 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:22,786 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:46:22,787 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:46:22,903 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:46:24,907 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:46:24,908 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:46:25,996 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:46:25,998 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:46:25,998 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:46:25,998 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:46:26,082 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:46:28,090 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:46:28,090 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:46:30,254 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:46:30,256 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:46:32,337 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:46:32,337 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:46:33,540 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:46:35,547 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:46:35,550 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:46:37,688 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:46:37,689 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:46:39,095 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:46:40,571 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:46:40,572 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:46:41,765 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:46:41,766 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:46:42,867 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:46:42,868 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:46:45,035 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:46:45,035 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:46:45,036 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:46:45,036 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:45,036 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:46,195 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:46:46,196 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:46:46,319 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:46:51,324 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:46:51,325 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:46:53,503 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:46:53,504 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:46:58,645 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:46:58,646 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:47:00,812 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:47:05,816 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:47:05,817 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_154705.mp4
2025-03-19 15:47:05,817 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:47:05,817 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:47:11,085 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:47:11,087 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:47:11,134 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:47:12,271 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4
2025-03-19 15:47:12,272 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:47:14,284 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:47:17,291 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:47:17,291 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:47:20,296 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:47:20,297 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:47:20,297 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:47:21,472 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:47:21,473 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:47:21,473 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:47:21,474 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:47:21,580 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:47:23,589 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:47:23,590 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:47:23,590 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:47:25,878 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:47:25,879 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:47:34,060 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:47:34,062 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:47:34,063 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:47:34,063 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:34,425 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:47:34,425 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:34,644 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:47:34,645 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:34,846 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:47:34,846 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,097 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:47:35,098 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,314 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:47:35,315 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,544 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:47:35,545 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,767 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:47:35,767 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:36,005 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:47:36,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:36,252 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:47:36,253 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:38,480 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:47:38,481 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:47:38,481 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:47:38,609 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{40fcf1b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t618}
    * Task{27869f6 #618 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:47:38,609 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:47:38,610 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:47:38,610 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:47:38,610 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154738_20250319_154738.png
2025-03-19 15:47:40,253 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154738_20250319_154738.png
2025-03-19 15:47:40,254 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154738_20250319_154738.png
2025-03-19 15:47:40,254 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:47:47,392 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:47:47,409 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:47:57,539 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:47:57,540 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:47:57,540 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:47:57,668 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{40fcf1b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t618}
    * Task{27869f6 #618 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154757_20250319_154757.png
2025-03-19 15:47:59,319 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154757_20250319_154757.png
2025-03-19 15:47:59,320 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154757_20250319_154757.png
2025-03-19 15:47:59,320 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:48:03,879 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:48:03,885 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:48:03,885 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:48:03,886 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:48:03,886 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:48:03,886 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:48:07,065 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:48:08,070 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:48:08,071 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:48:08,071 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 131.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:48:08,071 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:48:18,073 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4 (大小: 4.18MB)
2025-03-19 15:48:18,074 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.919433秒，无需修复
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:48:25,437 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4
2025-03-19 15:48:25,444 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4
2025-03-19 15:48:25,445 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:48:25,445 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:48:30,703 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:48:31,008 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:48:32,013 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:48:32,014 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:48:32,014 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:48:33,128 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:48:33,129 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:48:33,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:48:35,242 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:48:35,243 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:48:36,369 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:48:36,370 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:48:36,370 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:48:37,509 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:48:37,510 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:48:37,511 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:48:37,512 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:46:18\n- 结束时间: 2025-03-19 15:48:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:48:37"}]}]}}
2025-03-19 15:48:37,980 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:48:37,982 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:53:38,046 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:53:38,047 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:53:38,048 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:53:38,048 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:53:38,181 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:53:38,325 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:53:38,326 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:53:38,326 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:53:38,326 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:53:38,558 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:53:38,559 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:53:38,559 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:53:38,559 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:53:40,051 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:53:40,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:53:41,283 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:53:41,427 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:53:41,428 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:53:41,428 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:53:41,428 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:53:42,823 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:53:42,824 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:53:45,197 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:53:45,197 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:53:45,316 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:53:47,321 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:53:47,322 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:53:48,412 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:53:48,413 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:53:48,413 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:53:48,413 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:53:48,488 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:53:50,498 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:53:50,499 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:53:52,682 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:53:52,683 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:53:54,766 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:53:54,767 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:53:55,875 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:53:55,876 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:53:55,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:53:55,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:53:55,954 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:53:57,962 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:53:57,962 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:54:00,133 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:54:00,134 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:54:01,557 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:54:03,052 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:54:03,053 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:54:04,204 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:54:04,205 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:54:05,284 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:54:05,284 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:54:07,463 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:54:08,647 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:54:08,647 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:54:08,772 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:54:13,778 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:54:13,779 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:54:15,922 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:54:15,922 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:54:21,065 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:54:21,066 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:54:23,215 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:54:28,217 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:54:28,218 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_155428.mp4
2025-03-19 15:54:28,218 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:54:28,218 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:54:33,472 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:54:33,473 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:54:33,518 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:54:34,712 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4
2025-03-19 15:54:34,714 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:54:36,726 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:54:39,734 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:54:39,734 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:54:42,738 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:54:42,740 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:54:42,740 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:54:43,934 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:54:43,936 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:54:43,936 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:54:43,937 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:54:44,042 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:54:46,045 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:54:46,046 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:54:46,046 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:54:48,392 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:54:48,393 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:54:56,590 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:54:56,591 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:54:56,592 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:54:56,592 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:56,869 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:54:56,870 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,176 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:54:57,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,407 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:54:57,408 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,622 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:54:57,622 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,863 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:54:57,864 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,118 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:54:58,119 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,359 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:54:58,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,599 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:54:58,601 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,840 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:54:58,841 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:55:01,069 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:55:01,071 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:55:01,071 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:55:01,229 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b62b33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t624}
    * Task{77126ee #624 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_155501_20250319_155501.png
2025-03-19 15:55:02,719 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_155501_20250319_155501.png
2025-03-19 15:55:02,719 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_155501_20250319_155501.png
2025-03-19 15:55:02,719 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:55:09,381 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_136.jpg
2025-03-19 15:55:09,388 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_136.jpg
2025-03-19 15:55:09,389 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:55:09,389 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:09,389 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:55:09,840 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:55:19,508 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:55:19,508 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:55:19,508 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:55:19,621 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b62b33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t624}
    * Task{77126ee #624 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_155519_20250319_155519.png
2025-03-19 15:55:21,081 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_155519_20250319_155519.png
2025-03-19 15:55:21,081 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_155519_20250319_155519.png
2025-03-19 15:55:21,081 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:55:26,750 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_137.jpg
2025-03-19 15:55:26,757 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_137.jpg
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:55:28,885 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:55:28,887 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:55:28,888 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:55:28,888 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:55:29,892 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:55:30,897 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:55:30,897 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:55:30,898 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 129.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:55:30,898 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:55:40,904 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4 (大小: 3.30MB)
2025-03-19 15:55:40,907 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:55:41,071 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.347822秒，无需修复
2025-03-19 15:55:41,072 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:55:41,072 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4
2025-03-19 15:55:41,072 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:55:48,477 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4
2025-03-19 15:55:48,484 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4
2025-03-19 15:55:48,485 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:55:48,485 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:55:53,746 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:55:53,748 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4
2025-03-19 15:55:53,748 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:55:53,748 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:55:53,749 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:55:54,123 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:55:55,129 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:55:55,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:55,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:55:56,241 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:55:56,242 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:55:56,242 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:55:58,360 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:55:58,361 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:55:59,527 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:55:59,528 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:59,528 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:56:00,642 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:56:00,643 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:56:00,643 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:56:00,644 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:53:41\n- 结束时间: 2025-03-19 15:56:00\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_136.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_137.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:56:00"}]}]}}
2025-03-19 15:56:01,080 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:56:01,084 - QuickAppADBTester - INFO - 测试完成
