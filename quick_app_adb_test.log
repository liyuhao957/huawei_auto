2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 09:50:30,106 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 09:50:30,296 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:30,419 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:30,659 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:30,660 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:32,114 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:32,115 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:33,314 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_095033.mp4
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:33,315 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:33,463 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:33,464 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:34,855 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:34,855 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:36,096 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:36,097 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:50:37,180 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:50:42,431 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:50:42,432 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 09:50:42,477 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 09:50:43,610 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4
2025-03-19 09:50:43,610 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 09:50:45,622 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 09:50:48,627 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 09:50:48,627 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 09:50:51,630 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 09:50:51,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:50:51,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:50:51,899 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:50:51,899 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:50:51,900 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:50:51,900 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:50:53,368 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:53,369 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:54,577 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:50:54,577 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:50:54,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:50:55,655 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 09:50:55,656 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 09:50:55,767 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 09:50:57,773 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 09:50:57,773 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 09:50:58,898 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 09:50:58,898 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 09:50:58,899 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:50:58,899 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 09:50:58,971 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:51:00,980 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 09:51:00,980 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 09:51:03,138 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 09:51:03,138 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 09:51:05,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 09:51:05,221 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 09:51:06,317 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:51:06,318 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 09:51:06,388 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:51:07,283 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 09:51:07,284 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 09:51:09,182 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 09:51:11,320 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 09:50:44.022 scrcpy[73813:3514663] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 54.0 MB/s (90640 bytes in 0.002s)
2025-03-19 09:50:44.887 scrcpy[73813:3514663] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 09:50:44.887 scrcpy[73813:3514663] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 09:51:05.940 scrcpy[73813:3514663] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 09:51:11,321 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 09:51:21,325 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095033.mp4 (大小: 1.53MB)
2025-03-19 09:51:21,325 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 09:51:21,537 - QuickAppADBTester - INFO - 录制文件完整，时长: 22.455544秒，无需修复
2025-03-19 09:51:21,537 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:51:22,674 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:51:27,931 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:51:27,933 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:51:30,104 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 09:51:30,104 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 09:51:30,105 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 09:51:30,105 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 09:51:30,105 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 09:50:33\n- 结束时间: 2025-03-19 09:51:30\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 09:51:30"}]}]}}
2025-03-19 09:51:30,736 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 09:56:40,836 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 09:56:40,931 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:56:41,072 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 09:56:41,333 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 09:56:41,334 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 09:56:41,334 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 09:56:43,552 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:43,765 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:56:43,767 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:56:45,184 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:56:45,185 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:56:46,418 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_095646.mp4
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:56:46,419 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:56:46,573 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:56:47,963 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:56:47,965 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:56:49,211 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:56:49,212 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:56:50,341 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:56:55,594 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:56:55,596 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 09:56:55,638 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 09:56:56,772 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4
2025-03-19 09:56:56,772 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 09:56:58,784 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 09:57:01,790 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 09:57:01,791 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 09:57:04,796 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 09:57:04,796 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 09:57:04,797 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 09:57:05,049 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 09:57:05,050 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 09:57:06,514 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:06,514 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:07,748 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:07,749 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:08,829 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 09:57:08,829 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 09:57:08,920 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 09:57:10,925 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 09:57:10,926 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 09:57:12,017 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:57:12,018 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 09:57:12,092 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:57:14,101 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 09:57:14,101 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 09:57:16,179 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 09:57:16,180 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 09:57:18,280 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 09:57:18,281 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 09:57:19,414 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 09:57:19,414 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 09:57:19,415 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 09:57:19,415 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 09:57:19,513 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 09:57:19,815 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 09:57:21,720 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 09:57:23,860 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 09:57:23,860 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 09:56:56.880 scrcpy[80193:3537006] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 180.2 MB/s (90640 bytes in 0.000s)
2025-03-19 09:56:57.557 scrcpy[80193:3537006] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 09:56:57.557 scrcpy[80193:3537006] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 09:57:18.274 scrcpy[80193:3537006] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 09:57:23,861 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 09:57:33,864 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4 (大小: 1.58MB)
2025-03-19 09:57:33,865 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 09:57:33,980 - QuickAppADBTester - INFO - 录制文件完整，时长: 22.249744秒，无需修复
2025-03-19 09:57:33,981 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 09:57:33,981 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_095646.mp4
2025-03-19 09:57:33,982 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 09:57:41,619 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_33.mp4
2025-03-19 09:57:41,625 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_33.mp4
2025-03-19 09:57:41,625 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 09:57:42,815 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 09:57:48,083 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 09:57:48,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 09:57:50,273 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 09:57:50,274 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 09:57:50,274 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 09:57:50,274 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 09:57:50,275 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 09:56:46\n- 结束时间: 2025-03-19 09:57:50\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 09:57:50"}]}]}}
2025-03-19 09:57:51,013 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:01:22,484 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:01:22,584 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:22,727 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:22,998 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:01:22,999 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:01:25,137 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:25,336 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:25,336 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:01:25,337 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:25,337 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:26,745 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:26,746 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:28,027 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100128.mp4
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:28,029 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:28,191 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:29,588 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:29,588 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:30,864 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:30,864 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:01:31,950 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:01:37,172 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:01:37,174 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:01:37,224 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:01:38,357 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4
2025-03-19 10:01:38,357 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:01:40,371 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:01:43,374 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:01:43,375 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:01:46,379 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:01:46,633 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:01:46,634 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:01:48,115 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:48,115 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:49,387 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:01:49,388 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:01:50,487 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:01:50,487 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:01:50,599 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:01:52,604 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:01:52,605 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:01:53,754 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:01:53,755 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:01:53,826 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:01:55,835 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:01:55,835 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:01:56,496 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:01:56,497 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:01:58,298 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:02:00,433 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:02:00,434 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:02:00,435 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:01:38.469 scrcpy[84982:3553737] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.9 MB/s (90640 bytes in 0.001s)
WARN: Device disconnected

2025-03-19 10:02:00,435 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:02:10,440 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4 (大小: 1.42MB)
2025-03-19 10:02:10,441 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 录制文件完整，时长: 17.299778秒，无需修复
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100128.mp4
2025-03-19 10:02:10,573 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:02:17,073 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:17,080 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:17,081 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:02:18,269 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:02:23,526 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:02:23,528 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4
2025-03-19 10:02:23,528 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:02:23,529 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:02:23\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_34.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:02:23"}]}]}}
2025-03-19 10:02:24,133 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:02:24,135 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:02:24,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:02:24,136 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:02:26,334 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:02:26,335 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:02:26,336 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:02:26,336 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 10:02:26,336 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:01:28\n- 结束时间: 2025-03-19 10:02:26\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:02:26"}]}]}}
2025-03-19 10:02:26,904 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:07:54,369 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:07:54,476 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:07:54,597 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:07:54,814 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:07:54,815 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:07:56,305 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:07:56,306 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:07:57,565 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:07:57,565 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100757.mp4
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:07:57,566 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:07:57,719 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:07:57,720 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:07:59,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:07:59,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:00,342 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:08:00,343 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:08:01,479 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:08:06,713 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:08:06,715 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:08:06,751 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:08:07,884 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4
2025-03-19 10:08:07,885 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:08:09,896 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:08:12,900 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:08:12,901 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:08:15,902 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:08:15,902 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:08:15,903 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:08:16,207 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:08:16,208 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:08:17,679 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:17,679 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:18,897 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:18,898 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:19,974 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:08:19,975 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:08:20,096 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:08:22,101 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:08:22,102 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:08:23,252 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:08:23,253 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:08:23,336 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:08:25,338 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:08:25,339 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:08:27,420 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:08:27,421 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:08:27,446 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:08:27,447 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:08:29,293 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:08:31,432 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:08:07.992 scrcpy[91768:3576905] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 134.1 MB/s (90640 bytes in 0.001s)
2025-03-19 10:08:08.729 scrcpy[91768:3576905] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:08:08.729 scrcpy[91768:3576905] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:08:31,433 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:08:41,439 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4 (大小: 1.49MB)
2025-03-19 10:08:41,439 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:08:41,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 18.504944秒，无需修复
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100757.mp4
2025-03-19 10:08:41,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:08:48,920 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:48,923 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:48,923 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:08:50,167 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:08:55,416 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:08:55,417 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4
2025-03-19 10:08:55,417 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:08:55,418 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:08:55\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_35.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:08:55"}]}]}}
2025-03-19 10:08:55,945 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:08:55,949 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:08:55,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:08:55,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:08:58,124 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:08:58,125 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:08:58,125 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:08:58,125 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-19 10:08:58,126 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：清除快应用中心数据失败、通过应用市场管理快应用失败、快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:07:57\n- 结束时间: 2025-03-19 10:08:58\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ❌ 失败\n3. 通过应用市场管理快应用: ❌ 失败\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:08:58"}]}]}}
2025-03-19 10:08:58,636 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:09:27,705 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:09:27,706 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:09:27,766 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:27,837 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:28,005 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:29,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:29,421 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:30,630 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:30,630 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_100930.mp4
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:30,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:30,815 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:30,816 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:32,219 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:32,220 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:33,435 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:33,435 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:09:34,572 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:09:39,842 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:09:39,843 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:09:39,878 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:09:41,062 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4
2025-03-19 10:09:41,062 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:09:43,071 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:09:46,075 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:09:46,075 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:09:49,079 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:09:49,309 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:09:49,310 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:09:50,775 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:50,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:09:52,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:09:53,139 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:09:53,139 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:09:53,264 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:09:55,265 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:09:55,265 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:09:56,339 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:09:56,340 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:09:56,341 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:09:56,341 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:09:56,422 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:09:58,426 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:09:58,426 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:10:00,601 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:10:00,602 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:10:02,729 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:10:02,730 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:10:03,876 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:10:03,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:10:04,026 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:10:06,033 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:10:06,034 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:10:08,194 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:10:08,195 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:10:09,620 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:10:11,100 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:10:11,100 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:10:12,257 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:10:12,258 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:10:13,353 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:10:13,354 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:10:15,526 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:10:15,527 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:10:16,169 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:10:16,700 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:10:16,700 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:10:16,821 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:10:21,826 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:10:21,827 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:10:23,969 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:10:23,970 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:10:29,123 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:10:29,124 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:10:31,293 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:10:36,299 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:10:36,300 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:10:37,476 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:10:37,476 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:10:37,477 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:10:37,477 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:10:37,573 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:10:39,578 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:10:39,579 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:10:39,579 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:10:41,843 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:10:41,844 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:10:46,283 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:10:50,032 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:10:50,033 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,310 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:10:50,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,588 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:10:50,589 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:50,819 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:10:50,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,067 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:10:51,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,287 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:10:51,288 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,509 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:10:51,510 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:51,763 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:10:51,763 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:52,009 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:10:52,009 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:52,283 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:10:52,284 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:10:54,518 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:10:54,520 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:10:54,520 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:10:54,640 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f336ba4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t324}
    * Task{47be4c2 #324 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:10:54,641 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101054_20250319_101054.png
2025-03-19 10:10:56,143 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:11:01,941 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg
2025-03-19 10:11:01,949 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg
2025-03-19 10:11:01,949 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:11:01,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:11:01,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:11:05,773 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:11:05,774 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:11:07,793 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:11:09,982 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:09:41.186 scrcpy[93340:3582202] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 139.6 MB/s (90640 bytes in 0.001s)
2025-03-19 10:09:41.924 scrcpy[93340:3582202] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:09:41.924 scrcpy[93340:3582202] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:11:09,983 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:11:19,989 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4 (大小: 9.13MB)
2025-03-19 10:11:19,991 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:11:20,154 - QuickAppADBTester - INFO - 录制文件完整，时长: 83.779578秒，无需修复
2025-03-19 10:11:20,154 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:11:20,155 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_100930.mp4
2025-03-19 10:11:20,155 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:11:28,422 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:28,429 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:28,429 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:11:29,570 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:11:34,821 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:11:34,822 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4
2025-03-19 10:11:34,822 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:11:34,823 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 测试被手动中断"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**华为快应用测试被手动中断**\n\n- 中断时间: 2025-03-19 10:11:34\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_37.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:11:34"}]}]}}
2025-03-19 10:11:35,363 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 测试被手动中断
2025-03-19 10:11:35,365 - QuickAppADBTester - INFO - 已发送中断通知，包含录制视频
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:11:35,366 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:11:37,480 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:11:37,481 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-19 10:11:37,481 - QuickAppADBTester - WARNING - 无法获取测试视频URL，可能是录制或上传失败
2025-03-19 10:11:37,481 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:11:37,482 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用防侧滑测试失败、快应用拉回测试失败、清空手机里的全部应用失败**\n\n- 开始时间: 2025-03-19 10:09:30\n- 结束时间: 2025-03-19 10:11:37\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ❌ 失败\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_36.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:11:37"}]}]}}
2025-03-19 10:11:38,004 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:16:28,839 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:16:29,031 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:16:29,139 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:29,140 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:29,342 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:16:29,343 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:16:31,519 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:31,691 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:31,692 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:33,116 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:33,117 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_101634.mp4
2025-03-19 10:16:34,334 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:34,335 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:34,511 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:34,512 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:35,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:35,916 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:37,178 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:37,178 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:16:38,370 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:16:43,612 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:16:43,614 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:16:43,662 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:16:44,845 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4
2025-03-19 10:16:44,846 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:16:46,858 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:16:49,862 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:16:49,862 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:16:52,867 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:16:52,868 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:16:52,868 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:16:53,184 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:16:53,185 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:16:54,659 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:54,660 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:55,870 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:16:55,871 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:16:56,961 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:16:56,961 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:16:57,085 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:16:59,098 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:16:59,098 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:17:00,311 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:00,312 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:17:00,393 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:02,401 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:17:02,401 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:17:04,478 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:17:04,480 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:17:06,581 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:17:06,582 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:17:07,722 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:17:07,722 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:17:07,728 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:07,733 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:17:07,820 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:09,826 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:17:09,826 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:17:11,993 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:17:11,995 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:17:13,417 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:17:14,865 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:17:14,866 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:17:16,009 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:17:16,009 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:17:17,105 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:17:17,106 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:17:19,284 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:17:19,285 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:17:19,967 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:17:20,441 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:17:20,442 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:17:20,555 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:17:25,557 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:17:25,557 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:17:27,706 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:17:27,706 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:17:32,860 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:17:32,861 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:17:35,000 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:17:40,002 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:17:40,004 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:17:41,116 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:17:41,195 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:17:43,199 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:17:45,459 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:17:45,460 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:17:50,055 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:17:53,582 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:17:53,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:53,914 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:17:53,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,164 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:17:54,165 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,407 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:17:54,407 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,659 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:17:54,659 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:54,878 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:17:54,879 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,099 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:17:55,100 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,357 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:17:55,358 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,579 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:17:55,580 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:55,823 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:17:55,824 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:17:58,054 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:17:58,055 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:17:58,055 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:17:58,168 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3ca8274 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t334}
    * Task{9cd6012 #334 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:17:58,169 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_101758_20250319_101758.png
2025-03-19 10:17:59,717 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:18:06,570 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:18:06,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:18:09,106 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:18:09,107 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:18:11,029 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:18:13,215 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:18:13,217 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:18:13,217 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:16:44.952 scrcpy[958:3608236] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 169.8 MB/s (90640 bytes in 0.001s)
2025-03-19 10:16:45.772 scrcpy[958:3608236] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:16:45.772 scrcpy[958:3608236] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:18:13,218 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:18:23,221 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4 (大小: 6.86MB)
2025-03-19 10:18:23,223 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 录制文件完整，时长: 83.310744秒，无需修复
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101634.mp4
2025-03-19 10:18:23,378 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:18:31,109 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:31,117 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:31,118 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:18:32,255 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:18:37,512 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:18:37,514 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:18:37,515 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:18:39,643 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4
2025-03-19 10:18:39,644 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-19 10:18:39,645 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:16:34\n- 中断时间: 2025-03-19 10:18:39\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_38.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_39.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:18:39"}]}]}}
2025-03-19 10:18:40,138 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:19:13,233 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:19:13,307 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:13,387 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:13,564 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:19:13,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:19:15,684 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:19:15,851 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:15,852 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:17,278 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:17,279 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:18,495 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_101918.mp4
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:18,496 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:18,667 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:18,668 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:20,084 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:20,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:21,268 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:21,269 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:19:22,406 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:19:27,642 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:19:27,643 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:19:27,681 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:19:28,820 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4
2025-03-19 10:19:28,821 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:19:30,828 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:19:33,834 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:19:33,835 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:19:36,837 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:19:36,838 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:19:36,838 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:19:37,014 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:19:37,015 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:19:38,427 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:38,428 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:39,629 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:19:39,629 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:19:39,630 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:19:40,719 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:19:40,719 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:19:40,844 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:19:42,848 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:19:42,848 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:19:43,107 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:19:44,907 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:19:46,992 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:19:46,993 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:19:46,994 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:19:28.914 scrcpy[3769:3618608] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 180.0 MB/s (90640 bytes in 0.000s)
2025-03-19 10:19:29.574 scrcpy[3769:3618608] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:19:29.574 scrcpy[3769:3618608] +[IMKInputSession subclass]: chose IMKInputSession_Modern
2025-03-19 10:19:40.385 scrcpy[3769:3618608] TSM AdjustCapsLockLEDForKeyTransitionHandling - _ISSetPhysicalKeyboardCapsLockLED Inhibit
WARN: Device disconnected

2025-03-19 10:19:46,994 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:19:56,998 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4 (大小: 1.08MB)
2025-03-19 10:19:56,999 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.577578秒，无需修复
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_101918.mp4
2025-03-19 10:19:57,147 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:20:03,302 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:03,306 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:03,306 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:20:04,448 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:20:09,693 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:20:09,694 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:20:09,695 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:20:09,695 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:20:11,830 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4
2025-03-19 10:20:11,832 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:20:11,833 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:19:18\n- 中断时间: 2025-03-19 10:20:11\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_40.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:20:11"}]}]}}
2025-03-19 10:20:12,406 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:25:38,468 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:25:38,535 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:25:38,615 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:25:38,820 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:25:38,821 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:25:39,404 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:25:39,404 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:25:57,409 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:25:57,486 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:25:57,546 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:25:57,688 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:25:59,082 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:25:59,083 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_102600.mp4
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:26:00,339 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:26:00,509 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:26:00,510 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:26:01,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:01,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:03,157 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:03,158 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:26:04,284 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:26:09,535 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:26:09,536 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:26:09,561 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:26:10,698 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4
2025-03-19 10:26:10,699 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:26:12,708 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:26:15,714 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:26:15,715 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:26:18,718 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:26:18,984 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:26:18,985 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:26:20,434 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:20,435 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:21,636 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:21,637 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:22,716 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:26:22,717 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:26:22,828 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:26:24,832 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:26:24,832 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:26:25,932 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:26:25,934 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:26:26,016 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:26:28,020 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:26:28,020 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:26:30,197 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:26:30,198 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:26:32,282 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:26:32,284 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:26:33,424 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:26:33,424 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:26:33,425 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:26:33,425 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:26:33,599 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:26:35,603 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:26:35,604 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:26:37,808 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:26:37,809 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:26:39,237 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:26:40,668 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:26:40,669 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:26:41,843 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:26:41,844 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:26:42,959 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:26:42,960 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:26:45,123 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:26:45,124 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:26:45,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:26:45,803 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:26:46,263 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:26:46,263 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:26:46,383 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:26:51,377 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:26:51,378 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:26:53,515 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:26:53,516 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:26:58,661 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:26:58,663 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:27:00,814 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:27:05,814 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:27:06,965 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:27:06,966 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:27:06,966 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:27:06,967 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:27:07,069 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:27:09,077 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:27:09,078 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:27:09,078 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:27:11,346 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:27:11,346 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:27:15,884 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:27:19,493 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:27:19,493 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:27:19,494 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:27:19,494 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:19,776 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:27:19,777 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,100 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:27:20,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,342 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:27:20,343 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,603 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:27:20,604 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:20,838 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:27:20,839 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,070 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:27:21,071 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,318 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:27:21,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,565 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:27:21,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:21,808 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:27:21,809 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:27:24,046 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:27:24,047 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:27:24,047 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:27:24,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f53a7c7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t346}
    * Task{a079d1d #346 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:27:24,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,863 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,864 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_102724_20250319_102724.png
2025-03-19 10:27:25,865 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:27:32,930 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:32,935 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:43,031 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:27:43,032 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:27:43,032 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:27:43,168 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f53a7c7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t346}
    * Task{a079d1d #346 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:27:43,168 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:27:43,169 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,854 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,855 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_102743_20250319_102743.png
2025-03-19 10:27:44,855 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:27:45,990 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-19 10:27:50,826 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg
2025-03-19 10:27:50,834 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:27:50,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:27:51,230 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:27:52,234 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:27:52,235 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:52,235 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:27:53,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:27:55,436 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:27:55,436 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:27:56,557 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:27:56,558 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:56,558 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:27:57,672 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:27:57,675 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:27:57,675 - QuickAppADBTester - INFO - 测试完成，按Home键回到桌面...
2025-03-19 10:27:57,676 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:27:57,676 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:28:02,807 - QuickAppADBTester - INFO - 测试完成，最后回到桌面...
2025-03-19 10:28:02,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:28:02,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:28:04,993 - QuickAppADBTester - INFO - 测试完成，停止scrcpy录制...
2025-03-19 10:28:04,994 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:28:04,994 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:28:06,946 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:28:09,077 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:28:09,078 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:28:09,078 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:28:10,081 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:28:11,087 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:28:12,088 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时4秒
2025-03-19 10:28:12,089 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 10:28:12,089 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:26:10.805 scrcpy[10339:3641503] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.1 MB/s (90640 bytes in 0.000s)
2025-03-19 10:26:11.547 scrcpy[10339:3641503] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:26:11.547 scrcpy[10339:3641503] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:28:12,090 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:28:22,092 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4 (大小: 10.87MB)
2025-03-19 10:28:22,094 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 录制文件完整，时长: 119.878189秒，无需修复
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_102600.mp4
2025-03-19 10:28:22,212 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:28:30,765 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:30,771 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:30,772 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:28:32,019 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:28:37,268 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:28:37,270 - QuickAppADBTester - INFO - 测试视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4
2025-03-19 10:28:37,270 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:28:37,271 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:26:00\n- 结束时间: 2025-03-19 10:28:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_41.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_42.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_43.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:28:37"}]}]}}
2025-03-19 10:28:37,706 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:28:37,709 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:28:37,710 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 10:33:38,696 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:33:38,697 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:33:38,698 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:33:38,698 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:33:38,843 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:33:39,022 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:33:39,023 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:33:39,023 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:33:39,024 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:33:39,288 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:33:41,484 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:41,685 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:33:41,686 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:33:43,128 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:33:43,128 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:33:44,344 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 开始使用scrcpy录制测试流程视频: test_flow_20250319_103344.mp4
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:33:44,345 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:33:44,529 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:33:45,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:33:45,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:33:47,199 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:33:47,200 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:33:48,334 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:33:53,581 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:33:53,582 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:33:53,633 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:33:54,824 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4
2025-03-19 10:33:54,824 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:33:56,835 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:33:59,839 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:33:59,840 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:34:00,443 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:34:00,444 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:34:02,402 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:34:04,533 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:34:04,534 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:33:54.921 scrcpy[18914:3671186] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 165.8 MB/s (90640 bytes in 0.001s)
2025-03-19 10:33:55.636 scrcpy[18914:3671186] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:33:55.636 scrcpy[18914:3671186] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:34:04,534 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:34:14,537 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4 (大小: 0.36MB)
2025-03-19 10:34:14,537 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 录制文件完整，时长: 4.780800秒，无需修复
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103344.mp4
2025-03-19 10:34:14,650 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:34:23,475 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-19 10:34:23,494 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 229, in upload_to_telegram
    file_path_response = requests.get(file_path_url)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/getFile?file_id=BAACAgUAAyEGAASVT2f4AAM6Z9otKm8Nbq30Siek3raz-2SUi7EAAqQUAAJ2DNhW7o1VejLuNYY2BA (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-19 10:34:23,497 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-19 10:34:23,497 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:34:24,738 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:34:29,972 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:34:29,973 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:34:29,973 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:36:55,641 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:36:55,739 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:36:55,887 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:36:55,887 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:36:55,888 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:36:55,888 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 屏幕状态为熄屏 (mHoldingDisplaySuspendBlocker=false)
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-19 10:36:56,154 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-19 10:36:56,155 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-19 10:36:56,155 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-19 10:36:58,356 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:36:58,544 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:36:58,545 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:36:59,962 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:36:59,963 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:37:01,178 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:37:01,327 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:37:01,327 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:37:01,328 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:37:01,328 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:37:02,722 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:02,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:03,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:05,063 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:37:05,065 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:37:05,171 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:37:07,176 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:37:07,177 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:37:08,258 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:37:08,259 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:37:08,260 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:37:08,260 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:37:08,334 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:37:10,344 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:37:10,344 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:37:12,498 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:37:12,499 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:37:14,578 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:37:14,579 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:37:15,681 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:37:15,682 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:37:15,750 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:37:17,758 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:37:17,759 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:37:19,928 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:37:19,929 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:37:21,333 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:37:22,787 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:37:22,788 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:37:23,960 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:37:23,961 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:37:25,064 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:37:25,065 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:37:27,265 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:37:27,266 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:37:28,410 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:37:28,411 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:37:28,531 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:37:33,532 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:37:33,533 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:37:35,652 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:37:35,653 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:37:40,809 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:37:40,810 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:37:42,982 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:37:47,988 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:37:47,988 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_103747.mp4
2025-03-19 10:37:47,989 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:37:49,179 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:37:54,432 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:37:54,432 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:37:54,461 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:37:55,595 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4
2025-03-19 10:37:55,596 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:37:57,609 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:38:00,618 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:38:00,620 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:38:03,625 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:38:03,625 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:38:03,626 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:38:04,833 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:38:04,834 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:38:04,945 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:38:06,954 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:38:06,956 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:38:06,956 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:38:09,039 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:38:09,039 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:38:10,951 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:38:10,951 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:38:10,952 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:38:10,952 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:38:12,865 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:38:15,005 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:38:15,006 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:38:15,007 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:37:55.705 scrcpy[23091:3685280] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 167.0 MB/s (90640 bytes in 0.001s)
2025-03-19 10:37:56.417 scrcpy[23091:3685280] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:37:56.417 scrcpy[23091:3685280] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:38:15,007 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:38:25,012 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4 (大小: 0.86MB)
2025-03-19 10:38:25,013 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.805856秒，无需修复
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103747.mp4
2025-03-19 10:38:25,109 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:38:31,818 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:31,824 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:31,825 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:38:32,963 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:38:38,213 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:38:38,214 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:38,214 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4
2025-03-19 10:38:38,215 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:38:38,216 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:37:01\n- 中断时间: 2025-03-19 10:38:38\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_44.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:38:38"}]}]}}
2025-03-19 10:38:38,980 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:39:07,017 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:39:07,018 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:39:07,113 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:39:07,259 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:39:07,260 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:39:07,497 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:39:07,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:39:08,954 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:08,955 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:10,219 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:39:10,220 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:39:10,384 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:39:10,385 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:39:11,795 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:11,796 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:13,077 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:13,078 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:14,214 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:39:14,215 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:39:14,342 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:39:16,343 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:39:16,344 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:39:17,430 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:39:17,431 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:39:17,509 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:39:19,519 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:39:19,520 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:39:21,709 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:39:21,713 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:39:23,818 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:39:23,819 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:39:24,966 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:39:24,967 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:39:24,967 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:39:24,968 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:39:25,134 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:39:27,138 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:39:27,138 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:39:29,356 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:39:29,358 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:39:30,767 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:39:32,251 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:39:32,252 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:39:33,412 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:39:33,412 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:39:34,521 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:39:34,522 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:39:36,726 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:39:36,727 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:39:36,728 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:39:37,878 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:39:37,879 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:39:37,991 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:39:42,997 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:39:42,999 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:39:45,139 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:39:45,140 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:39:50,281 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:39:50,282 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:39:52,430 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:39:57,435 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:39:57,436 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_103957.mp4
2025-03-19 10:39:57,436 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:39:58,620 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:40:03,858 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:40:03,858 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:40:03,898 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:40:05,087 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4
2025-03-19 10:40:05,088 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:40:07,101 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:40:10,108 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:40:10,108 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:40:13,108 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:40:13,110 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:40:13,110 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:40:14,307 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:40:14,308 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:40:14,363 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:40:15,157 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:40:16,907 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:40:18,989 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时1秒
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 2
2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:40:05.193 scrcpy[25234:3692907] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 202.1 MB/s (90640 bytes in 0.000s)
2025-03-19 10:40:05.910 scrcpy[25234:3692907] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:40:05.910 scrcpy[25234:3692907] +[IMKInputSession subclass]: chose IMKInputSession_Modern
WARN: Device disconnected

2025-03-19 10:40:18,990 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:40:28,996 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4 (大小: 0.80MB)
2025-03-19 10:40:28,998 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 录制文件完整，时长: 9.178711秒，无需修复
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_103957.mp4
2025-03-19 10:40:29,132 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:40:35,055 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:35,059 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:35,059 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:40:36,250 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:40:41,494 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:40:41,495 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:41,495 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4
2025-03-19 10:40:41,496 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 10:40:41,497 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:39:10\n- 中断时间: 2025-03-19 10:40:41\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_45.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:40:41"}]}]}}
2025-03-19 10:40:42,042 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:44:25,524 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:44:25,624 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:44:25,775 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:44:25,775 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:44:25,776 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:44:25,776 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:44:26,016 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:44:27,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:27,429 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:28,692 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:44:28,692 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:44:28,693 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:44:28,855 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:44:28,856 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:44:30,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:30,271 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:31,519 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:32,611 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:44:32,612 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:44:32,730 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:44:34,735 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:44:34,736 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:44:35,831 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:44:35,831 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:44:35,832 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:44:35,832 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:44:35,914 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:44:37,923 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:44:37,923 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:44:40,100 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:44:40,100 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:44:42,199 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:44:42,200 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:44:43,321 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:44:43,322 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:44:43,323 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:44:43,323 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:44:43,473 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:44:45,481 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:44:45,481 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:44:47,678 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:44:47,679 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:44:49,103 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:44:50,601 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:44:50,602 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:44:51,796 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:44:51,797 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:44:52,910 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:44:52,911 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:44:55,095 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:44:55,096 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:44:55,096 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:44:55,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:44:55,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:44:56,242 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:44:56,243 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:44:56,365 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:45:01,369 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:45:01,371 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:45:03,516 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:45:03,517 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:45:08,664 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:45:08,666 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:45:10,831 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:45:15,836 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:45:15,837 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_104515.mp4
2025-03-19 10:45:15,837 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:45:15,838 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:45:21,081 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:45:21,084 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:45:21,123 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:45:22,315 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4
2025-03-19 10:45:22,316 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:45:24,326 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:45:27,331 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:45:27,331 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:45:30,332 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:45:30,333 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:45:30,333 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:45:31,503 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:45:31,504 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:45:31,602 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:45:33,610 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:45:33,611 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:45:33,611 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:45:35,919 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:45:35,920 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:45:44,124 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:45:44,125 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,436 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:45:44,437 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,708 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:45:44,709 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:44,934 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:45:44,935 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,175 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:45:45,175 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,400 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:45:45,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,614 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:45:45,615 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:45,836 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:45:45,837 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:46,101 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:45:46,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:46,319 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:45:46,320 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:45:48,558 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:45:48,558 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:45:48,559 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76469ff u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t359}
    * Task{52cf615 #359 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:45:48,674 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:45:48,675 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,387 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,387 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_104548_20250319_104548.png
2025-03-19 10:45:50,388 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:45:57,356 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:45:57,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:45:57,419 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:46:07,533 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:46:07,534 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:46:07,535 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76469ff u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t359}
    * Task{52cf615 #359 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:46:07,681 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_104607_20250319_104607.png
2025-03-19 10:46:09,286 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:46:13,998 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:46:14,004 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:46:14,005 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:46:16,141 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:46:16,141 - QuickAppADBTester - INFO - 发送HOME键序列
2025-03-19 10:46:18,001 - QuickAppADBTester - INFO - 让设备屏幕休眠
2025-03-19 10:46:20,136 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:46:20,137 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:46:20,137 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:46:21,140 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:46:22,141 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:46:23,145 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:46:24,150 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:46:25,155 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:46:26,160 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:46:27,165 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:46:27,534 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:46:28,167 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:46:29,170 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:46:30,170 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:46:31,176 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:46:32,178 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:46:33,184 - QuickAppADBTester - INFO - 等待进程退出... (14/15)
2025-03-19 10:46:34,189 - QuickAppADBTester - INFO - 等待进程退出... (15/15)
2025-03-19 10:46:35,191 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 10:46:35,191 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 10:46:37,331 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 10:46:39,463 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 10:46:41,598 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 10:46:41,598 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 10:46:42,603 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 10:46:43,609 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 10:46:44,614 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 10:46:45,618 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 10:46:46,621 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 10:46:47,625 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 10:46:48,629 - QuickAppADBTester - INFO - 等待SIGTERM生效... (8/10)
2025-03-19 10:46:49,633 - QuickAppADBTester - INFO - 等待SIGTERM生效... (9/10)
2025-03-19 10:46:50,636 - QuickAppADBTester - INFO - 等待SIGTERM生效... (10/10)
2025-03-19 10:46:51,642 - QuickAppADBTester - WARNING - 所有温和的尝试都失败，不得不使用SIGKILL强制终止进程
2025-03-19 10:46:51,643 - QuickAppADBTester - WARNING - 这可能导致录制文件损坏(moov atom丢失)，录制可能无法播放
2025-03-19 10:46:53,644 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-19 10:46:53,645 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:45:22.417 scrcpy[30753:3713110] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 172.7 MB/s (90640 bytes in 0.001s)
2025-03-19 10:45:23.150 scrcpy[30753:3713110] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:45:23.150 scrcpy[30753:3713110] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:46:53,645 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:47:03,648 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4 (大小: 5.50MB)
2025-03-19 10:47:03,649 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:47:03,800 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12c904400] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4: Invalid data found when processing input

2025-03-19 10:47:03,855 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-19 10:47:03,855 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-19 10:47:03,898 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x13a804400] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4: Invalid data found when processing input

2025-03-19 10:47:03,898 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-19 10:47:03,964 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x144904080] moov atom not found
[in#0 @ 0x600003c60000] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4.
Error opening input files: Invalid data found when processing input

2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_104515.mp4
2025-03-19 10:47:03,964 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:47:11,464 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:11,472 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:11,473 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:47:11,473 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:47:16,699 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:47:16,700 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4
2025-03-19 10:47:16,701 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:47:16,701 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:47:16,702 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:47:17,089 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:47:18,092 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:47:18,092 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:47:18,093 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:47:19,306 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:47:19,307 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:47:19,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:47:21,493 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:47:21,494 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:47:22,673 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:47:22,674 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:47:22,674 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:47:23,105 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:47:23,106 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 10:44:28\n- 中断时间: 2025-03-19 10:47:23\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_46.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_47.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:47:23"}]}]}}
2025-03-19 10:47:23,640 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 10:49:59,394 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:49:59,395 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:49:59,464 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:49:59,539 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:49:59,540 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:49:59,727 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:49:59,728 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:50:01,191 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:01,191 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:50:02,434 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:50:02,435 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:50:02,435 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:50:02,595 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:50:02,596 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:50:03,996 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:03,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:05,310 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:05,311 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:06,412 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:50:06,413 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:50:06,544 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:50:08,548 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:50:08,548 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:50:09,632 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:50:09,633 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:50:09,717 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:50:11,726 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:50:11,726 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:50:13,895 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:50:13,896 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:50:15,985 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:50:15,986 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:50:17,093 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:50:17,094 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:50:17,172 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:50:19,178 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:50:19,178 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:50:21,313 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:50:21,314 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:50:22,718 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:50:24,193 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:50:24,194 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:50:25,387 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:50:25,387 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:50:26,480 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:50:26,480 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:50:28,669 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:50:28,670 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:50:28,671 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:50:29,808 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:50:29,808 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:50:29,922 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:50:34,924 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:50:34,925 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:50:37,032 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:50:37,034 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:50:42,169 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:50:42,171 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:50:44,374 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:50:49,380 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_105049.mp4
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:50:49,382 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:50:54,629 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:50:54,630 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:50:54,669 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:50:55,855 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4
2025-03-19 10:50:55,856 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:50:57,864 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:51:00,872 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:51:00,872 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:51:03,875 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:51:03,876 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:51:03,876 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:51:05,051 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:51:05,052 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:51:05,053 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:51:05,053 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:51:05,146 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:51:07,154 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:51:07,155 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:51:07,155 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:51:09,425 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:51:09,426 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:51:17,615 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:51:17,617 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:17,909 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:51:17,911 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,161 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:51:18,161 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,391 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:51:18,392 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,611 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:51:18,612 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:18,828 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:51:18,829 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,065 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:51:19,065 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,296 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:51:19,296 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,511 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:51:19,512 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:19,736 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:51:19,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:51:21,953 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:51:21,954 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:51:21,954 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eceabe8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t371}
    * Task{5aa12e7 #371 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:51:22,086 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:51:22,087 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105122_20250319_105122.png
2025-03-19 10:51:23,438 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:51:28,906 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:51:28,912 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:51:28,913 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:51:30,974 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:51:39,028 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:51:39,029 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:51:39,030 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:51:39,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eceabe8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t371}
    * Task{5aa12e7 #371 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:51:39,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105139_20250319_105139.png
2025-03-19 10:51:40,570 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:51:45,199 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:51:45,205 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:51:45,206 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:51:47,347 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:51:47,348 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:51:48,352 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:51:49,357 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:51:50,359 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:51:51,359 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:51:52,365 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:51:53,368 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:51:54,372 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:51:55,378 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:51:56,381 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:51:57,384 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:51:58,389 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:51:59,392 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:52:00,400 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时14秒
2025-03-19 10:52:00,422 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 10:52:00,422 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:50:55.958 scrcpy[36257:3732607] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.7 MB/s (90640 bytes in 0.000s)
2025-03-19 10:50:56.662 scrcpy[36257:3732607] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:50:56.662 scrcpy[36257:3732607] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:52:00,423 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:52:10,432 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4 (大小: 3.60MB)
2025-03-19 10:52:10,433 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 63.547256秒，无需修复
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:52:10,547 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105049.mp4
2025-03-19 10:52:10,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:52:17,447 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:17,455 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:17,456 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:52:17,456 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:52:22,723 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:52:22,724 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:52:22,725 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:52:23,131 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:52:24,136 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:52:24,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:24,137 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:25,321 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:52:25,322 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:52:25,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:52:27,510 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:52:27,511 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:52:28,705 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:52:28,705 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:28,706 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:29,897 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:52:29,898 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:50:02\n- 结束时间: 2025-03-19 10:52:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_48.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_49.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:52:29"}]}]}}
2025-03-19 10:52:30,856 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:52:30,860 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:52:30,860 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 10:52:50,695 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 10:52:50,696 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 10:52:50,696 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 10:52:55,889 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 10:52:55,889 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 10:52:55,890 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 10:52:55,960 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:52:56,042 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:52:56,187 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:52:57,636 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:52:57,636 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 10:52:58,892 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 10:52:59,048 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 10:52:59,049 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 10:53:00,458 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:00,459 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:01,693 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:02,786 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 10:53:02,786 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 10:53:02,901 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 10:53:04,907 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 10:53:04,908 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 10:53:05,991 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 10:53:05,992 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 10:53:05,992 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:53:05,993 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 10:53:06,070 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:53:08,076 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 10:53:08,077 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 10:53:10,256 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 10:53:10,256 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 10:53:12,330 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 10:53:12,331 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 10:53:13,436 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 10:53:13,436 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 10:53:13,437 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:53:13,437 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 10:53:13,519 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:53:15,529 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 10:53:15,530 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 10:53:17,693 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 10:53:17,694 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 10:53:19,109 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 10:53:20,553 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 10:53:20,554 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 10:53:21,694 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 10:53:21,695 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 10:53:22,791 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 10:53:22,791 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 10:53:24,970 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:53:24,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:53:26,151 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 10:53:26,151 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 10:53:26,260 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 10:53:31,266 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 10:53:31,267 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 10:53:33,451 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 10:53:33,452 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 10:53:38,612 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 10:53:38,613 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 10:53:40,770 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 10:53:45,776 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 10:53:45,777 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_105345.mp4
2025-03-19 10:53:45,777 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:53:45,778 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:53:51,013 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:53:51,014 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 10:53:51,060 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 10:53:52,245 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4
2025-03-19 10:53:52,246 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 10:53:54,257 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 10:53:57,261 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 10:53:57,261 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 10:54:00,267 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 10:54:01,432 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 10:54:01,433 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 10:54:01,524 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 10:54:03,534 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 10:54:05,804 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 10:54:05,804 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 10:54:14,003 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 10:54:14,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,286 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 10:54:14,287 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,513 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 10:54:14,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,733 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 10:54:14,733 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:14,943 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 10:54:14,944 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,178 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 10:54:15,179 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,433 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 10:54:15,433 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,679 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 10:54:15,680 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:15,931 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 10:54:15,932 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:16,152 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 10:54:16,153 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 10:54:18,393 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 10:54:18,394 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:54:18,394 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:54:18,518 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ea08245 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t383}
    * Task{9dbeea8 #383 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 10:54:18,519 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,290 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,291 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_105418_20250319_105418.png
2025-03-19 10:54:20,291 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:54:26,125 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg
2025-03-19 10:54:26,131 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:54:26,132 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:54:27,358 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 10:54:36,306 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 10:54:36,306 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 10:54:36,307 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ea08245 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t383}
    * Task{9dbeea8 #383 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 10:54:36,388 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_105436_20250319_105436.png
2025-03-19 10:54:38,213 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 10:54:44,201 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 10:54:44,208 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 10:54:44,209 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:54:44,209 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:54:46,401 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-15秒...
2025-03-19 10:54:46,402 - QuickAppADBTester - INFO - 等待进程退出... (1/15)
2025-03-19 10:54:47,407 - QuickAppADBTester - INFO - 等待进程退出... (2/15)
2025-03-19 10:54:48,413 - QuickAppADBTester - INFO - 等待进程退出... (3/15)
2025-03-19 10:54:49,414 - QuickAppADBTester - INFO - 等待进程退出... (4/15)
2025-03-19 10:54:50,415 - QuickAppADBTester - INFO - 等待进程退出... (5/15)
2025-03-19 10:54:51,421 - QuickAppADBTester - INFO - 等待进程退出... (6/15)
2025-03-19 10:54:52,426 - QuickAppADBTester - INFO - 等待进程退出... (7/15)
2025-03-19 10:54:53,431 - QuickAppADBTester - INFO - 等待进程退出... (8/15)
2025-03-19 10:54:54,434 - QuickAppADBTester - INFO - 等待进程退出... (9/15)
2025-03-19 10:54:55,439 - QuickAppADBTester - INFO - 等待进程退出... (10/15)
2025-03-19 10:54:56,441 - QuickAppADBTester - INFO - 等待进程退出... (11/15)
2025-03-19 10:54:57,445 - QuickAppADBTester - INFO - 等待进程退出... (12/15)
2025-03-19 10:54:57,464 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 10:54:58,452 - QuickAppADBTester - INFO - 等待进程退出... (13/15)
2025-03-19 10:54:59,455 - QuickAppADBTester - INFO - 等待进程退出... (14/15)
2025-03-19 10:55:00,459 - QuickAppADBTester - INFO - 等待进程退出... (15/15)
2025-03-19 10:55:01,462 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 10:55:01,463 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 10:55:03,652 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 10:55:05,839 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 10:55:08,023 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 10:55:08,024 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 10:55:09,030 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 10:55:10,031 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 10:55:11,035 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 10:55:12,041 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 10:55:13,045 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 10:55:14,046 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 10:55:15,052 - QuickAppADBTester - INFO - 等待SIGTERM生效... (8/10)
2025-03-19 10:55:16,057 - QuickAppADBTester - INFO - 等待SIGTERM生效... (9/10)
2025-03-19 10:55:17,058 - QuickAppADBTester - INFO - 等待SIGTERM生效... (10/10)
2025-03-19 10:55:18,063 - QuickAppADBTester - WARNING - 所有温和的尝试都失败，不得不使用SIGKILL强制终止进程
2025-03-19 10:55:18,064 - QuickAppADBTester - WARNING - 这可能导致录制文件损坏(moov atom丢失)，录制可能无法播放
2025-03-19 10:55:20,064 - QuickAppADBTester - INFO - 录制进程已退出，退出码: -9
2025-03-19 10:55:20,066 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 10:53:52.361 scrcpy[39176:3743368] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 178.4 MB/s (90640 bytes in 0.000s)
2025-03-19 10:53:53.063 scrcpy[39176:3743368] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 10:53:53.063 scrcpy[39176:3743368] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 10:55:20,066 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 10:55:30,067 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4 (大小: 3.75MB)
2025-03-19 10:55:30,068 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 10:55:30,204 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x12fe06ab0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4: Invalid data found when processing input

2025-03-19 10:55:30,245 - QuickAppADBTester - INFO - 检测到ffmpeg: ffmpeg version 7.1.1 Copyright (c) 2000-2025 the FFmpeg developers
2025-03-19 10:55:30,245 - QuickAppADBTester - INFO - 使用ffmpeg分析文件
2025-03-19 10:55:30,282 - QuickAppADBTester - WARNING - 文件可能损坏: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06af0] moov atom not found
/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4: Invalid data found when processing input

2025-03-19 10:55:30,282 - QuickAppADBTester - INFO - 尝试重编码修复文件
2025-03-19 10:55:30,327 - QuickAppADBTester - ERROR - 修复失败: [mov,mp4,m4a,3gp,3g2,mj2 @ 0x138e06b50] moov atom not found
[in#0 @ 0x6000020cc400] Error opening input: Invalid data found when processing input
Error opening input file /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4.
Error opening input files: Invalid data found when processing input

2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_105345.mp4
2025-03-19 10:55:30,327 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 10:55:37,016 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:37,023 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:37,023 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 10:55:37,024 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 10:55:42,281 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 10:55:42,282 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 10:55:42,673 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 10:55:43,677 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 10:55:43,678 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:55:43,678 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:55:44,872 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 10:55:44,873 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 10:55:44,873 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 10:55:47,068 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 10:55:47,069 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 10:55:48,261 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 10:55:48,262 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 10:55:48,262 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 10:55:49,438 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 10:55:49,439 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 10:55:49,440 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 10:55:49,440 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 10:52:58\n- 结束时间: 2025-03-19 10:55:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_50.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_51.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_52.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 10:55:49"}]}]}}
2025-03-19 10:55:49,917 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 10:55:49,921 - QuickAppADBTester - INFO - 测试完成
2025-03-19 10:55:49,921 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:13:39,266 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:13:39,268 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:13:39,268 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:13:40,666 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:13:40,768 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:13:40,929 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:13:40,930 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:13:40,931 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:13:40,931 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:13:41,180 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:13:42,636 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:42,637 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:43,890 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:13:43,891 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:13:44,064 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:13:44,065 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:13:45,469 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:45,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:13:46,712 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:13:47,794 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:13:47,794 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:13:47,908 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:13:49,914 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:13:49,915 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:13:51,004 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:13:51,005 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:13:51,007 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:13:51,007 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:13:51,090 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:13:53,099 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:13:53,100 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:13:55,279 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:13:55,280 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:13:57,368 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:13:57,369 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:13:58,467 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:13:58,468 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:13:58,539 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:14:00,549 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:14:00,550 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:14:02,784 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:14:02,785 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:14:04,202 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:14:05,665 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:14:05,666 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:14:06,871 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:14:06,872 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:14:07,988 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:14:07,989 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:14:10,170 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:14:10,171 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:14:10,172 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:14:11,336 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:14:11,337 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:14:11,447 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:14:16,451 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:14:16,452 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:14:18,649 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:14:18,650 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:14:23,850 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:14:23,852 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:14:26,006 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:14:31,011 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:14:31,012 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_111431.mp4
2025-03-19 11:14:31,012 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:14:31,014 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:14:36,291 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:14:36,292 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:14:36,342 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:14:37,523 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4
2025-03-19 11:14:37,524 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 11:14:39,533 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:14:42,540 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:14:42,541 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:14:45,543 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:14:45,544 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:14:45,544 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:14:46,728 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:14:46,729 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:14:46,845 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:14:48,848 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:14:48,848 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:14:48,849 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:14:51,126 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:14:51,126 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:14:59,311 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:14:59,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:14:59,615 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:14:59,616 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:14:59,888 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:14:59,889 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,144 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:15:00,144 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,396 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:15:00,397 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,629 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:15:00,630 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:00,876 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:15:00,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,110 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:15:01,111 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,337 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:15:01,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:01,569 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:15:01,570 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:15:03,799 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:15:03,800 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:15:03,801 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:15:03,918 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{72ada14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t395}
    * Task{c3b0803 #395 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:15:03,919 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,701 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,702 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111503_20250319_111503.png
2025-03-19 11:15:05,703 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:15:12,647 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:15:20,215 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:20,220 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:15:20,221 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:15:30,381 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:15:30,382 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:15:30,383 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:15:30,515 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{72ada14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t395}
    * Task{c3b0803 #395 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:15:30,516 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,321 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,321 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111530_20250319_111530.png
2025-03-19 11:15:32,325 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:15:37,140 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:15:37,148 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:15:39,340 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:15:39,341 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:15:40,346 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:15:41,348 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:15:42,352 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:15:42,746 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:15:43,357 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:15:44,362 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:15:45,366 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:15:46,367 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:15:47,373 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:15:48,378 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:15:49,381 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:15:50,384 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:15:51,385 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:15:52,387 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:15:53,391 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:15:54,394 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:15:55,398 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:15:56,402 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:15:57,402 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:15:58,407 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:15:59,412 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:16:00,416 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:16:01,439 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时23秒
2025-03-19 11:16:01,440 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:16:01,441 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:14:37.642 scrcpy[59095:3807605] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 32.3 MB/s (90640 bytes in 0.003s)
2025-03-19 11:16:00.462 scrcpy[59095:3807605] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:16:00.462 scrcpy[59095:3807605] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:16:01,441 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:16:11,446 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4 (大小: 4.10MB)
2025-03-19 11:16:11,447 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 录制文件完整，时长: 82.114144秒，无需修复
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111431.mp4
2025-03-19 11:16:11,565 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:16:18,568 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:16:18,570 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:16:23,833 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:16:23,834 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:16:23,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:16:24,211 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:25,217 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:26,416 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:16:26,417 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:16:26,417 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:16:27,840 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 11:13:43\n- 中断时间: 2025-03-19 11:16:27\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_53.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_54.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:16:27"}]}]}}
2025-03-19 11:16:28,412 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:16:34,981 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:16:35,053 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:16:35,157 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:16:35,158 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:16:35,354 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:16:35,355 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:16:36,789 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:36,790 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:38,039 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:16:38,040 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:16:38,209 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:16:38,210 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:16:39,602 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:39,602 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:40,896 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:16:40,897 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:16:41,984 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:16:41,985 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:16:42,114 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:16:44,118 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:16:44,118 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:16:45,276 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:16:45,276 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:16:45,277 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:16:45,277 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:16:45,357 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:16:47,366 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:16:47,367 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:16:49,456 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:16:49,458 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:16:51,560 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:16:51,561 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:16:52,724 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:16:52,725 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:16:52,856 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:16:54,861 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:16:54,862 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:16:57,082 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:16:57,083 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:16:58,498 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:16:59,974 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:16:59,975 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:17:01,182 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:17:01,183 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:17:02,286 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:17:02,287 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:17:04,472 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:17:04,473 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:17:05,636 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:17:05,636 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:17:05,763 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:17:10,769 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:17:10,771 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:17:12,937 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:17:12,937 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:17:18,071 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:17:18,072 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:17:20,255 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:17:25,259 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_111725.mp4
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:17:25,260 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:17:30,537 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:17:30,539 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:17:30,584 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:17:31,774 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4
2025-03-19 11:17:31,775 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --power-off-on-close --no-audio
2025-03-19 11:17:33,789 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:17:36,796 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:17:36,796 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:17:39,800 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:17:39,802 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:17:39,802 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:17:40,974 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:17:40,975 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:17:41,071 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:17:43,079 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:17:43,080 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:17:43,080 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:17:45,343 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:17:45,343 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:17:53,548 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:17:53,550 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:53,817 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:17:53,818 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,053 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:17:54,053 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,305 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:17:54,305 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,530 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:17:54,532 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:54,773 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:17:54,774 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,023 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:17:55,023 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,252 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:17:55,253 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,486 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:17:55,487 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:55,744 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:17:55,745 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:17:57,996 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:17:57,997 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:17:57,998 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:17:58,122 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1ebed33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t405}
    * Task{a970e69 #405 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:17:58,123 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,993 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,995 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_111758_20250319_111758.png
2025-03-19 11:17:59,995 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:18:06,071 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:06,076 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:18:06,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:18:06,894 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:18:16,213 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:18:16,215 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:18:16,216 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:18:16,398 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1ebed33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t405}
    * Task{a970e69 #405 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:18:16,399 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,284 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,284 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_111816_20250319_111816.png
2025-03-19 11:18:18,285 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:18:23,241 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:18:23,243 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:18:25,392 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:18:25,393 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:18:25,394 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:18:25,394 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:18:26,398 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:18:27,404 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:18:28,409 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:18:29,413 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:18:30,416 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:18:31,421 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:18:32,425 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:18:33,431 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:18:34,437 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:18:35,438 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:18:36,443 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:18:36,988 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:18:37,447 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:18:38,450 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:18:39,453 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:18:40,455 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:18:41,460 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:18:42,467 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:18:43,471 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:18:44,474 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:18:45,476 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:18:46,478 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:18:47,479 - QuickAppADBTester - INFO - 等待进程退出... (23/30)
2025-03-19 11:18:48,484 - QuickAppADBTester - INFO - 等待进程退出... (24/30)
2025-03-19 11:18:49,487 - QuickAppADBTester - INFO - 等待进程退出... (25/30)
2025-03-19 11:18:50,492 - QuickAppADBTester - INFO - 等待进程退出... (26/30)
2025-03-19 11:18:51,495 - QuickAppADBTester - INFO - 等待进程退出... (27/30)
2025-03-19 11:18:52,500 - QuickAppADBTester - INFO - 等待进程退出... (28/30)
2025-03-19 11:18:53,504 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时29秒
2025-03-19 11:18:53,505 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:18:53,505 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:17:31.887 scrcpy[59544:3812654] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 178.8 MB/s (90640 bytes in 0.000s)
2025-03-19 11:17:32.627 scrcpy[59544:3812654] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:17:32.627 scrcpy[59544:3812654] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:18:53,506 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:19:03,513 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4 (大小: 4.41MB)
2025-03-19 11:19:03,514 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:19:03,694 - QuickAppADBTester - INFO - 录制文件完整，时长: 75.279267秒，无需修复
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_111725.mp4
2025-03-19 11:19:03,695 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:19:10,767 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:19:10,770 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:19:16,001 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:19:16,001 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:19:16,002 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:19:16,392 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:19:17,398 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:19:17,398 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:19:17,399 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:19:18,599 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:19:18,599 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:19:18,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:19:20,791 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:19:20,791 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:19:21,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:19:23,115 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:19:23,116 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:19:23,117 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:19:23,117 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:16:38\n- 结束时间: 2025-03-19 11:19:23\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_55.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_56.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:19:23"}]}]}}
2025-03-19 11:19:23,650 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:19:23,651 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:19:23,652 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:19:53,033 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:19:53,034 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:19:53,034 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:22:53,129 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:22:53,231 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:22:53,335 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:22:53,551 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:22:53,552 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:22:54,984 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:54,984 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:22:56,268 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:22:56,268 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:22:56,269 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:22:56,430 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:22:56,431 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:22:56,431 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:22:56,432 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:22:57,827 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:57,828 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:22:59,043 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:23:00,125 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:23:00,126 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:23:00,248 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:23:02,250 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:23:02,251 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:23:03,343 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:03,344 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:23:03,426 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:23:05,430 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:23:05,432 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:23:07,638 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:23:07,639 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:23:09,717 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:23:09,717 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:23:10,815 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:23:10,815 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:23:10,816 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:10,816 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:23:10,888 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:23:12,897 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:23:12,898 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:23:15,073 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:23:15,073 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:23:16,501 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:23:17,980 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:23:17,980 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:23:19,183 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:23:19,183 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:23:20,272 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:23:20,272 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:23:22,465 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:23:22,466 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:23:22,467 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:23:23,603 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:23:23,605 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:23:23,721 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:23:28,724 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:23:28,724 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:23:30,897 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:23:30,898 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:23:36,009 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:23:36,011 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:23:38,165 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:23:43,168 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:23:43,169 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_112343.mp4
2025-03-19 11:23:43,169 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:23:43,170 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:23:48,439 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:23:48,440 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:23:48,495 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:23:49,677 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4
2025-03-19 11:23:49,679 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:23:51,688 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:23:54,695 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:23:54,695 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:23:57,697 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:23:57,699 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:23:57,701 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:23:58,864 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:23:58,865 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:23:58,966 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:24:00,971 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:24:00,972 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:24:00,972 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:24:03,250 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:24:03,251 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:24:11,455 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:24:11,456 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:11,794 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:24:11,795 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,007 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:24:12,007 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,273 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:24:12,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,658 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:24:12,658 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:12,894 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:24:12,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,108 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:24:13,108 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,386 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:24:13,386 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,641 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:24:13,641 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:13,981 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:24:13,982 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:24:16,191 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:24:16,191 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:24:16,192 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{91c5133 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t417}
    * Task{1981269 #417 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:24:16,318 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:24:16,319 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,004 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,005 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112416_20250319_112416.png
2025-03-19 11:24:18,005 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:24:24,802 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:24,806 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:24:24,808 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:24:24,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:24:34,993 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:24:34,994 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:24:34,994 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{91c5133 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t417}
    * Task{1981269 #417 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:24:35,117 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:24:35,118 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,838 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,839 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112435_20250319_112435.png
2025-03-19 11:24:36,839 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:24:41,563 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:41,565 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:24:41,566 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:24:43,732 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:24:43,732 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:24:43,733 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:24:43,733 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:24:44,738 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:24:45,743 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:24:46,746 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:24:47,747 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:24:48,748 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:24:49,753 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:24:50,758 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:24:51,758 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:24:52,762 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:24:53,765 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时12秒
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:24:54,768 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:23:49.787 scrcpy[60829:3824788] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.8 MB/s (90640 bytes in 0.001s)
2025-03-19 11:23:50.480 scrcpy[60829:3824788] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:23:50.480 scrcpy[60829:3824788] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:24:54,769 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:25:04,772 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4 (大小: 3.99MB)
2025-03-19 11:25:04,774 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 录制文件完整，时长: 58.575511秒，无需修复
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112343.mp4
2025-03-19 11:25:04,943 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:25:12,288 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:25:12,293 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:25:17,543 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:25:17,544 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:25:17,968 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:25:18,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:25:20,068 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:25:20,068 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:25:20,069 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:25:22,171 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:25:22,171 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:25:23,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:25:24,401 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:25:24,403 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:25:24,403 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:25:24,404 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:22:56\n- 结束时间: 2025-03-19 11:25:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_57.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_58.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:25:24"}]}]}}
2025-03-19 11:25:24,954 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:25:24,956 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:25:24,956 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:26:39,055 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:26:39,056 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:26:39,056 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:26:40,002 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:26:40,101 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:26:40,242 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:26:40,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:26:40,496 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:26:40,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:26:41,972 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:41,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:43,206 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:26:43,207 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:26:43,373 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:26:44,765 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:44,767 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:46,026 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:26:46,027 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:26:47,107 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:26:47,108 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:26:47,202 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:26:49,208 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:26:49,208 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:26:50,277 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:26:50,278 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:26:50,353 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:26:52,358 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:26:52,359 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:26:54,525 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:26:54,526 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:26:56,606 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:26:56,607 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:26:57,709 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:26:57,714 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:26:57,717 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:26:57,718 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:26:57,787 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:26:59,797 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:26:59,798 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:27:02,015 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:27:02,016 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:27:03,443 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:27:04,928 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:27:04,929 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:27:06,109 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:27:06,110 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:27:07,220 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:27:07,221 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:27:09,405 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:27:09,406 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:27:10,569 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:27:10,569 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:27:10,691 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:27:15,694 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:27:15,695 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:27:17,848 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:27:17,849 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:27:23,005 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:27:23,006 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:27:25,149 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_112730.mp4
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:27:30,155 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:27:35,410 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:27:35,411 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:27:35,460 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:27:36,652 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4
2025-03-19 11:27:36,652 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4 --no-playback --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:27:38,665 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:27:41,672 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:27:41,672 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:27:44,675 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:27:44,678 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:27:44,678 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:27:45,851 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:27:45,852 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:27:45,955 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:27:47,963 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:27:47,964 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:27:47,964 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:27:50,209 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:27:50,210 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:27:58,391 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:27:58,392 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:58,642 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:27:58,642 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:58,875 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:27:58,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,121 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:27:59,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,370 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:27:59,371 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,639 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:27:59,639 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:27:59,914 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:27:59,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,145 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:28:00,145 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,397 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:28:00,398 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:00,625 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:28:00,626 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:28:02,874 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:28:02,875 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:28:02,876 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:28:02,993 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{daaead9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t423}
    * Task{f8ef37f #423 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:28:02,993 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:28:02,994 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,848 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,850 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_112802_20250319_112802.png
2025-03-19 11:28:04,851 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:28:10,578 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:28:10,582 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:28:11,772 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:28:20,755 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:28:20,756 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:28:20,756 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{daaead9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t423}
    * Task{f8ef37f #423 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:28:20,914 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,666 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,666 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_112820_20250319_112820.png
2025-03-19 11:28:22,667 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:28:27,393 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:28:27,398 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:28:29,591 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:28:29,592 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:28:30,596 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:28:31,601 - QuickAppADBTester - INFO - 等待进程退出... (3/30)
2025-03-19 11:28:32,606 - QuickAppADBTester - INFO - 等待进程退出... (4/30)
2025-03-19 11:28:33,609 - QuickAppADBTester - INFO - 等待进程退出... (5/30)
2025-03-19 11:28:34,614 - QuickAppADBTester - INFO - 等待进程退出... (6/30)
2025-03-19 11:28:35,618 - QuickAppADBTester - INFO - 等待进程退出... (7/30)
2025-03-19 11:28:36,621 - QuickAppADBTester - INFO - 等待进程退出... (8/30)
2025-03-19 11:28:37,626 - QuickAppADBTester - INFO - 等待进程退出... (9/30)
2025-03-19 11:28:38,628 - QuickAppADBTester - INFO - 等待进程退出... (10/30)
2025-03-19 11:28:39,630 - QuickAppADBTester - INFO - 等待进程退出... (11/30)
2025-03-19 11:28:40,635 - QuickAppADBTester - INFO - 等待进程退出... (12/30)
2025-03-19 11:28:41,641 - QuickAppADBTester - INFO - 等待进程退出... (13/30)
2025-03-19 11:28:41,862 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-19 11:28:42,645 - QuickAppADBTester - INFO - 等待进程退出... (14/30)
2025-03-19 11:28:43,646 - QuickAppADBTester - INFO - 等待进程退出... (15/30)
2025-03-19 11:28:44,653 - QuickAppADBTester - INFO - 等待进程退出... (16/30)
2025-03-19 11:28:45,657 - QuickAppADBTester - INFO - 等待进程退出... (17/30)
2025-03-19 11:28:46,662 - QuickAppADBTester - INFO - 等待进程退出... (18/30)
2025-03-19 11:28:47,662 - QuickAppADBTester - INFO - 等待进程退出... (19/30)
2025-03-19 11:28:48,663 - QuickAppADBTester - INFO - 等待进程退出... (20/30)
2025-03-19 11:28:49,668 - QuickAppADBTester - INFO - 等待进程退出... (21/30)
2025-03-19 11:28:50,672 - QuickAppADBTester - INFO - 等待进程退出... (22/30)
2025-03-19 11:28:51,673 - QuickAppADBTester - INFO - 等待进程退出... (23/30)
2025-03-19 11:28:52,677 - QuickAppADBTester - INFO - 等待进程退出... (24/30)
2025-03-19 11:28:53,681 - QuickAppADBTester - INFO - 等待进程退出... (25/30)
2025-03-19 11:28:54,685 - QuickAppADBTester - INFO - 等待进程退出... (26/30)
2025-03-19 11:28:55,688 - QuickAppADBTester - INFO - 等待进程退出... (27/30)
2025-03-19 11:28:56,692 - QuickAppADBTester - INFO - 等待进程退出... (28/30)
2025-03-19 11:28:57,695 - QuickAppADBTester - INFO - 等待进程退出... (29/30)
2025-03-19 11:28:58,698 - QuickAppADBTester - INFO - 等待进程退出... (30/30)
2025-03-19 11:28:59,703 - QuickAppADBTester - INFO - SIGINT未能终止进程，尝试通过ADB停止scrcpy服务端
2025-03-19 11:28:59,703 - QuickAppADBTester - INFO - 执行: adb shell am force-stop com.genymobile.scrcpy
2025-03-19 11:29:01,886 - QuickAppADBTester - INFO - 执行: adb shell pkill -l 2 scrcpy-server
2025-03-19 11:29:04,081 - QuickAppADBTester - INFO - 执行: adb shell pkill scrcpy-server
2025-03-19 11:29:06,272 - QuickAppADBTester - INFO - 尝试通过SIGTERM终止进程
2025-03-19 11:29:06,273 - QuickAppADBTester - INFO - 等待SIGTERM生效... (1/10)
2025-03-19 11:29:07,276 - QuickAppADBTester - INFO - 等待SIGTERM生效... (2/10)
2025-03-19 11:29:08,279 - QuickAppADBTester - INFO - 等待SIGTERM生效... (3/10)
2025-03-19 11:29:09,284 - QuickAppADBTester - INFO - 等待SIGTERM生效... (4/10)
2025-03-19 11:29:10,289 - QuickAppADBTester - INFO - 等待SIGTERM生效... (5/10)
2025-03-19 11:29:11,291 - QuickAppADBTester - INFO - 等待SIGTERM生效... (6/10)
2025-03-19 11:29:11,952 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-19 11:29:12,294 - QuickAppADBTester - INFO - 等待SIGTERM生效... (7/10)
2025-03-19 11:29:13,299 - QuickAppADBTester - INFO - 进程在接收SIGTERM后成功退出，用时8秒
2025-03-19 11:29:13,299 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:29:13,300 - QuickAppADBTester - INFO - stderr输出: 2025-03-19 11:27:36.765 scrcpy[61406:3833302] INFO: No video mirroring, SDK mouse disabled
/opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 166.9 MB/s (90640 bytes in 0.001s)
2025-03-19 11:27:37.516 scrcpy[61406:3833302] +[IMKClient subclass]: chose IMKClient_Modern
2025-03-19 11:27:37.516 scrcpy[61406:3833302] +[IMKInputSession subclass]: chose IMKInputSession_Modern

2025-03-19 11:29:13,301 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:29:23,305 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4 (大小: 3.81MB)
2025-03-19 11:29:23,305 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 录制文件完整，时长: 95.415067秒，无需修复
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_112730.mp4
2025-03-19 11:29:23,391 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:29:30,110 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:30,117 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:30,117 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:29:30,118 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:29:35,355 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:29:35,364 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:29:35,368 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:29:35,982 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:29:36,987 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:29:36,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:29:36,988 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:29:38,218 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:29:40,423 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:29:40,424 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:29:41,577 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:29:41,578 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:29:41,578 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:29:42,722 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:29:42,723 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:26:43\n- 结束时间: 2025-03-19 11:29:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_59.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_60.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:29:42"}]}]}}
2025-03-19 11:29:43,203 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:29:43,204 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:29:43,204 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:42:27,593 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:42:27,595 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:42:27,595 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:46:25,408 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:46:25,500 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:46:25,581 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:46:25,767 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:46:27,241 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:27,242 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:46:28,496 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:46:28,672 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:46:30,080 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:30,080 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:31,314 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:31,315 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:32,396 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:46:32,396 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:46:32,502 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:46:34,506 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:46:34,507 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:46:35,597 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:46:35,682 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:46:37,689 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:46:37,690 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:46:39,819 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:46:39,820 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:46:41,895 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:46:41,896 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:46:42,999 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:46:42,999 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:46:43,000 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:46:43,000 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:46:43,066 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:46:45,075 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:46:45,076 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:46:47,253 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:46:47,255 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:46:48,667 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:46:50,108 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:46:50,109 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:46:51,263 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:46:51,264 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:46:52,369 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:46:52,369 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:46:54,506 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:46:54,507 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:46:54,507 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:46:54,507 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:46:54,508 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:46:55,690 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:46:55,691 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:46:55,809 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:47:00,812 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:47:00,813 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:47:02,974 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:47:02,974 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:47:08,141 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:47:08,143 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:47:10,293 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:47:15,298 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:47:15,300 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_114715.mp4
2025-03-19 11:47:15,300 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:47:15,300 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:47:20,568 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:47:20,570 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:47:20,618 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:47:21,810 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4
2025-03-19 11:47:21,811 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:47:23,823 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:47:26,829 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:47:26,830 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:47:29,835 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:47:29,835 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:47:29,835 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:47:31,020 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:47:31,021 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:47:31,021 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:47:31,021 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:47:31,129 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:47:33,139 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:47:33,140 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:47:33,140 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:47:35,439 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:47:35,440 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:47:43,618 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:47:43,619 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:47:43,619 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:47:43,619 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,003 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:47:44,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,262 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:47:44,263 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,497 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:47:44,498 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,731 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:47:44,732 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:44,980 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:47:44,981 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,208 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:47:45,209 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,454 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:47:45,454 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,683 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:47:45,684 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:45,936 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:47:45,937 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:47:48,169 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:47:48,170 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:47:48,170 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:47:48,340 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c89ed01 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t429}
    * Task{8127594 #429 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:47:48,341 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:47:48,341 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:47:48,341 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:47:48,342 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_114748_20250319_114748.png
2025-03-19 11:47:50,059 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_114748_20250319_114748.png
2025-03-19 11:47:50,060 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_114748_20250319_114748.png
2025-03-19 11:47:50,060 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:47:56,934 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:47:56,987 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:47:56,989 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:47:56,989 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:47:56,989 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:47:56,990 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:07,168 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:48:07,171 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:48:07,171 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:48:07,310 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c89ed01 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t429}
    * Task{8127594 #429 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:48:07,310 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:48:07,311 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:48:07,311 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:48:07,311 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_114807_20250319_114807.png
2025-03-19 11:48:09,127 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_114807_20250319_114807.png
2025-03-19 11:48:09,128 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_114807_20250319_114807.png
2025-03-19 11:48:09,129 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:48:13,974 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:48:13,983 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:16,153 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:48:16,154 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:48:16,155 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:48:16,155 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:48:17,158 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 42.9 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-19 11:48:18,163 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:48:28,171 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4 (大小: 3.56MB)
2025-03-19 11:48:28,172 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.447178秒，无需修复
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_114715.mp4
2025-03-19 11:48:28,328 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:48:35,257 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4
2025-03-19 11:48:35,259 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4
2025-03-19 11:48:35,259 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:48:35,259 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:48:40,477 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:48:40,480 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:48:40,809 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:48:41,814 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:48:41,815 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:48:41,815 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:42,919 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:48:42,919 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:48:42,919 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:48:45,016 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:48:45,017 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:48:46,206 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:48:46,207 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:48:46,207 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:48:47,338 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:48:47,340 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:48:47,341 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:48:47,341 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:46:28\n- 结束时间: 2025-03-19 11:48:47\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_61.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_62.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:48:47"}]}]}}
2025-03-19 11:48:47,778 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:48:47,782 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:48:47,782 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:51:40,913 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:51:40,914 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:51:40,914 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:51:42,074 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:51:42,159 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:51:42,317 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:51:42,317 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:51:42,317 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:51:42,318 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:51:42,583 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:51:42,584 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:51:42,584 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:51:42,584 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:51:44,044 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:51:44,045 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:51:45,276 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:51:45,435 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:51:45,435 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:51:45,435 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:51:45,436 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:51:46,838 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:51:46,839 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:51:48,092 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:51:49,175 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:51:49,175 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:51:49,283 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:51:51,289 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:51:51,290 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:51:52,378 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:51:52,381 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:51:52,381 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:51:52,382 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:51:52,466 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:51:54,472 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:51:54,473 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:51:56,654 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:51:56,655 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:51:58,738 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:51:58,739 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:51:59,845 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:51:59,849 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:51:59,849 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:51:59,849 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:51:59,940 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:52:01,943 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:52:01,944 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:52:04,085 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:52:04,086 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:52:05,507 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:52:06,998 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:52:06,999 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:52:08,211 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:52:08,212 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:52:09,316 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:52:09,317 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:52:11,510 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:52:12,683 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:52:12,684 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:52:12,804 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:52:17,808 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:52:17,810 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:52:19,964 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:52:19,965 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:52:25,116 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:52:25,117 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:52:27,268 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:52:32,273 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:52:32,275 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_115232.mp4
2025-03-19 11:52:32,276 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:52:32,276 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:52:37,540 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:52:37,541 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:52:37,593 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:52:38,782 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4
2025-03-19 11:52:38,783 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:52:40,796 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:52:43,804 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:52:43,805 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:52:46,808 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:52:46,808 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:52:46,809 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:52:47,998 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:52:47,999 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:52:47,999 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:52:47,999 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:52:48,108 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:52:50,118 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:52:50,119 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:52:50,119 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:52:52,446 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:52:52,447 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:53:00,641 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:53:00,643 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:53:00,643 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:53:00,643 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:00,988 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:53:00,989 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,210 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:53:01,212 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,443 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:53:01,444 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,701 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:53:01,702 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:01,955 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:53:01,956 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,201 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:53:02,202 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,434 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:53:02,435 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,689 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:53:02,690 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:02,997 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:53:02,998 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:53:05,264 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:53:05,265 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:53:05,265 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:53:05,460 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c781865 u0 com.huawei.fastapp/.app.processManager.DeepLinkActivity t437}
    * Task{90529c7 #437 type=standard A=10148:rpk.loader.entry U=0 visible=true mode=fullscreen translucent=true sz=1}

2025-03-19 11:53:05,461 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:53:05,461 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:53:05,462 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:53:05,462 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115305_20250319_115305.png
2025-03-19 11:53:07,186 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115305_20250319_115305.png
2025-03-19 11:53:07,187 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115305_20250319_115305.png
2025-03-19 11:53:07,187 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:53:12,486 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_63.jpg
2025-03-19 11:53:12,494 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_63.jpg
2025-03-19 11:53:12,495 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:53:12,495 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:53:12,495 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:53:13,893 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:53:22,585 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:53:22,586 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:53:22,586 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:53:22,729 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:53:22,729 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-19 11:53:22,730 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-19 11:53:22,730 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:53:22,730 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115322_20250319_115322.png
2025-03-19 11:53:24,073 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115322_20250319_115322.png
2025-03-19 11:53:24,074 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115322_20250319_115322.png
2025-03-19 11:53:24,074 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:53:29,185 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_64.jpg
2025-03-19 11:53:29,193 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_64.jpg
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:53:29,194 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:53:31,378 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:53:31,379 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:53:31,379 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:53:31,379 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:53:32,381 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:53:33,385 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:53:33,386 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:53:33,387 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 126.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 11:53:33,387 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:53:43,389 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4 (大小: 8.66MB)
2025-03-19 11:53:43,390 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:53:43,556 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.742567秒，无需修复
2025-03-19 11:53:43,556 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:53:43,557 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115232.mp4
2025-03-19 11:53:43,557 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:53:51,151 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4
2025-03-19 11:53:51,158 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4
2025-03-19 11:53:51,158 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:53:51,158 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:53:56,433 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:53:56,434 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4
2025-03-19 11:53:56,434 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:53:56,434 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:53:56,435 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:53:56,785 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:53:57,790 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:53:57,791 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:53:57,791 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:53:58,975 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:53:58,976 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:53:58,976 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:54:01,089 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:54:01,090 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:54:02,254 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:54:02,255 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:02,256 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:03,398 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:54:03,399 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-19 11:54:03,400 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:54:03,400 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用拉回测试失败**\n\n- 开始时间: 2025-03-19 11:51:45\n- 结束时间: 2025-03-19 11:54:03\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ✅ 成功\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_63.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_64.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_65.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:54:03"}]}]}}
2025-03-19 11:54:03,928 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:54:03,931 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:54:03,931 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:54:19,933 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:54:19,935 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:54:19,935 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:54:20,937 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:54:21,043 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:54:21,194 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:54:21,194 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:54:21,195 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:54:21,195 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:54:21,420 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:54:22,925 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:22,926 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:24,174 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:54:24,175 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:54:24,332 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:54:24,333 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:54:24,333 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:54:24,333 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:54:25,735 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:25,735 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:27,008 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:27,009 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:28,096 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:54:28,096 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:54:28,206 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:54:30,211 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:54:30,211 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:54:31,305 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:54:31,305 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:54:31,306 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:54:31,306 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:54:31,383 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:54:33,394 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:54:33,394 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:54:35,580 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:54:35,581 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:54:37,674 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:54:37,675 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:54:38,779 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:54:38,780 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:54:38,781 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:54:38,781 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:54:38,853 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:54:40,862 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:54:40,863 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:54:43,027 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:54:43,029 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:54:44,458 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:54:45,927 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:54:45,929 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:54:47,107 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:54:47,128 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:54:48,218 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:54:48,220 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:54:50,390 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:54:50,391 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:54:50,391 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:54:50,391 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:54:50,392 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:54:51,517 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:54:51,518 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:54:51,643 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:54:56,646 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:54:56,646 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:54:58,782 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:54:58,782 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:55:03,916 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:55:03,917 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:55:06,075 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:55:11,078 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:55:11,080 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_115511.mp4
2025-03-19 11:55:11,080 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:55:11,080 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:55:16,346 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:55:16,347 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:55:16,401 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:55:17,592 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4
2025-03-19 11:55:17,594 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:55:19,604 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:55:22,612 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:55:22,612 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:55:25,616 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:55:25,617 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:55:25,617 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:55:26,797 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:55:26,798 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:55:26,798 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:55:26,798 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:55:26,904 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:55:28,912 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:55:28,912 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:55:28,913 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:55:31,191 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:55:31,193 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:55:39,408 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:55:39,409 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:55:39,409 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:55:39,409 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:39,686 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:55:39,687 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:39,920 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:55:39,921 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:40,180 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:55:40,181 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:40,411 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:55:40,412 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:40,748 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:55:40,748 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,077 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:55:41,078 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,340 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:55:41,340 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,620 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:55:41,621 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:41,906 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:55:41,906 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:55:44,140 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:55:44,141 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:55:44,141 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-19 11:55:44,218 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:55:44,218 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115544_20250319_115544.png
2025-03-19 11:55:45,382 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115544_20250319_115544.png
2025-03-19 11:55:45,382 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115544_20250319_115544.png
2025-03-19 11:55:45,382 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:55:50,662 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_66.jpg
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_66.jpg
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:55:50,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:55:52,715 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:56:00,834 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:56:00,835 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:56:00,835 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-19 11:56:00,969 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:56:00,969 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115600_20250319_115600.png
2025-03-19 11:56:02,321 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115600_20250319_115600.png
2025-03-19 11:56:02,321 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115600_20250319_115600.png
2025-03-19 11:56:02,321 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:56:07,890 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_67.jpg
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_67.jpg
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:56:07,898 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:56:10,018 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:56:11,024 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:56:12,031 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:56:12,031 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:56:12,032 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 118.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 11:56:12,032 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:56:22,035 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4 (大小: 4.90MB)
2025-03-19 11:56:22,036 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:56:22,226 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.498833秒，无需修复
2025-03-19 11:56:22,227 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:56:22,227 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115511.mp4
2025-03-19 11:56:22,227 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:56:29,438 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4
2025-03-19 11:56:29,450 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4
2025-03-19 11:56:29,450 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:56:29,450 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:56:34,720 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:56:34,721 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:56:35,117 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:56:36,119 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:56:36,120 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:56:36,120 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:56:37,311 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:56:37,313 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:56:37,313 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:56:39,411 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:56:39,412 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:56:40,585 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:56:40,586 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:56:40,586 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:56:41,702 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:56:41,704 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-19 11:56:41,704 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:56:41,705 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-19 11:54:24\n- 结束时间: 2025-03-19 11:56:41\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_66.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_67.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_68.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:56:41"}]}]}}
2025-03-19 11:56:42,180 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 11:56:42,183 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:56:42,183 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 11:56:58,140 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 11:56:58,141 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 11:56:58,141 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 11:56:59,054 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 11:56:59,055 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 11:56:59,148 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 11:56:59,242 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 11:56:59,243 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 11:56:59,243 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:56:59,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:56:59,407 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:57:00,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:00,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:02,151 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:57:02,151 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 11:57:02,152 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 11:57:02,152 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 11:57:02,152 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 11:57:02,302 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 11:57:02,302 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 11:57:02,302 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 11:57:02,303 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 11:57:03,717 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:03,717 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:04,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:06,068 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 11:57:06,069 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 11:57:06,189 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 11:57:08,191 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 11:57:08,201 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 11:57:09,292 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 11:57:09,295 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 11:57:09,295 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:57:09,295 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 11:57:09,387 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:57:11,393 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 11:57:11,393 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 11:57:13,531 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 11:57:13,532 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 11:57:15,616 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 11:57:15,617 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 11:57:16,724 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 11:57:16,725 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 11:57:16,725 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:57:16,725 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 11:57:16,795 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:57:18,801 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 11:57:18,802 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 11:57:21,005 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 11:57:21,005 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 11:57:22,422 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 11:57:23,981 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 11:57:23,982 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 11:57:25,368 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 11:57:25,369 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 11:57:26,466 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 11:57:26,466 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 11:57:28,652 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:57:28,653 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:57:29,787 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 11:57:29,788 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 11:57:29,923 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 11:57:34,926 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 11:57:34,927 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 11:57:37,041 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 11:57:37,041 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 11:57:42,186 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 11:57:42,187 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 11:57:44,350 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 11:57:49,366 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 11:57:49,367 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_115749.mp4
2025-03-19 11:57:49,367 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:57:49,367 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:57:54,631 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:57:54,632 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 11:57:54,679 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 11:57:55,870 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4
2025-03-19 11:57:55,871 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 11:57:57,884 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 11:58:00,890 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 11:58:00,890 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 11:58:03,898 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 11:58:03,899 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 11:58:03,899 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 11:58:05,099 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 11:58:05,100 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 11:58:05,100 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 11:58:05,100 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 11:58:05,197 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 11:58:07,208 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 11:58:07,209 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 11:58:07,209 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 11:58:09,502 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 11:58:09,502 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 11:58:17,719 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,010 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 11:58:18,010 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,241 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 11:58:18,242 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,476 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 11:58:18,477 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,709 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 11:58:18,710 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:18,952 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 11:58:18,953 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,177 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 11:58:19,178 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,409 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 11:58:19,409 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,626 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 11:58:19,627 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:19,889 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 11:58:19,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 11:58:22,134 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 11:58:22,135 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:58:22,135 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:58:22,295 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2abdc49 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t450}
    * Task{70f5a6f #450 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 11:58:22,296 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115822_20250319_115822.png
2025-03-19 11:58:23,787 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115822_20250319_115822.png
2025-03-19 11:58:23,787 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_115822_20250319_115822.png
2025-03-19 11:58:23,788 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:58:29,092 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_69.jpg
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_69.jpg
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:58:29,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:58:31,019 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 11:58:39,288 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 11:58:39,289 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 11:58:39,289 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 11:58:39,414 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2abdc49 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t450}
    * Task{70f5a6f #450 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 11:58:39,415 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 11:58:39,416 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 11:58:39,416 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 11:58:39,416 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115839_20250319_115839.png
2025-03-19 11:58:40,911 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115839_20250319_115839.png
2025-03-19 11:58:40,912 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_115839_20250319_115839.png
2025-03-19 11:58:40,912 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 11:58:46,434 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_70.jpg
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_70.jpg
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:58:46,440 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:58:48,625 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 11:58:48,625 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 11:58:48,626 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 11:58:48,626 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 11:58:49,631 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 11:58:50,634 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 11:58:50,635 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 11:58:50,635 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 133.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 11:58:50,635 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 11:59:00,639 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4 (大小: 3.40MB)
2025-03-19 11:59:00,640 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 11:59:00,746 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.851856秒，无需修复
2025-03-19 11:59:00,747 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 11:59:00,747 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_115749.mp4
2025-03-19 11:59:00,747 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 11:59:07,365 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4
2025-03-19 11:59:07,370 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4
2025-03-19 11:59:07,370 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 11:59:07,370 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 11:59:12,632 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 11:59:12,633 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 11:59:13,052 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 11:59:14,058 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 11:59:14,058 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:59:14,058 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:59:15,168 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 11:59:15,169 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 11:59:15,169 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 11:59:17,274 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 11:59:17,275 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 11:59:18,427 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 11:59:18,428 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 11:59:18,428 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 11:59:19,559 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 11:59:19,559 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 11:59:19,559 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 11:59:19,560 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 11:57:02\n- 结束时间: 2025-03-19 11:59:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_69.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_70.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_71.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 11:59:19"}]}]}}
2025-03-19 11:59:20,155 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 11:59:20,158 - QuickAppADBTester - INFO - 测试完成
2025-03-19 11:59:20,158 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 12:04:20,179 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:04:20,180 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:04:20,180 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:04:20,180 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:04:20,325 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:04:20,428 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:04:20,429 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:04:20,429 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:04:20,429 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:04:20,662 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:04:20,662 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:04:20,663 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:04:20,663 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:04:22,144 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:22,145 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:04:23,390 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:04:23,519 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:04:23,520 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:04:23,520 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:04:23,520 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:04:24,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:24,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:26,190 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:26,191 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:27,292 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:04:27,293 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:04:27,424 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:04:29,430 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:04:29,431 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:04:30,528 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:04:30,529 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:04:30,529 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:04:30,529 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:04:30,596 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:04:32,605 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:04:32,606 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:04:34,798 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:04:34,799 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:04:36,882 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:04:36,883 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:04:37,986 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:04:37,987 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:04:37,987 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:04:37,987 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:04:38,062 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:04:40,070 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:04:40,070 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:04:42,258 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:04:42,262 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:04:43,682 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:04:45,178 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:04:45,179 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:04:46,354 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:04:46,355 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:04:47,463 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:04:47,464 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:04:49,648 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:04:49,649 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:04:50,837 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:04:50,838 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:04:50,966 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:04:55,969 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:04:55,969 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:04:58,120 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:04:58,121 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:05:03,255 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:05:03,256 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:05:05,415 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:05:10,420 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:05:10,421 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_120510.mp4
2025-03-19 12:05:10,421 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:05:10,421 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:05:15,691 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:05:15,692 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:05:15,741 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:05:16,931 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4
2025-03-19 12:05:16,932 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:05:18,941 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:05:21,944 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:05:21,945 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:05:24,950 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:05:24,952 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:05:24,952 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:05:26,139 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:05:26,140 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:05:26,140 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:05:26,141 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:05:26,245 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:05:28,255 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:05:28,255 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:05:28,255 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:05:30,509 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:05:30,510 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:05:38,681 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:05:38,682 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:05:38,682 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:05:38,682 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,006 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:05:39,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,252 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:05:39,254 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,497 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:05:39,498 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,740 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:05:39,741 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:39,992 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:05:39,993 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,213 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:05:40,214 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,448 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:05:40,448 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,685 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:05:40,686 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:40,939 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:05:40,940 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:05:43,226 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:05:43,226 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:05:43,227 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c4edf17 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t456}
    * Task{cf76ced #456 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:05:43,373 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_120543_20250319_120543.png
2025-03-19 12:05:45,174 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_120543_20250319_120543.png
2025-03-19 12:05:45,175 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_120543_20250319_120543.png
2025-03-19 12:05:45,175 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:05:52,054 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:05:52,576 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:05:52,582 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:05:52,582 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:05:52,582 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:05:52,583 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:02,701 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:06:02,702 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:06:02,702 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c4edf17 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t456}
    * Task{cf76ced #456 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:06:02,822 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:06:02,823 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_120602_20250319_120602.png
2025-03-19 12:06:04,643 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_120602_20250319_120602.png
2025-03-19 12:06:04,644 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_120602_20250319_120602.png
2025-03-19 12:06:04,645 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:06:09,584 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:06:09,591 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg
2025-03-19 12:06:09,591 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:06:09,592 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:06:09,592 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:06:09,592 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:11,699 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:06:11,700 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:06:11,700 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:06:11,700 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:06:12,705 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:06:13,711 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:06:13,712 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:06:13,712 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 126.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:06:13,712 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:06:23,718 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4 (大小: 4.66MB)
2025-03-19 12:06:23,718 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:06:23,812 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.832400秒，无需修复
2025-03-19 12:06:23,813 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:06:23,813 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_120510.mp4
2025-03-19 12:06:23,813 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:06:31,018 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4
2025-03-19 12:06:31,024 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4
2025-03-19 12:06:31,024 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:06:31,024 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:06:36,285 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:06:36,286 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:06:36,663 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:06:37,668 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:06:37,669 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:06:37,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:38,772 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:06:38,773 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:06:38,773 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:06:40,887 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:06:40,888 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:06:42,051 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:06:42,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:06:42,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:06:43,210 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:06:43,211 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:06:43,211 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:06:43,211 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:04:23\n- 结束时间: 2025-03-19 12:06:43\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_72.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_73.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:06:43"}]}]}}
2025-03-19 12:06:43,648 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:06:43,652 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:11:43,709 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:11:43,710 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:11:43,710 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:11:43,710 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:11:43,856 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:11:43,994 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:11:44,233 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:11:44,234 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:11:44,234 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:11:44,234 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:11:45,687 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:11:45,688 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:11:46,969 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:11:47,136 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:11:47,136 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:11:47,137 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:11:47,137 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:11:48,546 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:11:48,546 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:11:49,814 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:11:50,905 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:11:50,906 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:11:51,020 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:11:53,022 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:11:53,023 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:11:54,112 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:11:54,113 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:11:54,113 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:11:54,113 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:11:54,195 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:11:56,206 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:11:56,207 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:11:58,392 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:11:58,393 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:12:00,458 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:12:00,459 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:12:01,568 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:12:01,569 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:12:01,569 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:12:01,569 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:12:01,649 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:12:03,656 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:12:03,657 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:12:05,857 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:12:05,858 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:12:07,281 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:12:08,743 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:12:08,744 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:12:09,931 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:12:09,932 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:12:11,029 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:12:11,030 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:12:13,219 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:12:13,220 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:12:14,377 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:12:14,378 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:12:14,500 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:12:19,504 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:12:19,505 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:12:21,646 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:12:21,646 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:12:26,793 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:12:26,793 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:12:28,965 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:12:33,968 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:12:33,969 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_121233.mp4
2025-03-19 12:12:33,969 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:12:33,969 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:12:39,229 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:12:39,230 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:12:39,284 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:12:40,475 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4
2025-03-19 12:12:40,475 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:12:42,483 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:12:45,489 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:12:45,489 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:12:48,491 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:12:48,492 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:12:48,492 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:12:49,679 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:12:49,680 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:12:49,680 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:12:49,680 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:12:49,765 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:12:51,770 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:12:51,771 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:12:51,772 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:12:54,093 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:12:54,094 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:13:02,272 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:13:02,273 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:13:02,273 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:13:02,273 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:02,569 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:13:02,570 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:02,801 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:13:02,802 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,089 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:13:03,090 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,366 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:13:03,367 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,623 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:13:03,624 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:03,851 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:13:03,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:04,090 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:13:04,091 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:04,333 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:13:04,334 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:04,582 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:13:04,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:13:06,834 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:13:06,835 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:13:06,835 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:13:06,948 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{88f0c29 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t462}
    * Task{11adcdc #462 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:13:06,948 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:13:06,949 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:13:06,949 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:13:06,949 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_121306_20250319_121306.png
2025-03-19 12:13:08,234 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_121306_20250319_121306.png
2025-03-19 12:13:08,235 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_121306_20250319_121306.png
2025-03-19 12:13:08,235 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:13:15,024 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_74.jpg
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_74.jpg
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:13:15,028 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:13:15,631 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:13:25,127 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:13:25,127 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:13:25,127 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:13:25,241 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{88f0c29 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t462}
    * Task{11adcdc #462 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:13:25,242 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_121325_20250319_121325.png
2025-03-19 12:13:26,606 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_121325_20250319_121325.png
2025-03-19 12:13:26,607 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_121325_20250319_121325.png
2025-03-19 12:13:26,607 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:13:32,965 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_75.jpg
2025-03-19 12:13:32,970 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_75.jpg
2025-03-19 12:13:32,970 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:13:32,970 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:13:32,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:13:32,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:13:35,154 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:13:35,155 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:13:35,155 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:13:35,155 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:13:36,159 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:13:37,165 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:13:37,165 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:13:37,166 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 107.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:13:37,166 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:13:47,172 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4 (大小: 3.49MB)
2025-03-19 12:13:47,172 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.797256秒，无需修复
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121233.mp4
2025-03-19 12:13:47,277 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:13:54,425 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4
2025-03-19 12:13:54,431 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4
2025-03-19 12:13:54,431 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:13:54,431 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:13:59,691 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:13:59,692 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:14:00,068 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:14:01,071 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:14:01,071 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:14:01,071 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:14:02,166 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:14:02,167 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:14:02,167 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:14:04,268 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:14:04,268 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:14:05,431 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:14:05,432 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:14:05,432 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:14:06,566 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:14:06,567 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:14:06,567 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:14:06,568 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:11:46\n- 结束时间: 2025-03-19 12:14:06\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_74.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_75.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_76.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:14:06"}]}]}}
2025-03-19 12:14:06,977 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:14:06,979 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:19:07,006 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:19:07,008 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:19:07,008 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:19:07,008 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:19:07,146 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:19:07,290 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:19:07,291 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:19:07,291 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:19:07,291 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:19:07,537 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:19:07,538 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:19:07,538 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:19:07,538 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:19:08,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:08,989 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:10,270 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:19:10,271 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:19:10,419 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:19:10,420 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:19:10,420 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:19:10,420 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:19:11,825 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:11,826 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:13,089 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:14,186 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:19:14,187 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:19:14,308 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:19:16,314 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:19:16,315 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:19:17,401 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:19:17,469 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:19:19,476 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:19:19,477 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:19:21,646 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:19:21,647 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:19:23,730 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:19:23,731 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:19:24,833 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:19:24,834 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:19:24,834 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:19:24,834 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:19:24,907 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:19:26,913 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:19:26,914 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:19:29,088 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:19:29,089 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:19:30,502 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:19:31,953 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:19:31,954 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:19:33,113 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:19:33,114 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:19:34,214 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:19:34,215 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:19:36,415 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:19:36,415 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:19:36,416 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:19:36,416 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:19:36,416 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:19:37,596 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:19:37,597 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:19:37,723 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:19:42,725 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:19:42,725 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:19:44,866 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:19:44,867 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:19:50,015 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:19:50,015 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:19:52,162 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:19:57,168 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:19:57,168 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_121957.mp4
2025-03-19 12:19:57,169 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:19:57,169 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:20:02,427 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:20:02,428 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:20:02,473 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:20:03,611 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4
2025-03-19 12:20:03,612 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:20:05,619 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:20:08,621 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:20:08,621 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:20:11,624 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:20:11,625 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:20:11,625 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:20:12,800 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:20:12,801 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:20:12,801 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:20:12,801 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:20:12,907 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:20:14,915 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:20:14,916 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:20:14,916 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:20:17,201 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:20:17,202 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:20:25,393 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:20:25,393 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:20:25,394 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:20:25,394 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:25,638 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:20:25,639 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:25,938 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:20:25,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,203 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:20:26,204 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,457 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:20:26,458 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,721 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:20:26,721 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:26,957 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:20:26,957 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:27,186 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:20:27,187 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:27,411 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:20:27,412 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:27,647 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:20:27,647 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:20:29,883 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:20:29,884 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:20:29,884 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:20:30,005 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e754ba8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t468}
    * Task{48a05a7 #468 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:20:30,006 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122030_20250319_122030.png
2025-03-19 12:20:31,196 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122030_20250319_122030.png
2025-03-19 12:20:31,197 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122030_20250319_122030.png
2025-03-19 12:20:31,197 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:20:37,492 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:37,497 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:37,497 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:20:37,498 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:20:37,498 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:20:38,714 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:20:47,627 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:20:47,628 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:20:47,628 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:20:47,771 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e754ba8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t468}
    * Task{48a05a7 #468 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:20:47,772 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122047_20250319_122047.png
2025-03-19 12:20:48,965 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122047_20250319_122047.png
2025-03-19 12:20:48,965 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122047_20250319_122047.png
2025-03-19 12:20:48,965 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:20:53,440 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:53,445 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg
2025-03-19 12:20:53,445 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:20:53,446 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:20:53,446 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:20:53,446 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:20:55,633 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:20:56,639 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:20:57,644 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:20:57,645 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:20:57,645 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 155.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:20:57,645 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:21:07,651 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4 (大小: 3.16MB)
2025-03-19 12:21:07,651 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:21:07,763 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.132889秒，无需修复
2025-03-19 12:21:07,763 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:21:07,764 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_121957.mp4
2025-03-19 12:21:07,764 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:21:15,089 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4
2025-03-19 12:21:15,094 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4
2025-03-19 12:21:15,095 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:21:15,095 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:21:20,355 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:21:20,356 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:21:20,673 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:21:21,679 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:21:21,679 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:21:21,679 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:21:22,791 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:21:22,792 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:21:22,793 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:21:24,909 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:21:24,910 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:21:26,068 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:21:26,068 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:21:26,068 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:21:27,192 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:21:27,192 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:21:27,193 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:21:27,193 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:19:10\n- 结束时间: 2025-03-19 12:21:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_77.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_78.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:21:27"}]}]}}
2025-03-19 12:21:27,604 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:21:27,606 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:26:28,608 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:26:28,609 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:26:28,609 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:26:28,609 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:26:28,710 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:26:28,855 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:26:28,855 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:26:28,856 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:26:28,856 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:26:29,085 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:26:30,535 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:30,535 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:31,814 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:26:31,815 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:26:31,961 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:26:33,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:33,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:26:34,596 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:34,597 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:35,677 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:26:35,677 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:26:35,787 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:26:37,791 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:26:37,792 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:26:38,874 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:26:38,942 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:26:40,945 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:26:40,945 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:26:43,124 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:26:43,125 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:26:45,211 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:26:45,212 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:26:46,312 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:26:46,313 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:26:46,313 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:26:46,313 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:26:46,389 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:26:48,398 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:26:48,399 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:26:50,561 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:26:50,562 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:26:51,982 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:26:53,424 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:26:53,425 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:26:54,600 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:26:54,601 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:26:55,713 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:26:55,713 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:26:57,859 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:26:57,860 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:26:57,860 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:26:57,860 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:26:57,861 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:26:59,042 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:26:59,043 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:26:59,166 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:27:04,168 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:27:04,169 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:27:06,299 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:27:06,300 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:27:11,442 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:27:11,442 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:27:13,570 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:27:18,574 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:27:18,575 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_122718.mp4
2025-03-19 12:27:18,575 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:27:18,576 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:27:23,844 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:27:23,845 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:27:23,878 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:27:25,054 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4
2025-03-19 12:27:25,055 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:27:27,064 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:27:30,070 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:27:30,071 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:27:33,075 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:27:33,076 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:27:33,076 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:27:34,242 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:27:34,243 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:27:34,243 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:27:34,243 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:27:34,350 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:27:36,359 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:27:36,359 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:27:36,360 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:27:38,669 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:27:38,670 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:27:46,834 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:27:46,836 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:27:46,836 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:27:46,836 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,115 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:27:47,116 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,362 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:27:47,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,595 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:27:47,596 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:47,851 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:27:47,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,096 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:27:48,097 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,360 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:27:48,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,597 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:27:48,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:48,818 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:27:48,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:49,089 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:27:49,090 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:27:51,331 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:27:51,332 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:27:51,332 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:27:51,426 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9667dde u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t474}
    * Task{5d899ea #474 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:27:51,427 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122751_20250319_122751.png
2025-03-19 12:27:52,825 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122751_20250319_122751.png
2025-03-19 12:27:52,825 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_122751_20250319_122751.png
2025-03-19 12:27:52,826 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:27:59,312 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:27:59,317 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:27:59,318 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:27:59,318 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:27:59,318 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:00,168 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:28:09,465 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:28:09,466 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:28:09,466 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:28:09,577 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9667dde u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t474}
    * Task{5d899ea #474 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:28:09,577 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:28:09,577 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:28:09,578 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:28:09,578 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122809_20250319_122809.png
2025-03-19 12:28:10,954 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122809_20250319_122809.png
2025-03-19 12:28:10,955 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_122809_20250319_122809.png
2025-03-19 12:28:10,955 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:28:15,541 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:28:15,546 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:17,706 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:28:17,706 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:28:17,706 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:28:17,707 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:28:18,709 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:28:19,713 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:28:19,713 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:28:19,714 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 164.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:28:19,714 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:28:29,719 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4 (大小: 3.18MB)
2025-03-19 12:28:29,719 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:28:29,834 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.884578秒，无需修复
2025-03-19 12:28:29,835 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:28:29,835 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_122718.mp4
2025-03-19 12:28:29,835 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:28:37,387 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4
2025-03-19 12:28:37,394 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4
2025-03-19 12:28:37,395 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:28:37,395 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:28:42,634 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:28:42,636 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:28:43,014 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:28:44,020 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:28:44,020 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:28:44,021 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:45,112 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:28:45,112 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:28:45,113 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:28:47,206 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:28:47,207 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:28:48,385 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:28:48,386 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:28:48,386 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:28:49,526 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:28:49,527 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:28:49,528 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:28:49,528 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:26:31\n- 结束时间: 2025-03-19 12:28:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_79.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_80.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:28:49"}]}]}}
2025-03-19 12:28:49,996 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:28:49,997 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:48:56,387 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:48:56,388 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:48:56,388 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:48:56,388 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:48:56,503 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:48:56,645 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:48:56,646 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:48:56,646 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:48:56,646 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:48:56,860 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:48:58,328 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:48:58,328 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:48:59,544 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:48:59,545 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:48:59,705 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:48:59,706 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:48:59,706 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:48:59,706 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:49:01,128 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:49:01,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:49:02,413 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:49:02,414 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:49:02,415 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:49:02,415 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:49:02,415 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:49:03,502 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:49:03,503 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:49:03,627 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:49:05,633 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:49:05,634 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:49:06,726 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:49:06,726 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:49:06,727 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:49:06,727 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:49:06,806 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:49:08,815 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:49:08,816 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:49:11,011 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:49:11,012 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:49:13,101 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:49:13,101 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:49:14,206 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:49:14,207 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:49:14,207 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:49:14,207 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:49:14,283 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:49:16,300 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:49:16,300 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:49:18,528 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:49:18,529 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:49:19,944 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:49:21,416 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:49:21,417 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:49:22,552 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:49:22,552 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:49:23,660 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:49:23,660 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:49:25,813 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:49:25,814 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:49:26,975 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:49:26,976 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:49:27,102 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:49:32,111 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:49:32,112 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:49:34,251 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:49:34,252 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:49:39,386 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:49:39,387 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:49:41,542 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:49:46,546 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:49:46,547 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_124946.mp4
2025-03-19 12:49:46,547 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:49:46,548 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:49:51,841 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:49:51,843 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:49:51,896 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:49:53,053 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4
2025-03-19 12:49:53,054 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:49:55,069 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:49:58,079 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:49:58,081 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:50:01,085 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:50:01,086 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:50:01,086 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:50:02,290 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:50:02,291 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:50:02,292 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:50:02,292 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:50:02,393 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:50:04,408 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:50:04,409 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:50:04,409 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:50:06,724 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:50:06,725 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:50:14,918 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:50:14,918 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:50:14,918 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:50:14,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:15,254 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:50:15,255 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:15,524 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:50:15,525 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:15,751 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:50:15,751 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,004 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:50:16,005 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,230 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:50:16,231 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,481 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:50:16,481 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,694 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:50:16,695 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:16,953 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:50:16,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:17,189 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:50:17,190 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:50:19,449 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:50:19,450 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:50:19,450 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:50:19,590 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f98068d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t480}
    * Task{c619853 #480 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:50:19,591 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125019_20250319_125019.png
2025-03-19 12:50:21,414 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125019_20250319_125019.png
2025-03-19 12:50:21,414 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125019_20250319_125019.png
2025-03-19 12:50:21,415 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:50:28,304 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:50:29,317 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_81.jpg
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_81.jpg
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:50:29,323 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:50:39,446 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:50:39,447 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:50:39,447 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:50:39,572 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f98068d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t480}
    * Task{c619853 #480 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:50:39,572 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:50:39,572 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:50:39,573 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:50:39,573 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125039_20250319_125039.png
2025-03-19 12:50:41,397 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125039_20250319_125039.png
2025-03-19 12:50:41,397 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125039_20250319_125039.png
2025-03-19 12:50:41,397 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:50:47,284 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_82.jpg
2025-03-19 12:50:47,290 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_82.jpg
2025-03-19 12:50:47,290 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:50:47,290 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:50:47,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:50:47,291 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:50:49,406 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:50:49,407 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:50:49,408 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:50:49,408 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:50:50,418 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:50:51,421 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:50:51,421 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:50:51,421 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 173.0 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-19 12:50:51,422 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:51:01,430 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4 (大小: 4.04MB)
2025-03-19 12:51:01,431 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.505978秒，无需修复
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_124946.mp4
2025-03-19 12:51:01,547 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:51:08,833 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4
2025-03-19 12:51:08,838 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4
2025-03-19 12:51:08,838 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:51:08,838 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:51:14,106 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:51:14,107 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:51:14,476 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:51:15,484 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:51:15,484 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:51:15,484 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:51:16,592 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:51:16,593 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:51:16,594 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:51:18,716 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:51:18,717 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:51:19,883 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:51:19,883 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:51:19,883 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:51:21,022 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:51:21,023 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:51:21,023 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:51:21,023 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:48:59\n- 结束时间: 2025-03-19 12:51:21\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_81.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_82.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_83.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:51:21"}]}]}}
2025-03-19 12:51:21,430 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:51:21,434 - QuickAppADBTester - INFO - 测试完成
2025-03-19 12:56:21,713 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 12:56:21,714 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 12:56:21,715 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 12:56:21,715 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 12:56:21,842 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 12:56:21,995 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 12:56:21,996 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 12:56:21,996 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:56:21,996 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:56:22,238 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:56:22,239 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:56:22,239 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:56:22,239 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:56:23,718 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:23,719 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:24,970 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:56:24,970 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 12:56:24,970 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 12:56:24,971 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 12:56:24,971 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 12:56:25,113 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 12:56:25,114 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 12:56:25,114 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 12:56:25,114 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 12:56:26,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:26,511 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:27,785 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:28,884 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 12:56:28,885 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 12:56:29,002 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 12:56:31,009 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 12:56:31,009 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 12:56:32,105 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 12:56:32,106 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 12:56:32,106 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:56:32,106 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 12:56:32,186 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:56:34,201 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 12:56:34,201 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 12:56:36,377 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 12:56:36,378 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 12:56:38,469 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 12:56:38,469 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 12:56:39,578 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 12:56:39,579 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 12:56:39,579 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:56:39,579 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 12:56:39,655 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:56:41,669 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 12:56:41,670 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 12:56:43,827 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 12:56:43,828 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 12:56:45,238 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 12:56:46,715 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 12:56:46,716 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 12:56:47,870 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 12:56:47,871 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 12:56:48,978 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 12:56:48,979 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 12:56:51,115 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 12:56:51,115 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 12:56:51,115 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 12:56:51,116 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:56:51,116 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:56:52,268 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 12:56:52,269 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 12:56:52,382 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 12:56:57,391 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 12:56:57,392 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 12:56:59,543 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 12:56:59,544 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 12:57:04,682 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 12:57:04,683 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 12:57:06,845 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 12:57:11,856 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 12:57:11,856 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_125711.mp4
2025-03-19 12:57:11,856 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:57:11,857 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:57:17,149 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:57:17,150 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 12:57:17,197 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 12:57:18,357 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4
2025-03-19 12:57:18,358 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 12:57:20,375 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 12:57:23,383 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 12:57:23,384 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 12:57:26,393 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 12:57:26,394 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 12:57:26,394 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 12:57:27,582 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 12:57:27,583 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 12:57:27,583 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 12:57:27,584 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 12:57:27,683 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 12:57:29,699 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 12:57:29,700 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 12:57:29,700 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 12:57:31,967 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 12:57:31,968 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 12:57:40,165 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 12:57:40,166 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 12:57:40,166 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 12:57:40,167 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:40,459 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 12:57:40,460 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:40,731 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 12:57:40,732 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:40,992 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 12:57:40,993 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,249 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 12:57:41,250 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,514 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 12:57:41,515 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,764 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 12:57:41,765 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:41,999 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 12:57:42,000 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:42,305 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 12:57:42,306 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:42,551 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 12:57:42,551 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 12:57:44,813 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 12:57:44,814 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:57:44,815 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:57:44,963 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fa6b2b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t486}
    * Task{6f7a3f7 #486 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 12:57:44,964 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125744_20250319_125744.png
2025-03-19 12:57:46,713 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125744_20250319_125744.png
2025-03-19 12:57:46,714 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_125744_20250319_125744.png
2025-03-19 12:57:46,714 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:57:53,615 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 12:57:54,432 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:57:54,438 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:04,631 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 12:58:04,631 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 12:58:04,632 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fa6b2b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t486}
    * Task{6f7a3f7 #486 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 12:58:04,728 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125804_20250319_125804.png
2025-03-19 12:58:06,000 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125804_20250319_125804.png
2025-03-19 12:58:06,000 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_125804_20250319_125804.png
2025-03-19 12:58:06,000 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 12:58:11,387 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_85.jpg
2025-03-19 12:58:11,393 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_85.jpg
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:58:11,394 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:13,564 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 12:58:13,565 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 12:58:13,566 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 12:58:13,566 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 12:58:14,575 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 12:58:15,582 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 12:58:15,583 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 12:58:15,583 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 152.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 12:58:15,583 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 12:58:25,591 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4 (大小: 3.74MB)
2025-03-19 12:58:25,591 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.288244秒，无需修复
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_125711.mp4
2025-03-19 12:58:25,700 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 12:58:34,457 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4
2025-03-19 12:58:34,464 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4
2025-03-19 12:58:34,464 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 12:58:34,464 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 12:58:39,689 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 12:58:39,690 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 12:58:40,186 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 12:58:41,195 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 12:58:41,196 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:58:41,196 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:42,308 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 12:58:42,309 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 12:58:42,309 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 12:58:44,413 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 12:58:44,414 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 12:58:45,589 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 12:58:45,590 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 12:58:45,590 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 12:58:46,737 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 12:58:46,738 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 12:58:46,739 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 12:58:46,739 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 12:56:24\n- 结束时间: 2025-03-19 12:58:46\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_85.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_86.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 12:58:46"}]}]}}
2025-03-19 12:58:47,130 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 12:58:47,134 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:03:47,248 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:03:47,250 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:03:47,250 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:03:47,250 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:03:47,385 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:03:47,540 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:03:47,541 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:03:47,541 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:03:47,541 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:03:47,755 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:03:47,755 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:03:47,756 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:03:47,756 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:03:49,231 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:03:49,232 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:03:50,511 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:03:50,512 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:03:50,663 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:03:50,664 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:03:50,664 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:03:50,664 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:03:52,076 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:03:52,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:03:53,352 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:03:53,353 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:03:54,453 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:03:54,454 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:03:54,565 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:03:56,572 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:03:56,573 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:03:57,665 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:03:57,666 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:03:57,666 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:03:57,666 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:03:57,744 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:03:59,763 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:03:59,765 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:04:01,920 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:04:01,921 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:04:04,013 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:04:04,014 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:04:05,120 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:04:05,121 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:04:05,121 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:04:05,121 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:04:05,203 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:04:07,218 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:04:07,219 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:04:09,387 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:04:09,387 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:04:10,808 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:04:12,296 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:04:12,297 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:04:13,466 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:04:13,467 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:04:14,569 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:04:14,570 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:04:16,722 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:04:16,722 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:04:16,723 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:04:16,723 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:04:16,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:04:17,879 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:04:17,880 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:04:18,005 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:04:23,013 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:04:23,014 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:04:25,168 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:04:25,169 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:04:30,321 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:04:30,322 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:04:32,481 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:04:37,486 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:04:37,487 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_130437.mp4
2025-03-19 13:04:37,487 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:04:37,487 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:04:42,780 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:04:42,781 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:04:42,828 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:04:43,991 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4
2025-03-19 13:04:43,992 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:04:46,006 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:04:49,015 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:04:49,016 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:04:52,021 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:04:52,021 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:04:52,022 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:04:53,208 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:04:53,209 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:04:53,209 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:04:53,209 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:04:53,309 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:04:55,320 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:04:55,321 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:04:55,321 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:04:57,644 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:04:57,645 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:05:05,845 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:05:05,846 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:05:05,846 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:05:05,847 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,119 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:05:06,120 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,383 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:05:06,384 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,612 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:05:06,613 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:06,859 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:05:06,860 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,102 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:05:07,103 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,344 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:05:07,345 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,594 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:05:07,595 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:07,822 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:05:07,822 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:08,083 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:05:08,084 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:05:10,327 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:05:10,329 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:05:10,329 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:05:10,488 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bb9912c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t492}
    * Task{a501bfb #492 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:05:10,488 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:05:10,489 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:05:10,489 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:05:10,489 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_130510_20250319_130510.png
2025-03-19 13:05:11,984 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_130510_20250319_130510.png
2025-03-19 13:05:11,984 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_130510_20250319_130510.png
2025-03-19 13:05:11,985 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:05:19,217 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:05:19,390 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:19,396 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:19,397 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:05:19,397 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:05:19,397 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:05:29,562 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:05:29,563 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:05:29,563 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:05:29,690 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bb9912c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t492}
    * Task{a501bfb #492 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:05:29,690 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:05:29,691 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:05:29,691 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:05:29,691 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_130529_20250319_130529.png
2025-03-19 13:05:31,204 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_130529_20250319_130529.png
2025-03-19 13:05:31,205 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_130529_20250319_130529.png
2025-03-19 13:05:31,205 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:05:35,714 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:05:35,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:05:37,895 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:05:38,905 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:05:39,911 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:05:39,911 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:05:39,911 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 109.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:05:39,912 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:05:49,922 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4 (大小: 3.52MB)
2025-03-19 13:05:49,924 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.032389秒，无需修复
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_130437.mp4
2025-03-19 13:05:50,043 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:05:57,286 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4
2025-03-19 13:05:57,292 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4
2025-03-19 13:05:57,292 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:05:57,292 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:06:02,520 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:06:02,522 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4
2025-03-19 13:06:02,522 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:06:02,522 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:06:02,523 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:06:02,869 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:06:03,876 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:06:03,877 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:06:03,877 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:06:04,998 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:06:04,999 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:06:04,999 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:06:07,107 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:06:07,108 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:06:08,274 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:06:08,275 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:06:08,275 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:06:09,416 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:06:09,417 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:06:09,418 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:06:09,418 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:03:50\n- 结束时间: 2025-03-19 13:06:09\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_87.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_88.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:06:09"}]}]}}
2025-03-19 13:06:09,786 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:06:09,789 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:11:09,995 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:11:09,997 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:11:09,997 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:11:09,997 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:11:10,133 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:11:10,274 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:11:10,275 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:11:10,275 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:11:10,275 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:11:10,522 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:11:10,523 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:11:10,523 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:11:10,524 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:11:12,006 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:12,007 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:13,275 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:11:13,276 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:11:13,428 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:11:13,429 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:11:13,429 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:11:13,429 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:11:14,844 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:14,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:16,096 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:11:16,096 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:11:16,097 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:11:16,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:16,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:17,191 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:11:17,192 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:11:17,309 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:11:19,315 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:11:19,316 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:11:20,410 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:11:20,411 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:11:20,411 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:11:20,411 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:11:20,491 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:11:22,507 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:11:22,508 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:11:24,704 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:11:24,705 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:11:26,796 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:11:26,797 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:11:27,908 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:11:27,913 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:11:27,914 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:11:27,914 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:11:27,991 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:11:30,005 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:11:30,006 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:11:32,165 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:11:32,166 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:11:33,590 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:11:35,061 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:11:35,062 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:11:36,257 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:11:36,258 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:11:37,361 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:11:37,361 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:11:39,548 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:11:39,549 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:11:40,728 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:11:40,728 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:11:40,857 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:11:45,864 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:11:45,865 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:11:48,017 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:11:48,018 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:11:53,177 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:11:53,179 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:11:55,332 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:12:00,337 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:12:00,338 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_131200.mp4
2025-03-19 13:12:00,338 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:12:00,338 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:12:05,630 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:12:05,632 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:12:05,677 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:12:06,837 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4
2025-03-19 13:12:06,838 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:12:08,847 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:12:11,857 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:12:11,857 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:12:14,864 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:12:14,865 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:12:14,865 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:12:16,072 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:12:16,073 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:12:16,073 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:12:16,073 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:12:16,172 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:12:18,188 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:12:18,189 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:12:18,189 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:12:20,478 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:12:20,479 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:12:28,667 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:12:28,668 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:12:28,668 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:12:28,668 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:28,895 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:12:28,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,182 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:12:29,183 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,448 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:12:29,449 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,676 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:12:29,676 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:29,918 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:12:29,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,146 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:12:30,147 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,381 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:12:30,382 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,618 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:12:30,618 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:30,847 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:12:30,848 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:12:33,102 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:12:33,102 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:12:33,102 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:12:33,258 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{55b4044 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t498}
    * Task{dfa5a62 #498 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:12:33,259 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131233_20250319_131233.png
2025-03-19 13:12:34,621 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131233_20250319_131233.png
2025-03-19 13:12:34,621 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131233_20250319_131233.png
2025-03-19 13:12:34,621 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:12:41,541 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_89.jpg
2025-03-19 13:12:41,547 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_89.jpg
2025-03-19 13:12:41,547 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:12:41,548 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:12:41,548 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:12:42,072 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:12:51,669 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:12:51,670 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:12:51,670 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:12:51,819 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{55b4044 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t498}
    * Task{dfa5a62 #498 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:12:51,820 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_131251_20250319_131251.png
2025-03-19 13:12:53,175 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_131251_20250319_131251.png
2025-03-19 13:12:53,175 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_131251_20250319_131251.png
2025-03-19 13:12:53,175 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:12:58,997 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_90.jpg
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_90.jpg
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:12:59,003 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:13:01,186 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:13:01,187 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:13:01,188 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:13:01,188 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:13:02,195 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:13:03,202 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:13:03,203 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:13:03,203 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 122.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:13:03,203 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:13:13,211 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4 (大小: 3.22MB)
2025-03-19 13:13:13,212 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.518422秒，无需修复
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131200.mp4
2025-03-19 13:13:13,317 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:13:20,581 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4
2025-03-19 13:13:20,588 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4
2025-03-19 13:13:20,588 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:13:20,588 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:13:25,869 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:13:25,871 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:13:26,227 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:13:27,236 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:13:27,237 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:13:27,237 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:13:28,344 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:13:28,345 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:13:28,345 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:13:30,454 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:13:30,454 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:13:31,638 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:13:31,639 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:13:31,639 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:13:32,786 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:13:32,787 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:13:32,787 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:13:32,788 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:11:13\n- 结束时间: 2025-03-19 13:13:32\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_89.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_90.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_91.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:13:32"}]}]}}
2025-03-19 13:13:33,244 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:13:33,246 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:18:33,471 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:18:33,473 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:18:33,473 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:18:33,474 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:18:33,599 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:18:33,761 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:18:33,762 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:18:33,762 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:18:33,762 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:18:33,989 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:18:33,990 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:18:33,990 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:18:33,990 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:18:35,468 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:18:35,469 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:18:36,722 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:18:36,723 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:18:36,865 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:18:36,865 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:18:36,866 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:18:36,866 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:18:38,273 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:18:38,274 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:18:39,522 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:18:40,622 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:18:40,623 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:18:40,754 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:18:42,758 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:18:42,758 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:18:43,851 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:18:43,852 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:18:43,852 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:18:43,853 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:18:43,929 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:18:45,948 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:18:45,949 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:18:48,127 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:18:48,128 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:18:50,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:18:50,220 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:18:51,319 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:18:51,320 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:18:51,320 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:18:51,320 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:18:51,384 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:18:53,397 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:18:53,398 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:18:55,567 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:18:55,568 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:18:56,993 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:18:58,472 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:18:58,473 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:18:59,627 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:18:59,628 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:19:00,741 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:19:00,741 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:19:02,951 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:19:02,952 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:19:04,135 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:19:04,136 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:19:04,251 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:19:09,254 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:19:09,254 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:19:11,424 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:19:11,425 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:19:16,583 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:19:16,584 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:19:18,756 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:19:23,765 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:19:23,766 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_131923.mp4
2025-03-19 13:19:23,766 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:19:23,766 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:19:29,055 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:19:29,056 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:19:29,102 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:19:30,316 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4
2025-03-19 13:19:30,317 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:19:32,333 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:19:35,344 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:19:35,345 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:19:38,349 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:19:38,350 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:19:38,350 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:19:39,546 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:19:39,547 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:19:39,547 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:19:39,547 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:19:39,650 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:19:41,665 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:19:41,665 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:19:41,666 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:19:43,967 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:19:43,968 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:19:52,171 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:19:52,172 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:19:52,172 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:19:52,172 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:52,482 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:19:52,482 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:52,774 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:19:52,775 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,006 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:19:53,007 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,224 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:19:53,225 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,454 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:19:53,455 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,697 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:19:53,698 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:53,928 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:19:53,929 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:54,194 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:19:54,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:54,423 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:19:54,424 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:19:56,675 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:19:56,676 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:19:56,676 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:19:56,790 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ed9ed98 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t504}
    * Task{4ccc457 #504 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:19:56,791 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131956_20250319_131956.png
2025-03-19 13:19:57,910 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131956_20250319_131956.png
2025-03-19 13:19:57,910 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_131956_20250319_131956.png
2025-03-19 13:19:57,910 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:20:04,102 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_92.jpg
2025-03-19 13:20:04,108 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_92.jpg
2025-03-19 13:20:04,109 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:20:04,109 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:04,109 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:05,573 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:20:14,299 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:20:14,299 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:20:14,300 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:20:14,411 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ed9ed98 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t504}
    * Task{4ccc457 #504 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:20:14,412 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_132014_20250319_132014.png
2025-03-19 13:20:15,465 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_132014_20250319_132014.png
2025-03-19 13:20:15,466 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_132014_20250319_132014.png
2025-03-19 13:20:15,466 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:20:21,212 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_93.jpg
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_93.jpg
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:21,218 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:23,369 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:20:23,370 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:20:23,370 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:20:23,370 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:20:24,371 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:20:25,381 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:20:25,381 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:20:25,382 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 120.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:20:25,382 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:20:35,390 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4 (大小: 2.77MB)
2025-03-19 13:20:35,392 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.215833秒，无需修复
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_131923.mp4
2025-03-19 13:20:35,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:20:42,902 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4
2025-03-19 13:20:42,907 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4
2025-03-19 13:20:42,908 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:20:42,909 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:20:48,153 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:20:48,155 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4
2025-03-19 13:20:48,155 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:20:48,155 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:20:48,157 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:20:48,535 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:20:49,540 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:20:49,541 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:49,541 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:50,643 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:20:50,643 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:20:50,643 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:20:52,737 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:20:52,738 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:20:53,890 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:20:53,891 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:20:53,891 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:20:55,022 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:20:55,024 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:20:55,024 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:20:55,024 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:18:36\n- 结束时间: 2025-03-19 13:20:55\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_92.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_93.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_94.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:20:55"}]}]}}
2025-03-19 13:20:55,406 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:20:55,409 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:30:22,898 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:30:22,900 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:30:22,905 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:30:22,907 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:30:23,058 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:30:23,442 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:30:23,442 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:30:23,442 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:30:23,444 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:30:23,681 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:30:25,157 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:25,158 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:26,405 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:30:26,406 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:30:26,567 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:30:26,568 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:30:26,568 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:30:26,568 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:30:27,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:27,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:29,228 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:29,229 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:30,449 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:30:30,449 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:30:30,564 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:30:32,566 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:30:32,567 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:30:33,649 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:30:33,650 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:30:33,650 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:30:33,650 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:30:33,710 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:30:35,720 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:30:35,721 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:30:37,897 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:30:37,897 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:30:39,976 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:30:39,977 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:30:41,080 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:30:41,081 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:30:41,081 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:30:41,081 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:30:41,162 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:30:43,171 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:30:43,172 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:30:45,369 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:30:45,370 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:30:46,781 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:30:48,269 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:30:48,269 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:30:49,390 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:30:49,391 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:30:50,490 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:30:50,491 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:30:52,666 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:30:52,667 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:30:53,844 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:30:53,845 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:30:53,963 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:30:58,967 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:30:58,968 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:31:01,111 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:31:01,112 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:31:06,249 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:31:06,251 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:31:08,430 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:31:13,434 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:31:13,435 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_133113.mp4
2025-03-19 13:31:13,435 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:31:13,436 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:31:18,715 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:31:18,716 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:31:18,762 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:31:19,949 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4
2025-03-19 13:31:19,949 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:31:21,956 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:31:24,959 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:31:24,959 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:31:27,964 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:31:27,965 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:31:27,965 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:31:29,166 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:31:29,167 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:31:29,167 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:31:29,167 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:31:29,277 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:31:31,287 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:31:31,288 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:31:31,288 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:31:33,586 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:31:33,586 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:31:41,735 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:31:41,736 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:31:41,736 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:31:41,736 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,004 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:31:42,005 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,230 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:31:42,231 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,488 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:31:42,489 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,710 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:31:42,711 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:42,940 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:31:42,941 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,161 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:31:43,162 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,407 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:31:43,408 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,633 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:31:43,634 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:43,875 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:31:43,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:31:46,124 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:31:46,125 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:31:46,126 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ac4feb5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t510}
    * Task{86b70bb #510 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:31:46,247 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133146_20250319_133146.png
2025-03-19 13:31:48,041 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133146_20250319_133146.png
2025-03-19 13:31:48,042 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133146_20250319_133146.png
2025-03-19 13:31:48,042 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:31:55,057 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:31:55,895 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:31:55,903 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:31:55,904 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:31:55,904 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:31:55,904 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:06,048 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:32:06,050 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:32:06,050 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:32:06,187 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ac4feb5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t510}
    * Task{86b70bb #510 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:32:06,187 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:32:06,188 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:32:06,188 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:32:06,188 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133206_20250319_133206.png
2025-03-19 13:32:07,908 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133206_20250319_133206.png
2025-03-19 13:32:07,908 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133206_20250319_133206.png
2025-03-19 13:32:07,908 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:32:14,592 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:32:14,599 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:32:14,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:16,736 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:32:16,737 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:32:16,737 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:32:16,738 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:32:17,740 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:32:18,746 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:32:18,747 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:32:18,747 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 130.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:32:18,747 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:32:28,752 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4 (大小: 3.92MB)
2025-03-19 13:32:28,754 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:32:28,900 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.903556秒，无需修复
2025-03-19 13:32:28,901 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:32:28,901 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133113.mp4
2025-03-19 13:32:28,901 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:32:41,564 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4
2025-03-19 13:32:41,566 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4
2025-03-19 13:32:41,566 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:32:41,566 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:32:46,741 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:32:46,743 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:32:47,158 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:32:48,163 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:32:48,163 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:32:48,163 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:49,253 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:32:49,254 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:32:49,254 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:32:51,369 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:32:51,370 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:32:52,524 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:32:52,525 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:32:52,525 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:32:53,643 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:32:53,644 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:32:53,645 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:32:53,646 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:30:26\n- 结束时间: 2025-03-19 13:32:53\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_95.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_96.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:32:53"}]}]}}
2025-03-19 13:32:54,327 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:32:54,330 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:37:54,351 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:37:54,353 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:37:54,354 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:37:54,354 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:37:54,488 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:37:54,621 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:37:54,622 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:37:54,622 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:37:54,622 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:37:54,870 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:37:54,871 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:37:54,871 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:37:54,871 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:37:56,385 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:37:56,386 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:37:57,613 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:37:57,613 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:37:57,614 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:37:57,614 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:37:57,614 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:37:57,759 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:37:59,149 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:37:59,150 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:38:00,413 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:38:01,506 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:38:01,507 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:38:01,634 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:38:03,639 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:38:03,639 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:38:04,700 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:38:04,701 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:38:04,702 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:38:04,702 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:38:04,780 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:38:06,791 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:38:06,791 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:38:08,938 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:38:08,939 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:38:11,021 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:38:11,022 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:38:12,119 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:38:12,119 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:38:12,120 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:38:12,120 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:38:12,181 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:38:14,189 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:38:14,189 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:38:16,373 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:38:16,376 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:38:17,802 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:38:19,281 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:38:19,281 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:38:20,455 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:38:20,456 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:38:21,568 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:38:21,568 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:38:23,746 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:38:23,747 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:38:23,748 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:38:23,748 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:38:23,749 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:38:24,912 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:38:24,912 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:38:25,024 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:38:30,029 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:38:30,029 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:38:32,165 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:38:32,166 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:38:37,313 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:38:37,314 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:38:39,479 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:38:44,485 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:38:44,485 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_133844.mp4
2025-03-19 13:38:44,486 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:38:44,486 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:38:49,752 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:38:49,753 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:38:49,799 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:38:50,930 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4
2025-03-19 13:38:50,932 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:38:52,942 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:38:55,948 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:38:55,948 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:38:58,951 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:38:58,952 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:38:58,952 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:39:00,118 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:39:00,221 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:39:02,230 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:39:02,231 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:39:02,231 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:39:04,514 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:39:04,517 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:39:12,749 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:39:12,751 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:39:12,751 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:39:12,751 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,049 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:39:13,050 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,267 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:39:13,268 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,504 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:39:13,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,736 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:39:13,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:13,954 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:39:13,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,208 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:39:14,209 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,438 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:39:14,439 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,672 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:39:14,673 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:14,921 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:39:14,922 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:39:17,180 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:39:17,181 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:39:17,182 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c0e905a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t516}
    * Task{59f6f68 #516 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:39:17,309 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:39:17,310 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133917_20250319_133917.png
2025-03-19 13:39:18,760 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133917_20250319_133917.png
2025-03-19 13:39:18,761 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_133917_20250319_133917.png
2025-03-19 13:39:18,761 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:39:25,658 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:25,663 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:25,664 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:39:25,664 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:39:25,664 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:39:26,064 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:39:35,856 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:39:35,857 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:39:35,857 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:39:35,972 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c0e905a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t516}
    * Task{59f6f68 #516 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:39:35,973 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133935_20250319_133935.png
2025-03-19 13:39:37,443 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133935_20250319_133935.png
2025-03-19 13:39:37,443 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_133935_20250319_133935.png
2025-03-19 13:39:37,443 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:39:42,006 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:42,010 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:39:42,011 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:39:44,146 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:39:44,147 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:39:44,147 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:39:44,148 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:39:45,150 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:39:46,154 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:39:46,156 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:39:46,157 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 138.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:39:46,157 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:39:56,159 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4 (大小: 3.26MB)
2025-03-19 13:39:56,160 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.300389秒，无需修复
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_133844.mp4
2025-03-19 13:39:56,291 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:40:03,594 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4
2025-03-19 13:40:03,595 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4
2025-03-19 13:40:03,596 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:40:03,596 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:40:08,834 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:40:08,835 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:40:09,174 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:40:10,179 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:40:10,180 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:40:10,180 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:40:11,274 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:40:11,274 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:40:11,275 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:40:13,372 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:40:13,372 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:40:14,548 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:40:14,548 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:40:14,548 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:40:15,681 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:40:15,682 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:40:15,683 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:40:15,683 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:37:57\n- 结束时间: 2025-03-19 13:40:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_97.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_98.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:40:15"}]}]}}
2025-03-19 13:40:16,155 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:40:16,157 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:45:16,207 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:45:16,208 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:45:16,209 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:45:16,209 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:45:16,331 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:45:16,497 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:45:16,499 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:45:16,499 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:45:16,499 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:45:16,741 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:45:16,741 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:45:16,742 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:45:16,742 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:45:18,218 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:18,219 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:45:19,494 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:45:19,664 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:45:19,664 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:45:19,665 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:45:19,665 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:45:21,087 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:21,088 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:22,352 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:23,453 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:45:23,453 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:45:23,568 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:45:25,573 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:45:25,573 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:45:26,648 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:45:26,649 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:45:26,649 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:45:26,649 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:45:26,716 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:45:28,722 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:45:28,722 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:45:30,904 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:45:30,904 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:45:32,987 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:45:32,987 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:45:34,094 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:45:34,095 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:45:34,095 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:45:34,095 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:45:34,168 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:45:36,171 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:45:36,171 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:45:38,342 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:45:38,343 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:45:39,758 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:45:41,246 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:45:41,247 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:45:42,378 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:45:42,379 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:45:43,491 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:45:43,492 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:45:45,679 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:45:45,680 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:45:46,848 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:45:46,849 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:45:46,972 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:45:51,975 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:45:51,975 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:45:54,115 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:45:54,115 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:45:59,225 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:45:59,225 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:46:01,375 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_134606.mp4
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:46:06,380 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:46:11,629 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:46:11,629 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:46:11,655 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:46:12,844 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4
2025-03-19 13:46:12,845 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:46:14,853 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:46:17,857 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:46:17,858 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:46:20,861 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:46:20,861 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:46:20,862 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:46:22,028 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:46:22,029 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:46:22,029 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:46:22,029 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:46:22,131 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:46:24,139 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:46:24,140 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:46:24,140 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:46:26,381 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:46:26,382 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:46:34,502 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:46:34,503 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:46:34,503 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:46:34,503 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:34,774 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:46:34,775 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,007 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:46:35,008 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,254 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:46:35,255 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,502 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:46:35,503 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,752 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:46:35,754 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:35,973 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:46:35,973 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:36,223 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:46:36,224 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:36,490 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:46:36,491 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:36,741 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:46:36,742 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:46:38,978 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:46:38,979 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:46:38,979 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:46:39,101 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2fa2e7f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t522}
    * Task{f0d339b #522 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:46:39,102 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_134639_20250319_134639.png
2025-03-19 13:46:41,188 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_134639_20250319_134639.png
2025-03-19 13:46:41,190 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_134639_20250319_134639.png
2025-03-19 13:46:41,190 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:46:47,948 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:46:48,775 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:46:48,781 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:46:48,782 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:46:48,782 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:46:48,782 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:46:58,899 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:46:58,900 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:46:58,900 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:46:59,029 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2fa2e7f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t522}
    * Task{f0d339b #522 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:46:59,030 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_134659_20250319_134659.png
2025-03-19 13:47:01,091 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_134659_20250319_134659.png
2025-03-19 13:47:01,096 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_134659_20250319_134659.png
2025-03-19 13:47:01,096 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:47:07,062 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:47:07,065 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg
2025-03-19 13:47:07,065 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:47:07,066 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:47:07,066 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:47:07,066 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:47:09,179 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:47:09,180 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:47:09,180 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:47:09,180 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:47:10,184 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:47:11,186 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:47:11,187 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:47:11,187 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:47:11,187 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:47:21,190 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4 (大小: 3.70MB)
2025-03-19 13:47:21,192 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.450222秒，无需修复
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_134606.mp4
2025-03-19 13:47:21,310 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:47:28,635 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4
2025-03-19 13:47:28,642 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4
2025-03-19 13:47:28,642 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:47:28,642 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:47:33,902 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:47:33,903 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:47:34,282 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:47:35,287 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:47:35,288 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:47:35,288 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:47:36,396 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:47:36,397 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:47:36,397 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:47:38,510 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:47:38,511 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:47:39,687 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:47:39,689 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:47:39,689 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:47:40,816 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:47:40,817 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:47:40,817 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:47:40,818 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:45:19\n- 结束时间: 2025-03-19 13:47:40\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_99.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_100.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:47:40"}]}]}}
2025-03-19 13:47:41,411 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:47:41,414 - QuickAppADBTester - INFO - 测试完成
2025-03-19 13:52:41,447 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 13:52:41,450 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 13:52:41,451 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 13:52:41,451 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 13:52:41,596 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:52:41,711 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:52:41,944 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:52:43,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:52:43,430 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:52:44,717 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 13:52:44,718 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 13:52:44,867 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 13:52:44,868 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 13:52:44,868 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 13:52:44,868 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 13:52:46,280 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:52:46,281 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:52:47,576 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:52:48,669 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 13:52:48,669 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 13:52:48,794 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 13:52:50,799 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 13:52:50,799 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 13:52:51,876 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 13:52:51,877 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 13:52:51,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:52:51,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 13:52:51,957 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:52:53,968 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 13:52:53,969 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 13:52:56,163 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 13:52:56,164 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 13:52:58,263 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 13:52:58,264 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 13:52:59,367 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 13:52:59,368 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 13:52:59,368 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:52:59,369 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 13:52:59,449 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:53:01,458 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 13:53:01,459 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 13:53:03,679 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 13:53:03,680 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 13:53:05,066 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 13:53:06,516 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 13:53:06,517 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 13:53:07,712 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 13:53:07,712 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 13:53:08,821 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 13:53:08,822 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 13:53:11,016 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 13:53:11,017 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 13:53:11,017 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 13:53:11,018 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:53:11,018 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:53:12,215 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 13:53:12,217 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 13:53:12,347 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 13:53:17,353 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 13:53:17,354 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 13:53:19,518 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 13:53:19,519 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 13:53:24,669 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 13:53:24,669 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 13:53:26,821 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 13:53:31,827 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 13:53:31,827 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_135331.mp4
2025-03-19 13:53:31,828 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:53:31,828 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:53:37,100 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:53:37,103 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 13:53:37,146 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 13:53:38,329 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4
2025-03-19 13:53:38,329 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 13:53:40,340 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 13:53:43,343 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 13:53:43,345 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 13:53:46,346 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 13:53:46,346 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 13:53:46,347 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 13:53:47,532 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 13:53:47,533 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 13:53:47,533 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 13:53:47,533 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 13:53:47,612 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 13:53:49,621 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 13:53:49,622 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 13:53:49,622 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 13:53:51,880 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 13:53:51,880 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 13:54:00,066 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 13:54:00,066 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 13:54:00,066 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 13:54:00,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:00,309 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 13:54:00,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:00,545 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 13:54:00,546 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:00,790 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 13:54:00,791 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,038 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 13:54:01,038 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,278 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 13:54:01,279 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,504 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 13:54:01,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,740 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 13:54:01,741 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:01,967 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 13:54:01,968 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:02,215 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 13:54:02,216 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 13:54:04,447 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 13:54:04,448 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:54:04,448 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:54:04,605 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{de1f706 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t528}
    * Task{71e371d #528 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 13:54:04,606 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_135404_20250319_135404.png
2025-03-19 13:54:06,451 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_135404_20250319_135404.png
2025-03-19 13:54:06,452 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_135404_20250319_135404.png
2025-03-19 13:54:06,452 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:54:13,431 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 13:54:13,555 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_101.jpg
2025-03-19 13:54:13,564 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_101.jpg
2025-03-19 13:54:13,565 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 13:54:13,565 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:54:13,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:54:23,693 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 13:54:23,696 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 13:54:23,696 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 13:54:23,802 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{de1f706 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t528}
    * Task{71e371d #528 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 13:54:23,803 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_135423_20250319_135423.png
2025-03-19 13:54:25,708 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_135423_20250319_135423.png
2025-03-19 13:54:25,708 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_135423_20250319_135423.png
2025-03-19 13:54:25,708 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 13:54:32,048 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_102.jpg
2025-03-19 13:54:32,053 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_102.jpg
2025-03-19 13:54:32,053 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 13:54:32,053 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 13:54:32,054 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:54:32,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:54:34,193 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 13:54:34,194 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 13:54:34,194 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 13:54:34,194 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 13:54:35,198 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 13:54:36,199 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 13:54:36,200 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 13:54:36,200 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 137.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 13:54:36,200 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 13:54:46,203 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4 (大小: 4.26MB)
2025-03-19 13:54:46,203 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.115589秒，无需修复
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_135331.mp4
2025-03-19 13:54:46,320 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 13:54:53,715 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4
2025-03-19 13:54:53,720 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4
2025-03-19 13:54:53,720 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 13:54:53,720 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 13:54:59,043 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 13:54:59,044 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4
2025-03-19 13:54:59,044 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 13:54:59,045 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 13:54:59,045 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 13:54:59,425 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 13:55:00,426 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 13:55:00,426 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:55:00,427 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:55:01,537 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 13:55:01,538 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 13:55:01,538 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 13:55:03,629 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 13:55:03,630 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 13:55:04,778 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 13:55:04,779 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 13:55:04,779 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 13:55:05,921 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 13:55:05,922 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 13:55:05,922 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 13:55:05,923 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 13:52:44\n- 结束时间: 2025-03-19 13:55:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_101.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_102.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_103.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 13:55:05"}]}]}}
2025-03-19 13:55:06,435 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 13:55:06,437 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:00:06,488 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:00:06,491 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:00:06,491 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:00:06,491 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:00:06,635 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:00:06,769 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:00:06,769 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:00:06,770 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:00:06,770 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:00:07,013 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:00:07,014 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:00:07,014 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:00:07,015 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:00:08,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:08,505 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:09,763 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:00:09,764 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:00:09,932 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:00:09,933 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:00:09,933 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:00:09,933 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:00:11,347 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:11,348 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:12,624 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:00:12,624 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:00:12,624 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:00:12,625 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:12,625 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:13,712 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:00:13,713 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:00:13,832 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:00:15,838 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:00:15,838 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:00:16,925 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:00:16,926 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:00:16,927 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:00:16,927 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:00:17,007 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:00:19,015 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:00:19,015 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:00:21,215 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:00:21,216 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:00:23,303 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:00:23,304 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:00:24,408 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:00:24,409 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:00:24,409 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:00:24,409 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:00:24,487 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:00:26,497 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:00:26,497 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:00:28,725 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:00:28,726 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:00:30,149 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:00:31,591 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:00:31,591 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:00:32,789 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:00:32,791 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:00:33,904 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:00:33,905 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:00:36,092 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:00:36,092 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:00:36,092 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:00:36,093 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:00:36,093 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:00:37,226 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:00:37,227 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:00:37,356 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:00:42,360 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:00:42,361 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:00:44,538 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:00:44,539 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:00:49,730 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:00:49,732 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:00:51,899 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:00:56,904 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:00:56,905 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_140056.mp4
2025-03-19 14:00:56,906 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:00:56,906 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:01:02,157 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:01:02,158 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:01:02,206 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:01:03,397 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4
2025-03-19 14:01:03,398 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:01:05,408 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:01:08,413 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:01:08,414 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:01:11,420 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:01:11,421 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:01:11,421 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:01:12,606 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:01:12,607 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:01:12,607 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:01:12,608 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:01:12,718 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:01:14,727 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:01:14,727 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:01:14,727 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:01:17,015 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:01:17,016 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:01:25,193 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:01:25,193 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:01:25,194 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:01:25,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:25,468 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:01:25,468 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:25,758 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:01:25,759 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,005 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:01:26,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,254 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:01:26,254 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,495 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:01:26,496 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:26,749 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:01:26,750 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:27,004 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:01:27,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:27,279 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:01:27,279 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:27,503 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:01:27,504 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:01:29,745 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:01:29,746 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:01:29,746 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:01:29,858 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4185d03 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t534}
    * Task{b031efe #534 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:01:29,858 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:01:29,858 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:01:29,859 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:01:29,859 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140129_20250319_140129.png
2025-03-19 14:01:31,442 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140129_20250319_140129.png
2025-03-19 14:01:31,442 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140129_20250319_140129.png
2025-03-19 14:01:31,443 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:01:38,514 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:01:38,642 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:38,646 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:38,647 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:01:38,647 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:01:38,647 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:01:48,766 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:01:48,767 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:01:48,767 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:01:48,893 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4185d03 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t534}
    * Task{b031efe #534 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:01:48,894 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140148_20250319_140148.png
2025-03-19 14:01:50,581 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140148_20250319_140148.png
2025-03-19 14:01:50,582 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140148_20250319_140148.png
2025-03-19 14:01:50,582 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:01:55,269 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:55,275 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:01:55,276 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:01:57,394 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:01:57,395 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:01:57,395 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:01:57,395 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:01:58,398 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:01:59,401 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:02:09,406 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4 (大小: 3.74MB)
2025-03-19 14:02:09,407 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.185700秒，无需修复
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140056.mp4
2025-03-19 14:02:09,534 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:02:16,317 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4
2025-03-19 14:02:16,322 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4
2025-03-19 14:02:16,322 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:02:16,322 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:02:21,582 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:02:21,583 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4
2025-03-19 14:02:21,584 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:02:21,584 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:02:21,584 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:02:21,901 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:02:22,904 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:02:22,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:02:22,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:02:24,024 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:02:24,025 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:02:24,025 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:02:26,144 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:02:26,145 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:02:27,297 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:02:27,298 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:02:27,298 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:02:28,419 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:02:28,420 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:02:28,421 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:02:28,421 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:00:09\n- 结束时间: 2025-03-19 14:02:28\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_104.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_105.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:02:28"}]}]}}
2025-03-19 14:02:28,871 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:02:28,874 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:07:28,896 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:07:28,899 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:07:28,899 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:07:28,899 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:07:29,034 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:07:29,194 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:07:29,195 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:07:29,195 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:07:29,195 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:07:29,410 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:07:29,410 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:07:29,410 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:07:29,411 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:07:30,908 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:30,908 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:32,180 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:07:32,180 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:07:32,181 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:07:32,181 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:07:32,181 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:07:32,333 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:07:32,334 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:07:32,334 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:07:32,334 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:07:33,744 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:33,745 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:35,005 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:35,007 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:36,110 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:07:36,126 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:07:36,240 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:07:38,245 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:07:38,245 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:07:39,339 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:07:39,340 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:07:39,340 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:07:39,340 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:07:39,432 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:07:41,441 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:07:41,442 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:07:43,633 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:07:43,634 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:07:45,734 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:07:45,735 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:07:46,843 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:07:46,844 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:07:46,844 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:07:46,844 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:07:46,920 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:07:48,929 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:07:48,929 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:07:51,114 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:07:51,115 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:07:52,535 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:07:54,007 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:07:54,008 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:07:55,183 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:07:55,184 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:07:56,299 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:07:56,300 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:07:58,490 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:07:58,491 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:07:58,492 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:07:58,492 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:07:58,492 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:07:59,666 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:07:59,667 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:07:59,800 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:08:04,806 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:08:04,807 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:08:06,960 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:08:06,961 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:08:12,166 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:08:12,168 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:08:14,318 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:08:19,322 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:08:19,323 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_140819.mp4
2025-03-19 14:08:19,323 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:08:19,323 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:08:24,547 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:08:24,547 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:08:24,583 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:08:25,771 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4
2025-03-19 14:08:25,771 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:08:27,783 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:08:30,789 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:08:30,789 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:08:33,792 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:08:33,792 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:08:33,792 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:08:34,945 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:08:34,946 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:08:34,946 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:08:34,946 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:08:35,042 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:08:37,049 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:08:37,049 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:08:37,049 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:08:39,312 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:08:39,313 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:08:47,499 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:08:47,503 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:08:47,503 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:08:47,503 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:47,843 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:08:47,844 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,084 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:08:48,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,317 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:08:48,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,554 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:08:48,555 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:48,857 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:08:48,858 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,116 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:08:49,116 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,368 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:08:49,369 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,629 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:08:49,629 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:49,859 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:08:49,859 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:08:52,113 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:08:52,114 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:08:52,114 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:08:52,417 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{13ef717 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t540}
    * Task{c38bf22 #540 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:08:52,418 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140852_20250319_140852.png
2025-03-19 14:08:54,205 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140852_20250319_140852.png
2025-03-19 14:08:54,213 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_140852_20250319_140852.png
2025-03-19 14:08:54,213 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:09:00,930 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:09:01,241 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:01,249 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:11,421 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:09:11,422 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:09:11,422 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:09:11,564 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{13ef717 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t540}
    * Task{c38bf22 #540 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:09:11,564 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:09:11,565 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:09:11,565 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:09:11,565 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140911_20250319_140911.png
2025-03-19 14:09:12,995 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140911_20250319_140911.png
2025-03-19 14:09:12,995 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_140911_20250319_140911.png
2025-03-19 14:09:12,995 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:09:17,570 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:17,577 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:19,706 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:09:19,708 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:09:19,708 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:09:19,708 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:09:20,712 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:09:21,715 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:09:21,715 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:09:21,716 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:09:21,716 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:09:31,720 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4 (大小: 3.04MB)
2025-03-19 14:09:31,721 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.079967秒，无需修复
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_140819.mp4
2025-03-19 14:09:31,823 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:09:39,271 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4
2025-03-19 14:09:39,277 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4
2025-03-19 14:09:39,277 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:09:39,277 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:09:44,536 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:09:44,537 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4
2025-03-19 14:09:44,538 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:09:44,538 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:09:44,538 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:09:44,910 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:09:45,914 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:09:45,914 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:45,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:47,026 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:09:47,027 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:09:47,027 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:09:49,124 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:09:49,125 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:09:50,281 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:09:50,282 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:09:50,282 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:09:51,425 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:09:51,426 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:09:51,426 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:09:51,427 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:07:32\n- 结束时间: 2025-03-19 14:09:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_107.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:09:51"}]}]}}
2025-03-19 14:09:51,883 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:09:51,885 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:14:51,943 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:14:51,946 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:14:51,947 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:14:51,947 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:14:52,078 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:14:52,232 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:14:52,457 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:14:52,459 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:14:52,459 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:14:52,460 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:14:53,949 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:14:53,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:14:55,228 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:14:55,228 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:14:55,229 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:14:55,229 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:14:55,229 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:14:55,390 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:14:55,391 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:14:55,391 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:14:55,391 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:14:56,805 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:14:56,806 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:14:58,052 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:14:58,053 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:14:59,145 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:14:59,145 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:14:59,263 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:15:01,268 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:15:01,269 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:15:02,368 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:15:02,369 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:15:02,369 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:15:02,369 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:15:02,432 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:15:04,442 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:15:04,443 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:15:06,637 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:15:06,638 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:15:08,724 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:15:08,725 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:15:09,829 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:15:09,830 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:15:09,830 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:15:09,830 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:15:09,903 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:15:11,913 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:15:11,914 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:15:14,098 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:15:14,099 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:15:15,514 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:15:16,986 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:15:16,986 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:15:18,100 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:15:18,104 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:15:19,209 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:15:19,210 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:15:21,355 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:15:21,356 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:15:22,512 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:15:22,513 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:15:22,625 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:15:27,628 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:15:27,629 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:15:29,789 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:15:29,790 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:15:34,938 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:15:34,938 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:15:37,092 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:15:42,097 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:15:42,098 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_141542.mp4
2025-03-19 14:15:42,098 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:15:42,098 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:15:47,361 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:15:47,362 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:15:47,407 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:15:48,598 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4
2025-03-19 14:15:48,598 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:15:50,610 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:15:53,612 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:15:53,613 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:15:56,614 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:15:56,615 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:15:56,615 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:15:57,803 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:15:57,804 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:15:57,804 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:15:57,804 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:15:57,887 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:15:59,895 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:15:59,896 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:15:59,896 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:16:02,197 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:16:02,198 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:16:10,394 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:16:10,395 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:16:10,395 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:16:10,395 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:10,710 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:16:10,711 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:10,953 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:16:10,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,194 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:16:11,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,427 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:16:11,428 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,657 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:16:11,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:11,901 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:16:11,902 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:12,129 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:16:12,130 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:12,401 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:16:12,402 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:12,637 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:16:12,638 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:16:14,886 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:16:14,887 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:16:14,887 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:16:15,033 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1bc8599 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t546}
    * Task{f5eec3f #546 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:16:15,033 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:16:15,034 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:16:15,034 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:16:15,034 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_141615_20250319_141615.png
2025-03-19 14:16:16,603 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_141615_20250319_141615.png
2025-03-19 14:16:16,603 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_141615_20250319_141615.png
2025-03-19 14:16:16,604 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:16:23,712 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:16:23,966 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_108.jpg
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_108.jpg
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:16:23,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:16:34,102 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:16:34,104 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:16:34,104 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1bc8599 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t546}
    * Task{f5eec3f #546 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:16:34,217 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_141634_20250319_141634.png
2025-03-19 14:16:35,643 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_141634_20250319_141634.png
2025-03-19 14:16:35,643 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_141634_20250319_141634.png
2025-03-19 14:16:35,643 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:16:41,766 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_109.jpg
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_109.jpg
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:16:41,768 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:16:43,895 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:16:43,895 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:16:43,896 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:16:43,896 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:16:44,899 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:16:45,901 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:16:45,902 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:16:45,902 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:16:45,902 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:16:55,906 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4 (大小: 3.62MB)
2025-03-19 14:16:55,906 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.424422秒，无需修复
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_141542.mp4
2025-03-19 14:16:56,033 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:17:03,183 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4
2025-03-19 14:17:03,189 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4
2025-03-19 14:17:03,189 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:17:03,189 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:17:08,465 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:17:08,467 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4
2025-03-19 14:17:08,467 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:17:08,467 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:17:08,468 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:17:08,900 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:17:09,906 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:17:09,906 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:17:09,906 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:17:11,010 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:17:11,011 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:17:11,011 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:17:13,111 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:17:13,111 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:17:14,299 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:17:14,299 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:17:14,300 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:17:15,437 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:17:15,437 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:17:15,438 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:17:15,438 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:14:55\n- 结束时间: 2025-03-19 14:17:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_108.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_109.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_110.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:17:15"}]}]}}
2025-03-19 14:17:15,857 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:17:15,859 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:22:16,323 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:22:16,325 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:22:16,325 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:22:16,325 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:22:16,463 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:22:16,585 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:22:16,838 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:22:16,839 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:22:16,839 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:22:16,839 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:22:18,334 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:18,336 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:19,608 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:22:19,609 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:22:19,783 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:22:19,784 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:22:19,784 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:22:19,784 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:22:21,193 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:21,194 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:22,454 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:22,455 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:23,555 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:22:23,556 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:22:23,681 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:22:25,689 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:22:25,690 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:22:26,772 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:22:26,773 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:22:26,773 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:22:26,773 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:22:26,856 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:22:28,876 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:22:28,876 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:22:31,060 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:22:31,061 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:22:33,143 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:22:33,144 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:22:34,257 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:22:34,258 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:22:34,258 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:22:34,258 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:22:34,320 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:22:36,340 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:22:36,340 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:22:38,518 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:22:38,518 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:22:39,950 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:22:41,400 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:22:41,401 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:22:42,588 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:22:42,589 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:22:43,698 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:22:43,699 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:22:45,883 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:22:45,884 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:22:47,063 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:22:47,065 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:22:47,189 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:22:52,199 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:22:52,200 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:22:54,363 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:22:54,363 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:22:59,528 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:22:59,529 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:23:01,701 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:23:06,708 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:23:06,710 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_142306.mp4
2025-03-19 14:23:06,710 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:23:06,710 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:23:11,987 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:23:11,988 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:23:12,033 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:23:13,184 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4
2025-03-19 14:23:13,185 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:23:15,200 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:23:18,204 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:23:18,204 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:23:21,213 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:23:21,213 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:23:21,213 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:23:22,384 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:23:22,384 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:23:22,385 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:23:22,385 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:23:22,487 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:23:24,504 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:23:24,504 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:23:24,504 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:23:26,743 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:23:26,743 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:23:34,948 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:23:34,949 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:23:34,949 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:23:34,949 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:35,268 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:23:35,269 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:35,590 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:23:35,591 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:35,848 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:23:35,849 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,086 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:23:36,087 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,314 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:23:36,314 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,563 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:23:36,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:36,805 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:23:36,806 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:37,049 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:23:37,049 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:37,299 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:23:37,300 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:23:39,559 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:23:39,560 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:23:39,560 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:23:39,687 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eeaf5d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t552}
    * Task{e19f5a3 #552 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:23:39,688 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_142339_20250319_142339.png
2025-03-19 14:23:41,183 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_142339_20250319_142339.png
2025-03-19 14:23:41,184 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_142339_20250319_142339.png
2025-03-19 14:23:41,184 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:23:46,000 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:23:46,003 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:23:46,003 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:23:46,004 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:23:46,004 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:23:48,409 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:23:56,126 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:23:56,126 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:23:56,126 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:23:56,230 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eeaf5d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t552}
    * Task{e19f5a3 #552 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:23:56,230 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:23:56,230 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:23:56,231 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:23:56,231 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_142356_20250319_142356.png
2025-03-19 14:23:57,721 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_142356_20250319_142356.png
2025-03-19 14:23:57,722 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_142356_20250319_142356.png
2025-03-19 14:23:57,722 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:24:02,759 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:24:02,764 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:24:04,921 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:24:04,923 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:24:04,923 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:24:04,923 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:24:05,927 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:24:06,932 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:24:06,933 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:24:06,933 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 173.6 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-19 14:24:06,933 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:24:16,936 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4 (大小: 3.26MB)
2025-03-19 14:24:16,938 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.908044秒，无需修复
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_142306.mp4
2025-03-19 14:24:17,048 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:24:25,009 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4
2025-03-19 14:24:25,015 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4
2025-03-19 14:24:25,015 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:24:25,015 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:24:30,268 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:24:30,269 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4
2025-03-19 14:24:30,270 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:24:30,270 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:24:30,270 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:24:30,697 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:24:31,701 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:24:31,701 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:24:31,701 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:24:32,803 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:24:32,805 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:24:32,805 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:24:34,912 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:24:34,912 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:24:36,128 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:24:36,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:24:36,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:24:37,275 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:24:37,275 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:24:37,275 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:24:37,276 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:22:19\n- 结束时间: 2025-03-19 14:24:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_106.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_111.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:24:37"}]}]}}
2025-03-19 14:24:37,695 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:24:37,698 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:29:37,728 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:29:37,730 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:29:37,730 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:29:37,731 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:29:37,873 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:29:38,041 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:29:38,318 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:29:38,319 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:29:38,319 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:29:38,319 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:29:39,799 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:29:39,800 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:29:41,074 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:29:41,074 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:29:41,075 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:29:41,075 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:29:41,075 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:29:41,236 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:29:41,237 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:29:41,237 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:29:41,237 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:29:42,635 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:29:42,636 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:29:43,916 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:29:43,917 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:29:45,013 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:29:45,014 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:29:45,141 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:29:47,146 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:29:47,147 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:29:48,242 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:29:48,242 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:29:48,242 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:29:48,243 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:29:48,328 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:29:50,334 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:29:50,335 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:29:52,502 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:29:52,503 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:29:54,591 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:29:54,592 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:29:55,704 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:29:55,705 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:29:55,705 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:29:55,705 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:29:55,778 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:29:57,785 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:29:57,785 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:29:59,936 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:29:59,936 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:30:01,368 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:30:02,844 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:30:02,845 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:30:04,029 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:30:04,029 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:30:05,130 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:30:05,131 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:30:07,300 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:30:07,301 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:30:08,420 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:30:08,420 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:30:08,550 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:30:13,555 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:30:13,557 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:30:15,730 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:30:15,731 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:30:20,881 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:30:20,882 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:30:23,048 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:30:28,050 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:30:28,052 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_143028.mp4
2025-03-19 14:30:28,053 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:30:28,053 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:30:33,301 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:30:33,303 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:30:33,348 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:30:34,488 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4
2025-03-19 14:30:34,491 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:30:36,503 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:30:39,506 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:30:39,508 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:30:42,514 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:30:42,515 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:30:42,515 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:30:43,692 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:30:43,693 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:30:43,693 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:30:43,693 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:30:43,805 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:30:45,812 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:30:45,813 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:30:45,813 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:30:48,107 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:30:48,109 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:30:56,289 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:30:56,291 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:30:56,291 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:30:56,291 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:56,559 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:30:56,559 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:56,806 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:30:56,807 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,068 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:30:57,068 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,308 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:30:57,309 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,540 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:30:57,541 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:57,776 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:30:57,777 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:58,035 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:30:58,036 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:58,254 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:30:58,255 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:30:58,513 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:30:58,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:31:00,743 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:31:00,744 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:31:00,744 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:31:00,881 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a074010 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t558}
    * Task{900332f #558 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:31:00,882 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143100_20250319_143100.png
2025-03-19 14:31:03,396 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143100_20250319_143100.png
2025-03-19 14:31:03,397 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143100_20250319_143100.png
2025-03-19 14:31:03,397 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:31:09,612 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:31:11,054 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:11,062 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:11,062 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:31:11,063 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:31:11,063 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:31:21,193 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:31:21,194 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:31:21,194 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:31:21,290 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a074010 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t558}
    * Task{900332f #558 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:31:21,291 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143121_20250319_143121.png
2025-03-19 14:31:23,747 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143121_20250319_143121.png
2025-03-19 14:31:23,748 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143121_20250319_143121.png
2025-03-19 14:31:23,748 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:31:33,980 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:31:33,982 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:31:36,099 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:31:36,100 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:31:36,100 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:31:36,100 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:31:37,105 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:31:38,110 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:31:38,111 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:31:38,111 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 92.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:31:38,111 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:31:48,115 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4 (大小: 5.13MB)
2025-03-19 14:31:48,118 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:31:48,245 - QuickAppADBTester - INFO - 录制文件完整，时长: 60.683222秒，无需修复
2025-03-19 14:31:48,245 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:31:48,245 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143028.mp4
2025-03-19 14:31:48,246 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:32:01,022 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4
2025-03-19 14:32:01,029 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4
2025-03-19 14:32:01,029 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:32:01,029 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:32:06,293 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:32:06,294 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4
2025-03-19 14:32:06,294 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:32:06,295 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:32:06,295 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:32:06,624 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:32:07,625 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:32:07,626 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:32:07,626 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:32:08,720 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:32:08,721 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:32:08,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:32:10,835 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:32:10,836 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:32:12,028 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:32:12,028 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:32:12,029 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:32:13,172 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:32:13,173 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:32:13,174 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:32:13,175 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:29:41\n- 结束时间: 2025-03-19 14:32:13\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_112.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_113.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:32:13"}]}]}}
2025-03-19 14:32:13,643 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:32:13,646 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:37:13,709 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:37:13,713 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:37:13,713 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:37:13,713 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:37:13,830 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:37:13,988 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:37:13,989 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:37:13,989 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:37:13,989 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:37:14,261 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:37:15,694 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:15,694 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:16,938 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:37:16,939 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:37:17,084 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:37:17,085 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:37:17,085 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:37:17,085 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:37:18,483 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:18,484 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:37:19,736 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:19,737 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:20,831 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:37:20,832 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:37:20,948 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:37:22,953 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:37:22,953 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:37:24,048 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:37:24,049 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:37:24,050 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:37:24,050 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:37:24,130 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:37:26,139 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:37:26,140 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:37:28,328 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:37:28,329 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:37:30,421 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:37:30,422 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:37:31,526 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:37:31,527 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:37:31,527 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:37:31,527 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:37:31,606 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:37:33,616 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:37:33,616 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:37:35,778 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:37:35,779 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:37:37,204 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:37:38,690 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:37:38,691 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:37:39,841 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:37:39,842 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:37:40,954 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:37:40,955 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:37:43,145 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:37:43,146 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:37:43,147 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:37:43,147 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:37:43,147 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:37:44,323 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:37:44,324 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:37:44,447 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:37:49,452 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:37:49,453 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:37:51,644 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:37:51,645 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:37:56,799 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:37:56,800 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:37:58,975 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:38:03,980 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:38:03,981 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_143803.mp4
2025-03-19 14:38:03,981 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:38:03,981 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:38:09,212 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:38:09,215 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:38:09,269 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:38:10,460 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4
2025-03-19 14:38:10,461 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:38:12,473 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:38:15,476 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:38:15,476 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:38:18,478 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:38:18,478 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:38:18,478 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:38:19,657 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:38:19,755 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:38:21,764 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:38:21,764 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:38:21,764 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:38:24,069 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:38:24,073 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:38:32,292 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:38:32,293 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:38:32,293 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:38:32,293 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:32,637 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:38:32,637 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:32,919 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:38:32,920 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,143 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:38:33,144 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,395 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:38:33,395 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,622 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:38:33,622 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:33,876 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:38:33,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:34,122 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:38:34,123 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:34,357 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:38:34,358 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:34,562 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:38:34,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:38:36,792 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:38:36,793 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:38:36,793 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{24503a3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t564}
    * Task{980a259 #564 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:38:36,908 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:38:36,909 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143836_20250319_143836.png
2025-03-19 14:38:38,433 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143836_20250319_143836.png
2025-03-19 14:38:38,433 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_143836_20250319_143836.png
2025-03-19 14:38:38,433 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:38:45,593 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:38:45,617 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:38:45,624 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:38:45,624 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:38:45,624 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:38:45,625 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:38:55,780 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:38:55,780 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:38:55,780 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:38:55,909 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{24503a3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t564}
    * Task{980a259 #564 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:38:55,910 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143855_20250319_143855.png
2025-03-19 14:38:57,369 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143855_20250319_143855.png
2025-03-19 14:38:57,370 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_143855_20250319_143855.png
2025-03-19 14:38:57,370 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:39:01,936 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:39:01,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:39:04,077 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:39:04,077 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:39:04,078 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:39:04,078 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:39:05,083 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:39:06,089 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:39:06,090 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:39:06,090 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 125.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:39:06,090 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:39:16,095 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4 (大小: 3.81MB)
2025-03-19 14:39:16,095 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.737589秒，无需修复
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_143803.mp4
2025-03-19 14:39:16,193 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:39:23,615 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4
2025-03-19 14:39:23,619 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4
2025-03-19 14:39:23,619 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:39:23,619 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:39:28,871 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:39:28,872 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:39:29,284 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:39:30,290 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:39:30,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:39:30,291 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:39:31,399 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:39:31,399 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:39:31,400 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:39:33,497 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:39:33,497 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:39:34,658 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:39:34,658 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:39:34,658 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:39:35,792 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:39:35,793 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:39:35,793 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:39:35,794 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:37:16\n- 结束时间: 2025-03-19 14:39:35\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_114.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_115.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:39:35"}]}]}}
2025-03-19 14:39:36,220 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:39:36,224 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:44:37,226 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:44:37,228 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:44:37,228 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:44:37,228 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:44:37,383 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:44:37,552 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:44:37,552 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:44:37,553 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:44:37,553 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:44:37,811 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:44:37,812 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:44:37,812 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:44:37,812 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:44:39,293 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:44:39,294 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:44:40,560 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:44:40,735 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:44:40,736 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:44:40,736 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:44:40,736 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:44:42,131 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:44:42,132 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:44:43,382 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:44:43,383 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:44:44,482 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:44:44,483 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:44:44,600 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:44:46,606 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:44:46,607 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:44:47,700 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:44:47,701 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:44:47,701 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:44:47,701 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:44:47,780 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:44:49,787 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:44:49,788 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:44:51,982 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:44:51,983 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:44:54,051 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:44:54,051 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:44:55,161 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:44:55,162 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:44:55,162 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:44:55,162 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:44:55,239 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:44:57,249 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:44:57,249 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:44:59,437 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:44:59,438 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:45:00,860 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:45:02,338 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:45:02,339 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:45:03,505 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:45:03,505 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:45:04,604 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:45:04,605 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:45:06,784 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:45:06,785 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:45:06,785 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:45:06,786 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:45:06,786 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:45:07,953 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:45:07,954 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:45:08,055 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:45:13,061 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:45:13,062 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:45:15,205 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:45:15,206 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:45:20,354 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:45:20,354 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:45:22,505 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:45:27,511 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:45:27,513 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_144527.mp4
2025-03-19 14:45:27,514 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:45:27,514 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:45:32,774 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:45:32,776 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:45:32,817 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:45:34,003 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4
2025-03-19 14:45:34,004 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:45:36,012 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:45:39,015 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:45:39,016 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:45:42,020 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:45:42,020 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:45:42,021 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:45:43,197 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:45:43,198 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:45:43,198 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:45:43,198 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:45:43,301 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:45:45,311 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:45:45,311 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:45:45,312 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:45:47,604 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:45:47,605 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:45:55,798 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:45:55,800 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:45:55,800 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:45:55,800 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,096 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:45:56,097 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,337 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:45:56,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,576 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:45:56,577 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:56,804 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:45:56,805 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,045 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:45:57,046 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,273 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:45:57,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,541 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:45:57,542 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:57,772 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:45:57,773 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:45:58,047 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:45:58,047 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:46:00,346 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:46:00,348 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:46:00,348 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:46:00,474 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f5a9206 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t570}
    * Task{fa596f4 #570 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:46:00,475 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_144600_20250319_144600.png
2025-03-19 14:46:02,548 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_144600_20250319_144600.png
2025-03-19 14:46:02,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_144600_20250319_144600.png
2025-03-19 14:46:02,548 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:46:09,125 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:46:09,859 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:09,865 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:09,866 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:46:09,866 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:09,866 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:46:20,017 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:46:20,018 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:46:20,018 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f5a9206 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t570}
    * Task{fa596f4 #570 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:46:20,151 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_144620_20250319_144620.png
2025-03-19 14:46:22,136 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_144620_20250319_144620.png
2025-03-19 14:46:22,137 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_144620_20250319_144620.png
2025-03-19 14:46:22,137 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:46:26,782 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:26,784 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:46:26,784 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:46:26,785 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:46:26,785 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:26,785 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:46:28,933 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:46:28,934 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:46:28,935 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:46:28,935 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:46:29,939 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:46:30,942 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:46:30,943 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:46:30,943 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 115.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:46:30,944 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:46:40,948 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4 (大小: 4.22MB)
2025-03-19 14:46:40,950 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.088467秒，无需修复
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_144527.mp4
2025-03-19 14:46:41,081 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:46:48,185 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4
2025-03-19 14:46:48,193 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4
2025-03-19 14:46:48,193 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:46:48,194 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:46:53,458 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:46:53,459 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:46:53,900 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:46:54,905 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:46:54,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:54,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:46:56,016 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:46:56,017 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:46:56,018 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:46:58,129 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:46:58,130 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:46:59,280 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:46:59,281 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:46:59,281 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:47:00,418 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:47:00,419 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:47:00,419 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:47:00,419 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:44:40\n- 结束时间: 2025-03-19 14:47:00\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_117.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:47:00"}]}]}}
2025-03-19 14:47:00,882 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:47:00,885 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:52:01,226 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 14:52:01,227 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 14:52:01,227 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 14:52:01,227 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 14:52:01,365 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 14:52:01,519 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 14:52:01,520 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 14:52:01,521 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:52:01,521 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:52:01,773 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:52:01,774 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:52:01,774 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:52:01,774 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:52:03,252 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:03,253 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:04,491 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 14:52:04,492 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 14:52:04,640 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 14:52:04,641 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 14:52:04,641 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 14:52:04,641 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 14:52:06,058 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:06,059 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:07,309 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:08,414 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 14:52:08,416 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 14:52:08,543 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 14:52:10,553 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 14:52:10,553 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 14:52:11,655 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 14:52:11,656 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 14:52:11,656 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:52:11,656 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 14:52:11,732 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:52:13,752 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 14:52:13,752 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 14:52:15,951 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 14:52:15,951 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 14:52:18,036 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 14:52:18,037 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 14:52:19,143 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 14:52:19,144 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 14:52:19,144 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:52:19,144 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 14:52:19,217 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:52:21,225 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 14:52:21,225 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 14:52:23,426 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 14:52:23,427 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 14:52:24,847 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 14:52:26,294 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 14:52:26,295 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 14:52:27,477 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 14:52:27,477 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 14:52:28,577 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 14:52:28,577 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 14:52:30,752 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:52:30,754 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:52:31,925 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 14:52:31,926 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 14:52:32,042 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 14:52:37,051 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 14:52:37,052 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 14:52:39,211 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 14:52:39,212 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 14:52:44,383 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 14:52:44,383 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 14:52:46,543 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 14:52:51,553 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 14:52:51,554 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_145251.mp4
2025-03-19 14:52:51,554 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:52:51,555 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:52:56,835 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:52:56,836 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 14:52:56,887 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 14:52:58,105 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4
2025-03-19 14:52:58,105 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 14:53:00,119 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 14:53:03,125 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 14:53:03,126 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 14:53:06,132 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 14:53:06,132 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 14:53:06,132 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 14:53:07,352 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 14:53:07,352 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 14:53:07,353 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 14:53:07,353 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 14:53:07,459 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 14:53:09,473 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 14:53:09,474 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 14:53:09,474 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 14:53:11,727 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 14:53:11,727 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 14:53:19,946 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 14:53:19,946 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 14:53:19,947 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 14:53:19,947 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,203 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 14:53:20,204 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,468 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 14:53:20,468 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,704 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 14:53:20,704 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:20,933 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 14:53:20,934 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,202 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 14:53:21,203 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,440 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 14:53:21,440 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,701 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 14:53:21,704 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:21,938 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 14:53:21,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:22,176 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 14:53:22,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 14:53:24,431 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 14:53:24,432 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:53:24,432 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:53:24,570 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1816dd2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t576}
    * Task{e675a0 #576 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:53:24,570 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:53:24,571 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 14:53:24,571 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 14:53:24,571 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_145324_20250319_145324.png
2025-03-19 14:53:26,578 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_145324_20250319_145324.png
2025-03-19 14:53:26,578 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_145324_20250319_145324.png
2025-03-19 14:53:26,578 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:53:33,344 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 14:53:34,416 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_118.jpg
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_118.jpg
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:53:34,420 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:53:44,559 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 14:53:44,560 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 14:53:44,560 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 14:53:44,673 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1816dd2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t576}
    * Task{e675a0 #576 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 14:53:44,673 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 14:53:44,673 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 14:53:44,674 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 14:53:44,674 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_145344_20250319_145344.png
2025-03-19 14:53:46,696 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_145344_20250319_145344.png
2025-03-19 14:53:46,696 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_145344_20250319_145344.png
2025-03-19 14:53:46,696 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 14:53:51,555 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:53:51,561 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:53:53,693 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 14:53:53,694 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 14:53:53,694 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 14:53:53,694 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 14:53:54,700 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 14:53:55,703 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 14:53:55,704 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 14:53:55,704 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 14:53:55,705 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 14:54:05,710 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4 (大小: 3.85MB)
2025-03-19 14:54:05,711 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.794122秒，无需修复
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_145251.mp4
2025-03-19 14:54:05,820 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 14:54:18,128 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4
2025-03-19 14:54:18,135 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4
2025-03-19 14:54:18,135 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 14:54:18,135 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 14:54:23,382 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 14:54:23,383 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 14:54:23,744 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 14:54:24,750 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 14:54:24,750 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:54:24,750 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:54:25,852 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 14:54:25,853 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 14:54:25,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 14:54:27,952 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 14:54:27,953 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 14:54:29,126 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 14:54:29,127 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 14:54:29,127 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 14:54:30,267 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 14:54:30,267 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 14:54:30,267 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 14:54:30,268 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 14:52:04\n- 结束时间: 2025-03-19 14:54:30\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_118.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_116.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_119.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 14:54:30"}]}]}}
2025-03-19 14:54:32,076 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 14:54:32,078 - QuickAppADBTester - INFO - 测试完成
2025-03-19 14:54:35,720 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 14:54:35,720 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 14:54:35,721 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:01:51,286 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:01:51,387 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:01:51,484 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:01:51,646 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:01:51,647 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:01:51,647 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:01:51,647 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:01:53,079 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:01:53,080 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:01:54,338 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:01:54,339 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:01:54,507 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:01:54,507 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:01:54,507 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:01:54,508 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:01:55,900 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:01:55,900 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:01:57,137 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:01:57,139 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:01:58,228 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:01:58,229 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:01:58,368 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:02:00,374 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:02:00,374 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:02:01,453 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:02:01,454 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:02:01,455 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:02:01,455 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:02:01,543 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:02:03,553 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:02:03,554 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:02:05,763 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:02:05,764 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:02:07,878 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:02:07,879 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:02:08,978 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:02:08,979 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:02:08,979 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:02:08,979 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:02:09,088 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:02:11,095 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:02:11,095 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:02:13,292 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:02:13,293 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:02:14,708 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:02:16,176 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:02:16,177 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:02:17,337 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:02:17,338 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:02:18,453 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:02:18,454 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:02:20,618 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:02:20,619 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:02:20,619 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:02:20,619 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:02:20,620 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:02:21,800 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:02:21,801 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:02:21,930 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:02:26,935 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:02:26,936 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:02:29,116 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:02:29,117 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:02:34,264 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:02:34,265 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:02:36,448 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:02:41,453 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:02:41,454 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_150241.mp4
2025-03-19 15:02:41,454 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:02:41,454 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:02:46,711 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:02:46,712 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:02:46,751 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:02:47,888 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4
2025-03-19 15:02:47,889 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:02:49,900 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:02:52,904 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:02:52,904 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:02:55,905 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:02:55,905 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:02:55,906 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:02:57,092 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:02:57,093 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:02:57,093 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:02:57,093 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:02:57,194 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:02:59,201 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:02:59,202 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:02:59,202 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:03:01,470 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:03:01,471 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:03:09,654 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:03:09,655 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:03:09,655 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:03:09,655 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:09,915 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:03:09,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,203 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:03:10,203 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,446 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:03:10,447 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,674 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:03:10,674 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:10,905 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:03:10,914 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,131 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:03:11,132 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,366 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:03:11,366 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,597 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:03:11,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:11,868 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:03:11,869 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:03:14,121 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:03:14,122 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:03:14,122 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:03:14,292 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{36b31a4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t582}
    * Task{756b0d3 #582 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:03:14,292 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:03:14,292 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:03:14,293 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:03:14,293 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_150314_20250319_150314.png
2025-03-19 15:03:15,835 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_150314_20250319_150314.png
2025-03-19 15:03:15,835 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_150314_20250319_150314.png
2025-03-19 15:03:15,835 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:03:22,838 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_120.jpg
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_120.jpg
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:03:22,843 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:03:23,008 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:03:33,001 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:03:33,001 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:03:33,002 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{36b31a4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t582}
    * Task{756b0d3 #582 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:03:33,113 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:03:33,114 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_150333_20250319_150333.png
2025-03-19 15:03:34,552 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_150333_20250319_150333.png
2025-03-19 15:03:34,552 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_150333_20250319_150333.png
2025-03-19 15:03:34,553 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:03:40,623 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_121.jpg
2025-03-19 15:03:40,626 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_121.jpg
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:03:40,627 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:03:42,759 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:03:42,760 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:03:42,760 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:03:42,760 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:03:43,766 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:03:44,772 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:03:44,772 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:03:44,773 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 160.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:03:44,773 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:03:54,779 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4 (大小: 3.76MB)
2025-03-19 15:03:54,779 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.973033秒，无需修复
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_150241.mp4
2025-03-19 15:03:54,894 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:04:01,924 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4
2025-03-19 15:04:01,936 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4
2025-03-19 15:04:01,937 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:04:01,937 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:04:07,187 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:04:07,188 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4
2025-03-19 15:04:07,188 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:04:07,189 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:04:07,189 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:04:07,536 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:04:08,542 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:04:08,542 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:04:08,542 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:04:09,656 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:04:09,657 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:04:09,657 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:04:11,759 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:04:11,760 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:04:12,942 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:04:12,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:04:12,944 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:04:14,081 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:04:14,082 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:04:14,082 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:04:14,083 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:01:54\n- 结束时间: 2025-03-19 15:04:14\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_120.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_121.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_122.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:04:14"}]}]}}
2025-03-19 15:04:14,594 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:04:14,597 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:04:14,598 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 15:09:14,663 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:09:14,667 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:09:14,667 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:09:14,667 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:09:14,797 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:09:14,950 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:09:15,195 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:09:15,196 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:09:15,196 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:09:15,196 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:09:16,652 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:16,652 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:09:17,904 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:09:18,045 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:09:18,046 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:09:18,046 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:09:18,046 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:09:19,451 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:19,452 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:20,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:21,816 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:09:21,816 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:09:21,937 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:09:23,939 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:09:23,939 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:09:25,064 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:09:25,065 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:09:25,065 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:09:25,065 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:09:25,150 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:09:27,158 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:09:27,158 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:09:29,325 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:09:29,326 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:09:31,415 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:09:31,415 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:09:32,519 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:09:32,598 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:09:34,604 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:09:34,605 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:09:36,764 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:09:36,765 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:09:38,175 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:09:39,661 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:09:39,662 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:09:40,823 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:09:40,823 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:09:41,930 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:09:41,931 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:09:44,124 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:09:44,124 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:09:44,125 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:09:44,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:09:44,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:09:45,314 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:09:45,315 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:09:45,439 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:09:50,445 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:09:50,446 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:09:52,604 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:09:52,605 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:09:57,767 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:09:57,768 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:09:59,927 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:10:04,932 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:10:04,933 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_151004.mp4
2025-03-19 15:10:04,933 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:10:04,933 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:10:10,211 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:10:10,213 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:10:10,262 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:10:11,401 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4
2025-03-19 15:10:11,402 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:10:13,417 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:10:16,422 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:10:16,423 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:10:19,424 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:10:19,424 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:10:19,425 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:10:20,609 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:10:20,610 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:10:20,610 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:10:20,610 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:10:20,718 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:10:22,728 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:10:22,729 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:10:22,729 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:10:25,036 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:10:25,037 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:10:33,242 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:10:33,243 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:10:33,243 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:10:33,243 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:33,608 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:10:33,609 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:33,875 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:10:33,875 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,122 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:10:34,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,321 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:10:34,322 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,570 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:10:34,571 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:34,790 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:10:34,790 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:35,066 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:10:35,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:35,312 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:10:35,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:35,563 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:10:35,564 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:10:37,798 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:10:37,798 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:10:37,799 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{53c4356 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t588}
    * Task{cd13ee2 #588 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:10:37,940 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151037_20250319_151037.png
2025-03-19 15:10:39,774 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151037_20250319_151037.png
2025-03-19 15:10:39,775 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151037_20250319_151037.png
2025-03-19 15:10:39,776 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:10:46,533 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:10:47,139 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:10:47,148 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:10:57,290 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:10:57,292 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:10:57,292 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:10:57,404 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{53c4356 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t588}
    * Task{cd13ee2 #588 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:10:57,405 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151057_20250319_151057.png
2025-03-19 15:10:59,273 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151057_20250319_151057.png
2025-03-19 15:10:59,274 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151057_20250319_151057.png
2025-03-19 15:10:59,274 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:11:04,021 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:11:04,025 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:11:04,026 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:11:06,147 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:11:06,148 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:11:06,148 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:11:06,148 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:11:07,151 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:11:08,154 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:11:08,154 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:11:08,154 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:11:08,155 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:11:18,159 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4 (大小: 3.92MB)
2025-03-19 15:11:18,162 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:11:18,276 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.906711秒，无需修复
2025-03-19 15:11:18,277 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:11:18,277 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151004.mp4
2025-03-19 15:11:18,277 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:11:25,798 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4
2025-03-19 15:11:25,804 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4
2025-03-19 15:11:25,804 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:11:25,804 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:11:31,071 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:11:31,072 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4
2025-03-19 15:11:31,073 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:11:31,073 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:11:31,073 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:11:31,484 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:11:32,489 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:11:32,490 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:11:32,490 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:11:33,605 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:11:33,606 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:11:33,607 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:11:35,721 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:11:35,721 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:11:36,873 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:11:36,874 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:11:36,874 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:11:38,007 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:11:38,008 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:11:38,008 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:11:38,009 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:09:17\n- 结束时间: 2025-03-19 15:11:38\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_123.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_124.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:11:38"}]}]}}
2025-03-19 15:11:38,425 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:11:38,429 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:16:38,463 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:16:38,466 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:16:38,466 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:16:38,466 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:16:38,612 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:16:38,788 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:16:38,789 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:16:38,789 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:16:38,789 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:16:39,032 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:16:39,033 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:16:39,033 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:16:39,033 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:16:40,509 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:16:40,510 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:16:41,771 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:16:41,771 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:16:41,772 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:16:41,772 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:16:41,772 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:16:41,920 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:16:41,921 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:16:41,922 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:16:41,922 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:16:43,338 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:16:43,339 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:16:44,593 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:16:44,594 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:16:45,685 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:16:45,686 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:16:45,802 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:16:47,803 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:16:47,803 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:16:48,894 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:16:48,895 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:16:48,895 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:16:48,895 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:16:48,978 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:16:50,985 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:16:50,986 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:16:53,161 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:16:53,162 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:16:55,250 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:16:55,251 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:16:56,353 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:16:56,356 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:16:56,356 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:16:56,356 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:16:56,460 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:16:58,468 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:16:58,468 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:17:00,630 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:17:00,634 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:17:02,056 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:17:03,530 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:17:03,531 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:17:04,711 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:17:04,712 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:17:05,826 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:17:05,827 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:17:08,014 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:17:08,015 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:17:09,152 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:17:09,153 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:17:09,282 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:17:14,285 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:17:14,285 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:17:16,451 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:17:16,452 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:17:21,564 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:17:21,565 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:17:23,725 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_151728.mp4
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:17:28,730 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:17:33,997 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:17:33,998 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:17:34,047 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:17:35,182 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4
2025-03-19 15:17:35,183 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:17:37,191 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:17:40,198 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:17:40,198 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:17:43,201 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:17:43,202 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:17:43,202 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:17:44,372 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:17:44,373 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:17:44,373 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:17:44,373 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:17:44,484 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:17:46,492 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:17:46,492 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:17:46,492 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:17:48,763 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:17:48,764 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:17:56,955 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:57,342 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:17:57,342 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:57,589 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:17:57,590 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:57,818 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:17:57,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,053 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:17:58,054 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,284 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:17:58,285 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,518 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:17:58,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,749 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:17:58,750 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:58,969 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:17:58,970 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:17:59,207 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:17:59,208 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:18:01,443 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:18:01,444 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:18:01,444 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5360b5c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t594}
    * Task{27dbfeb #594 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:18:01,558 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151801_20250319_151801.png
2025-03-19 15:18:03,651 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151801_20250319_151801.png
2025-03-19 15:18:03,652 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_151801_20250319_151801.png
2025-03-19 15:18:03,653 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:18:10,321 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:18:11,052 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:11,056 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:11,057 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:18:11,057 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:18:11,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:18:21,164 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:18:21,165 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:18:21,165 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:18:21,265 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5360b5c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t594}
    * Task{27dbfeb #594 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:18:21,266 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151821_20250319_151821.png
2025-03-19 15:18:23,437 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151821_20250319_151821.png
2025-03-19 15:18:23,438 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_151821_20250319_151821.png
2025-03-19 15:18:23,438 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:18:28,869 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:28,877 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:18:28,878 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:18:31,025 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:18:31,026 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:18:31,026 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:18:31,026 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:18:32,031 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:18:33,033 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:18:33,033 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:18:33,034 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 159.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:18:33,034 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:18:43,035 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4 (大小: 3.97MB)
2025-03-19 15:18:43,036 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.871600秒，无需修复
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_151728.mp4
2025-03-19 15:18:43,147 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:18:50,475 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4
2025-03-19 15:18:50,482 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4
2025-03-19 15:18:50,483 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:18:50,483 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:18:55,749 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:18:55,750 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4
2025-03-19 15:18:55,751 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:18:55,751 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:18:55,751 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:18:56,161 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:18:57,166 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:18:57,166 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:18:57,166 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:18:58,268 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:18:58,269 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:18:58,269 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:19:00,388 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:19:00,389 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:19:01,551 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:19:01,552 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:19:01,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:19:02,699 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:19:02,700 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:19:02,701 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:19:02,701 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:16:41\n- 结束时间: 2025-03-19 15:19:02\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_125.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_126.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:19:02"}]}]}}
2025-03-19 15:19:03,176 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:19:03,178 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:24:03,803 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:24:03,805 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:24:03,805 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:24:03,805 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:24:03,924 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:24:04,074 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:24:04,075 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:24:04,075 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:24:04,075 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:24:04,323 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:24:04,323 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:24:04,324 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:24:04,324 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:24:05,807 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:05,808 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:07,075 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:24:07,075 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:24:07,076 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:24:07,076 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:24:07,076 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:24:07,246 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:24:07,247 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:24:07,247 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:24:07,247 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:24:08,656 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:08,657 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:09,930 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:09,931 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:11,031 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:24:11,031 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:24:11,152 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:24:13,156 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:24:13,157 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:24:14,255 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:24:14,256 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:24:14,257 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:24:14,257 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:24:14,337 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:24:16,343 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:24:16,344 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:24:18,525 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:24:18,526 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:24:20,615 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:24:20,617 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:24:21,727 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:24:21,728 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:24:21,728 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:24:21,728 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:24:21,804 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:24:23,809 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:24:23,810 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:24:25,988 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:24:25,990 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:24:27,400 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:24:28,862 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:24:28,863 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:24:30,056 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:24:30,057 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:24:31,158 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:24:31,159 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:24:33,355 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:24:33,356 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:24:34,517 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:24:34,518 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:24:34,622 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:24:39,627 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:24:39,629 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:24:41,785 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:24:41,785 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:24:46,922 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:24:46,922 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:24:49,067 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:24:54,073 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:24:54,074 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_152454.mp4
2025-03-19 15:24:54,074 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:24:54,074 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:24:59,321 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:24:59,322 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:24:59,371 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:25:00,559 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4
2025-03-19 15:25:00,560 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:25:02,568 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:25:05,571 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:25:05,572 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:25:08,573 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:25:08,574 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:25:08,574 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:25:09,742 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:25:09,743 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:25:09,743 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:25:09,744 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:25:09,851 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:25:11,858 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:25:11,859 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:25:11,859 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:25:14,149 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:25:14,150 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:25:22,310 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:25:22,312 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:25:22,312 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:25:22,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:22,604 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:25:22,604 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:22,851 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:25:22,852 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,087 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:25:23,087 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,313 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:25:23,314 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,594 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:25:23,594 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:23,814 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:25:23,815 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:24,050 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:25:24,051 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:24,281 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:25:24,282 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:24,498 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:25:24,498 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:25:26,774 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:25:26,774 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:25:26,774 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:25:26,944 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{10b34bf u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t600}
    * Task{e0d9ed5 #600 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:25:26,944 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:25:26,945 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:25:26,945 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:25:26,945 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_152526_20250319_152526.png
2025-03-19 15:25:28,211 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_152526_20250319_152526.png
2025-03-19 15:25:28,212 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_152526_20250319_152526.png
2025-03-19 15:25:28,212 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:25:34,738 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_127.jpg
2025-03-19 15:25:34,745 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_127.jpg
2025-03-19 15:25:34,745 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:25:34,746 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:25:34,746 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:25:35,672 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:25:44,880 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:25:44,882 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:25:44,882 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:25:45,012 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{10b34bf u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t600}
    * Task{e0d9ed5 #600 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:25:45,013 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_152545_20250319_152545.png
2025-03-19 15:25:46,251 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_152545_20250319_152545.png
2025-03-19 15:25:46,251 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_152545_20250319_152545.png
2025-03-19 15:25:46,251 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:25:51,884 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_128.jpg
2025-03-19 15:25:51,890 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_128.jpg
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:25:51,891 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:25:54,037 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:25:54,038 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:25:54,038 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:25:54,038 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:25:55,039 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:25:56,045 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:25:56,045 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:25:56,045 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 162.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:25:56,046 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:26:06,048 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4 (大小: 2.92MB)
2025-03-19 15:26:06,049 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.609944秒，无需修复
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_152454.mp4
2025-03-19 15:26:06,145 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:26:13,587 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4
2025-03-19 15:26:13,592 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4
2025-03-19 15:26:13,592 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:26:13,592 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:26:18,791 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:26:18,792 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:26:19,224 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:26:20,230 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:26:20,230 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:26:20,231 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:26:21,338 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:26:21,339 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:26:21,339 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:26:23,442 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:26:23,443 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:26:24,607 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:26:24,608 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:26:24,608 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:26:25,718 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:26:25,719 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:26:25,719 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:26:25,720 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:24:07\n- 结束时间: 2025-03-19 15:26:25\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_127.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_128.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_129.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:26:25"}]}]}}
2025-03-19 15:26:26,328 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:26:26,332 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:31:26,391 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:31:26,395 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:31:26,395 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:31:26,395 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:31:26,538 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:31:26,650 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:31:26,651 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:31:26,651 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:31:26,651 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:31:26,914 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:31:26,914 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:31:26,914 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:31:26,915 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:31:28,391 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:28,392 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:29,681 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:31:29,682 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:31:29,849 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:31:29,850 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:31:29,850 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:31:29,850 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:31:31,263 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:31,264 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:32,538 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:31:32,539 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:31:32,539 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:31:32,539 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:32,540 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:33,634 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:31:33,635 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:31:33,763 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:31:35,768 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:31:35,769 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:31:36,876 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:31:36,878 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:31:36,878 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:31:36,878 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:31:36,963 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:31:38,974 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:31:38,974 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:31:41,152 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:31:41,153 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:31:43,246 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:31:43,247 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:31:44,357 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:31:44,358 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:31:44,358 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:31:44,359 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:31:44,441 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:31:46,448 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:31:46,449 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:31:48,603 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:31:48,604 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:31:50,030 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:31:51,512 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:31:51,513 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:31:52,675 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:31:52,676 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:31:53,785 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:31:53,785 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:31:55,979 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:31:55,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:31:57,110 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:31:57,111 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:31:57,233 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:32:02,236 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:32:02,236 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:32:04,378 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:32:04,379 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:32:09,521 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:32:09,522 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:32:11,684 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:32:16,686 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:32:16,686 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_153216.mp4
2025-03-19 15:32:16,687 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:32:16,687 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:32:21,954 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:32:21,955 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:32:22,004 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:32:23,197 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4
2025-03-19 15:32:23,198 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:32:25,209 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:32:28,213 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:32:28,214 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:32:31,216 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:32:31,217 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:32:31,217 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:32:32,429 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:32:32,430 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:32:32,430 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:32:32,430 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:32:32,536 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:32:34,539 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:32:34,539 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:32:34,539 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:32:36,816 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:32:36,817 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:32:45,024 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:32:45,024 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:32:45,025 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:32:45,025 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:45,324 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:32:45,325 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:45,588 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:32:45,589 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:45,817 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:32:45,818 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,055 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:32:46,056 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,287 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:32:46,287 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,504 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:32:46,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,714 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:32:46,714 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:46,960 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:32:46,961 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:47,210 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:32:47,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:32:49,488 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:32:49,489 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:32:49,489 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:32:49,617 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{646fea2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t606}
    * Task{f4f2869 #606 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:32:49,617 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:32:49,618 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:32:49,618 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:32:49,618 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_153249_20250319_153249.png
2025-03-19 15:32:51,977 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_153249_20250319_153249.png
2025-03-19 15:32:51,978 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_153249_20250319_153249.png
2025-03-19 15:32:51,979 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:32:58,324 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:33:00,004 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:00,012 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:00,013 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:33:00,013 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:00,013 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:10,125 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:33:10,126 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:33:10,126 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:33:10,257 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{646fea2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t606}
    * Task{f4f2869 #606 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:33:10,258 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_153310_20250319_153310.png
2025-03-19 15:33:12,534 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_153310_20250319_153310.png
2025-03-19 15:33:12,534 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_153310_20250319_153310.png
2025-03-19 15:33:12,535 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:33:17,435 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:17,442 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:17,443 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:19,570 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:33:19,571 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:33:19,572 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:33:19,572 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:33:20,576 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:33:21,580 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:33:21,581 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:33:21,581 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 138.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:33:21,582 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:33:31,586 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4 (大小: 4.64MB)
2025-03-19 15:33:31,586 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.438667秒，无需修复
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153216.mp4
2025-03-19 15:33:31,698 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:33:39,764 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4
2025-03-19 15:33:39,771 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4
2025-03-19 15:33:39,771 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:33:39,771 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:33:45,020 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:33:45,022 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:33:45,418 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:33:46,424 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:33:46,424 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:46,424 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:47,513 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:33:47,514 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:33:47,514 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:33:49,622 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:33:49,623 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:33:50,780 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:33:50,781 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:33:50,781 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:33:51,901 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:33:51,902 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:33:51,902 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:33:51,903 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:31:29\n- 结束时间: 2025-03-19 15:33:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_130.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_131.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:33:51"}]}]}}
2025-03-19 15:33:52,509 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:33:52,514 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:38:52,517 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:38:52,520 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:38:52,520 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:38:52,520 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:38:52,663 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:38:52,803 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:38:52,804 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:38:52,804 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:38:52,804 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:38:53,057 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:38:53,058 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:38:53,058 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:38:53,058 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:38:54,537 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:38:54,538 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:38:55,818 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:38:55,819 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:38:55,967 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:38:55,967 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:38:55,968 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:38:55,968 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:38:57,371 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:38:57,373 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:38:58,623 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:38:58,624 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:38:59,715 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:38:59,715 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:38:59,838 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:39:01,840 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:39:01,841 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:39:02,931 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:39:02,932 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:39:02,932 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:39:02,932 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:39:03,012 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:39:05,019 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:39:05,020 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:39:07,210 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:39:07,211 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:39:09,300 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:39:09,301 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:39:10,393 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:39:10,393 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:39:10,394 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:39:10,394 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:39:10,469 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:39:12,477 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:39:12,478 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:39:14,631 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:39:14,632 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:39:16,058 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:39:17,544 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:39:17,545 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:39:18,690 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:39:18,691 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:39:19,806 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:39:19,807 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:39:21,986 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:39:21,987 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:39:23,175 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:39:23,175 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:39:23,303 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:39:28,309 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:39:28,309 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:39:30,461 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:39:30,464 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:39:35,624 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:39:35,625 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:39:37,780 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:39:42,784 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:39:42,785 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_153942.mp4
2025-03-19 15:39:42,785 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:39:42,785 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:39:48,059 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:39:48,060 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:39:48,113 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:39:49,250 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4
2025-03-19 15:39:49,251 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:39:51,262 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:39:54,269 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:39:54,269 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:39:57,275 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:39:57,275 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:39:57,275 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:39:58,483 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:39:58,484 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:39:58,484 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:39:58,484 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:39:58,580 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:40:00,589 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:40:00,589 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:40:00,590 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:40:02,877 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:40:02,878 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:40:11,050 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:40:11,051 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:40:11,051 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:40:11,051 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:11,346 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:40:11,346 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:11,619 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:40:11,620 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:11,912 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:40:11,912 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,150 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:40:12,151 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,392 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:40:12,394 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,653 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:40:12,655 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:12,924 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:40:12,925 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:13,170 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:40:13,171 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:13,424 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:40:13,425 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:40:15,672 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:40:15,673 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:40:15,673 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:40:15,821 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e4f0bd3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t612}
    * Task{eade09 #612 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:40:15,822 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154015_20250319_154015.png
2025-03-19 15:40:17,471 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154015_20250319_154015.png
2025-03-19 15:40:17,471 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154015_20250319_154015.png
2025-03-19 15:40:17,472 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:40:24,376 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:40:24,596 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:24,603 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:24,603 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:40:24,604 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:40:24,604 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:40:34,734 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:40:34,735 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:40:34,735 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:40:34,837 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e4f0bd3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t612}
    * Task{eade09 #612 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:40:34,838 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154034_20250319_154034.png
2025-03-19 15:40:36,468 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154034_20250319_154034.png
2025-03-19 15:40:36,469 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154034_20250319_154034.png
2025-03-19 15:40:36,469 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:40:41,192 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:41,196 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:40:41,197 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:40:43,318 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:40:43,319 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:40:43,319 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:40:43,320 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:40:44,323 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:40:45,329 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:40:45,329 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:40:45,329 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:40:45,330 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:40:55,333 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4 (大小: 3.76MB)
2025-03-19 15:40:55,334 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:40:55,503 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.215967秒，无需修复
2025-03-19 15:40:55,504 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:40:55,504 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_153942.mp4
2025-03-19 15:40:55,504 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:41:02,927 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4
2025-03-19 15:41:02,930 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4
2025-03-19 15:41:02,931 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:41:02,931 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:41:08,175 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:41:08,176 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4
2025-03-19 15:41:08,176 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:41:08,177 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:41:08,177 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:41:08,562 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:41:09,567 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:41:09,567 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:41:09,567 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:41:10,668 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:41:10,668 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:41:10,669 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:41:12,779 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:41:12,779 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:41:13,955 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:41:13,956 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:41:13,956 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:41:15,091 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:41:15,093 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:41:15,093 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:41:15,094 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:38:55\n- 结束时间: 2025-03-19 15:41:15\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_132.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_133.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:41:15"}]}]}}
2025-03-19 15:41:15,631 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:41:15,636 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:46:15,686 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:46:15,691 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:46:15,692 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:46:15,693 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:46:15,857 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:46:15,972 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:46:16,158 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:46:16,159 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:46:16,159 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:46:16,159 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:46:17,637 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:17,638 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:18,868 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:46:18,869 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:46:19,030 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:46:20,431 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:20,431 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:21,689 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:46:21,689 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:46:21,689 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:46:21,690 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:21,690 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:22,786 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:46:22,787 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:46:22,903 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:46:24,907 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:46:24,908 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:46:25,996 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:46:25,998 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:46:25,998 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:46:25,998 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:46:26,082 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:46:28,090 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:46:28,090 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:46:30,254 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:46:30,256 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:46:32,337 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:46:32,337 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:46:33,444 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:46:33,540 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:46:35,547 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:46:35,550 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:46:37,688 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:46:37,689 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:46:39,095 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:46:40,571 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:46:40,572 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:46:41,765 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:46:41,766 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:46:42,867 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:46:42,868 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:46:45,035 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:46:45,035 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:46:45,036 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:46:45,036 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:46:45,036 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:46:46,195 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:46:46,196 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:46:46,319 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:46:51,324 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:46:51,325 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:46:53,503 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:46:53,504 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:46:58,645 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:46:58,646 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:47:00,812 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:47:05,816 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:47:05,817 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_154705.mp4
2025-03-19 15:47:05,817 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:47:05,817 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:47:11,085 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:47:11,087 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:47:11,134 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:47:12,271 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4
2025-03-19 15:47:12,272 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:47:14,284 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:47:17,291 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:47:17,291 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:47:20,296 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:47:20,297 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:47:20,297 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:47:21,472 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:47:21,473 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:47:21,473 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:47:21,474 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:47:21,580 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:47:23,589 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:47:23,590 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:47:23,590 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:47:25,878 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:47:25,879 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:47:34,060 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:47:34,062 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:47:34,063 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:47:34,063 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:34,425 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:47:34,425 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:34,644 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:47:34,645 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:34,846 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:47:34,846 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,097 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:47:35,098 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,314 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:47:35,315 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,544 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:47:35,545 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:35,767 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:47:35,767 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:36,005 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:47:36,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:36,252 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:47:36,253 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:47:38,480 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:47:38,481 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:47:38,481 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:47:38,609 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{40fcf1b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t618}
    * Task{27869f6 #618 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:47:38,609 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:47:38,610 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:47:38,610 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:47:38,610 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154738_20250319_154738.png
2025-03-19 15:47:40,253 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154738_20250319_154738.png
2025-03-19 15:47:40,254 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_154738_20250319_154738.png
2025-03-19 15:47:40,254 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:47:47,392 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:47:47,409 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:47:47,414 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:47:57,539 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:47:57,540 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:47:57,540 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:47:57,668 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{40fcf1b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t618}
    * Task{27869f6 #618 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:47:57,669 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154757_20250319_154757.png
2025-03-19 15:47:59,319 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154757_20250319_154757.png
2025-03-19 15:47:59,320 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_154757_20250319_154757.png
2025-03-19 15:47:59,320 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:48:03,879 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:48:03,885 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg
2025-03-19 15:48:03,885 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:48:03,886 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:48:03,886 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:48:03,886 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:48:06,060 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:48:07,065 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:48:08,070 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:48:08,071 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:48:08,071 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 131.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:48:08,071 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:48:18,073 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4 (大小: 4.18MB)
2025-03-19 15:48:18,074 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.919433秒，无需修复
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_154705.mp4
2025-03-19 15:48:18,192 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:48:25,437 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4
2025-03-19 15:48:25,444 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4
2025-03-19 15:48:25,445 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:48:25,445 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:48:30,703 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:48:30,704 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:48:31,008 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:48:32,013 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:48:32,014 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:48:32,014 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:48:33,128 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:48:33,129 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:48:33,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:48:35,242 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:48:35,243 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:48:36,369 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:48:36,370 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:48:36,370 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:48:37,509 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:48:37,510 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:48:37,511 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:48:37,512 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:46:18\n- 结束时间: 2025-03-19 15:48:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_134.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_135.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:48:37"}]}]}}
2025-03-19 15:48:37,980 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:48:37,982 - QuickAppADBTester - INFO - 测试完成
2025-03-19 15:53:38,046 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 15:53:38,047 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 15:53:38,048 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 15:53:38,048 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 15:53:38,181 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 15:53:38,325 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 15:53:38,326 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 15:53:38,326 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:53:38,326 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:53:38,558 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:53:38,559 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:53:38,559 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:53:38,559 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:53:40,051 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:53:40,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:53:41,283 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 15:53:41,284 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 15:53:41,427 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 15:53:41,428 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 15:53:41,428 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 15:53:41,428 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 15:53:42,823 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:53:42,824 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:53:44,100 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:53:45,197 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 15:53:45,197 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 15:53:45,316 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 15:53:47,321 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 15:53:47,322 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 15:53:48,412 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 15:53:48,413 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 15:53:48,413 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:53:48,413 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 15:53:48,488 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:53:50,498 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 15:53:50,499 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 15:53:52,682 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 15:53:52,683 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 15:53:54,766 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 15:53:54,767 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 15:53:55,875 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 15:53:55,876 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 15:53:55,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:53:55,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 15:53:55,954 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:53:57,962 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 15:53:57,962 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 15:54:00,133 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 15:54:00,134 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 15:54:01,557 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 15:54:03,052 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 15:54:03,053 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 15:54:04,204 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 15:54:04,205 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 15:54:05,284 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 15:54:05,284 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 15:54:07,463 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:54:07,464 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:54:08,647 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 15:54:08,647 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 15:54:08,772 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 15:54:13,778 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 15:54:13,779 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 15:54:15,922 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 15:54:15,922 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 15:54:21,065 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 15:54:21,066 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 15:54:23,215 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 15:54:28,217 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 15:54:28,218 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_155428.mp4
2025-03-19 15:54:28,218 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:54:28,218 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:54:33,472 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:54:33,473 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 15:54:33,518 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 15:54:34,712 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4
2025-03-19 15:54:34,714 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 15:54:36,726 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 15:54:39,734 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 15:54:39,734 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 15:54:42,738 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 15:54:42,740 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 15:54:42,740 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 15:54:43,934 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 15:54:43,936 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 15:54:43,936 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 15:54:43,937 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 15:54:44,042 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 15:54:46,045 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 15:54:46,046 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 15:54:46,046 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 15:54:48,392 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 15:54:48,393 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 15:54:56,590 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 15:54:56,591 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 15:54:56,592 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 15:54:56,592 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:56,869 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 15:54:56,870 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,176 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 15:54:57,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,407 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 15:54:57,408 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,622 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 15:54:57,622 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:57,863 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 15:54:57,864 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,118 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 15:54:58,119 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,359 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 15:54:58,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,599 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 15:54:58,601 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:54:58,840 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 15:54:58,841 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 15:55:01,069 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 15:55:01,071 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:55:01,071 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:55:01,229 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b62b33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t624}
    * Task{77126ee #624 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 15:55:01,231 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_155501_20250319_155501.png
2025-03-19 15:55:02,719 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_155501_20250319_155501.png
2025-03-19 15:55:02,719 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_155501_20250319_155501.png
2025-03-19 15:55:02,719 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:55:09,381 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_136.jpg
2025-03-19 15:55:09,388 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_136.jpg
2025-03-19 15:55:09,389 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 15:55:09,389 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:09,389 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:55:09,840 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 15:55:19,508 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 15:55:19,508 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 15:55:19,508 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 15:55:19,621 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b62b33 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t624}
    * Task{77126ee #624 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 15:55:19,622 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_155519_20250319_155519.png
2025-03-19 15:55:21,081 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_155519_20250319_155519.png
2025-03-19 15:55:21,081 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_155519_20250319_155519.png
2025-03-19 15:55:21,081 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 15:55:26,750 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_137.jpg
2025-03-19 15:55:26,757 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_137.jpg
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:26,758 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:55:28,885 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 15:55:28,887 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 15:55:28,888 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 15:55:28,888 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 15:55:29,892 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 15:55:30,897 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 15:55:30,897 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 15:55:30,898 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 129.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 15:55:30,898 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 15:55:40,904 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4 (大小: 3.30MB)
2025-03-19 15:55:40,907 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 15:55:41,071 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.347822秒，无需修复
2025-03-19 15:55:41,072 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 15:55:41,072 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_155428.mp4
2025-03-19 15:55:41,072 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 15:55:48,477 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4
2025-03-19 15:55:48,484 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4
2025-03-19 15:55:48,485 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 15:55:48,485 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 15:55:53,746 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 15:55:53,748 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4
2025-03-19 15:55:53,748 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 15:55:53,748 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 15:55:53,749 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 15:55:54,123 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 15:55:55,129 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 15:55:55,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:55,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:55:56,241 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 15:55:56,242 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 15:55:56,242 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 15:55:58,360 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 15:55:58,361 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 15:55:59,527 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 15:55:59,528 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 15:55:59,528 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 15:56:00,642 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 15:56:00,643 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 15:56:00,643 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 15:56:00,644 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 15:53:41\n- 结束时间: 2025-03-19 15:56:00\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_136.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_137.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_138.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 15:56:00"}]}]}}
2025-03-19 15:56:01,080 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 15:56:01,084 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:01:01,229 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:01:01,231 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:01:01,231 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:01:01,231 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:01:01,529 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:01:01,662 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:01:01,662 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:01:01,662 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:01:01,662 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:01:01,876 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:01:01,877 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:01:01,877 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:01:01,878 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:01:03,360 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:01:03,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:01:04,751 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:01:04,751 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:01:04,752 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:01:04,752 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:01:04,752 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:01:04,951 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:01:04,951 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:01:04,951 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:01:04,951 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:01:06,328 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:01:06,329 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:01:07,561 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:01:07,562 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:01:07,562 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:01:07,562 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:01:07,562 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:01:08,648 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:01:08,649 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:01:08,838 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:01:10,840 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:01:10,840 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:01:11,932 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:01:11,933 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:01:11,933 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:01:11,933 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:01:12,000 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:01:14,006 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:01:14,007 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:01:16,187 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:01:16,188 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:01:18,263 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:01:18,266 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:01:19,354 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:01:19,355 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:01:19,355 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:01:19,355 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:01:19,422 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:01:21,432 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:01:21,432 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:01:23,576 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:01:23,576 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:01:24,978 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:01:26,447 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:01:26,447 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:01:27,628 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:01:27,629 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:01:28,742 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:01:28,743 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:01:30,906 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:01:30,907 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:01:30,907 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:01:30,907 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:01:30,907 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:01:32,101 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:01:32,102 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:01:32,216 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:01:37,221 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:01:37,222 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:01:39,394 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:01:39,396 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:01:44,525 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:01:44,526 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:01:46,693 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:01:51,698 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:01:51,698 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_160151.mp4
2025-03-19 16:01:51,699 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:01:51,699 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:01:56,985 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:01:56,986 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:01:57,019 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:01:58,154 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160151.mp4
2025-03-19 16:01:58,155 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160151.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:02:00,166 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:02:03,170 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:02:03,171 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:02:06,172 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:02:06,174 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:02:06,174 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:02:07,373 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:02:07,374 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:02:07,374 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:02:07,374 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:02:07,478 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:02:09,485 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:02:09,485 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:02:09,486 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:02:11,733 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:02:11,734 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:02:19,898 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:02:19,899 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:02:19,899 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:02:19,900 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:20,271 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:02:20,271 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:20,530 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:02:20,531 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:20,788 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:02:20,789 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:21,009 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:02:21,010 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:21,255 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:02:21,256 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:21,496 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:02:21,497 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:21,741 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:02:21,742 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:22,004 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:02:22,005 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:22,227 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:02:22,227 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:02:24,456 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:02:24,456 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:02:24,457 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:02:24,627 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{915421f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t630}
    * Task{8bdabca #630 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:02:24,628 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:02:24,628 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:02:24,628 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:02:24,628 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_160224_20250319_160224.png
2025-03-19 16:02:26,010 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_160224_20250319_160224.png
2025-03-19 16:02:26,011 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_160224_20250319_160224.png
2025-03-19 16:02:26,011 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:02:32,753 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_139.jpg
2025-03-19 16:02:32,761 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_139.jpg
2025-03-19 16:02:32,762 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:02:32,762 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:02:32,762 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:02:33,265 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:02:42,946 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:02:42,948 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:02:42,948 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:02:43,036 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{915421f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t630}
    * Task{8bdabca #630 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:02:43,036 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:02:43,037 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:02:43,037 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:02:43,037 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_160243_20250319_160243.png
2025-03-19 16:02:44,386 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_160243_20250319_160243.png
2025-03-19 16:02:44,387 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_160243_20250319_160243.png
2025-03-19 16:02:44,387 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:02:50,195 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_140.jpg
2025-03-19 16:02:50,201 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_140.jpg
2025-03-19 16:02:50,202 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:02:50,202 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:02:50,202 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:02:50,202 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:02:52,327 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:02:52,328 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:02:52,328 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:02:52,328 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:02:53,332 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:02:54,338 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:02:54,338 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:02:54,339 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 50.3 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-19 16:02:54,339 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:03:04,342 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160151.mp4 (大小: 3.31MB)
2025-03-19 16:03:04,343 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:03:04,423 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.352444秒，无需修复
2025-03-19 16:03:04,424 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:03:04,424 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160151.mp4
2025-03-19 16:03:04,424 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:03:11,780 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_141.mp4
2025-03-19 16:03:11,785 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_141.mp4
2025-03-19 16:03:11,785 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:03:11,785 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:03:17,042 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:03:17,043 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_141.mp4
2025-03-19 16:03:17,044 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:03:17,044 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:03:17,044 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:03:17,502 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:03:18,503 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:03:18,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:03:18,504 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:03:19,607 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:03:19,608 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:03:19,608 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:03:21,710 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:03:21,711 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:03:22,864 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:03:22,865 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:03:22,865 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:03:23,970 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:03:23,972 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:03:23,972 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:03:23,972 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:01:04\n- 结束时间: 2025-03-19 16:03:23\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_139.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_140.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_141.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:03:23"}]}]}}
2025-03-19 16:03:24,399 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:03:24,402 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:08:24,882 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:08:24,884 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:08:24,884 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:08:24,884 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:08:25,025 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:08:25,187 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:08:25,188 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:08:25,188 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:08:25,188 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:08:25,454 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:08:25,454 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:08:25,454 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:08:25,454 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:08:26,940 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:08:26,941 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:08:28,209 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:08:28,210 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:08:28,210 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:08:28,210 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:08:28,210 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:08:28,361 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:08:28,362 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:08:28,362 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:08:28,362 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:08:29,781 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:08:29,782 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:08:31,051 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:08:31,051 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:08:31,051 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:08:31,051 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:08:31,051 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:08:32,156 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:08:32,159 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:08:32,287 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:08:34,295 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:08:34,296 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:08:35,358 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:08:35,359 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:08:35,360 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:08:35,360 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:08:35,437 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:08:37,456 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:08:37,456 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:08:39,641 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:08:39,642 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:08:41,735 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:08:41,736 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:08:42,839 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:08:42,839 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:08:42,840 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:08:42,840 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:08:42,915 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:08:44,932 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:08:44,932 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:08:47,100 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:08:47,101 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:08:48,532 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:08:50,021 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:08:50,022 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:08:51,174 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:08:51,175 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:08:52,279 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:08:52,281 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:08:54,461 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:08:54,462 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:08:54,462 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:08:54,462 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:08:54,462 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:08:55,644 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:08:55,644 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:08:55,787 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:09:00,788 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:09:00,788 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:09:02,958 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:09:02,958 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:09:08,089 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:09:08,090 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:09:10,264 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:09:15,266 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:09:15,267 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_160915.mp4
2025-03-19 16:09:15,267 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:09:15,267 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:09:20,553 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:09:20,554 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:09:20,601 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:09:21,820 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160915.mp4
2025-03-19 16:09:21,820 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160915.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:09:23,832 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:09:26,843 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:09:26,843 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:09:29,849 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:09:29,849 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:09:29,850 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:09:31,072 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:09:31,073 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:09:31,073 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:09:31,073 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:09:31,170 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:09:33,190 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:09:33,191 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:09:33,191 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:09:35,500 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:09:35,501 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:09:43,688 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:09:43,689 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:09:43,689 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:09:43,689 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:43,986 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:09:43,986 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:44,249 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:09:44,249 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:44,483 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:09:44,484 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:44,714 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:09:44,715 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:44,964 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:09:44,964 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:45,222 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:09:45,223 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:45,543 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:09:45,543 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:45,784 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:09:45,786 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:46,026 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:09:46,027 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:09:48,293 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:09:48,294 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:09:48,294 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:09:48,433 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ce9587c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t636}
    * Task{986c78b #636 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:09:48,434 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:09:48,434 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:09:48,434 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:09:48,434 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_160948_20250319_160948.png
2025-03-19 16:09:50,028 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_160948_20250319_160948.png
2025-03-19 16:09:50,029 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_160948_20250319_160948.png
2025-03-19 16:09:50,030 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:09:57,052 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:09:57,070 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_142.jpg
2025-03-19 16:09:57,075 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_142.jpg
2025-03-19 16:09:57,075 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:09:57,075 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:09:57,076 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:10:07,278 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:10:07,278 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:10:07,279 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:10:07,365 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ce9587c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t636}
    * Task{986c78b #636 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:10:07,365 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:10:07,365 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:10:07,366 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:10:07,366 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_161007_20250319_161007.png
2025-03-19 16:10:08,847 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_161007_20250319_161007.png
2025-03-19 16:10:08,847 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_161007_20250319_161007.png
2025-03-19 16:10:08,847 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:10:13,797 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_142.jpg
2025-03-19 16:10:13,801 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_142.jpg
2025-03-19 16:10:13,802 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:10:13,802 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:10:13,802 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:10:13,802 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:10:15,985 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:10:15,986 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:10:15,987 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:10:15,987 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:10:16,996 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:10:18,005 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:10:18,006 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:10:18,006 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 164.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 16:10:18,006 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:10:28,016 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160915.mp4 (大小: 3.30MB)
2025-03-19 16:10:28,017 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:10:28,161 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.356611秒，无需修复
2025-03-19 16:10:28,161 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:10:28,161 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_160915.mp4
2025-03-19 16:10:28,161 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:10:35,634 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_143.mp4
2025-03-19 16:10:35,641 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_143.mp4
2025-03-19 16:10:35,641 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:10:35,641 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:10:40,903 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:10:40,904 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_143.mp4
2025-03-19 16:10:40,904 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:10:40,904 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:10:40,905 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:10:41,344 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:10:42,348 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:10:42,348 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:10:42,348 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:10:43,456 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:10:43,456 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:10:43,457 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:10:45,556 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:10:45,556 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:10:46,717 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:10:46,718 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:10:46,719 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:10:47,861 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:10:47,863 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:10:47,863 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:10:47,863 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:08:28\n- 结束时间: 2025-03-19 16:10:47\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_142.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_142.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_143.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:10:47"}]}]}}
2025-03-19 16:10:48,344 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:10:48,346 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:15:48,372 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:15:48,374 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:15:48,374 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:15:48,374 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:15:48,510 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:15:48,674 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:15:48,675 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:15:48,675 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:15:48,675 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:15:48,900 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:15:48,900 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:15:48,900 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:15:48,900 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:15:50,383 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:15:50,384 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:15:51,659 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:15:51,659 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:15:51,659 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:15:51,659 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:15:51,660 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:15:51,821 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:15:51,822 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:15:51,822 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:15:51,822 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:15:53,237 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:15:53,238 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:15:54,498 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:15:54,498 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:15:54,498 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:15:54,499 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:15:54,499 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:15:55,592 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:15:55,593 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:15:55,710 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:15:57,713 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:15:57,714 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:15:58,802 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:15:58,804 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:15:58,805 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:15:58,805 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:15:58,883 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:16:00,891 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:16:00,892 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:16:03,082 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:16:03,082 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:16:05,171 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:16:05,171 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:16:06,277 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:16:06,278 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:16:06,278 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:16:06,278 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:16:06,383 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:16:08,390 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:16:08,391 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:16:10,571 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:16:10,572 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:16:11,995 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:16:13,471 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:16:13,472 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:16:14,634 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:16:14,634 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:16:15,739 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:16:15,740 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:16:17,936 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:16:17,936 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:16:17,937 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:16:17,937 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:16:17,937 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:16:19,091 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:16:19,092 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:16:19,208 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:16:24,212 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:16:24,213 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:16:26,399 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:16:26,400 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:16:31,531 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:16:31,532 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:16:33,712 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:16:38,718 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:16:38,719 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_161638.mp4
2025-03-19 16:16:38,719 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:16:38,719 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:16:43,986 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:16:43,988 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:16:44,051 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:16:45,242 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_161638.mp4
2025-03-19 16:16:45,243 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_161638.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:16:47,254 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:16:50,258 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:16:50,258 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:16:53,259 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:16:53,259 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:16:53,259 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:16:54,613 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:16:54,614 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:16:54,614 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:16:54,614 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:16:54,741 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:16:56,753 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:16:56,753 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:16:56,753 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:16:59,081 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:16:59,082 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:17:07,306 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:17:07,308 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:17:07,308 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:17:07,308 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:07,556 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:17:07,557 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:07,828 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:17:07,829 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:08,083 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:17:08,083 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:08,295 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:17:08,296 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:08,567 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:17:08,568 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:08,832 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:17:08,833 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:09,087 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:17:09,088 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:09,321 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:17:09,322 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:09,557 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:17:09,557 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:17:11,822 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:17:11,822 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:17:11,822 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:17:11,991 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{18b9161 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t642}
    * Task{9d22d74 #642 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:17:11,992 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:17:11,992 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:17:11,992 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:17:11,993 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_161711_20250319_161711.png
2025-03-19 16:17:14,029 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_161711_20250319_161711.png
2025-03-19 16:17:14,029 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_161711_20250319_161711.png
2025-03-19 16:17:14,029 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:17:20,414 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:17:21,711 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_144.jpg
2025-03-19 16:17:21,717 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_144.jpg
2025-03-19 16:17:21,717 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:17:21,717 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:17:21,717 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:17:31,899 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:17:31,901 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:17:31,901 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:17:32,027 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{18b9161 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t642}
    * Task{9d22d74 #642 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:17:32,028 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:17:32,028 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:17:32,028 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:17:32,028 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_161732_20250319_161732.png
2025-03-19 16:17:34,063 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_161732_20250319_161732.png
2025-03-19 16:17:34,063 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_161732_20250319_161732.png
2025-03-19 16:17:34,063 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:17:40,525 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_145.jpg
2025-03-19 16:17:40,533 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_145.jpg
2025-03-19 16:17:40,533 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:17:40,533 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:17:40,533 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:17:40,533 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:17:42,680 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:17:42,681 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:17:42,681 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:17:42,681 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:17:43,685 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:17:44,688 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:17:44,689 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:17:44,689 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 118.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 16:17:44,689 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:17:54,694 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_161638.mp4 (大小: 3.93MB)
2025-03-19 16:17:54,696 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:17:54,813 - QuickAppADBTester - INFO - 录制文件完整，时长: 56.510444秒，无需修复
2025-03-19 16:17:54,814 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:17:54,814 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_161638.mp4
2025-03-19 16:17:54,814 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:18:01,990 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_146.mp4
2025-03-19 16:18:01,996 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_146.mp4
2025-03-19 16:18:01,996 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:18:01,996 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:18:07,243 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:18:07,247 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_146.mp4
2025-03-19 16:18:07,250 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:18:07,250 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:18:07,250 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:18:07,530 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:18:08,535 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:18:08,536 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:18:08,536 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:18:09,633 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:18:09,634 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:18:09,634 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:18:11,817 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:18:11,818 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:18:12,962 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:18:12,963 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:18:12,963 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:18:14,074 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:18:14,075 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:18:14,075 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:18:14,076 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:15:51\n- 结束时间: 2025-03-19 16:18:14\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_144.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_145.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_146.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:18:14"}]}]}}
2025-03-19 16:18:14,501 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:18:14,503 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:23:14,509 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:23:14,511 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:23:14,511 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:23:14,512 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:23:14,647 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:23:14,794 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:23:14,795 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:23:14,795 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:23:14,795 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:23:15,038 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:23:15,039 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:23:15,039 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:23:15,039 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:23:16,482 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:23:16,483 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:23:17,728 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:23:17,728 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:23:17,728 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:23:17,728 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:23:17,728 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:23:17,881 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:23:17,882 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:23:17,882 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:23:17,882 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:23:19,294 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:23:19,294 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:23:20,569 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:23:20,569 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:23:20,569 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:23:20,569 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:23:20,569 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:23:21,666 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:23:21,667 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:23:21,788 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:23:23,791 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:23:23,792 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:23:24,880 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:23:24,881 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:23:24,881 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:23:24,881 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:23:24,963 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:23:26,973 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:23:26,974 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:23:29,164 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:23:29,165 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:23:31,250 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:23:31,251 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:23:32,355 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:23:32,356 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:23:32,356 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:23:32,356 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:23:32,434 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:23:34,444 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:23:34,444 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:23:36,583 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:23:36,584 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:23:38,009 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:23:39,483 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:23:39,484 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:23:40,622 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:23:40,623 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:23:41,731 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:23:41,732 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:23:43,937 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:23:43,937 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:23:43,937 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:23:43,937 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:23:43,938 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:23:45,119 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:23:45,120 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:23:45,226 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:23:50,230 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:23:50,231 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:23:52,406 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:23:52,407 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:23:57,562 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:23:57,563 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:23:59,730 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:24:04,734 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:24:04,734 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_162404.mp4
2025-03-19 16:24:04,734 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:24:04,734 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:24:09,978 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:24:09,979 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:24:10,025 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:24:11,214 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_162404.mp4
2025-03-19 16:24:11,215 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_162404.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:24:13,224 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:24:16,227 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:24:16,227 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:24:19,230 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:24:19,231 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:24:19,231 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:24:20,445 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:24:20,445 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:24:20,446 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:24:20,446 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:24:20,545 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:24:22,550 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:24:22,551 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:24:22,551 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:24:24,900 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:24:24,901 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:24:33,094 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:24:33,095 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:24:33,096 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:24:33,096 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:33,415 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:24:33,416 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:33,692 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:24:33,693 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:33,973 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:24:33,974 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:34,225 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:24:34,225 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:34,457 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:24:34,458 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:34,669 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:24:34,669 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:34,874 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:24:34,874 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:35,107 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:24:35,108 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:35,392 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:24:35,393 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:24:37,689 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:24:37,690 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:24:37,690 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:24:37,852 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b1d6e29 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t648}
    * Task{ff5c3e5 #648 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:24:37,853 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:24:37,853 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:24:37,853 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:24:37,854 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_162437_20250319_162437.png
2025-03-19 16:24:39,277 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_162437_20250319_162437.png
2025-03-19 16:24:39,278 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_162437_20250319_162437.png
2025-03-19 16:24:39,278 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:24:46,342 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:24:51,316 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_147.jpg
2025-03-19 16:24:51,323 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_147.jpg
2025-03-19 16:24:51,324 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:24:51,324 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:24:51,324 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:25:01,459 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:25:01,460 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:25:01,461 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:25:01,559 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b1d6e29 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t648}
    * Task{ff5c3e5 #648 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:25:01,559 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:25:01,559 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:25:01,560 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:25:01,560 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_162501_20250319_162501.png
2025-03-19 16:25:02,943 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_162501_20250319_162501.png
2025-03-19 16:25:02,944 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_162501_20250319_162501.png
2025-03-19 16:25:02,944 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:25:12,407 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_147.jpg
2025-03-19 16:25:12,414 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_147.jpg
2025-03-19 16:25:12,414 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:25:12,415 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:25:12,415 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:25:12,415 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:25:14,553 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:25:14,555 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:25:14,555 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:25:14,555 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:25:15,559 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:25:16,561 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:25:16,561 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:25:16,561 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 130.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 16:25:16,561 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:25:26,567 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_162404.mp4 (大小: 3.91MB)
2025-03-19 16:25:26,567 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:25:26,671 - QuickAppADBTester - INFO - 录制文件完整，时长: 62.474544秒，无需修复
2025-03-19 16:25:26,671 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:25:26,671 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_162404.mp4
2025-03-19 16:25:26,671 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:25:40,832 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_148.mp4
2025-03-19 16:25:40,841 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_148.mp4
2025-03-19 16:25:40,841 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:25:40,841 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:25:46,109 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:25:46,111 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_148.mp4
2025-03-19 16:25:46,111 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:25:46,111 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:25:46,111 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:25:46,531 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:25:47,537 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:25:47,537 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:25:47,538 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:25:48,634 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:25:48,635 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:25:48,635 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:25:50,750 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:25:50,752 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:25:51,903 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:25:51,903 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:25:51,903 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:25:53,037 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:25:53,038 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:25:53,038 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:25:53,039 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:23:17\n- 结束时间: 2025-03-19 16:25:53\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_147.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_147.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_148.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:25:53"}]}]}}
2025-03-19 16:25:58,749 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:25:58,752 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:30:58,828 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:30:58,833 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:30:58,833 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:30:58,834 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:30:58,974 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:30:59,088 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:30:59,089 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:30:59,089 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:30:59,089 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:30:59,336 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:30:59,336 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:30:59,337 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:30:59,337 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:31:00,832 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:31:00,835 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:31:02,089 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:31:02,090 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:31:02,090 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:31:02,090 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:31:02,090 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:31:02,241 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:31:02,242 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:31:02,242 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:31:02,242 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:31:03,654 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:31:03,655 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:31:04,928 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:31:04,928 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:31:04,928 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:31:04,928 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:31:04,928 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:31:06,015 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:31:06,016 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:31:06,152 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:31:08,155 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:31:08,156 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:31:09,235 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:31:09,236 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:31:09,236 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:31:09,236 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:31:09,302 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:31:11,310 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:31:11,311 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:31:13,489 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:31:13,490 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:31:15,568 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:31:15,569 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:31:16,668 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:31:16,669 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:31:16,669 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:31:16,669 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:31:16,733 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:31:18,743 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:31:18,743 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:31:20,949 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:31:20,950 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:31:22,361 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:31:23,795 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:31:23,795 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:31:24,972 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:31:24,973 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:31:26,075 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:31:26,075 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:31:28,237 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:31:28,238 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:31:28,238 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:31:28,238 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:31:28,238 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:31:29,402 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:31:29,403 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:31:29,529 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:31:34,533 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:31:34,535 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:31:36,690 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:31:36,691 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:31:41,840 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:31:41,842 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:31:44,013 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:31:49,017 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:31:49,017 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_163149.mp4
2025-03-19 16:31:49,017 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:31:49,018 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:31:54,296 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:31:54,298 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:31:54,347 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:31:55,537 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163149.mp4
2025-03-19 16:31:55,539 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163149.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:31:57,550 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:32:00,552 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:32:00,553 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:32:03,558 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:32:03,559 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:32:03,559 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:32:04,738 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:32:04,739 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:32:04,739 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:32:04,739 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:32:04,822 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:32:06,830 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:32:06,832 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:32:06,833 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:32:09,116 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:32:09,117 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:32:17,301 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:32:17,303 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:32:17,303 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:32:17,303 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:17,597 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:32:17,598 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:17,839 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:32:17,840 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:18,095 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:32:18,096 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:18,356 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:32:18,357 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:18,600 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:32:18,601 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:18,845 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:32:18,846 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:19,074 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:32:19,074 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:19,295 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:32:19,296 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:19,547 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:32:19,548 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:32:21,761 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:32:21,762 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:32:21,762 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:32:21,912 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{84fc6e3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t654}
    * Task{bdf3799 #654 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:32:21,913 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:32:21,913 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:32:21,913 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:32:21,914 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_163221_20250319_163221.png
2025-03-19 16:32:23,130 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_163221_20250319_163221.png
2025-03-19 16:32:23,131 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_163221_20250319_163221.png
2025-03-19 16:32:23,131 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:32:29,920 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_149.jpg
2025-03-19 16:32:29,926 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_149.jpg
2025-03-19 16:32:29,930 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:32:29,930 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:32:29,931 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:32:30,647 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:32:40,096 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:32:40,098 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:32:40,098 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:32:40,216 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{84fc6e3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t654}
    * Task{bdf3799 #654 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:32:40,216 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:32:40,216 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:32:40,216 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:32:40,216 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_163240_20250319_163240.png
2025-03-19 16:32:41,400 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_163240_20250319_163240.png
2025-03-19 16:32:41,401 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_163240_20250319_163240.png
2025-03-19 16:32:41,401 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:32:45,707 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_149.jpg
2025-03-19 16:32:45,712 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_149.jpg
2025-03-19 16:32:45,713 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:32:45,713 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:32:45,713 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:32:45,713 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:32:47,863 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:32:47,863 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:32:47,863 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:32:47,864 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:32:48,865 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:32:49,870 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:32:49,871 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:32:49,871 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 136.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 16:32:49,871 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:32:59,874 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163149.mp4 (大小: 3.09MB)
2025-03-19 16:32:59,875 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:32:59,993 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.458089秒，无需修复
2025-03-19 16:32:59,993 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:32:59,993 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163149.mp4
2025-03-19 16:32:59,993 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:33:07,433 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_150.mp4
2025-03-19 16:33:07,443 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_150.mp4
2025-03-19 16:33:07,443 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:33:07,443 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:33:12,648 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:33:12,651 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_150.mp4
2025-03-19 16:33:12,651 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:33:12,651 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:33:12,651 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:33:13,045 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:33:14,051 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:33:14,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:33:14,052 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:33:15,151 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:33:15,152 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:33:15,152 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:33:17,248 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:33:17,249 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:33:18,415 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:33:18,416 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:33:18,416 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:33:19,567 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:33:19,568 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:33:19,569 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:33:19,569 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:31:02\n- 结束时间: 2025-03-19 16:33:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_149.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_149.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_150.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:33:19"}]}]}}
2025-03-19 16:33:20,017 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:33:20,019 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:38:20,986 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:38:20,988 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:38:20,988 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:38:20,988 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:38:21,250 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:38:21,378 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:38:21,379 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:38:21,379 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:38:21,379 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:38:21,582 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:38:21,583 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:38:21,583 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:38:21,583 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:38:23,054 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:38:23,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:38:24,270 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:38:24,270 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:38:24,270 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:38:24,270 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:38:24,270 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:38:24,398 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:38:24,398 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:38:24,398 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:38:24,398 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:38:25,783 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:38:25,783 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:38:27,017 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:38:27,017 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:38:27,017 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:38:27,017 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:38:27,017 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:38:28,109 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:38:28,109 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:38:28,229 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:38:30,234 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:38:30,235 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:38:31,301 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:38:31,301 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:38:31,301 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:38:31,301 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:38:31,350 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:38:33,362 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:38:33,362 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:38:35,549 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:38:35,550 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:38:37,640 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:38:37,641 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:38:38,736 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:38:38,737 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:38:38,737 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:38:38,737 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:38:38,811 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:38:40,818 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:38:40,819 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:38:42,967 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:38:42,967 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:38:44,377 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:38:45,845 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:38:45,845 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:38:46,994 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:38:46,995 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:38:48,099 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:38:48,099 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:38:50,288 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:38:50,289 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:38:50,290 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:38:50,290 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:38:50,290 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:38:51,486 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:38:51,487 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:38:51,618 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:38:56,624 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:38:56,625 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:38:58,776 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:38:58,777 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:39:03,919 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:39:03,920 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:39:06,068 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:39:11,073 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:39:11,073 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_163911.mp4
2025-03-19 16:39:11,074 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:39:11,074 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:39:16,322 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:39:16,323 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:39:16,355 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:39:17,485 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163911.mp4
2025-03-19 16:39:17,486 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163911.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:39:19,497 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:39:22,500 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:39:22,500 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:39:25,501 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:39:25,502 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:39:25,502 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:39:26,631 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:39:26,632 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:39:26,632 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:39:26,632 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:39:26,732 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:39:28,741 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:39:28,742 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:39:28,742 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:39:31,015 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:39:31,016 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:39:39,192 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:39:39,192 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:39:39,192 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:39:39,193 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:39,480 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:39:39,481 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:39,704 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:39:39,704 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:39,938 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:39:39,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:40,201 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:39:40,202 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:40,465 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:39:40,465 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:40,703 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:39:40,704 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:40,937 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:39:40,938 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:41,172 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:39:41,173 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:41,414 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:39:41,415 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:39:43,664 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:39:43,665 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:39:43,665 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:39:43,824 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{229dc7d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t660}
    * Task{6c4b7c3 #660 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:39:43,825 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:39:43,825 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:39:43,825 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:39:43,825 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_163943_20250319_163943.png
2025-03-19 16:39:45,147 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_163943_20250319_163943.png
2025-03-19 16:39:45,148 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_163943_20250319_163943.png
2025-03-19 16:39:45,148 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:39:51,971 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_151.jpg
2025-03-19 16:39:51,978 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_151.jpg
2025-03-19 16:39:51,978 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:39:51,978 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:39:51,978 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:39:52,604 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:40:02,144 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:40:02,145 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:40:02,145 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:40:02,293 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{229dc7d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t660}
    * Task{6c4b7c3 #660 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:40:02,294 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:40:02,294 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:40:02,294 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:40:02,294 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_164002_20250319_164002.png
2025-03-19 16:40:03,612 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_164002_20250319_164002.png
2025-03-19 16:40:03,612 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_164002_20250319_164002.png
2025-03-19 16:40:03,612 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:40:09,687 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_152.jpg
2025-03-19 16:40:09,693 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_152.jpg
2025-03-19 16:40:09,694 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:40:09,694 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:40:09,694 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:40:09,694 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:40:11,842 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:40:11,842 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:40:11,842 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:40:11,842 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:40:12,847 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:40:13,851 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:40:13,854 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:40:13,854 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 177.1 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-19 16:40:13,854 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:40:23,857 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163911.mp4 (大小: 3.90MB)
2025-03-19 16:40:23,859 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:40:23,971 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.488689秒，无需修复
2025-03-19 16:40:23,971 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:40:23,972 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_163911.mp4
2025-03-19 16:40:23,972 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:40:31,143 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_153.mp4
2025-03-19 16:40:31,147 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_153.mp4
2025-03-19 16:40:31,147 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:40:31,147 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:40:36,396 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:40:36,398 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_153.mp4
2025-03-19 16:40:36,398 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:40:36,398 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:40:36,399 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:40:36,826 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:40:37,832 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:40:37,832 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:40:37,833 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:40:38,933 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:40:38,934 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:40:38,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:40:41,038 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:40:41,039 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:40:42,183 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:40:42,184 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:40:42,184 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:40:43,314 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:40:43,315 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:40:43,315 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:40:43,316 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:38:24\n- 结束时间: 2025-03-19 16:40:43\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_151.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_152.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_153.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:40:43"}]}]}}
2025-03-19 16:40:43,740 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:40:43,743 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:45:43,800 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:45:43,806 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:45:43,806 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:45:43,806 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:45:43,946 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:45:44,111 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:45:44,112 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:45:44,113 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:45:44,113 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:45:44,317 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:45:44,318 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:45:44,318 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:45:44,318 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:45:45,777 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:45:45,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:45:47,011 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:45:47,012 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:45:47,013 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:45:47,014 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:45:47,014 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:45:47,169 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:45:47,170 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:45:47,170 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:45:47,170 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:45:48,576 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:45:48,577 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:45:49,833 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:45:49,833 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:45:49,833 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:45:49,833 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:45:49,833 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:45:50,925 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:45:50,926 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:45:51,045 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:45:53,051 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:45:53,053 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:45:54,150 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:45:54,151 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:45:54,151 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:45:54,151 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:45:54,223 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:45:56,229 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:45:56,230 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:45:58,417 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:45:58,418 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:46:00,502 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:46:00,502 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:46:01,608 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:46:01,608 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:46:01,608 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:46:01,608 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:46:01,678 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:46:03,687 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:46:03,687 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:46:05,849 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:46:05,851 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:46:07,268 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:46:08,740 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:46:08,740 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:46:09,930 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:46:09,931 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:46:11,035 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:46:11,036 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:46:13,191 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:46:13,191 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:46:13,191 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:46:13,192 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:46:13,192 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:46:14,347 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:46:14,348 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:46:14,466 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:46:19,474 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:46:19,475 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:46:21,632 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:46:21,632 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:46:26,758 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:46:26,759 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:46:28,896 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:46:33,902 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:46:33,903 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_164633.mp4
2025-03-19 16:46:33,903 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:46:33,903 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:46:39,157 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:46:39,161 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:46:39,212 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:46:40,353 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_164633.mp4
2025-03-19 16:46:40,354 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_164633.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:46:42,368 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:46:45,374 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:46:45,374 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:46:48,376 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:46:48,377 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:46:48,377 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:46:49,578 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:46:49,579 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:46:49,579 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:46:49,579 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:46:49,686 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:46:51,694 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:46:51,695 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:46:51,695 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:46:53,957 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:46:53,958 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:47:02,142 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:47:02,143 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:47:02,143 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:47:02,143 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:02,483 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:47:02,484 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:02,742 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:47:02,743 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:02,970 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:47:02,970 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:03,222 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:47:03,223 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:03,455 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:47:03,456 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:03,711 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:47:03,712 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:03,943 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:47:03,944 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:04,207 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:47:04,208 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:04,437 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:47:04,437 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:47:06,657 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:47:06,657 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:47:06,657 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:47:06,788 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4e916dc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t666}
    * Task{d5ec4c8 #666 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:47:06,788 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:47:06,788 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:47:06,788 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:47:06,789 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_164706_20250319_164706.png
2025-03-19 16:47:08,858 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_164706_20250319_164706.png
2025-03-19 16:47:08,859 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_164706_20250319_164706.png
2025-03-19 16:47:08,861 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:47:15,488 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:47:16,545 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_154.jpg
2025-03-19 16:47:16,547 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_154.jpg
2025-03-19 16:47:16,547 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:47:16,547 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:47:16,547 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:47:26,719 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:47:26,721 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:47:26,721 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:47:26,854 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4e916dc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t666}
    * Task{d5ec4c8 #666 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:47:26,855 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:47:26,855 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:47:26,855 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:47:26,855 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_164726_20250319_164726.png
2025-03-19 16:47:29,012 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_164726_20250319_164726.png
2025-03-19 16:47:29,013 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_164726_20250319_164726.png
2025-03-19 16:47:29,014 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:47:33,708 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_154.jpg
2025-03-19 16:47:33,714 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_154.jpg
2025-03-19 16:47:33,714 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:47:33,714 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:47:33,714 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:47:33,715 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:47:35,893 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:47:35,895 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:47:35,896 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:47:35,896 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:47:36,901 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:47:37,904 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:47:37,904 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:47:37,904 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 124.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 16:47:37,905 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:47:47,909 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_164633.mp4 (大小: 4.01MB)
2025-03-19 16:47:47,909 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:47:48,060 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.692756秒，无需修复
2025-03-19 16:47:48,060 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:47:48,060 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_164633.mp4
2025-03-19 16:47:48,060 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:47:55,304 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_155.mp4
2025-03-19 16:47:55,312 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_155.mp4
2025-03-19 16:47:55,312 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:47:55,312 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:48:00,563 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:48:00,564 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_155.mp4
2025-03-19 16:48:00,565 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:48:00,565 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:48:00,565 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:48:00,959 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:48:01,960 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:48:01,961 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:48:01,961 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:48:03,066 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:48:03,067 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:48:03,067 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:48:05,166 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:48:05,169 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:48:06,338 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:48:06,339 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:48:06,339 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:48:07,477 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:48:07,478 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:48:07,478 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:48:07,480 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:45:47\n- 结束时间: 2025-03-19 16:48:07\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_154.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_154.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_155.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:48:07"}]}]}}
2025-03-19 16:48:07,939 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:48:07,943 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:53:07,974 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:53:07,977 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:53:07,977 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:53:07,978 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:53:08,106 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:53:08,268 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:53:08,268 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:53:08,268 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:53:08,269 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:53:08,501 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:53:08,502 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:53:08,502 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:53:08,502 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:53:09,949 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:53:09,951 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:53:11,205 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:53:11,206 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:53:11,206 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:53:11,206 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:53:11,206 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:53:11,375 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:53:11,376 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:53:11,376 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:53:11,376 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:53:12,782 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:53:12,782 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:53:14,029 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:53:14,030 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:53:14,030 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:53:14,030 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:53:14,030 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:53:15,129 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:53:15,130 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:53:15,243 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:53:17,248 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:53:17,249 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:53:18,331 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:53:18,332 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:53:18,332 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:53:18,332 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:53:18,412 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:53:20,420 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:53:20,421 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:53:22,617 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:53:22,618 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:53:24,699 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:53:24,700 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:53:25,796 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:53:25,797 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:53:25,797 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:53:25,797 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:53:25,870 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:53:27,880 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 16:53:27,880 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 16:53:30,043 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 16:53:30,044 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 16:53:31,460 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 16:53:32,932 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 16:53:32,932 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 16:53:34,111 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 16:53:34,111 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 16:53:35,209 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 16:53:35,210 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 16:53:37,396 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 16:53:37,397 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 16:53:37,397 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:53:37,397 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:53:37,397 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:53:38,585 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 16:53:38,586 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 16:53:38,700 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 16:53:43,701 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 16:53:43,704 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 16:53:45,850 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 16:53:45,851 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 16:53:50,975 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 16:53:50,976 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 16:53:53,131 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 16:53:58,134 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 16:53:58,141 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_165358.mp4
2025-03-19 16:53:58,141 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:53:58,141 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:54:03,402 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:54:03,404 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 16:54:03,450 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 16:54:04,641 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_165358.mp4
2025-03-19 16:54:04,641 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_165358.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 16:54:06,650 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 16:54:09,657 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 16:54:09,658 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 16:54:12,660 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 16:54:12,660 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 16:54:12,661 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 16:54:13,852 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 16:54:13,853 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 16:54:13,854 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:54:13,854 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 16:54:13,956 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:54:15,963 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 16:54:15,964 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 16:54:15,964 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 16:54:18,247 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 16:54:18,248 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 16:54:26,395 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 16:54:26,396 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 16:54:26,396 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 16:54:26,397 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:26,690 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 16:54:26,691 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:26,931 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 16:54:26,932 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:27,167 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 16:54:27,168 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:27,429 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 16:54:27,430 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:27,684 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 16:54:27,685 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:27,915 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 16:54:27,916 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:28,144 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 16:54:28,145 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:28,400 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 16:54:28,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:28,645 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 16:54:28,646 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 16:54:30,886 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 16:54:30,887 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:54:30,887 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:54:31,055 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ca34c91 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t672}
    * Task{580c664 #672 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:54:31,056 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:54:31,056 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 16:54:31,057 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 16:54:31,057 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_165431_20250319_165431.png
2025-03-19 16:54:33,124 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_165431_20250319_165431.png
2025-03-19 16:54:33,125 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_165431_20250319_165431.png
2025-03-19 16:54:33,125 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:54:39,768 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 16:54:40,708 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_156.jpg
2025-03-19 16:54:40,712 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_156.jpg
2025-03-19 16:54:40,713 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 16:54:40,713 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:54:40,713 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:54:50,882 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 16:54:50,883 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 16:54:50,883 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 16:54:50,993 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ca34c91 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t672}
    * Task{580c664 #672 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 16:54:50,993 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 16:54:50,994 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 16:54:50,994 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 16:54:50,994 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_165450_20250319_165450.png
2025-03-19 16:54:53,041 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_165450_20250319_165450.png
2025-03-19 16:54:53,042 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_165450_20250319_165450.png
2025-03-19 16:54:53,042 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 16:54:57,695 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_156.jpg
2025-03-19 16:54:57,702 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_156.jpg
2025-03-19 16:54:57,702 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 16:54:57,703 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 16:54:57,703 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:54:57,703 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:54:59,839 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 16:54:59,840 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 16:54:59,840 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 16:54:59,840 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 16:55:00,844 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 16:55:01,847 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 16:55:01,848 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 16:55:01,848 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 113.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 16:55:01,848 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 16:55:11,851 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_165358.mp4 (大小: 4.12MB)
2025-03-19 16:55:11,852 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 16:55:11,999 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.351722秒，无需修复
2025-03-19 16:55:11,999 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 16:55:11,999 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_165358.mp4
2025-03-19 16:55:11,999 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 16:55:19,050 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_157.mp4
2025-03-19 16:55:19,057 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_157.mp4
2025-03-19 16:55:19,057 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 16:55:19,057 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 16:55:24,324 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 16:55:24,325 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_157.mp4
2025-03-19 16:55:24,325 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 16:55:24,326 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 16:55:24,326 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 16:55:24,757 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 16:55:25,762 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 16:55:25,763 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:55:25,763 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:55:26,867 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 16:55:26,868 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 16:55:26,868 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 16:55:28,966 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 16:55:28,967 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 16:55:30,120 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 16:55:30,121 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:55:30,121 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:55:31,265 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 16:55:31,266 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 16:55:31,266 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 16:55:31,267 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:53:11\n- 结束时间: 2025-03-19 16:55:31\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_156.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_156.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_157.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 16:55:31"}]}]}}
2025-03-19 16:55:31,707 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 16:55:31,709 - QuickAppADBTester - INFO - 测试完成
2025-03-19 16:59:39,599 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 16:59:39,600 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 16:59:39,600 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 16:59:41,146 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 16:59:41,146 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 16:59:41,147 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 16:59:41,147 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 16:59:41,147 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 16:59:41,258 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 16:59:41,400 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 16:59:41,400 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 16:59:41,401 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:59:41,401 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:59:41,631 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:59:41,631 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:59:41,631 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:59:41,631 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:59:43,090 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:59:43,091 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:59:44,323 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:59:44,324 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 16:59:44,324 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 16:59:44,324 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 16:59:44,324 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 16:59:44,471 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 16:59:44,471 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 16:59:44,471 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 16:59:44,471 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 16:59:45,853 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:59:45,854 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:59:47,104 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 16:59:47,104 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 16:59:47,104 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 16:59:47,104 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 16:59:47,104 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 16:59:48,187 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 16:59:48,187 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 16:59:48,298 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 16:59:50,304 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 16:59:50,305 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 16:59:51,393 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 16:59:51,394 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 16:59:51,394 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:59:51,394 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 16:59:51,463 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 16:59:53,469 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 16:59:53,470 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 16:59:55,645 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 16:59:55,646 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 16:59:57,722 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 16:59:57,724 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 16:59:58,826 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 16:59:58,826 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 16:59:58,827 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 16:59:58,827 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 16:59:58,896 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:00:00,906 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:00:00,906 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:00:03,062 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:00:03,063 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:00:04,473 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:00:05,929 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:00:05,930 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:00:07,102 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:00:07,102 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:00:08,206 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:00:08,207 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:00:10,385 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:00:10,386 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:00:10,386 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:00:10,386 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:00:10,387 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:00:11,548 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:00:11,548 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:00:11,660 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:00:16,665 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:00:16,665 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:00:18,805 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:00:18,806 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:00:23,941 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:00:23,941 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:00:26,089 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:00:31,092 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:00:31,093 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_170031.mp4
2025-03-19 17:00:31,093 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:00:31,093 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:00:36,317 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:00:36,318 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:00:36,354 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:00:37,541 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170031.mp4
2025-03-19 17:00:37,541 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170031.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:00:39,551 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:00:42,557 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:00:42,557 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:00:45,558 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:00:45,559 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:00:45,559 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:00:46,730 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:00:46,731 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:00:46,731 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:00:46,731 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:00:46,821 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:00:48,832 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:00:48,833 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:00:48,833 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:00:51,108 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:00:51,108 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:00:59,291 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:00:59,292 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:00:59,292 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:00:59,292 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:00:59,623 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:00:59,624 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:00:59,872 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:00:59,873 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:00,088 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:01:00,089 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:00,350 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:01:00,350 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:00,578 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:01:00,578 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:00,813 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:01:00,813 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:01,024 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:01:01,025 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:01,261 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:01:01,261 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:01,508 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:01:01,508 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:01:03,732 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:01:03,734 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:01:03,734 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:01:03,894 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1d096fa u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t678}
    * Task{b706708 #678 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:01:03,894 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:01:03,895 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:01:03,895 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:01:03,895 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_170103_20250319_170103.png
2025-03-19 17:01:05,613 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_170103_20250319_170103.png
2025-03-19 17:01:05,613 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_170103_20250319_170103.png
2025-03-19 17:01:05,614 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:01:12,490 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_158.jpg
2025-03-19 17:01:12,497 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_158.jpg
2025-03-19 17:01:12,498 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:01:12,498 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:01:12,498 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:01:12,649 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:01:22,668 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:01:22,670 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:01:22,670 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:01:22,812 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{1d096fa u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t678}
    * Task{b706708 #678 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:01:22,812 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:01:22,812 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:01:22,812 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:01:22,812 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_170122_20250319_170122.png
2025-03-19 17:01:24,448 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_170122_20250319_170122.png
2025-03-19 17:01:24,448 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_170122_20250319_170122.png
2025-03-19 17:01:24,448 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:01:29,476 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_158.jpg
2025-03-19 17:01:29,481 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_158.jpg
2025-03-19 17:01:29,482 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:01:29,482 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:01:29,482 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:01:29,482 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:01:31,612 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:01:31,612 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:01:31,612 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:01:31,613 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:01:32,618 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:01:33,621 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:01:33,621 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:01:33,621 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 160.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:01:33,621 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:01:43,625 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170031.mp4 (大小: 3.83MB)
2025-03-19 17:01:43,627 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:01:43,745 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.217567秒，无需修复
2025-03-19 17:01:43,745 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:01:43,745 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170031.mp4
2025-03-19 17:01:43,745 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:01:50,940 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_159.mp4
2025-03-19 17:01:50,946 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_159.mp4
2025-03-19 17:01:50,946 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:01:50,946 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:01:56,209 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:01:56,210 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_159.mp4
2025-03-19 17:01:56,210 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:01:56,210 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:01:56,210 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:01:56,672 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:01:57,676 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:01:57,678 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:01:57,678 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:01:58,785 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:01:58,785 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:01:58,786 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:02:00,886 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:02:00,886 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:02:02,078 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:02:02,079 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:02:02,079 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:02:03,213 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:02:03,215 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:02:03,216 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:02:03,217 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 16:59:44\n- 结束时间: 2025-03-19 17:02:03\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_158.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_158.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_159.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:02:03"}]}]}}
2025-03-19 17:02:03,667 - QuickAppADBTester - ERROR - 飞书通知发送异常: HTTPSConnectionPool(host='open.feishu.cn', port=443): Max retries exceeded with url: /open-apis/bot/v2/hook/2e9f09a8-4cec-4475-a6a8-4da61c4a874c (Caused by ProxyError('Cannot connect to proxy.', RemoteDisconnected('Remote end closed connection without response')))
2025-03-19 17:02:03,703 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 716, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 468, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 463, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1378, in getresponse
    response.begin()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='open.feishu.cn', port=443): Max retries exceeded with url: /open-apis/bot/v2/hook/2e9f09a8-4cec-4475-a6a8-4da61c4a874c (Caused by ProxyError('Cannot connect to proxy.', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 414, in send_feishu_notification
    response = requests.post(FEISHU_WEBHOOK_URL, headers=headers, data=json.dumps(msg))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 559, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPSConnectionPool(host='open.feishu.cn', port=443): Max retries exceeded with url: /open-apis/bot/v2/hook/2e9f09a8-4cec-4475-a6a8-4da61c4a874c (Caused by ProxyError('Cannot connect to proxy.', RemoteDisconnected('Remote end closed connection without response')))

2025-03-19 17:02:03,705 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:02:03,706 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 17:07:03,758 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:07:03,761 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:07:03,761 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:07:03,761 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:07:03,900 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:07:04,062 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:07:04,062 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:07:04,063 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:07:04,063 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:07:04,304 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:07:04,305 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:07:04,305 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:07:04,305 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:07:05,769 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:07:05,770 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:07:07,023 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:07:07,024 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:07:07,024 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:07:07,024 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:07:07,024 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:07:07,188 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:07:07,189 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:07:07,189 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:07:07,189 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:07:08,582 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:07:08,583 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:07:09,837 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:07:09,837 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:07:09,837 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:07:09,837 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:07:09,837 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:07:10,918 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:07:10,919 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:07:11,033 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:07:13,037 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:07:13,038 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:07:14,129 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:07:14,130 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:07:14,130 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:07:14,130 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:07:14,211 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:07:16,221 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:07:16,222 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:07:18,406 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:07:18,408 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:07:20,493 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:07:20,494 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:07:21,597 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:07:21,598 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:07:21,598 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:07:21,598 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:07:21,678 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:07:23,686 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:07:23,687 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:07:25,845 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:07:25,846 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:07:27,274 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:07:28,747 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:07:28,748 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:07:29,920 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:07:29,921 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:07:31,025 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:07:31,026 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:07:33,182 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:07:33,185 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:07:33,185 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:07:33,185 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:07:33,185 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:07:34,362 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:07:34,362 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:07:34,452 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:07:39,458 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:07:39,458 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:07:41,619 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:07:41,619 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:07:46,760 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:07:46,762 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:07:48,929 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:07:53,934 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:07:53,935 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_170753.mp4
2025-03-19 17:07:53,935 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:07:53,935 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:07:59,194 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:07:59,195 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:07:59,255 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:08:00,392 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170753.mp4
2025-03-19 17:08:00,393 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170753.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:08:02,408 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:08:05,414 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:08:05,415 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:08:08,421 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:08:08,421 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:08:08,421 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:08:09,602 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:08:09,603 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:08:09,603 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:08:09,603 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:08:09,695 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:08:11,704 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:08:11,704 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:08:11,705 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:08:13,978 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:08:13,979 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:08:22,144 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:08:22,145 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:08:22,145 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:08:22,145 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:22,427 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:08:22,429 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:22,671 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:08:22,672 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:22,904 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:08:22,905 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:23,145 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:08:23,147 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:23,398 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:08:23,399 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:23,622 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:08:23,623 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:23,853 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:08:23,854 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:24,085 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:08:24,086 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:24,342 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:08:24,342 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:08:26,582 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:08:26,584 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:08:26,584 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:08:26,710 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{589cfd5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t684}
    * Task{f3276db #684 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:08:26,710 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:08:26,710 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:08:26,711 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:08:26,711 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_170826_20250319_170826.png
2025-03-19 17:08:28,196 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_170826_20250319_170826.png
2025-03-19 17:08:28,199 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_170826_20250319_170826.png
2025-03-19 17:08:28,200 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:08:35,519 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:08:35,552 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_160.jpg
2025-03-19 17:08:35,556 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_160.jpg
2025-03-19 17:08:35,556 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:08:35,556 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:08:35,556 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:08:45,727 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:08:45,728 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:08:45,728 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:08:45,878 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{589cfd5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t684}
    * Task{f3276db #684 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:08:45,879 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:08:45,879 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:08:45,879 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:08:45,879 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_170845_20250319_170845.png
2025-03-19 17:08:47,373 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_170845_20250319_170845.png
2025-03-19 17:08:47,374 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_170845_20250319_170845.png
2025-03-19 17:08:47,374 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:08:51,934 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_160.jpg
2025-03-19 17:08:51,938 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_160.jpg
2025-03-19 17:08:51,938 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:08:51,939 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:08:51,939 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:08:51,939 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:08:54,124 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:08:54,126 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:08:54,126 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:08:54,126 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:08:55,128 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:08:56,132 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:08:56,132 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:08:56,133 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 136.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:08:56,133 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:09:06,139 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170753.mp4 (大小: 3.62MB)
2025-03-19 17:09:06,140 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:09:06,297 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.770533秒，无需修复
2025-03-19 17:09:06,297 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:09:06,297 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_170753.mp4
2025-03-19 17:09:06,297 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:09:14,974 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_161.mp4
2025-03-19 17:09:14,982 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_161.mp4
2025-03-19 17:09:14,982 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:09:14,982 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:09:20,243 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:09:20,243 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_161.mp4
2025-03-19 17:09:20,244 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:09:20,244 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:09:20,244 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:09:20,668 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:09:21,671 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:09:21,671 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:09:21,672 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:09:22,774 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:09:22,775 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:09:22,775 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:09:24,881 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:09:24,883 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:09:26,010 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:09:26,010 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:09:26,010 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:09:27,127 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:09:27,128 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:09:27,128 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:09:27,129 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:07:07\n- 结束时间: 2025-03-19 17:09:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_160.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_160.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_161.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:09:27"}]}]}}
2025-03-19 17:09:27,756 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:09:27,760 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:14:27,762 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:14:27,765 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:14:27,765 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:14:27,766 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:14:27,893 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:14:28,002 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:14:28,002 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:14:28,003 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:14:28,003 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:14:28,244 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:14:28,245 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:14:28,245 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:14:28,245 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:14:29,730 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:14:29,730 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:14:30,975 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:14:30,975 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:14:30,976 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:14:30,976 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:14:30,976 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:14:31,120 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:14:31,121 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:14:31,121 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:14:31,121 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:14:32,520 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:14:32,520 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:14:33,777 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:14:33,777 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:14:33,777 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:14:33,777 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:14:33,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:14:34,869 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:14:34,870 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:14:34,969 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:14:36,974 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:14:36,975 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:14:38,065 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:14:38,066 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:14:38,066 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:14:38,067 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:14:38,144 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:14:40,154 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:14:40,155 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:14:42,344 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:14:42,346 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:14:44,428 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:14:44,429 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:14:45,527 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:14:45,527 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:14:45,528 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:14:45,528 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:14:45,603 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:14:47,614 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:14:47,615 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:14:49,799 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:14:49,801 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:14:51,219 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:14:52,698 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:14:52,700 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:14:53,855 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:14:53,857 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:14:54,962 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:14:54,963 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:14:57,132 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:14:57,133 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:14:57,133 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:14:57,133 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:14:57,133 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:14:58,271 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:14:58,272 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:14:58,391 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:15:03,396 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:15:03,397 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:15:05,550 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:15:05,551 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:15:10,689 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:15:10,690 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:15:12,854 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:15:17,859 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:15:17,860 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_171517.mp4
2025-03-19 17:15:17,860 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:15:17,860 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:15:23,167 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:15:23,169 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:15:23,199 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:15:24,334 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_171517.mp4
2025-03-19 17:15:24,335 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_171517.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:15:26,344 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:15:29,348 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:15:29,349 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:15:32,354 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:15:32,355 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:15:32,355 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:15:33,507 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:15:33,508 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:15:33,508 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:15:33,508 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:15:33,605 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:15:35,608 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:15:35,609 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:15:35,609 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:15:37,901 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:15:37,901 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:15:46,066 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:15:46,067 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:15:46,067 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:15:46,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:46,505 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:15:46,506 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:46,758 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:15:46,759 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:47,125 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:15:47,126 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:47,388 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:15:47,403 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:47,725 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:15:47,725 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:48,049 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:15:48,050 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:48,299 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:15:48,299 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:48,643 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:15:48,644 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:48,915 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:15:48,916 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:15:51,192 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:15:51,192 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:15:51,192 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:15:51,320 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{83fdb9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t690}
    * Task{1b2715f #690 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:15:51,321 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:15:51,321 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:15:51,321 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:15:51,322 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_171551_20250319_171551.png
2025-03-19 17:15:52,592 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_171551_20250319_171551.png
2025-03-19 17:15:52,593 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_171551_20250319_171551.png
2025-03-19 17:15:52,593 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:15:59,528 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:15:59,878 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_162.jpg
2025-03-19 17:15:59,886 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_162.jpg
2025-03-19 17:15:59,886 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:15:59,886 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:15:59,886 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:16:10,039 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:16:10,041 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:16:10,042 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:16:10,175 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{83fdb9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t690}
    * Task{1b2715f #690 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:16:10,176 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:16:10,176 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:16:10,176 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:16:10,176 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_171610_20250319_171610.png
2025-03-19 17:16:11,388 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_171610_20250319_171610.png
2025-03-19 17:16:11,388 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_171610_20250319_171610.png
2025-03-19 17:16:11,389 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:16:15,805 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_162.jpg
2025-03-19 17:16:15,811 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_162.jpg
2025-03-19 17:16:15,811 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:16:15,812 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:16:15,812 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:16:15,812 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:16:17,956 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:16:17,957 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:16:17,957 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:16:17,957 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:16:18,960 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:16:19,965 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:16:19,966 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:16:19,966 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 109.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:16:19,966 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:16:29,972 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_171517.mp4 (大小: 3.83MB)
2025-03-19 17:16:29,972 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:16:30,088 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.934756秒，无需修复
2025-03-19 17:16:30,088 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:16:30,088 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_171517.mp4
2025-03-19 17:16:30,088 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:16:38,138 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_163.mp4
2025-03-19 17:16:38,141 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_163.mp4
2025-03-19 17:16:38,141 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:16:38,141 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:16:43,368 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:16:43,370 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_163.mp4
2025-03-19 17:16:43,370 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:16:43,370 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:16:43,370 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:16:43,753 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:16:44,756 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:16:44,756 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:16:44,756 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:16:45,856 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:16:45,856 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:16:45,857 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:16:47,953 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:16:47,954 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:16:49,122 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:16:49,122 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:16:49,123 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:16:50,254 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:16:50,255 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:16:50,255 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:16:50,256 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:14:30\n- 结束时间: 2025-03-19 17:16:50\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_162.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_162.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_163.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:16:50"}]}]}}
2025-03-19 17:16:50,741 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:16:50,745 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:21:50,781 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:21:50,783 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:21:50,783 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:21:50,783 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:21:50,905 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:21:51,070 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:21:51,070 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:21:51,070 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:21:51,070 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:21:51,315 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:21:51,315 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:21:51,316 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:21:51,316 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:21:52,798 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:21:52,799 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:21:54,089 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:21:54,089 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:21:54,089 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:21:54,089 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:21:54,089 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:21:54,235 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:21:54,235 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:21:54,235 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:21:54,235 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:21:55,628 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:21:55,629 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:21:56,914 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:21:56,915 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:21:56,915 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:21:56,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:21:56,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:21:58,012 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:21:58,012 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:21:58,125 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:22:00,130 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:22:00,130 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:22:01,223 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:22:01,224 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:22:01,224 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:22:01,225 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:22:01,303 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:22:03,315 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:22:03,316 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:22:05,516 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:22:05,517 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:22:07,602 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:22:07,603 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:22:08,704 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:22:08,705 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:22:08,705 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:22:08,705 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:22:08,777 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:22:10,785 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:22:10,786 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:22:12,952 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:22:12,953 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:22:14,362 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:22:15,838 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:22:15,839 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:22:16,996 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:22:16,997 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:22:18,106 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:22:18,107 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:22:20,287 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:22:20,289 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:22:20,289 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:22:20,289 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:22:20,289 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:22:21,434 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:22:21,435 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:22:21,548 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:22:26,552 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:22:26,553 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:22:28,706 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:22:28,708 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:22:33,847 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:22:33,849 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:22:36,005 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:22:41,011 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:22:41,012 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_172241.mp4
2025-03-19 17:22:41,013 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:22:41,013 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:22:46,264 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:22:46,265 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:22:46,309 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:22:47,500 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_172241.mp4
2025-03-19 17:22:47,502 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_172241.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:22:49,513 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:22:52,525 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:22:52,525 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:22:55,535 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:22:55,535 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:22:55,535 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:22:56,728 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:22:56,728 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:22:56,729 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:22:56,729 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:22:56,831 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:22:58,841 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:22:58,842 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:22:58,842 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:23:01,094 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:23:01,095 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:23:09,321 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:23:09,322 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:23:09,322 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:23:09,322 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:09,649 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:23:09,649 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:09,900 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:23:09,900 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:10,144 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:23:10,145 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:10,368 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:23:10,368 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:10,602 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:23:10,602 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:10,836 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:23:10,836 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:11,076 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:23:11,077 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:11,309 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:23:11,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:11,587 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:23:11,588 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:23:13,862 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:23:13,863 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:23:13,863 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:23:13,984 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a946776 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t696}
    * Task{a578502 #696 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:23:13,985 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:23:13,985 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:23:13,985 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:23:13,985 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_172313_20250319_172313.png
2025-03-19 17:23:15,756 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_172313_20250319_172313.png
2025-03-19 17:23:15,758 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_172313_20250319_172313.png
2025-03-19 17:23:15,759 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:23:22,673 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:23:22,859 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_164.jpg
2025-03-19 17:23:22,865 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_164.jpg
2025-03-19 17:23:22,865 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:23:22,865 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:23:22,866 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:23:33,012 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:23:33,013 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:23:33,014 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:23:33,135 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a946776 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t696}
    * Task{a578502 #696 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:23:33,136 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:23:33,136 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:23:33,136 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:23:33,136 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_172333_20250319_172333.png
2025-03-19 17:23:34,809 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_172333_20250319_172333.png
2025-03-19 17:23:34,810 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_172333_20250319_172333.png
2025-03-19 17:23:34,810 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:23:39,434 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_164.jpg
2025-03-19 17:23:39,444 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_164.jpg
2025-03-19 17:23:39,445 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:23:39,445 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:23:39,445 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:23:39,445 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:23:41,576 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:23:41,577 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:23:41,578 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:23:41,578 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:23:42,581 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:23:43,586 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:23:43,586 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:23:43,586 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 125.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:23:43,587 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:23:53,593 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_172241.mp4 (大小: 3.58MB)
2025-03-19 17:23:53,595 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:23:53,746 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.168856秒，无需修复
2025-03-19 17:23:53,746 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:23:53,746 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_172241.mp4
2025-03-19 17:23:53,746 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:24:00,809 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_165.mp4
2025-03-19 17:24:00,816 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_165.mp4
2025-03-19 17:24:00,816 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:24:00,816 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:24:06,073 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:24:06,080 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_165.mp4
2025-03-19 17:24:06,080 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:24:06,081 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:24:06,081 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:24:06,467 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:24:07,470 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:24:07,471 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:24:07,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:24:08,578 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:24:08,579 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:24:08,579 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:24:10,680 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:24:10,681 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:24:11,852 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:24:11,853 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:24:11,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:24:12,990 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:24:12,991 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:24:12,991 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:24:12,992 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:21:54\n- 结束时间: 2025-03-19 17:24:12\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_164.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_164.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_165.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:24:12"}]}]}}
2025-03-19 17:24:13,445 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:24:13,446 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:29:13,493 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:29:13,495 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:29:13,495 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:29:13,496 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:29:13,627 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:29:13,788 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:29:13,788 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:29:13,788 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:29:13,789 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:29:14,037 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:29:14,038 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:29:14,038 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:29:14,038 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:29:15,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:29:15,510 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:29:16,778 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:29:16,778 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:29:16,778 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:29:16,778 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:29:16,778 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:29:16,907 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:29:16,908 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:29:16,908 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:29:16,908 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:29:18,306 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:29:18,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:29:19,560 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:29:19,560 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:29:19,560 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:29:19,560 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:29:19,560 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:29:20,656 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:29:20,657 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:29:20,782 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:29:22,783 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:29:22,784 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:29:23,871 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:29:23,872 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:29:23,872 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:29:23,872 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:29:23,944 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:29:25,955 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:29:25,955 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:29:28,137 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:29:28,138 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:29:30,211 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:29:30,212 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:29:31,321 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:29:31,322 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:29:31,322 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:29:31,323 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:29:31,397 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:29:33,406 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:29:33,408 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:29:35,563 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:29:35,564 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:29:36,968 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:29:38,445 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:29:38,446 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:29:39,611 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:29:39,611 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:29:40,699 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:29:40,700 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:29:42,944 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:29:42,944 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:29:42,944 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:29:42,944 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:29:42,944 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:29:44,123 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:29:44,124 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:29:44,285 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:29:49,294 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:29:49,300 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:29:51,503 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:29:51,503 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:29:56,702 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:29:56,703 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:29:58,867 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:30:03,873 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:30:03,878 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_173003.mp4
2025-03-19 17:30:03,878 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:30:03,879 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:30:09,161 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:30:09,162 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:30:09,197 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:30:10,384 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173003.mp4
2025-03-19 17:30:10,385 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173003.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:30:12,396 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:30:15,403 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:30:15,404 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:30:18,406 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:30:18,406 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:30:18,406 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:30:19,587 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:30:19,588 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:30:19,588 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:30:19,589 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:30:19,690 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:30:21,699 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:30:21,700 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:30:21,701 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:30:23,968 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:30:23,968 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:30:32,108 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:30:32,111 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:30:32,111 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:30:32,111 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:32,367 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:30:32,367 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:32,632 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:30:32,633 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:32,884 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:30:32,884 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:33,098 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:30:33,099 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:33,323 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:30:33,324 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:33,547 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:30:33,548 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:33,795 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:30:33,796 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:34,023 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:30:34,024 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:34,238 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:30:34,238 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:30:36,500 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:30:36,501 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:30:36,501 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:30:36,635 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{322962a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t702}
    * Task{5f4f1b8 #702 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:30:36,636 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:30:36,636 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:30:36,636 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:30:36,637 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_173036_20250319_173036.png
2025-03-19 17:30:38,284 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_173036_20250319_173036.png
2025-03-19 17:30:38,286 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_173036_20250319_173036.png
2025-03-19 17:30:38,286 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:30:45,504 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:30:48,171 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_166.jpg
2025-03-19 17:30:48,177 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_166.jpg
2025-03-19 17:30:48,178 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:30:48,178 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:30:48,178 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:30:58,372 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:30:58,374 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:30:58,374 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:30:58,490 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{322962a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t702}
    * Task{5f4f1b8 #702 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:30:58,490 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:30:58,491 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:30:58,491 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:30:58,491 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_173058_20250319_173058.png
2025-03-19 17:31:00,179 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_173058_20250319_173058.png
2025-03-19 17:31:00,179 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_173058_20250319_173058.png
2025-03-19 17:31:00,179 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:31:05,605 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_166.jpg
2025-03-19 17:31:05,607 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_166.jpg
2025-03-19 17:31:05,607 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:31:05,608 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:31:05,608 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:31:05,608 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:31:07,778 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:31:07,780 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:31:07,781 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:31:07,782 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:31:08,787 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:31:09,792 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:31:09,792 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:31:09,792 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 130.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:31:09,792 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:31:19,798 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173003.mp4 (大小: 3.27MB)
2025-03-19 17:31:19,801 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:31:19,945 - QuickAppADBTester - INFO - 录制文件完整，时长: 56.555344秒，无需修复
2025-03-19 17:31:19,945 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:31:19,945 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173003.mp4
2025-03-19 17:31:19,945 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:31:26,983 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_167.mp4
2025-03-19 17:31:26,991 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_167.mp4
2025-03-19 17:31:26,991 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:31:26,991 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:31:32,240 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:31:32,241 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_167.mp4
2025-03-19 17:31:32,241 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:31:32,242 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:31:32,242 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:31:32,694 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:31:33,697 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:31:33,698 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:31:33,698 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:31:34,794 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:31:34,795 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:31:34,795 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:31:36,874 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:31:36,875 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:31:38,005 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:31:38,006 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:31:38,006 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:31:39,139 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:31:39,140 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:31:39,141 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:31:39,141 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:29:16\n- 结束时间: 2025-03-19 17:31:39\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_166.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_166.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_167.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:31:39"}]}]}}
2025-03-19 17:31:39,551 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:31:39,554 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:36:39,586 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:36:39,590 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:36:39,590 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:36:39,590 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:36:39,713 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:36:39,842 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:36:39,842 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:36:39,843 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:36:39,843 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:36:40,067 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:36:40,068 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:36:40,068 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:36:40,068 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:36:41,551 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:36:41,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:36:42,812 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:36:42,813 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:36:42,813 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:36:42,813 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:36:42,813 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:36:42,962 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:36:42,962 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:36:42,962 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:36:42,963 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:36:44,368 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:36:44,369 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:36:45,618 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:36:45,618 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:36:45,619 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:36:45,619 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:36:45,619 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:36:46,719 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:36:46,721 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:36:46,830 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:36:48,836 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:36:48,836 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:36:49,924 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:36:49,925 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:36:49,926 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:36:49,926 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:36:50,003 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:36:52,013 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:36:52,014 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:36:54,185 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:36:54,186 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:36:56,275 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:36:56,276 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:36:57,369 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:36:57,369 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:36:57,369 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:36:57,369 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:36:57,444 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:36:59,452 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:36:59,453 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:37:01,584 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:37:01,585 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:37:03,008 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:37:04,485 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:37:04,485 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:37:05,629 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:37:05,630 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:37:06,735 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:37:06,736 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:37:08,908 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:37:08,909 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:37:08,909 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:37:08,910 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:37:08,910 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:37:10,056 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:37:10,057 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:37:10,171 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:37:15,175 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:37:15,176 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:37:17,323 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:37:17,324 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:37:22,460 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:37:22,462 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:37:24,616 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:37:29,620 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:37:29,621 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_173729.mp4
2025-03-19 17:37:29,621 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:37:29,621 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:37:34,867 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:37:34,867 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:37:34,885 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:37:36,075 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173729.mp4
2025-03-19 17:37:36,076 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173729.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:37:38,082 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:37:41,088 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:37:41,089 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:37:44,090 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:37:44,091 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:37:44,091 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:37:45,304 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:37:45,305 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:37:45,306 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:37:45,306 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:37:45,413 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:37:47,416 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:37:47,416 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:37:47,416 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:37:49,682 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:37:49,684 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:37:57,874 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:37:57,875 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:37:57,875 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:37:57,875 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:58,197 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:37:58,198 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:58,496 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:37:58,497 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:58,737 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:37:58,738 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:58,977 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:37:58,978 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:59,203 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:37:59,204 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:59,454 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:37:59,455 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:59,673 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:37:59,674 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:37:59,914 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:37:59,914 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:38:00,166 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:38:00,166 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:38:02,430 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:38:02,431 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:38:02,431 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:38:02,567 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a7a4bc0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t708}
    * Task{bdcb69f #708 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:38:02,568 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:38:02,568 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:38:02,568 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:38:02,568 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_173802_20250319_173802.png
2025-03-19 17:38:04,203 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_173802_20250319_173802.png
2025-03-19 17:38:04,203 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_173802_20250319_173802.png
2025-03-19 17:38:04,203 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:38:11,200 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:38:11,523 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_168.jpg
2025-03-19 17:38:11,528 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_168.jpg
2025-03-19 17:38:11,528 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:38:11,528 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:38:11,528 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:38:21,696 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:38:21,697 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:38:21,697 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:38:21,829 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a7a4bc0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t708}
    * Task{bdcb69f #708 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:38:21,829 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:38:21,830 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:38:21,830 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:38:21,830 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_173821_20250319_173821.png
2025-03-19 17:38:23,388 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_173821_20250319_173821.png
2025-03-19 17:38:23,389 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_173821_20250319_173821.png
2025-03-19 17:38:23,389 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:38:29,594 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_169.jpg
2025-03-19 17:38:29,603 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_169.jpg
2025-03-19 17:38:29,603 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:38:29,603 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:38:29,603 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:38:29,603 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:38:31,763 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:38:31,764 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:38:31,764 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:38:31,765 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:38:32,768 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:38:33,773 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:38:33,773 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:38:33,774 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 119.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:38:33,774 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:38:43,783 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173729.mp4 (大小: 3.37MB)
2025-03-19 17:38:43,783 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:38:43,929 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.712689秒，无需修复
2025-03-19 17:38:43,929 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:38:43,929 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_173729.mp4
2025-03-19 17:38:43,930 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:38:50,768 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_170.mp4
2025-03-19 17:38:50,775 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_170.mp4
2025-03-19 17:38:50,775 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:38:50,775 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:38:56,022 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:38:56,024 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_170.mp4
2025-03-19 17:38:56,025 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:38:56,025 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:38:56,025 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:38:56,469 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:38:57,471 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:38:57,472 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:38:57,472 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:38:58,583 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:38:58,584 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:38:58,584 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:39:00,690 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:39:00,691 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:39:01,870 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:39:01,871 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:39:01,871 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:39:03,010 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:39:03,012 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:39:03,012 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:39:03,013 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:36:42\n- 结束时间: 2025-03-19 17:39:03\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_168.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_169.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_170.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:39:03"}]}]}}
2025-03-19 17:39:03,417 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:39:03,420 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:44:03,762 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:44:03,764 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:44:03,764 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:44:03,764 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:44:03,911 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:44:04,077 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:44:04,077 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:44:04,077 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:44:04,078 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:44:04,333 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:44:04,334 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:44:04,334 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:44:04,334 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:44:05,821 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:44:05,821 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:44:07,092 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:44:07,092 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:44:07,092 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:44:07,092 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:44:07,092 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:44:07,252 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:44:07,253 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:44:07,253 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:44:07,253 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:44:08,652 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:44:08,653 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:44:09,907 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:44:09,908 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:44:09,908 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:44:09,908 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:44:09,908 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:44:11,006 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:44:11,007 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:44:11,126 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:44:13,129 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:44:13,130 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:44:14,219 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:44:14,220 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:44:14,220 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:44:14,220 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:44:14,295 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:44:16,306 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:44:16,306 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:44:18,507 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:44:18,509 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:44:20,592 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:44:20,593 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:44:21,693 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:44:21,694 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:44:21,694 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:44:21,694 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:44:21,784 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:44:23,795 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:44:23,795 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:44:25,957 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:44:25,958 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:44:27,386 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:44:28,860 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:44:28,860 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:44:30,037 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:44:30,038 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:44:31,148 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:44:31,149 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:44:33,342 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:44:33,343 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:44:33,344 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:44:33,344 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:44:33,344 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:44:34,497 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:44:34,498 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:44:34,600 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:44:39,605 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:44:39,607 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:44:41,778 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:44:41,779 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:44:46,917 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:44:46,917 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:44:49,060 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:44:54,066 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:44:54,066 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_174454.mp4
2025-03-19 17:44:54,066 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:44:54,067 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:44:59,323 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:44:59,324 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:44:59,367 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:45:00,559 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_174454.mp4
2025-03-19 17:45:00,560 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_174454.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:45:02,567 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:45:05,572 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:45:05,574 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:45:08,578 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:45:08,580 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:45:08,581 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:45:09,782 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:45:09,782 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:45:09,783 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:45:09,783 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:45:09,888 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:45:11,893 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:45:11,894 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:45:11,894 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:45:14,165 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:45:14,165 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:45:22,361 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:45:22,361 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:45:22,361 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:45:22,361 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:22,658 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:45:22,659 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:22,951 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:45:22,951 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:23,171 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:45:23,172 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:23,435 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:45:23,436 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:23,672 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:45:23,673 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:23,899 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:45:23,900 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:24,157 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:45:24,158 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:24,416 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:45:24,417 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:24,677 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:45:24,678 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:45:26,914 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:45:26,914 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:45:26,915 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:45:27,057 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{302c0d8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t714}
    * Task{c4f1284 #714 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:45:27,057 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:45:27,058 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:45:27,058 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:45:27,058 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_174527_20250319_174527.png
2025-03-19 17:45:28,662 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_174527_20250319_174527.png
2025-03-19 17:45:28,662 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_174527_20250319_174527.png
2025-03-19 17:45:28,662 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:45:35,689 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:45:36,073 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_171.jpg
2025-03-19 17:45:36,077 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_171.jpg
2025-03-19 17:45:36,077 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:45:36,077 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:45:36,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:45:46,260 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:45:46,262 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:45:46,262 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:45:46,382 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{302c0d8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t714}
    * Task{c4f1284 #714 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:45:46,383 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:45:46,383 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:45:46,383 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:45:46,383 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_174546_20250319_174546.png
2025-03-19 17:45:47,959 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_174546_20250319_174546.png
2025-03-19 17:45:47,959 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_174546_20250319_174546.png
2025-03-19 17:45:47,960 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:45:52,580 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_171.jpg
2025-03-19 17:45:52,585 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_171.jpg
2025-03-19 17:45:52,585 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:45:52,585 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:45:52,586 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:45:52,586 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:45:54,737 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:45:54,738 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:45:54,738 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:45:54,738 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:45:55,739 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:45:56,741 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:45:56,742 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:45:56,742 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:45:56,742 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:46:06,747 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_174454.mp4 (大小: 3.62MB)
2025-03-19 17:46:06,747 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:46:06,900 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.250622秒，无需修复
2025-03-19 17:46:06,900 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:46:06,900 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_174454.mp4
2025-03-19 17:46:06,900 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:46:14,049 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_172.mp4
2025-03-19 17:46:14,053 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_172.mp4
2025-03-19 17:46:14,053 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:46:14,053 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:46:19,303 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:46:19,305 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_172.mp4
2025-03-19 17:46:19,305 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:46:19,305 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:46:19,305 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:46:19,668 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:46:20,669 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:46:20,670 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:46:20,670 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:46:21,773 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:46:21,774 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:46:21,774 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:46:23,870 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:46:23,871 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:46:25,033 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:46:25,034 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:46:25,034 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:46:26,155 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:46:26,157 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:46:26,157 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:46:26,158 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:44:07\n- 结束时间: 2025-03-19 17:46:26\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_171.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_171.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_172.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:46:26"}]}]}}
2025-03-19 17:46:26,589 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:46:26,592 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:51:27,581 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:51:27,586 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:51:27,587 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:51:27,587 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:51:27,713 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:51:27,874 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:51:27,874 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:51:27,874 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:51:27,874 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:51:28,091 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:51:28,091 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:51:28,092 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:51:28,092 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:51:29,551 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:51:29,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:51:30,809 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:51:30,810 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:51:30,811 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:51:30,811 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:51:30,811 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:51:30,960 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:51:30,960 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:51:30,961 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:51:30,961 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:51:32,375 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:51:32,376 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:51:33,649 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:51:33,650 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:51:33,650 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:51:33,650 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:51:33,650 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:51:34,748 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:51:34,749 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:51:34,845 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:51:36,847 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:51:36,848 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:51:37,928 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:51:37,930 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:51:37,930 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:51:37,930 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:51:38,001 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:51:40,010 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:51:40,010 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:51:42,177 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:51:42,177 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:51:44,265 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:51:44,266 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:51:45,366 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:51:45,367 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:51:45,367 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:51:45,367 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:51:45,441 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:51:47,451 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:51:47,453 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:51:49,619 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:51:49,620 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:51:51,038 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:51:52,461 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:51:52,462 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:51:53,638 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:51:53,639 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:51:54,751 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:51:54,751 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:51:56,926 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:51:56,927 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:51:56,927 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:51:56,927 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:51:56,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:51:58,090 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:51:58,091 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:51:58,205 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:52:03,208 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:52:03,209 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:52:05,371 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:52:05,373 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:52:10,506 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:52:10,507 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:52:12,658 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:52:17,664 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:52:17,665 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_175217.mp4
2025-03-19 17:52:17,665 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:52:17,665 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:52:22,932 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:52:22,934 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:52:22,976 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:52:24,168 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175217.mp4
2025-03-19 17:52:24,170 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175217.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:52:26,180 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:52:29,185 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:52:29,186 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:52:32,191 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:52:32,191 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:52:32,191 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:52:33,373 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:52:33,374 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:52:33,374 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:52:33,374 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:52:33,463 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:52:35,465 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 17:52:35,466 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 17:52:35,466 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 17:52:37,790 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 17:52:37,791 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 17:52:45,974 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 17:52:45,975 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 17:52:45,975 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 17:52:45,976 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:46,236 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 17:52:46,236 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:46,473 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 17:52:46,474 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:46,722 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 17:52:46,722 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:46,951 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 17:52:46,951 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:47,155 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 17:52:47,156 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:47,427 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 17:52:47,428 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:47,672 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 17:52:47,673 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:47,914 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 17:52:47,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:48,175 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 17:52:48,175 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 17:52:50,417 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 17:52:50,418 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:52:50,418 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:52:50,582 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{dd9ae80 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t720}
    * Task{292885f #720 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:52:50,582 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:52:50,582 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 17:52:50,582 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 17:52:50,582 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_175250_20250319_175250.png
2025-03-19 17:52:52,198 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_175250_20250319_175250.png
2025-03-19 17:52:52,199 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_175250_20250319_175250.png
2025-03-19 17:52:52,199 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:52:59,126 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_173.jpg
2025-03-19 17:52:59,131 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_173.jpg
2025-03-19 17:52:59,131 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 17:52:59,131 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:52:59,131 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:52:59,277 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 17:53:09,237 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 17:53:09,240 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 17:53:09,241 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 17:53:09,362 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{dd9ae80 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t720}
    * Task{292885f #720 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 17:53:09,362 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 17:53:09,362 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 17:53:09,362 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 17:53:09,363 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_175309_20250319_175309.png
2025-03-19 17:53:10,944 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_175309_20250319_175309.png
2025-03-19 17:53:10,944 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_175309_20250319_175309.png
2025-03-19 17:53:10,945 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 17:53:15,433 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_173.jpg
2025-03-19 17:53:15,438 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_173.jpg
2025-03-19 17:53:15,439 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 17:53:15,439 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 17:53:15,439 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:53:15,439 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:53:17,616 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 17:53:17,617 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 17:53:17,617 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 17:53:17,618 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 17:53:18,620 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 17:53:19,623 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 17:53:19,623 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 17:53:19,623 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 17:53:19,623 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 17:53:29,629 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175217.mp4 (大小: 3.37MB)
2025-03-19 17:53:29,630 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 17:53:29,749 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.603044秒，无需修复
2025-03-19 17:53:29,749 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 17:53:29,749 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175217.mp4
2025-03-19 17:53:29,750 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 17:53:39,221 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_174.mp4
2025-03-19 17:53:39,229 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_174.mp4
2025-03-19 17:53:39,229 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:53:39,229 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:53:44,504 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:53:44,507 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_174.mp4
2025-03-19 17:53:44,507 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 17:53:44,507 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 17:53:44,507 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 17:53:44,918 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 17:53:45,922 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 17:53:45,922 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:53:45,922 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:53:47,032 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 17:53:47,033 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 17:53:47,033 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 17:53:49,136 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 17:53:49,137 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 17:53:50,290 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 17:53:50,290 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:53:50,290 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:53:51,403 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 17:53:51,404 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 17:53:51,405 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 17:53:51,406 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:51:30\n- 结束时间: 2025-03-19 17:53:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_173.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_173.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_174.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 17:53:51"}]}]}}
2025-03-19 17:53:52,027 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 17:53:52,030 - QuickAppADBTester - INFO - 测试完成
2025-03-19 17:58:52,063 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 17:58:52,067 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 17:58:52,068 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 17:58:52,068 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 17:58:52,203 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 17:58:52,339 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 17:58:52,340 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 17:58:52,340 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:58:52,340 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:58:52,561 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:58:52,561 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:58:52,561 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:58:52,561 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:58:54,021 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:58:54,022 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:58:55,322 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:58:55,322 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 17:58:55,322 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 17:58:55,322 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 17:58:55,322 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 17:58:55,476 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 17:58:55,476 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 17:58:55,476 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 17:58:55,476 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 17:58:56,878 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:58:56,878 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:58:58,129 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 17:58:58,129 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 17:58:58,129 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:58:58,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:58:58,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:58:59,219 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 17:58:59,220 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 17:58:59,339 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 17:59:01,345 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 17:59:01,345 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 17:59:02,445 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 17:59:02,446 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 17:59:02,447 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:59:02,447 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 17:59:02,540 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:59:04,547 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 17:59:04,548 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 17:59:06,684 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 17:59:06,685 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 17:59:08,763 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 17:59:08,764 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 17:59:09,868 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 17:59:09,869 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 17:59:09,869 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:59:09,869 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 17:59:09,942 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 17:59:11,951 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 17:59:11,951 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 17:59:14,142 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 17:59:14,143 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 17:59:15,565 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 17:59:17,042 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 17:59:17,043 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 17:59:18,228 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 17:59:18,229 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 17:59:19,331 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 17:59:19,332 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 17:59:21,529 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 17:59:21,530 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 17:59:21,530 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 17:59:21,530 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 17:59:21,530 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 17:59:22,694 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 17:59:22,695 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 17:59:22,823 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 17:59:27,826 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 17:59:27,827 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 17:59:29,983 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 17:59:29,984 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 17:59:35,145 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 17:59:35,146 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 17:59:37,296 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 17:59:42,300 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 17:59:42,302 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_175942.mp4
2025-03-19 17:59:42,302 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 17:59:42,302 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 17:59:47,568 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 17:59:47,570 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 17:59:47,619 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 17:59:48,810 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175942.mp4
2025-03-19 17:59:48,811 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175942.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 17:59:50,823 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 17:59:53,826 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 17:59:53,827 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 17:59:56,832 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 17:59:56,833 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 17:59:56,833 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 17:59:58,025 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 17:59:58,026 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 17:59:58,026 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 17:59:58,026 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 17:59:58,124 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:00:00,131 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:00:00,132 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:00:00,132 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:00:02,383 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:00:02,383 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:00:10,594 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:00:10,597 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:00:10,597 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:00:10,597 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:10,918 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:00:10,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:11,143 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:00:11,143 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:11,349 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:00:11,350 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:11,566 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:00:11,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:11,810 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:00:11,811 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:12,053 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:00:12,056 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:12,301 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:00:12,301 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:12,556 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:00:12,557 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:12,826 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:00:12,827 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:00:15,129 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:00:15,129 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:00:15,129 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:00:15,242 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8591ae6 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t726}
    * Task{13147d #726 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:00:15,242 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:00:15,242 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:00:15,242 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:00:15,242 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_180015_20250319_180015.png
2025-03-19 18:00:17,423 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_180015_20250319_180015.png
2025-03-19 18:00:17,424 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_180015_20250319_180015.png
2025-03-19 18:00:17,425 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:00:23,964 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 18:00:25,084 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_175.jpg
2025-03-19 18:00:25,089 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_175.jpg
2025-03-19 18:00:25,089 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 18:00:25,089 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:00:25,089 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:00:35,303 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 18:00:35,304 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:00:35,304 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:00:35,405 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8591ae6 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t726}
    * Task{13147d #726 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:00:35,407 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:00:35,407 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 18:00:35,407 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 18:00:35,407 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_180035_20250319_180035.png
2025-03-19 18:00:37,603 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_180035_20250319_180035.png
2025-03-19 18:00:37,604 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_180035_20250319_180035.png
2025-03-19 18:00:37,605 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:00:42,382 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_175.jpg
2025-03-19 18:00:42,390 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_175.jpg
2025-03-19 18:00:42,390 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 18:00:42,391 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 18:00:42,391 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:00:42,391 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:00:44,498 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:00:44,500 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:00:44,500 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:00:44,500 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:00:45,504 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 18:00:46,507 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 18:00:46,507 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:00:46,508 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 115.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 18:00:46,508 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:00:56,512 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175942.mp4 (大小: 4.49MB)
2025-03-19 18:00:56,513 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:00:56,686 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.840322秒，无需修复
2025-03-19 18:00:56,686 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:00:56,686 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_175942.mp4
2025-03-19 18:00:56,686 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:01:03,808 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_176.mp4
2025-03-19 18:01:03,814 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_176.mp4
2025-03-19 18:01:03,814 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:01:03,815 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:01:09,070 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:01:09,071 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_176.mp4
2025-03-19 18:01:09,071 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 18:01:09,071 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 18:01:09,071 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 18:01:09,480 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 18:01:10,486 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 18:01:10,486 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:01:10,486 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:01:11,586 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 18:01:11,587 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 18:01:11,587 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 18:01:13,687 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 18:01:13,688 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 18:01:14,860 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 18:01:14,861 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:01:14,861 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:01:16,014 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 18:01:16,014 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 18:01:16,015 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 18:01:16,015 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 17:58:55\n- 结束时间: 2025-03-19 18:01:16\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_175.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_175.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_176.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:01:16"}]}]}}
2025-03-19 18:01:16,533 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 18:01:16,536 - QuickAppADBTester - INFO - 测试完成
2025-03-19 18:06:16,580 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 18:06:16,583 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 18:06:16,584 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 18:06:16,584 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 18:06:16,722 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 18:06:16,857 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 18:06:16,857 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 18:06:16,858 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:06:16,858 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:06:17,020 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:06:17,020 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:06:17,020 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:06:17,020 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:06:18,482 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:06:18,482 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:06:19,755 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:06:19,755 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 18:06:19,755 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 18:06:19,755 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:06:19,756 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:06:19,901 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:06:19,901 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:06:19,901 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:06:19,902 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:06:21,313 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:06:21,313 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:06:22,590 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:06:22,590 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 18:06:22,590 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:06:22,590 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:06:22,591 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:06:23,687 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 18:06:23,688 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 18:06:23,802 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 18:06:25,807 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 18:06:25,808 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 18:06:26,897 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 18:06:26,898 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 18:06:26,898 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:06:26,898 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 18:06:26,977 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:06:28,983 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 18:06:28,984 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 18:06:31,178 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 18:06:31,179 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 18:06:33,265 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 18:06:33,266 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 18:06:34,366 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 18:06:34,368 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 18:06:34,368 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:06:34,368 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 18:06:34,448 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:06:36,451 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 18:06:36,451 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 18:06:38,600 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 18:06:38,601 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 18:06:40,028 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 18:06:41,501 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 18:06:41,502 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 18:06:42,680 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 18:06:42,680 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 18:06:43,792 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 18:06:43,793 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 18:06:45,986 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 18:06:45,987 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 18:06:45,987 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:06:45,987 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:06:45,987 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:06:47,174 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 18:06:47,175 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 18:06:47,299 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 18:06:52,304 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 18:06:52,305 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 18:06:54,460 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 18:06:54,460 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 18:06:59,603 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 18:06:59,605 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 18:07:01,767 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 18:07:06,773 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 18:07:06,774 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_180706.mp4
2025-03-19 18:07:06,775 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:07:06,775 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:07:12,044 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:07:12,045 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 18:07:12,090 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 18:07:13,222 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_180706.mp4
2025-03-19 18:07:13,223 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_180706.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 18:07:15,235 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 18:07:18,241 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 18:07:18,243 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 18:07:21,249 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 18:07:21,250 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 18:07:21,250 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 18:07:22,433 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 18:07:22,434 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 18:07:22,435 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:07:22,435 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 18:07:22,541 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:07:24,551 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:07:24,551 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:07:24,551 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:07:26,866 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:07:26,866 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:07:35,082 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:07:35,083 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:07:35,083 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:07:35,083 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:35,398 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:07:35,399 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:35,634 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:07:35,634 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:35,849 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:07:35,849 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:36,105 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:07:36,106 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:36,449 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:07:36,450 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:36,683 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:07:36,683 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:36,933 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:07:36,934 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:37,154 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:07:37,155 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:37,403 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:07:37,404 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:07:39,638 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:07:39,638 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:07:39,639 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:07:39,801 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f90197e u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t732}
    * Task{d24b5f5 #732 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:07:39,802 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:07:39,802 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:07:39,802 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:07:39,802 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_180739_20250319_180739.png
2025-03-19 18:07:41,689 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_180739_20250319_180739.png
2025-03-19 18:07:41,690 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_180739_20250319_180739.png
2025-03-19 18:07:41,690 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:07:48,342 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 18:07:49,431 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_177.jpg
2025-03-19 18:07:49,437 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_177.jpg
2025-03-19 18:07:49,437 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 18:07:49,437 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:07:49,438 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:07:59,575 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 18:07:59,576 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:07:59,576 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:07:59,678 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f90197e u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t732}
    * Task{d24b5f5 #732 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:07:59,678 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:07:59,679 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 18:07:59,679 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 18:07:59,679 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_180759_20250319_180759.png
2025-03-19 18:08:01,592 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_180759_20250319_180759.png
2025-03-19 18:08:01,593 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_180759_20250319_180759.png
2025-03-19 18:08:01,593 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:08:08,571 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_178.jpg
2025-03-19 18:08:08,579 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_178.jpg
2025-03-19 18:08:08,579 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 18:08:08,580 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 18:08:08,580 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:08:08,580 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:08:10,697 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:08:10,697 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:08:10,698 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:08:10,698 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:08:11,698 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 18:08:12,702 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 18:08:12,702 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:08:12,702 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 18:08:12,702 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:08:22,708 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_180706.mp4 (大小: 4.19MB)
2025-03-19 18:08:22,710 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:08:22,829 - QuickAppADBTester - INFO - 录制文件完整，时长: 56.580100秒，无需修复
2025-03-19 18:08:22,829 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:08:22,829 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_180706.mp4
2025-03-19 18:08:22,829 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:08:29,825 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_179.mp4
2025-03-19 18:08:29,830 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_179.mp4
2025-03-19 18:08:29,830 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:08:29,830 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:08:35,084 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:08:35,084 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_179.mp4
2025-03-19 18:08:35,084 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 18:08:35,084 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 18:08:35,084 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 18:08:35,482 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 18:08:36,488 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 18:08:36,489 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:08:36,489 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:08:37,595 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 18:08:37,597 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 18:08:37,597 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 18:08:39,709 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 18:08:39,710 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 18:08:40,864 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 18:08:40,864 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:08:40,865 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:08:42,005 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 18:08:42,006 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 18:08:42,006 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 18:08:42,007 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 18:06:19\n- 结束时间: 2025-03-19 18:08:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_177.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_178.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_179.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:08:42"}]}]}}
2025-03-19 18:08:42,475 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 18:08:42,478 - QuickAppADBTester - INFO - 测试完成
2025-03-19 18:13:43,424 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 18:13:43,427 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 18:13:43,427 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 18:13:43,428 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 18:13:43,562 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 18:13:43,731 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 18:13:43,732 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 18:13:43,732 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:13:43,732 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:13:43,988 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:13:43,989 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:13:43,989 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:13:43,989 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:13:45,468 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:13:45,469 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:13:46,742 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:13:46,742 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 18:13:46,742 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 18:13:46,742 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:13:46,743 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:13:46,886 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:13:46,887 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:13:46,887 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:13:46,887 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:13:48,265 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:13:48,265 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:13:49,507 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:13:49,507 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 18:13:49,507 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:13:49,508 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:13:49,508 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:13:50,600 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 18:13:50,601 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 18:13:50,719 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 18:13:52,722 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 18:13:52,722 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 18:13:53,813 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 18:13:53,814 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 18:13:53,814 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:13:53,814 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 18:13:53,891 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:13:55,902 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 18:13:55,904 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 18:13:58,065 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 18:13:58,066 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 18:14:00,151 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 18:14:00,152 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 18:14:01,242 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 18:14:01,242 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 18:14:01,243 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:14:01,243 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 18:14:01,317 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:14:03,328 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 18:14:03,328 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 18:14:05,495 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 18:14:05,496 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 18:14:06,920 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 18:14:08,388 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 18:14:08,389 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 18:14:09,541 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 18:14:09,542 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 18:14:10,645 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 18:14:10,645 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 18:14:12,836 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 18:14:12,836 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 18:14:12,836 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:14:12,837 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:14:12,837 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:14:14,010 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 18:14:14,011 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 18:14:14,136 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 18:14:19,139 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 18:14:19,141 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 18:14:21,300 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 18:14:21,301 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 18:14:26,433 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 18:14:26,434 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 18:14:28,587 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 18:14:33,592 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 18:14:33,593 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_181433.mp4
2025-03-19 18:14:33,594 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:14:33,594 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:14:38,837 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:14:38,838 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 18:14:38,871 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 18:14:40,051 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_181433.mp4
2025-03-19 18:14:40,051 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_181433.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 18:14:42,056 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 18:14:45,062 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 18:14:45,064 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 18:14:48,068 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 18:14:48,069 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 18:14:48,069 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 18:14:49,247 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 18:14:49,248 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 18:14:49,248 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:14:49,249 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 18:14:49,339 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:14:51,348 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:14:51,349 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:14:51,349 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:14:53,645 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:14:53,646 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:15:01,855 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:15:01,857 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:15:01,858 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:15:01,858 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:02,176 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:15:02,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:02,409 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:15:02,410 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:02,671 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:15:02,671 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:02,945 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:15:02,946 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:03,217 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:15:03,218 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:03,479 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:15:03,480 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:03,733 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:15:03,733 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:03,962 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:15:03,963 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:04,195 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:15:04,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:15:06,467 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:15:06,467 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:15:06,468 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:15:06,568 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7251467 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t738}
    * Task{58238b2 #738 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:15:06,569 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:15:06,569 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:15:06,569 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:15:06,569 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_181506_20250319_181506.png
2025-03-19 18:15:08,369 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_181506_20250319_181506.png
2025-03-19 18:15:08,371 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_181506_20250319_181506.png
2025-03-19 18:15:08,371 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:15:15,171 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 18:15:16,175 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_180.jpg
2025-03-19 18:15:16,180 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_180.jpg
2025-03-19 18:15:16,180 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 18:15:16,180 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:15:16,180 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:15:26,295 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 18:15:26,297 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:15:26,298 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:15:26,437 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7251467 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t738}
    * Task{58238b2 #738 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:15:26,438 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:15:26,438 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 18:15:26,438 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 18:15:26,438 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_181526_20250319_181526.png
2025-03-19 18:15:28,205 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_181526_20250319_181526.png
2025-03-19 18:15:28,205 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_181526_20250319_181526.png
2025-03-19 18:15:28,205 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:15:32,982 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_180.jpg
2025-03-19 18:15:32,989 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_180.jpg
2025-03-19 18:15:32,989 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 18:15:32,989 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 18:15:32,989 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:15:32,990 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:15:35,160 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:15:35,161 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:15:35,161 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:15:35,162 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:15:36,165 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 18:15:37,167 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 18:15:37,168 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:15:37,168 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 119.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 18:15:37,168 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:15:47,171 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_181433.mp4 (大小: 3.62MB)
2025-03-19 18:15:47,172 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:15:47,334 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.322700秒，无需修复
2025-03-19 18:15:47,335 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:15:47,335 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_181433.mp4
2025-03-19 18:15:47,335 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:15:54,836 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_181.mp4
2025-03-19 18:15:54,842 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_181.mp4
2025-03-19 18:15:54,842 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:15:54,842 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:16:00,098 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:16:00,099 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_181.mp4
2025-03-19 18:16:00,099 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 18:16:00,100 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 18:16:00,100 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 18:16:00,569 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 18:16:01,575 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 18:16:01,576 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:16:01,576 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:16:02,681 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 18:16:02,682 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 18:16:02,682 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 18:16:04,783 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 18:16:04,783 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 18:16:05,975 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 18:16:05,976 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:16:05,976 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:16:07,130 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 18:16:07,133 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 18:16:07,133 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 18:16:07,134 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 18:13:46\n- 结束时间: 2025-03-19 18:16:07\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_180.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_180.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_181.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:16:07"}]}]}}
2025-03-19 18:16:07,531 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 18:16:07,534 - QuickAppADBTester - INFO - 测试完成
2025-03-19 18:21:07,571 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 18:21:07,574 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 18:21:07,574 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 18:21:07,575 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 18:21:07,716 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 18:21:07,903 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 18:21:07,904 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 18:21:07,904 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:21:07,904 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:21:08,186 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:21:08,186 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:21:08,186 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:21:08,187 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:21:09,656 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:21:09,657 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:21:10,914 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:21:10,914 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 18:21:10,914 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 18:21:10,914 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:21:10,914 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:21:11,045 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:21:11,045 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:21:11,045 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:21:11,046 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:21:12,445 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:21:12,446 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:21:13,702 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:21:13,702 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 18:21:13,702 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:21:13,702 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:21:13,702 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:21:14,799 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 18:21:14,800 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 18:21:14,912 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 18:21:16,916 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 18:21:16,916 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 18:21:17,982 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 18:21:17,983 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 18:21:17,983 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:21:17,983 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 18:21:18,072 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:21:20,078 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 18:21:20,078 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 18:21:22,243 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 18:21:22,244 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 18:21:24,318 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 18:21:24,319 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 18:21:25,416 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 18:21:25,417 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 18:21:25,417 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:21:25,417 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 18:21:25,492 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:21:27,499 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 18:21:27,499 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 18:21:29,678 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 18:21:29,680 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 18:21:31,110 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 18:21:32,572 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 18:21:32,573 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 18:21:33,737 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 18:21:33,738 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 18:21:34,855 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 18:21:34,856 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 18:21:37,058 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 18:21:37,060 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 18:21:37,061 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:21:37,061 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:21:37,061 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:21:38,206 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 18:21:38,207 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 18:21:38,310 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 18:21:43,314 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 18:21:43,316 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 18:21:45,440 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 18:21:45,441 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 18:21:50,564 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 18:21:50,565 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 18:21:52,710 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 18:21:57,715 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 18:21:57,715 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_182157.mp4
2025-03-19 18:21:57,715 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:21:57,715 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:22:02,958 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:22:02,959 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 18:22:03,001 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 18:22:04,188 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182157.mp4
2025-03-19 18:22:04,189 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182157.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 18:22:06,197 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 18:22:09,203 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 18:22:09,204 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 18:22:12,206 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 18:22:12,206 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 18:22:12,207 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 18:22:13,356 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 18:22:13,357 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 18:22:13,357 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:22:13,358 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 18:22:13,455 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:22:15,464 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:22:15,466 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:22:15,466 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:22:17,723 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:22:17,724 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:22:25,907 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:22:25,909 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:22:25,909 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:22:25,909 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:26,220 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:22:26,220 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:26,456 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:22:26,457 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:26,691 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:22:26,692 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:26,941 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:22:26,941 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:27,189 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:22:27,190 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:27,418 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:22:27,419 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:27,635 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:22:27,636 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:27,889 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:22:27,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:28,127 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:22:28,128 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:22:30,358 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:22:30,359 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:22:30,359 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:22:30,497 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5d38d14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t744}
    * Task{3f59703 #744 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:22:30,498 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:22:30,498 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:22:30,498 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:22:30,498 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_182230_20250319_182230.png
2025-03-19 18:22:31,598 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-19 18:22:31,598 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-19 18:22:31,598 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:22:31,598 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:22:31,598 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:22:31,598 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:22:32,604 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时2秒
2025-03-19 18:22:32,604 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:22:32,605 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.2 MB/s (90640 bytes in 0.001s)

2025-03-19 18:22:32,605 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:22:42,606 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182157.mp4 (大小: 1.32MB)
2025-03-19 18:22:42,608 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:22:42,761 - QuickAppADBTester - INFO - 录制文件完整，时长: 26.587300秒，无需修复
2025-03-19 18:22:42,761 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:22:42,761 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182157.mp4
2025-03-19 18:22:42,761 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:22:50,214 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_182.mp4
2025-03-19 18:22:50,223 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_182.mp4
2025-03-19 18:22:50,224 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:22:50,224 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:22:55,522 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:22:55,523 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_182.mp4
2025-03-19 18:22:55,523 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-19 18:22:55,523 - QuickAppADBTester - INFO - 脚本已终止
2025-03-19 18:22:55,524 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_182.mp4
2025-03-19 18:22:55,524 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 18:22:55,524 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-19 18:21:10\n- 中断时间: 2025-03-19 18:22:55\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_182.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:22:55"}]}]}}
2025-03-19 18:22:56,006 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-19 18:22:56,009 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-19 18:23:20,645 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-19 18:23:20,646 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 18:23:20,646 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 18:23:20,646 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 18:23:20,646 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 18:23:20,757 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 18:23:20,842 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 18:23:20,842 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 18:23:20,842 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:23:20,842 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:23:21,033 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:23:21,033 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:23:21,033 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:23:21,033 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:23:22,473 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:23:22,473 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:23:23,745 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:23:23,745 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 18:23:23,746 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 18:23:23,746 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:23:23,746 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:23:23,929 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:23:23,930 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:23:23,930 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:23:23,931 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:23:25,338 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:23:25,339 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:23:26,596 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:23:26,597 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 18:23:26,597 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:23:26,597 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:23:26,597 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:23:27,681 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 18:23:27,682 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 18:23:27,790 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 18:23:29,792 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 18:23:29,793 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 18:23:30,873 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 18:23:30,874 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 18:23:30,874 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:23:30,875 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 18:23:30,943 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:23:32,952 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 18:23:32,952 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 18:23:35,128 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 18:23:35,129 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 18:23:37,202 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 18:23:37,203 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 18:23:38,297 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 18:23:38,298 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 18:23:38,298 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:23:38,299 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 18:23:38,366 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:23:40,376 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 18:23:40,377 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 18:23:42,554 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 18:23:42,554 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 18:23:43,969 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 18:23:45,442 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 18:23:45,442 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 18:23:46,635 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 18:23:46,635 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 18:23:47,740 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 18:23:47,741 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 18:23:49,924 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 18:23:49,926 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 18:23:49,926 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:23:49,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:23:49,926 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:23:51,033 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 18:23:51,035 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 18:23:51,148 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 18:23:56,153 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 18:23:56,153 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 18:23:58,288 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 18:23:58,289 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 18:24:03,416 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 18:24:03,417 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 18:24:05,570 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 18:24:10,576 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 18:24:10,576 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_182410.mp4
2025-03-19 18:24:10,577 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:24:10,577 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:24:15,814 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:24:15,815 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 18:24:15,853 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 18:24:16,989 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182410.mp4
2025-03-19 18:24:16,989 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182410.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 18:24:19,000 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 18:24:22,006 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 18:24:22,007 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 18:24:25,009 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 18:24:25,011 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 18:24:25,011 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 18:24:26,191 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 18:24:26,191 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 18:24:26,191 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:24:26,191 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 18:24:26,270 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:24:28,279 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:24:28,279 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:24:28,279 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:24:30,564 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:24:30,566 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:24:38,749 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:24:38,750 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:24:38,751 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:24:38,751 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:39,036 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:24:39,036 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:39,256 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:24:39,257 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:39,491 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:24:39,492 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:39,739 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:24:39,740 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:39,972 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:24:39,972 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:40,193 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:24:40,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:40,437 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:24:40,438 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:40,669 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:24:40,670 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:40,877 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:24:40,877 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:24:43,101 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:24:43,102 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:24:43,102 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:24:43,245 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{711d176 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t751}
    * Task{ad7fbe4 #751 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:24:43,246 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:24:43,246 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:24:43,246 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:24:43,246 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_182443_20250319_182443.png
2025-03-19 18:24:45,041 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_182443_20250319_182443.png
2025-03-19 18:24:45,042 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_182443_20250319_182443.png
2025-03-19 18:24:45,042 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:24:50,499 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_183.jpg
2025-03-19 18:24:50,503 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_183.jpg
2025-03-19 18:24:50,504 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 18:24:50,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:24:50,504 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:24:52,110 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 18:25:00,650 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 18:25:00,651 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:25:00,652 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:25:00,782 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{711d176 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t751}
    * Task{ad7fbe4 #751 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:25:00,782 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:25:00,782 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 18:25:00,782 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 18:25:00,782 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_182500_20250319_182500.png
2025-03-19 18:25:02,545 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_182500_20250319_182500.png
2025-03-19 18:25:02,546 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_182500_20250319_182500.png
2025-03-19 18:25:02,546 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:25:08,303 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_184.jpg
2025-03-19 18:25:08,308 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_184.jpg
2025-03-19 18:25:08,308 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 18:25:08,308 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 18:25:08,308 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:25:08,308 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:25:10,444 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:25:10,445 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:25:10,446 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:25:10,446 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:25:11,446 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 18:25:12,451 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 18:25:12,451 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:25:12,451 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 160.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 18:25:12,451 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:25:22,458 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182410.mp4 (大小: 3.75MB)
2025-03-19 18:25:22,459 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:25:22,630 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.493867秒，无需修复
2025-03-19 18:25:22,630 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:25:22,630 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_182410.mp4
2025-03-19 18:25:22,631 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:25:29,526 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_185.mp4
2025-03-19 18:25:29,533 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_185.mp4
2025-03-19 18:25:29,533 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:25:29,533 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:25:34,784 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:25:34,785 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_185.mp4
2025-03-19 18:25:34,785 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 18:25:34,785 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 18:25:34,786 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 18:25:35,225 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 18:25:36,229 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 18:25:36,229 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:25:36,230 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:25:37,332 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 18:25:37,333 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 18:25:37,333 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 18:25:39,436 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 18:25:39,437 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 18:25:40,607 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 18:25:40,607 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:25:40,607 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:25:41,725 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 18:25:41,727 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 18:25:41,727 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 18:25:41,728 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 18:23:23\n- 结束时间: 2025-03-19 18:25:41\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_183.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_184.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_185.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:25:41"}]}]}}
2025-03-19 18:25:42,252 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 18:25:42,254 - QuickAppADBTester - INFO - 测试完成
2025-03-19 18:25:42,254 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-19 18:30:42,289 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 18:30:42,291 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 18:30:42,291 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 18:30:42,291 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 18:30:42,412 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 18:30:42,563 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 18:30:42,563 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 18:30:42,563 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:30:42,563 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:30:42,801 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:30:42,801 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:30:42,801 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:30:42,801 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:30:44,278 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:30:44,278 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:30:45,555 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:30:45,555 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 18:30:45,556 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 18:30:45,556 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:30:45,556 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:30:45,711 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:30:45,711 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:30:45,711 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:30:45,712 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:30:47,122 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:30:47,123 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:30:48,378 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:30:48,378 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 18:30:48,378 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:30:48,378 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:30:48,379 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:30:49,467 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 18:30:49,467 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 18:30:49,588 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 18:30:51,589 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 18:30:51,589 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 18:30:52,672 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 18:30:52,672 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 18:30:52,673 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:30:52,673 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 18:30:52,752 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:30:54,761 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 18:30:54,761 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 18:30:56,924 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 18:30:56,925 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 18:30:59,011 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 18:30:59,011 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 18:31:00,112 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 18:31:00,113 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 18:31:00,113 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:31:00,113 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 18:31:00,188 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:31:02,198 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 18:31:02,199 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 18:31:04,377 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 18:31:04,378 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 18:31:05,787 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 18:31:07,270 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 18:31:07,271 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 18:31:08,466 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 18:31:08,467 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 18:31:09,575 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 18:31:09,576 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 18:31:11,779 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 18:31:11,779 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 18:31:11,779 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:31:11,780 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:31:11,780 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:31:12,944 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 18:31:12,947 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 18:31:13,098 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 18:31:18,099 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 18:31:18,100 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 18:31:20,211 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 18:31:20,212 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 18:31:25,358 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 18:31:25,359 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 18:31:27,523 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 18:31:32,526 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 18:31:32,528 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_183132.mp4
2025-03-19 18:31:32,528 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:31:32,528 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:31:37,795 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:31:37,797 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 18:31:37,842 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 18:31:39,033 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183132.mp4
2025-03-19 18:31:39,034 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183132.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 18:31:41,041 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 18:31:44,048 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 18:31:44,049 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 18:31:47,053 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 18:31:47,053 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 18:31:47,053 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 18:31:48,223 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 18:31:48,223 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 18:31:48,224 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:31:48,224 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 18:31:48,326 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:31:50,332 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:31:50,333 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:31:50,333 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:31:52,606 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:31:52,607 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:32:00,785 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:32:00,786 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:32:00,787 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:32:00,787 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:01,088 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:32:01,089 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:01,347 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:32:01,348 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:01,582 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:32:01,582 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:01,826 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:32:01,827 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:02,079 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:32:02,079 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:02,347 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:32:02,348 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:02,577 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:32:02,578 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:02,806 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:32:02,806 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:03,062 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:32:03,063 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:32:05,305 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:32:05,306 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:32:05,306 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:32:05,430 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5c46cfa u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t757}
    * Task{52f2d08 #757 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:32:05,431 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:32:05,431 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:32:05,431 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:32:05,431 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_183205_20250319_183205.png
2025-03-19 18:32:06,777 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_183205_20250319_183205.png
2025-03-19 18:32:06,777 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_183205_20250319_183205.png
2025-03-19 18:32:06,777 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:32:13,437 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_186.jpg
2025-03-19 18:32:13,443 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_186.jpg
2025-03-19 18:32:13,443 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 18:32:13,443 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:32:13,443 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:32:14,163 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 18:32:23,574 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 18:32:23,576 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:32:23,576 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:32:23,687 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5c46cfa u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t757}
    * Task{52f2d08 #757 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:32:23,687 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:32:23,687 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 18:32:23,687 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 18:32:23,687 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_183223_20250319_183223.png
2025-03-19 18:32:25,025 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_183223_20250319_183223.png
2025-03-19 18:32:25,026 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_183223_20250319_183223.png
2025-03-19 18:32:25,026 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:32:32,433 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_187.jpg
2025-03-19 18:32:32,439 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_187.jpg
2025-03-19 18:32:32,439 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 18:32:32,440 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 18:32:32,440 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:32:32,440 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:32:34,535 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:32:34,537 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:32:34,537 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:32:34,537 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:32:35,542 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 18:32:36,548 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 18:32:36,548 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:32:36,548 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 18:32:36,548 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:32:46,554 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183132.mp4 (大小: 4.37MB)
2025-03-19 18:32:46,554 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:32:46,682 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.703033秒，无需修复
2025-03-19 18:32:46,683 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:32:46,683 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183132.mp4
2025-03-19 18:32:46,683 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:33:12,708 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_188.mp4
2025-03-19 18:33:12,715 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_188.mp4
2025-03-19 18:33:12,715 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:33:12,716 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:33:17,964 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:33:17,965 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_188.mp4
2025-03-19 18:33:17,965 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 18:33:17,965 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 18:33:17,965 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 18:33:18,409 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 18:33:19,411 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 18:33:19,412 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:33:19,412 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:33:20,514 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 18:33:20,515 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 18:33:20,515 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 18:33:22,616 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 18:33:22,617 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 18:33:23,795 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 18:33:23,795 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:33:23,796 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:33:24,943 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 18:33:24,944 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 18:33:24,945 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 18:33:24,945 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 18:30:45\n- 结束时间: 2025-03-19 18:33:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_186.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_187.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_188.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:33:24"}]}]}}
2025-03-19 18:33:25,400 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 18:33:25,402 - QuickAppADBTester - INFO - 测试完成
2025-03-19 18:38:25,469 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 18:38:25,471 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 18:38:25,471 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 18:38:25,472 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 18:38:25,609 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 18:38:25,719 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 18:38:25,719 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 18:38:25,719 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:38:25,719 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:38:25,976 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:38:25,977 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:38:25,977 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:38:25,977 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:38:27,448 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:38:27,448 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:38:28,691 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:38:28,691 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 18:38:28,692 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 18:38:28,692 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 18:38:28,692 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 18:38:28,849 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 18:38:28,850 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 18:38:28,850 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 18:38:28,850 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 18:38:30,255 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:38:30,256 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:38:31,532 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 18:38:31,533 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 18:38:31,533 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:38:31,533 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:38:31,533 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:38:32,629 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 18:38:32,630 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 18:38:32,777 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 18:38:34,782 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 18:38:34,783 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 18:38:35,857 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 18:38:35,858 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 18:38:35,858 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:38:35,858 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 18:38:35,938 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:38:37,946 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 18:38:37,946 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 18:38:40,137 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 18:38:40,138 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 18:38:42,223 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 18:38:42,223 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 18:38:43,329 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 18:38:43,330 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 18:38:43,330 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:38:43,330 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 18:38:43,409 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:38:45,418 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 18:38:45,419 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 18:38:47,567 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 18:38:47,568 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 18:38:48,987 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 18:38:50,451 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 18:38:50,452 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 18:38:51,612 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 18:38:51,612 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 18:38:52,711 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 18:38:52,712 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 18:38:54,918 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 18:38:54,919 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 18:38:54,919 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 18:38:54,919 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:38:54,919 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:38:56,086 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 18:38:56,086 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 18:38:56,205 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 18:39:01,210 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 18:39:01,210 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 18:39:03,457 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 18:39:03,457 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 18:39:08,607 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 18:39:08,608 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 18:39:10,771 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 18:39:15,777 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 18:39:15,777 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_183915.mp4
2025-03-19 18:39:15,778 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:39:15,778 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:39:21,027 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:39:21,028 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 18:39:21,075 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 18:39:22,210 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183915.mp4
2025-03-19 18:39:22,212 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183915.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 18:39:24,221 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 18:39:27,226 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 18:39:27,227 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 18:39:30,230 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 18:39:30,230 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 18:39:30,230 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 18:39:31,395 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 18:39:31,396 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 18:39:31,396 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 18:39:31,396 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 18:39:31,500 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 18:39:33,509 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 18:39:33,510 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 18:39:33,510 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 18:39:35,790 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 18:39:35,791 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 18:39:43,974 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 18:39:43,975 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 18:39:43,975 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 18:39:43,975 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:44,239 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 18:39:44,239 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:44,498 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 18:39:44,499 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:44,734 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 18:39:44,735 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:44,967 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 18:39:44,968 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:45,222 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 18:39:45,222 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:45,494 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 18:39:45,495 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:45,738 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 18:39:45,739 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:45,954 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 18:39:45,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:46,191 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 18:39:46,192 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 18:39:48,443 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 18:39:48,443 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:39:48,443 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:39:48,547 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{52de7ab u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t763}
    * Task{142f9a1 #763 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:39:48,547 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:39:48,547 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 18:39:48,547 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 18:39:48,548 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_183948_20250319_183948.png
2025-03-19 18:39:50,220 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_183948_20250319_183948.png
2025-03-19 18:39:50,221 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_183948_20250319_183948.png
2025-03-19 18:39:50,222 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:39:57,334 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 18:39:57,658 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_189.jpg
2025-03-19 18:39:57,664 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_189.jpg
2025-03-19 18:39:57,665 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 18:39:57,665 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:39:57,665 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:40:07,826 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 18:40:07,827 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 18:40:07,827 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 18:40:07,920 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{52de7ab u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t763}
    * Task{142f9a1 #763 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 18:40:07,921 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 18:40:07,921 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 18:40:07,921 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 18:40:07,921 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_184007_20250319_184007.png
2025-03-19 18:40:09,417 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_184007_20250319_184007.png
2025-03-19 18:40:09,418 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_184007_20250319_184007.png
2025-03-19 18:40:09,418 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 18:40:14,049 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_189.jpg
2025-03-19 18:40:14,053 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_189.jpg
2025-03-19 18:40:14,053 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 18:40:14,053 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 18:40:14,054 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:40:14,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:40:16,182 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 18:40:16,183 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 18:40:16,183 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 18:40:16,183 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 18:40:17,187 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 18:40:18,191 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 18:40:18,191 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 18:40:18,191 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 125.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 18:40:18,192 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 18:40:28,196 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183915.mp4 (大小: 4.60MB)
2025-03-19 18:40:28,197 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 18:40:28,301 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.053311秒，无需修复
2025-03-19 18:40:28,301 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 18:40:28,301 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_183915.mp4
2025-03-19 18:40:28,301 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 18:40:35,546 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_190.mp4
2025-03-19 18:40:35,552 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_190.mp4
2025-03-19 18:40:35,552 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 18:40:35,552 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 18:40:40,796 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 18:40:40,797 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_190.mp4
2025-03-19 18:40:40,797 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 18:40:40,797 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 18:40:40,797 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 18:40:41,088 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 18:40:42,095 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 18:40:42,096 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:40:42,096 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:40:43,200 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 18:40:43,201 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 18:40:43,202 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 18:40:45,296 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 18:40:45,296 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 18:40:46,480 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 18:40:46,481 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 18:40:46,481 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 18:40:47,602 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 18:40:47,603 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 18:40:47,603 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 18:40:47,604 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 18:38:28\n- 结束时间: 2025-03-19 18:40:47\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_189.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_189.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_190.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 18:40:47"}]}]}}
2025-03-19 18:40:47,987 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 18:40:47,990 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:00:05,365 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:00:05,367 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:00:05,367 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:00:05,367 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:00:05,474 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:00:05,630 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:00:05,630 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:00:05,631 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:00:05,631 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:00:05,882 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:00:05,882 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:00:05,883 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:00:05,883 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:00:07,366 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:00:07,366 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:00:08,660 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:00:08,660 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:00:08,660 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:00:08,660 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:00:08,660 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:00:08,809 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:00:08,810 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:00:08,810 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:00:08,810 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:00:10,226 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:00:10,227 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:00:11,503 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:00:11,504 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:00:11,504 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:00:11,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:00:11,504 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:00:12,605 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:00:12,605 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:00:12,724 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:00:14,733 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:00:14,735 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:00:15,828 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:00:15,829 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:00:15,829 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:00:15,829 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:00:15,917 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:00:17,934 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:00:17,935 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:00:20,123 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:00:20,124 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:00:22,204 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:00:22,206 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:00:23,313 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:00:23,314 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:00:23,314 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:00:23,314 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:00:23,410 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:00:25,430 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:00:25,431 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:00:27,598 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:00:27,599 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:00:29,022 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:00:30,503 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:00:30,504 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:00:31,671 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:00:31,672 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:00:32,779 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:00:32,780 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:00:34,944 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:00:34,945 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:00:34,945 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:00:34,945 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:00:34,946 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:00:36,122 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:00:36,123 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:00:36,235 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:00:41,244 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:00:41,245 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:00:43,699 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:00:43,701 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:00:48,844 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:00:48,845 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:00:51,008 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:00:56,018 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:00:56,019 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_190056.mp4
2025-03-19 19:00:56,019 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:00:56,019 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:01:01,311 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:01:01,314 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:01:01,359 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:01:02,519 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190056.mp4
2025-03-19 19:01:02,520 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190056.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 19:01:04,532 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 19:01:07,543 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 19:01:07,543 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 19:01:10,551 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 19:01:10,552 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 19:01:10,552 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 19:01:11,741 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 19:01:11,742 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 19:01:11,742 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:01:11,742 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 19:01:11,839 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:01:13,855 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 19:01:13,855 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 19:01:13,855 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 19:01:16,141 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 19:01:16,141 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 19:01:24,291 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 19:01:24,292 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 19:01:24,292 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 19:01:24,292 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:24,624 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 19:01:24,625 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:24,837 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 19:01:24,838 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:25,078 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 19:01:25,079 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:25,309 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 19:01:25,310 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:25,558 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 19:01:25,559 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:25,819 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 19:01:25,820 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:26,092 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 19:01:26,093 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:26,328 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 19:01:26,329 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:26,579 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 19:01:26,580 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:01:28,841 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 19:01:28,842 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:01:28,842 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:01:28,996 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5dc1110 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t769}
    * Task{cf3f82f #769 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:01:28,997 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:01:28,997 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 19:01:28,998 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 19:01:28,998 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_190128_20250319_190128.png
2025-03-19 19:01:30,597 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_190128_20250319_190128.png
2025-03-19 19:01:30,598 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_190128_20250319_190128.png
2025-03-19 19:01:30,599 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:01:37,768 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 19:01:38,287 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_191.jpg
2025-03-19 19:01:38,293 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_191.jpg
2025-03-19 19:01:38,293 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 19:01:38,293 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:01:38,294 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:01:48,435 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 19:01:48,436 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:01:48,437 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:01:48,557 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5dc1110 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t769}
    * Task{cf3f82f #769 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:01:48,557 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:01:48,557 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 19:01:48,557 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 19:01:48,558 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_190148_20250319_190148.png
2025-03-19 19:01:49,949 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_190148_20250319_190148.png
2025-03-19 19:01:49,949 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_190148_20250319_190148.png
2025-03-19 19:01:49,949 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:01:55,797 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_192.jpg
2025-03-19 19:01:55,803 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_192.jpg
2025-03-19 19:01:55,803 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 19:01:55,803 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 19:01:55,803 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:01:55,803 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:01:57,940 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 19:01:57,941 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 19:01:57,941 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 19:01:57,942 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 19:01:58,948 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 19:01:59,956 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 19:01:59,956 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 19:01:59,957 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 169.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 19:01:59,957 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 19:02:09,961 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190056.mp4 (大小: 4.41MB)
2025-03-19 19:02:09,962 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 19:02:10,067 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.618356秒，无需修复
2025-03-19 19:02:10,067 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 19:02:10,067 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190056.mp4
2025-03-19 19:02:10,067 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 19:02:17,166 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_193.mp4
2025-03-19 19:02:17,173 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_193.mp4
2025-03-19 19:02:17,173 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:02:17,174 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:02:22,395 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:02:22,396 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_193.mp4
2025-03-19 19:02:22,397 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 19:02:22,397 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 19:02:22,397 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 19:02:22,798 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 19:02:23,808 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 19:02:23,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:02:23,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:02:24,917 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 19:02:24,918 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 19:02:24,918 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 19:02:27,033 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 19:02:27,035 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 19:02:28,187 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 19:02:28,188 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:02:28,188 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:02:29,316 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 19:02:29,317 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 19:02:29,317 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 19:02:29,318 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:00:08\n- 结束时间: 2025-03-19 19:02:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_191.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_192.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_193.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 19:02:29"}]}]}}
2025-03-19 19:02:29,717 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 19:02:29,720 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:07:29,921 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:07:29,923 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:07:29,923 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:07:29,923 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:07:30,064 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:07:30,208 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:07:30,209 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:07:30,209 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:07:30,210 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:07:30,489 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:07:30,490 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:07:30,490 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:07:30,490 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:07:31,961 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:07:31,962 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:07:33,244 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:07:33,244 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:07:33,244 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:07:33,244 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:07:33,245 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:07:33,394 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:07:33,395 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:07:33,395 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:07:33,395 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:07:34,806 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:07:34,807 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:07:36,084 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:07:36,085 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:07:36,085 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:07:36,085 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:07:36,085 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:07:37,191 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:07:37,191 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:07:37,299 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:07:39,310 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:07:39,310 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:07:40,410 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:07:40,411 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:07:40,411 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:07:40,411 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:07:40,486 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:07:42,506 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:07:42,506 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:07:44,695 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:07:44,696 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:07:46,788 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:07:46,789 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:07:47,893 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:07:47,894 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:07:47,894 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:07:47,894 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:07:47,968 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:07:49,987 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:07:49,988 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:07:52,194 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:07:52,195 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:07:53,619 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:07:55,078 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:07:55,079 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:07:56,265 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:07:56,266 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:07:57,373 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:07:57,374 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:07:59,543 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:07:59,544 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:07:59,544 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:07:59,544 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:07:59,544 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:08:00,686 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:08:00,687 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:08:00,803 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:08:05,813 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:08:05,813 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:08:07,930 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:08:07,931 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:08:13,101 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:08:13,101 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:08:15,255 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:08:20,261 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:08:20,262 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_190820.mp4
2025-03-19 19:08:20,262 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:08:20,262 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:08:25,545 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:08:25,546 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:08:25,593 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:08:26,754 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190820.mp4
2025-03-19 19:08:26,755 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190820.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 19:08:28,771 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 19:08:31,781 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 19:08:31,782 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 19:08:34,790 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 19:08:34,790 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 19:08:34,790 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 19:08:35,968 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 19:08:35,969 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 19:08:35,969 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:08:35,969 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 19:08:36,075 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:08:38,091 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 19:08:38,093 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 19:08:38,093 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 19:08:40,381 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 19:08:40,382 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 19:08:48,544 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 19:08:48,544 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 19:08:48,544 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 19:08:48,544 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:48,918 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 19:08:48,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:49,152 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 19:08:49,153 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:49,388 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 19:08:49,389 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:49,634 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 19:08:49,634 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:49,889 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 19:08:49,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:50,140 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 19:08:50,141 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:50,426 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 19:08:50,426 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:50,657 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 19:08:50,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:50,890 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 19:08:50,891 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:08:53,140 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 19:08:53,141 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:08:53,141 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:08:53,247 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8a5c308 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t775}
    * Task{23be4c6 #775 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:08:53,247 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:08:53,247 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 19:08:53,247 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 19:08:53,248 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_190853_20250319_190853.png
2025-03-19 19:08:55,310 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_190853_20250319_190853.png
2025-03-19 19:08:55,311 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_190853_20250319_190853.png
2025-03-19 19:08:55,311 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:09:02,002 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 19:09:02,524 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_194.jpg
2025-03-19 19:09:02,531 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_194.jpg
2025-03-19 19:09:02,531 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 19:09:02,531 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:09:02,531 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:09:12,654 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 19:09:12,655 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:09:12,656 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:09:12,758 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8a5c308 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t775}
    * Task{23be4c6 #775 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:09:12,759 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:09:12,759 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 19:09:12,759 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 19:09:12,759 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_190912_20250319_190912.png
2025-03-19 19:09:14,792 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_190912_20250319_190912.png
2025-03-19 19:09:14,793 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_190912_20250319_190912.png
2025-03-19 19:09:14,793 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:09:19,558 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_194.jpg
2025-03-19 19:09:19,563 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_194.jpg
2025-03-19 19:09:19,564 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 19:09:19,564 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 19:09:19,564 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:09:19,564 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:09:21,715 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 19:09:21,717 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 19:09:21,717 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 19:09:21,717 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 19:09:22,726 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 19:09:23,734 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 19:09:23,735 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 19:09:23,735 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 154.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 19:09:23,735 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 19:09:33,740 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190820.mp4 (大小: 3.74MB)
2025-03-19 19:09:33,740 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 19:09:33,854 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.156644秒，无需修复
2025-03-19 19:09:33,854 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 19:09:33,854 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_190820.mp4
2025-03-19 19:09:33,854 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 19:09:40,918 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_195.mp4
2025-03-19 19:09:40,924 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_195.mp4
2025-03-19 19:09:40,925 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:09:40,925 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:09:46,212 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:09:46,214 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_195.mp4
2025-03-19 19:09:46,214 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 19:09:46,214 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 19:09:46,214 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 19:09:46,605 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 19:09:47,615 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 19:09:47,615 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:09:47,616 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:09:48,724 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 19:09:48,725 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 19:09:48,725 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 19:09:50,833 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 19:09:50,834 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 19:09:51,990 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 19:09:51,991 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:09:51,991 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:09:53,142 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 19:09:53,143 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 19:09:53,143 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 19:09:53,144 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:07:33\n- 结束时间: 2025-03-19 19:09:53\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_194.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_194.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_195.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 19:09:53"}]}]}}
2025-03-19 19:09:53,545 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 19:09:53,547 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:14:53,745 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:14:53,748 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:14:53,748 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:14:53,748 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:14:53,883 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:14:54,025 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:14:54,026 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:14:54,026 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:14:54,026 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:14:54,254 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:14:54,255 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:14:54,255 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:14:54,255 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:14:55,745 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:14:55,746 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:14:56,990 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:14:56,991 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:14:56,991 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:14:56,991 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:14:56,991 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:14:57,155 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:14:57,156 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:14:57,156 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:14:57,156 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:14:58,563 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:14:58,564 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:14:59,812 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:14:59,812 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:14:59,812 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:14:59,812 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:14:59,812 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:15:00,913 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:15:00,914 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:15:01,024 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:15:03,028 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:15:03,028 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:15:04,121 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:15:04,122 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:15:04,122 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:15:04,122 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:15:04,201 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:15:06,221 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:15:06,222 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:15:08,349 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:15:08,350 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:15:10,444 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:15:10,445 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:15:11,556 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:15:11,557 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:15:11,557 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:15:11,557 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:15:11,631 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:15:13,648 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:15:13,649 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:15:15,833 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:15:15,834 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:15:17,258 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:15:18,705 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:15:18,706 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:15:19,879 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:15:19,880 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:15:20,994 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:15:20,995 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:15:23,188 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:15:23,189 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:15:23,189 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:15:23,189 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:15:23,189 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:15:24,388 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:15:24,389 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:15:24,499 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:15:29,504 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:15:29,505 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:15:31,677 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:15:31,678 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:15:36,813 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:15:36,814 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:15:38,983 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:15:43,993 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:15:43,994 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_191543.mp4
2025-03-19 19:15:43,994 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:15:43,994 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:15:49,282 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:15:49,282 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:15:49,314 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:15:50,471 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_191543.mp4
2025-03-19 19:15:50,472 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_191543.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 19:15:52,481 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 19:15:55,493 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 19:15:55,493 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 19:15:58,504 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 19:15:58,504 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 19:15:58,504 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 19:15:59,701 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 19:15:59,702 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 19:15:59,702 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:15:59,702 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 19:15:59,806 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:16:01,823 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 19:16:01,824 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 19:16:01,824 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 19:16:04,156 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 19:16:04,156 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 19:16:12,369 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 19:16:12,370 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 19:16:12,370 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 19:16:12,370 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:12,741 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 19:16:12,741 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:12,968 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 19:16:12,969 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:13,202 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 19:16:13,203 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:13,460 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 19:16:13,461 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:13,701 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 19:16:13,701 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:13,945 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 19:16:13,946 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:14,192 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 19:16:14,192 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:14,437 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 19:16:14,437 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:14,695 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 19:16:14,696 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:16:16,935 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 19:16:16,936 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:16:16,936 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:16:17,063 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9f21912 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t781}
    * Task{ca132e0 #781 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:16:17,064 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:16:17,064 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 19:16:17,064 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 19:16:17,064 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_191617_20250319_191617.png
2025-03-19 19:16:19,010 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_191617_20250319_191617.png
2025-03-19 19:16:19,011 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_191617_20250319_191617.png
2025-03-19 19:16:19,012 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:16:25,692 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 19:16:26,181 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_196.jpg
2025-03-19 19:16:26,187 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_196.jpg
2025-03-19 19:16:26,187 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 19:16:26,188 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:16:26,188 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:16:36,304 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 19:16:36,305 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:16:36,305 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:16:36,423 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9f21912 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t781}
    * Task{ca132e0 #781 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:16:36,424 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:16:36,424 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 19:16:36,424 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 19:16:36,424 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_191636_20250319_191636.png
2025-03-19 19:16:38,322 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_191636_20250319_191636.png
2025-03-19 19:16:38,323 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_191636_20250319_191636.png
2025-03-19 19:16:38,323 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:16:43,024 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_196.jpg
2025-03-19 19:16:43,028 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_196.jpg
2025-03-19 19:16:43,029 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 19:16:43,029 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 19:16:43,029 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:16:43,029 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:16:45,148 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 19:16:45,149 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 19:16:45,150 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 19:16:45,150 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 19:16:46,159 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 19:16:47,164 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 19:16:47,165 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 19:16:47,165 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 122.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 19:16:47,165 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 19:16:57,173 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_191543.mp4 (大小: 4.00MB)
2025-03-19 19:16:57,174 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 19:16:57,285 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.745211秒，无需修复
2025-03-19 19:16:57,285 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 19:16:57,285 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_191543.mp4
2025-03-19 19:16:57,285 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 19:17:04,369 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_197.mp4
2025-03-19 19:17:04,375 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_197.mp4
2025-03-19 19:17:04,375 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:17:04,375 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:17:09,587 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:17:09,588 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_197.mp4
2025-03-19 19:17:09,588 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 19:17:09,588 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 19:17:09,589 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 19:17:09,974 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 19:17:10,981 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 19:17:10,981 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:17:10,981 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:17:12,088 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 19:17:12,089 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 19:17:12,089 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 19:17:14,197 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 19:17:14,198 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 19:17:15,344 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 19:17:15,345 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:17:15,345 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:17:16,464 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 19:17:16,465 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 19:17:16,466 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 19:17:16,466 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:14:56\n- 结束时间: 2025-03-19 19:17:16\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_196.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_196.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_197.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 19:17:16"}]}]}}
2025-03-19 19:17:16,850 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 19:17:16,853 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:22:17,090 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:22:17,091 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:22:17,091 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:22:17,091 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:22:17,223 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:22:17,345 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:22:17,346 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:22:17,346 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:22:17,346 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:22:17,612 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:22:17,613 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:22:17,613 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:22:17,613 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:22:19,062 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:22:19,063 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:22:20,345 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:22:20,345 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:22:20,345 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:22:20,345 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:22:20,345 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:22:20,490 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:22:20,491 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:22:20,491 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:22:20,491 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:22:21,895 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:22:21,896 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:22:23,161 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:22:23,161 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:22:23,161 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:22:23,161 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:22:23,161 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:22:24,261 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:22:24,262 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:22:24,381 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:22:26,392 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:22:26,393 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:22:27,486 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:22:27,487 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:22:27,487 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:22:27,487 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:22:27,564 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:22:29,584 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:22:29,585 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:22:31,777 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:22:31,777 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:22:33,867 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:22:33,868 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:22:34,977 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:22:34,978 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:22:34,978 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:22:34,978 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:22:35,054 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:22:37,072 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:22:37,072 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:22:39,207 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:22:39,208 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:22:40,616 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:22:42,096 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:22:42,097 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:22:43,287 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:22:43,288 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:22:44,403 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:22:44,404 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:22:46,570 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:22:46,570 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:22:46,571 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:22:46,571 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:22:46,571 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:22:47,758 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:22:47,759 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:22:47,887 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:22:52,893 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:22:52,893 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:22:55,045 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:22:55,046 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:23:00,180 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:23:00,181 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:23:02,349 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:23:07,357 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:23:07,357 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_192307.mp4
2025-03-19 19:23:07,358 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:23:07,358 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:23:12,618 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:23:12,619 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:23:12,666 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:23:13,826 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_192307.mp4
2025-03-19 19:23:13,827 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_192307.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 19:23:15,843 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 19:23:18,851 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 19:23:18,852 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 19:23:21,859 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 19:23:21,860 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 19:23:21,860 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 19:23:23,021 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 19:23:23,022 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 19:23:23,022 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:23:23,023 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 19:23:23,121 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:23:25,141 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 19:23:25,141 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 19:23:25,141 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 19:23:27,435 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 19:23:27,436 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 19:23:35,619 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 19:23:35,620 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 19:23:35,620 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 19:23:35,620 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:35,897 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 19:23:35,898 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:36,224 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 19:23:36,225 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:36,456 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 19:23:36,457 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:36,711 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 19:23:36,712 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:36,936 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 19:23:36,937 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:37,171 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 19:23:37,172 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:37,397 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 19:23:37,397 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:37,608 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 19:23:37,609 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:37,885 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 19:23:37,886 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:23:40,124 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 19:23:40,124 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:23:40,125 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:23:40,285 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{302cfc0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t787}
    * Task{9520a9f #787 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:23:40,286 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:23:40,286 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 19:23:40,287 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 19:23:40,287 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_192340_20250319_192340.png
2025-03-19 19:23:41,958 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_192340_20250319_192340.png
2025-03-19 19:23:41,959 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_192340_20250319_192340.png
2025-03-19 19:23:41,959 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:23:49,068 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 19:23:49,671 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_198.jpg
2025-03-19 19:23:49,675 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_198.jpg
2025-03-19 19:23:49,675 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 19:23:49,676 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:23:49,676 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:23:59,799 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 19:23:59,800 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:23:59,800 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:23:59,896 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{302cfc0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t787}
    * Task{9520a9f #787 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:23:59,896 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:23:59,896 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 19:23:59,896 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 19:23:59,896 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_192359_20250319_192359.png
2025-03-19 19:24:01,585 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_192359_20250319_192359.png
2025-03-19 19:24:01,586 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_192359_20250319_192359.png
2025-03-19 19:24:01,586 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:24:06,289 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_198.jpg
2025-03-19 19:24:06,294 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_198.jpg
2025-03-19 19:24:06,295 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 19:24:06,295 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 19:24:06,295 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:24:06,295 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:24:08,429 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 19:24:08,430 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 19:24:08,430 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 19:24:08,430 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 19:24:09,432 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 19:24:10,440 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 19:24:10,440 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 19:24:10,440 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 165.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 19:24:10,440 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 19:24:20,450 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_192307.mp4 (大小: 4.11MB)
2025-03-19 19:24:20,451 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 19:24:20,552 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.771300秒，无需修复
2025-03-19 19:24:20,552 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 19:24:20,552 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_192307.mp4
2025-03-19 19:24:20,552 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 19:24:27,652 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_199.mp4
2025-03-19 19:24:27,657 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_199.mp4
2025-03-19 19:24:27,657 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:24:27,657 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:24:32,881 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:24:32,883 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_199.mp4
2025-03-19 19:24:32,883 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 19:24:32,883 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 19:24:32,883 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 19:24:33,324 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 19:24:34,334 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 19:24:34,335 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:24:34,335 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:24:35,448 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 19:24:35,449 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 19:24:35,449 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 19:24:37,549 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 19:24:37,550 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 19:24:38,721 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 19:24:38,722 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:24:38,722 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:24:39,868 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 19:24:39,869 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 19:24:39,869 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 19:24:39,870 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:22:20\n- 结束时间: 2025-03-19 19:24:39\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_198.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_198.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_199.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 19:24:39"}]}]}}
2025-03-19 19:24:40,270 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 19:24:40,273 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:29:40,415 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:29:40,417 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:29:40,417 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:29:40,417 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:29:40,555 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:29:40,723 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:29:40,724 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:29:40,724 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:29:40,724 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:29:40,968 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:29:40,968 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:29:40,969 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:29:40,969 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:29:42,444 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:29:42,444 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:29:43,706 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:29:43,706 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:29:43,707 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:29:43,707 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:29:43,707 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:29:43,858 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:29:43,859 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:29:43,859 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:29:43,859 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:29:45,274 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:29:45,274 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:29:46,548 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:29:46,549 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:29:46,549 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:29:46,549 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:29:46,549 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:29:47,652 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:29:47,653 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:29:47,767 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:29:49,771 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:29:49,772 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:29:50,866 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:29:50,867 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:29:50,867 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:29:50,867 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:29:50,945 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:29:52,961 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:29:52,961 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:29:55,143 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:29:55,144 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:29:57,236 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:29:57,237 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:29:58,343 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:29:58,344 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:29:58,345 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:29:58,345 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:29:58,418 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:30:00,437 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:30:00,437 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:30:02,611 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:30:02,612 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:30:04,029 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:30:05,511 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:30:05,512 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:30:06,674 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:30:06,674 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:30:07,791 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:30:07,792 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:30:09,984 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:30:09,985 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:30:09,985 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:30:09,985 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:30:09,985 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:30:11,150 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:30:11,151 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:30:11,262 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:30:16,271 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:30:16,272 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:30:18,437 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:30:18,437 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:30:23,610 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:30:23,611 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:30:25,784 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:30:30,787 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:30:30,788 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_193030.mp4
2025-03-19 19:30:30,788 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:30:30,789 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:30:36,078 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:30:36,080 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:30:36,128 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:30:37,289 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193030.mp4
2025-03-19 19:30:37,290 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193030.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 19:30:39,306 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 19:30:42,315 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 19:30:42,317 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 19:30:45,325 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 19:30:45,326 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 19:30:45,326 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 19:30:46,527 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 19:30:46,528 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 19:30:46,528 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:30:46,528 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 19:30:46,626 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:30:48,642 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 19:30:48,643 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 19:30:48,643 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 19:30:50,964 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 19:30:50,965 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 19:30:59,161 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 19:30:59,161 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 19:30:59,162 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 19:30:59,162 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:30:59,518 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 19:30:59,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:30:59,787 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 19:30:59,787 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:00,078 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 19:31:00,079 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:00,316 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 19:31:00,317 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:00,578 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 19:31:00,579 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:00,817 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 19:31:00,818 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:01,085 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 19:31:01,086 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:01,317 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 19:31:01,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:01,556 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 19:31:01,557 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:31:03,809 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 19:31:03,809 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:31:03,810 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:31:03,947 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8bf75c2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t793}
    * Task{96e209 #793 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:31:03,948 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:31:03,948 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 19:31:03,948 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 19:31:03,948 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_193103_20250319_193103.png
2025-03-19 19:31:05,794 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_193103_20250319_193103.png
2025-03-19 19:31:05,794 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_193103_20250319_193103.png
2025-03-19 19:31:05,794 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:31:12,541 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 19:31:13,159 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_200.jpg
2025-03-19 19:31:13,165 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_200.jpg
2025-03-19 19:31:13,165 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 19:31:13,165 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:31:13,165 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:31:23,289 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 19:31:23,289 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:31:23,290 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:31:23,390 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8bf75c2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t793}
    * Task{96e209 #793 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:31:23,390 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:31:23,390 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 19:31:23,390 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 19:31:23,390 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_193123_20250319_193123.png
2025-03-19 19:31:25,182 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_193123_20250319_193123.png
2025-03-19 19:31:25,183 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_193123_20250319_193123.png
2025-03-19 19:31:25,183 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:31:29,861 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_200.jpg
2025-03-19 19:31:29,867 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_200.jpg
2025-03-19 19:31:29,868 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 19:31:29,868 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 19:31:29,868 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:31:29,868 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:31:32,025 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 19:31:32,026 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 19:31:32,026 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 19:31:32,026 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 19:31:33,031 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 19:31:34,040 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 19:31:34,041 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 19:31:34,041 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 151.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 19:31:34,041 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 19:31:44,044 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193030.mp4 (大小: 3.64MB)
2025-03-19 19:31:44,044 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 19:31:44,168 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.854556秒，无需修复
2025-03-19 19:31:44,168 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 19:31:44,168 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193030.mp4
2025-03-19 19:31:44,168 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 19:31:51,134 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_201.mp4
2025-03-19 19:31:51,141 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_201.mp4
2025-03-19 19:31:51,141 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:31:51,141 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:31:56,426 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:31:56,427 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_201.mp4
2025-03-19 19:31:56,428 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 19:31:56,428 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 19:31:56,428 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 19:31:56,799 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 19:31:57,810 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 19:31:57,810 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:31:57,810 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:31:58,913 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 19:31:58,915 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 19:31:58,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 19:32:01,021 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 19:32:01,022 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 19:32:02,171 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 19:32:02,172 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:32:02,172 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:32:03,291 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 19:32:03,292 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 19:32:03,293 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 19:32:03,293 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:29:43\n- 结束时间: 2025-03-19 19:32:03\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_200.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_200.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_201.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 19:32:03"}]}]}}
2025-03-19 19:32:03,698 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 19:32:03,701 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:37:03,773 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:37:03,775 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:37:03,775 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:37:03,775 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:37:03,896 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:37:04,022 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:37:04,022 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:37:04,022 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:37:04,023 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:37:04,232 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:37:04,233 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:37:04,233 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:37:04,233 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:37:05,720 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:37:05,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:37:06,962 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:37:06,962 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:37:06,962 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:37:06,963 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:37:06,963 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:37:07,127 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:37:07,127 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:37:07,127 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:37:07,127 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:37:08,511 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:37:08,512 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:37:09,781 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:37:09,782 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:37:09,782 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:37:09,782 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:37:09,782 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:37:10,884 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:37:10,885 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:37:11,015 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:37:13,023 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:37:13,023 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:37:14,117 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:37:14,117 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:37:14,117 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:37:14,118 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:37:14,191 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:37:16,206 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:37:16,207 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:37:18,388 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:37:18,389 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:37:20,484 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:37:20,485 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:37:21,590 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:37:21,591 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:37:21,591 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:37:21,591 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:37:21,664 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:37:23,677 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:37:23,677 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:37:25,820 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:37:25,821 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:37:27,245 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:37:28,730 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:37:28,731 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:37:29,887 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:37:29,888 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:37:31,003 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:37:31,005 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:37:33,190 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:37:33,190 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:37:33,191 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:37:33,191 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:37:33,191 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:37:34,347 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:37:34,348 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:37:34,473 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:37:39,481 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:37:39,482 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:37:41,637 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:37:41,638 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:37:46,785 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:37:46,786 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:37:48,953 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:37:53,962 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:37:53,963 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_193753.mp4
2025-03-19 19:37:53,963 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:37:53,963 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:37:59,252 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:37:59,253 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:37:59,299 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:38:00,454 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193753.mp4
2025-03-19 19:38:00,455 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193753.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 19:38:02,471 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 19:38:05,481 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 19:38:05,481 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 19:38:08,487 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 19:38:08,487 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 19:38:08,487 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 19:38:09,660 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 19:38:09,661 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 19:38:09,661 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:38:09,662 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 19:38:09,761 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:38:11,778 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 19:38:11,778 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 19:38:11,778 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 19:38:14,118 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 19:38:14,119 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 19:38:22,324 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 19:38:22,325 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 19:38:22,325 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 19:38:22,326 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:22,699 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 19:38:22,700 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:22,929 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 19:38:22,930 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:23,158 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 19:38:23,159 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:23,413 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 19:38:23,414 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:23,653 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 19:38:23,654 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:23,901 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 19:38:23,902 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:24,131 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 19:38:24,132 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:24,362 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 19:38:24,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:24,617 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 19:38:24,618 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 19:38:26,857 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 19:38:26,858 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:38:26,859 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:38:26,973 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c199855 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t799}
    * Task{fc8b35b #799 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:38:26,974 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:38:26,974 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 19:38:26,974 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 19:38:26,974 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_193826_20250319_193826.png
2025-03-19 19:38:29,128 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_193826_20250319_193826.png
2025-03-19 19:38:29,129 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_193826_20250319_193826.png
2025-03-19 19:38:29,129 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:38:35,702 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 19:38:36,473 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_202.jpg
2025-03-19 19:38:36,479 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_202.jpg
2025-03-19 19:38:36,479 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 19:38:36,479 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:38:36,479 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:38:46,633 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 19:38:46,634 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 19:38:46,634 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 19:38:46,735 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c199855 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t799}
    * Task{fc8b35b #799 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 19:38:46,735 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 19:38:46,735 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 19:38:46,735 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 19:38:46,736 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_193846_20250319_193846.png
2025-03-19 19:38:48,867 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_193846_20250319_193846.png
2025-03-19 19:38:48,868 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_193846_20250319_193846.png
2025-03-19 19:38:48,868 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 19:38:55,064 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_203.jpg
2025-03-19 19:38:55,070 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_203.jpg
2025-03-19 19:38:55,070 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 19:38:55,071 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 19:38:55,071 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:38:55,071 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:38:57,190 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 19:38:57,191 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 19:38:57,191 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 19:38:57,191 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 19:38:58,201 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 19:38:59,210 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 19:38:59,210 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 19:38:59,211 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 122.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 19:38:59,211 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 19:39:09,218 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193753.mp4 (大小: 4.05MB)
2025-03-19 19:39:09,218 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 19:39:09,322 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.972989秒，无需修复
2025-03-19 19:39:09,322 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 19:39:09,322 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_193753.mp4
2025-03-19 19:39:09,322 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 19:39:16,350 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_204.mp4
2025-03-19 19:39:16,356 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_204.mp4
2025-03-19 19:39:16,357 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:39:16,357 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:39:21,621 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:39:21,622 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_204.mp4
2025-03-19 19:39:21,623 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 19:39:21,623 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 19:39:21,623 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 19:39:21,872 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 19:39:22,881 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 19:39:22,882 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:39:22,882 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:39:23,989 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 19:39:23,990 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 19:39:23,990 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 19:39:26,101 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 19:39:26,102 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 19:39:27,281 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 19:39:27,282 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:39:27,282 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:39:28,417 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 19:39:28,418 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 19:39:28,418 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 19:39:28,419 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:37:06\n- 结束时间: 2025-03-19 19:39:28\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_202.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_203.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_204.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 19:39:28"}]}]}}
2025-03-19 19:39:28,800 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 19:39:28,803 - QuickAppADBTester - INFO - 测试完成
2025-03-19 19:44:28,967 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 19:44:28,969 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 19:44:28,969 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 19:44:28,969 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 19:44:29,102 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 19:44:29,266 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 19:44:29,267 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 19:44:29,267 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:44:29,267 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:44:29,491 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:44:29,492 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:44:29,492 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:44:29,492 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:44:30,994 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:44:30,995 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:44:32,266 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:44:32,266 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 19:44:32,266 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 19:44:32,266 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 19:44:32,267 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 19:44:32,414 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 19:44:32,414 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 19:44:32,415 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 19:44:32,415 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 19:44:33,817 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:44:33,818 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:44:35,088 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 19:44:35,089 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 19:44:35,089 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:44:35,089 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:44:35,089 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:44:36,184 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 19:44:36,185 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 19:44:36,304 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 19:44:38,306 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 19:44:38,306 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 19:44:39,403 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 19:44:39,404 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 19:44:39,404 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:44:39,404 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 19:44:39,487 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:44:41,505 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 19:44:41,506 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 19:44:43,700 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 19:44:43,700 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 19:44:45,789 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 19:44:45,790 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 19:44:46,891 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 19:44:46,892 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 19:44:46,892 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 19:44:46,892 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 19:44:46,968 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 19:44:48,984 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 19:44:48,985 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 19:44:51,188 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 19:44:51,189 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 19:44:52,599 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 19:44:54,056 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 19:44:54,057 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 19:44:55,250 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 19:44:55,251 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 19:44:56,349 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 19:44:56,350 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 19:44:58,550 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 19:44:58,551 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 19:44:58,551 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 19:44:58,552 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 19:44:58,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 19:44:59,733 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 19:44:59,734 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 19:44:59,855 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 19:45:04,865 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 19:45:04,866 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 19:45:06,989 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 19:45:06,990 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 19:45:12,137 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 19:45:12,138 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 19:45:14,304 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 19:45:19,313 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 19:45:19,314 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_194519.mp4
2025-03-19 19:45:19,314 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 19:45:19,314 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 19:45:24,605 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 19:45:24,606 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 19:45:24,652 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 19:45:25,810 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_194519.mp4
2025-03-19 19:45:25,813 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_194519.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 20:01:07,851 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 20:01:10,794 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 20:01:10,794 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 20:01:13,799 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 20:01:13,799 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 20:01:13,800 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 20:01:14,965 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 20:01:14,966 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 20:01:14,966 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:01:14,966 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 20:01:15,066 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:01:17,078 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 20:01:17,078 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 20:01:17,078 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 20:01:19,327 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 20:01:19,327 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 20:01:27,466 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 20:01:27,469 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 20:01:27,469 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 20:01:27,469 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:27,844 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 20:01:27,845 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:28,063 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 20:01:28,063 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:28,327 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 20:01:28,328 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:28,597 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 20:01:28,598 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:28,832 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 20:01:28,833 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:29,062 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 20:01:29,062 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:29,306 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 20:01:29,307 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:29,518 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 20:01:29,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:29,748 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 20:01:29,749 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:01:31,971 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 20:01:31,972 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:01:31,972 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:01:32,113 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d4c8dbc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t805}
    * Task{d32c9a8 #805 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:01:32,114 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:01:32,114 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 20:01:32,114 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 20:01:32,115 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_200132_20250319_200132.png
2025-03-19 20:01:33,743 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_200132_20250319_200132.png
2025-03-19 20:01:33,743 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_200132_20250319_200132.png
2025-03-19 20:01:33,744 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:01:41,011 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 20:01:41,808 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-19 20:01:41,831 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-19 20:01:41,833 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-19 20:01:41,833 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 20:01:41,833 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:01:41,833 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:01:51,949 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 20:01:51,950 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:01:51,951 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:01:52,071 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d4c8dbc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t805}
    * Task{d32c9a8 #805 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:01:52,071 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:01:52,071 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 20:01:52,071 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 20:01:52,072 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_200152_20250319_200152.png
2025-03-19 20:01:53,776 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_200152_20250319_200152.png
2025-03-19 20:01:53,776 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_200152_20250319_200152.png
2025-03-19 20:01:53,776 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:17:41,009 - QuickAppADBTester - INFO - 录制进行中，已录制约 990 秒
2025-03-19 20:18:04,261 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:2423)')))
2025-03-19 20:18:04,266 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 716, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1286, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1332, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1281, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1080, in _send_output
    self.send(chunk)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1002, in send
    self.sock.sendall(data)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1241, in sendall
    v = self.send(byte_view[count:])
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1210, in send
    return self._sslobj.write(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:2423)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:2423)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:2423)')))

2025-03-19 20:18:04,270 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-19 20:18:04,270 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 20:18:04,270 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 20:18:04,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:18:04,270 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:18:06,395 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 20:18:06,396 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 20:18:06,396 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 20:18:06,396 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 20:18:07,402 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 20:18:08,413 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 20:18:08,413 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 20:18:08,414 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 156.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 20:18:08,414 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 20:18:18,423 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_194519.mp4 (大小: 3.67MB)
2025-03-19 20:18:18,425 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 20:18:18,542 - QuickAppADBTester - INFO - 录制文件完整，时长: 1959.822878秒，无需修复
2025-03-19 20:18:18,542 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 20:18:18,542 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_194519.mp4
2025-03-19 20:18:18,542 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 20:18:31,820 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_205.mp4
2025-03-19 20:18:31,826 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_205.mp4
2025-03-19 20:18:31,827 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:18:31,827 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:18:37,110 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:18:37,112 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_205.mp4
2025-03-19 20:18:37,112 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 20:18:37,112 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 20:18:37,112 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 20:18:37,517 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 20:18:38,526 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 20:18:38,527 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:18:38,527 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:18:39,635 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 20:18:39,636 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 20:18:39,636 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 20:18:41,740 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 20:18:41,741 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 20:18:42,935 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 20:18:42,936 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:18:42,936 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:18:44,078 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 20:18:44,079 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 20:18:44,079 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-19 20:18:44,079 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 19:44:32\n- 结束时间: 2025-03-19 20:18:44\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_205.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 20:18:44"}]}]}}
2025-03-19 20:18:44,456 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 20:18:44,459 - QuickAppADBTester - INFO - 测试完成
2025-03-19 20:35:05,660 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 20:35:05,717 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 20:35:05,717 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 20:35:05,717 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 20:35:05,844 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 20:35:06,006 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 20:35:06,006 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 20:35:06,007 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 20:35:06,007 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 20:35:06,276 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 20:35:06,276 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 20:35:06,276 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 20:35:06,276 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 20:35:07,768 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:35:07,769 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:35:09,048 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 20:35:09,049 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 20:35:09,049 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 20:35:09,049 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 20:35:09,049 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 20:35:09,199 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 20:35:09,200 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 20:35:09,200 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 20:35:09,200 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 20:35:10,618 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:35:10,619 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:35:11,888 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 20:35:11,888 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 20:35:11,889 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 20:35:11,889 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:35:11,889 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:35:12,988 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 20:35:12,989 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 20:35:13,110 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 20:35:15,117 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 20:35:15,118 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 20:35:16,235 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 20:35:16,236 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 20:35:16,236 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:35:16,236 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 20:35:16,330 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:35:18,343 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 20:35:18,344 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 20:35:20,544 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 20:35:20,545 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 20:35:22,636 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 20:35:22,638 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 20:35:23,749 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 20:35:23,750 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 20:35:23,750 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:35:23,750 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 20:35:23,827 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:35:25,842 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 20:35:25,843 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 20:35:28,032 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 20:35:28,033 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 20:35:29,457 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 20:35:30,934 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 20:35:30,935 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 20:35:32,090 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 20:35:32,092 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 20:35:33,202 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 20:35:33,203 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 20:35:35,384 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 20:35:35,385 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 20:35:35,385 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 20:35:35,385 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:35:35,385 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:35:36,595 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 20:35:36,596 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 20:35:36,727 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 20:35:41,735 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 20:35:41,736 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 20:35:43,897 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 20:35:43,898 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 20:35:49,085 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 20:35:49,086 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 20:35:51,248 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 20:35:56,256 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 20:35:56,257 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_203556.mp4
2025-03-19 20:35:56,257 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:35:56,257 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:36:01,549 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:36:01,550 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 20:36:01,595 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 20:36:02,813 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_203556.mp4
2025-03-19 20:36:02,814 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_203556.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 20:36:04,831 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 20:36:07,841 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 20:36:07,842 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 20:36:18,929 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 20:36:18,929 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 20:36:18,929 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 20:36:20,109 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 20:36:20,110 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 20:36:20,111 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:36:20,111 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 20:36:20,203 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:36:22,218 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 20:36:22,218 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 20:36:22,219 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 20:36:24,512 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 20:36:24,513 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 20:36:32,704 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 20:36:32,705 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 20:36:32,705 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 20:36:32,705 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:33,046 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 20:36:33,047 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:33,275 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 20:36:33,276 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:33,541 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 20:36:33,542 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:33,804 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 20:36:33,804 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:34,066 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 20:36:34,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:34,308 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 20:36:34,309 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:34,534 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 20:36:34,535 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:34,776 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 20:36:34,776 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:35,012 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 20:36:35,013 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:36:37,260 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 20:36:37,260 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:36:37,261 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:36:37,380 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4edb980 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t811}
    * Task{df42bfe #811 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:36:37,381 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:36:37,381 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 20:36:37,381 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 20:36:37,381 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_203637_20250319_203637.png
2025-03-19 20:36:38,067 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 20:36:38,678 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_203637_20250319_203637.png
2025-03-19 20:36:38,678 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_203637_20250319_203637.png
2025-03-19 20:36:38,679 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:36:47,508 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_206.jpg
2025-03-19 20:36:47,513 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_206.jpg
2025-03-19 20:36:47,513 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 20:36:47,513 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:36:47,513 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:36:57,686 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 20:36:57,688 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:36:57,688 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:36:57,807 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4edb980 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t811}
    * Task{df42bfe #811 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:36:57,807 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:36:57,807 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 20:36:57,807 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 20:36:57,808 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_203657_20250319_203657.png
2025-03-19 20:36:59,058 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_203657_20250319_203657.png
2025-03-19 20:36:59,058 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_203657_20250319_203657.png
2025-03-19 20:36:59,058 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:37:04,538 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_207.jpg
2025-03-19 20:37:04,544 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_207.jpg
2025-03-19 20:37:04,544 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 20:37:04,545 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 20:37:04,545 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:37:04,545 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:42:55,309 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 20:42:55,310 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 20:42:55,310 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 20:42:55,310 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 20:42:56,317 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 20:42:57,326 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 20:42:57,327 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 20:42:57,327 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 148.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 20:42:57,327 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 20:43:07,330 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_203556.mp4 (大小: 3.23MB)
2025-03-19 20:43:07,330 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 20:43:07,440 - QuickAppADBTester - INFO - 录制文件完整，时长: 362.555022秒，无需修复
2025-03-19 20:43:07,440 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 20:43:07,440 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_203556.mp4
2025-03-19 20:43:07,440 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 20:43:23,141 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-19 20:43:23,147 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-19 20:43:23,151 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-19 20:43:23,152 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:43:23,152 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:43:28,378 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:43:28,379 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-19 20:43:28,379 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 20:43:28,380 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 20:43:28,380 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 20:43:28,832 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 20:43:29,840 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 20:43:29,841 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:43:29,841 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:43:30,956 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 20:43:30,956 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 20:43:30,956 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 20:43:33,042 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 20:43:33,043 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 20:43:34,215 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 20:43:34,216 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:43:34,216 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:43:35,319 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 20:43:35,320 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 20:43:35,320 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-19 20:43:35,321 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 20:35:09\n- 结束时间: 2025-03-19 20:43:35\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_206.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_207.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 20:43:35"}]}]}}
2025-03-19 20:43:35,714 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 20:43:35,717 - QuickAppADBTester - INFO - 测试完成
2025-03-19 20:48:36,259 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 20:48:36,261 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 20:48:36,262 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 20:48:36,262 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 20:48:36,387 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 20:48:36,536 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 20:48:36,536 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 20:48:36,536 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 20:48:36,536 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 20:48:36,762 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 20:48:36,762 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 20:48:36,762 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 20:48:36,762 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 20:48:38,252 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:48:38,252 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:48:39,493 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 20:48:39,494 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 20:48:39,494 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 20:48:39,494 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 20:48:39,494 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 20:48:39,662 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 20:48:39,662 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 20:48:39,662 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 20:48:39,662 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 20:48:41,056 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:48:41,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:48:42,272 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 20:48:42,272 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 20:48:42,272 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 20:48:42,272 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:48:42,273 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:48:43,369 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 20:48:43,369 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 20:48:43,487 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 20:48:45,493 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 20:48:45,493 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 20:48:46,567 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 20:48:46,568 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 20:48:46,568 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:48:46,568 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 20:48:46,639 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:48:48,654 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 20:48:48,654 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 20:48:50,826 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 20:48:50,826 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 20:48:52,910 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 20:48:52,910 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 20:48:54,004 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 20:48:54,004 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 20:48:54,004 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:48:54,004 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 20:48:54,075 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:48:56,095 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 20:48:56,096 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 20:48:58,248 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 20:48:58,249 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 20:48:59,658 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 20:49:01,094 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 20:49:01,095 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 20:49:02,259 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 20:49:02,260 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 20:49:03,358 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 20:49:03,359 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 20:49:05,536 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 20:49:05,537 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 20:49:05,537 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 20:49:05,537 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:49:05,537 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:49:06,681 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 20:49:06,682 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 20:49:06,804 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 20:49:11,813 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 20:49:11,818 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 20:49:13,959 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 20:49:13,959 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 20:49:19,086 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 20:49:19,087 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 20:49:21,253 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 20:49:26,261 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 20:49:26,262 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_204926.mp4
2025-03-19 20:49:26,262 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:49:26,262 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:49:31,536 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:49:31,537 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 20:49:31,579 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 20:49:32,799 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_204926.mp4
2025-03-19 20:49:32,799 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_204926.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 20:49:34,808 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 20:49:37,812 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 20:49:37,813 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 20:49:40,816 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 20:49:40,817 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 20:49:40,817 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 20:49:41,988 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 20:49:41,989 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 20:49:41,989 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:49:41,989 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 20:49:42,085 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:49:44,096 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 20:49:44,096 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 20:49:44,096 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 20:49:46,400 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 20:49:46,401 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 20:49:54,588 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 20:49:54,588 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 20:49:54,589 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 20:49:54,589 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:54,936 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 20:49:54,937 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:55,194 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 20:49:55,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:55,439 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 20:49:55,439 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:55,688 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 20:49:55,689 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:55,914 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 20:49:55,914 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:56,146 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 20:49:56,147 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:56,378 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 20:49:56,379 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:56,594 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 20:49:56,595 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:56,818 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 20:49:56,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:49:59,122 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 20:49:59,123 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:49:59,123 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:49:59,281 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c041c14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t817}
    * Task{4eb203 #817 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:49:59,282 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:49:59,282 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 20:49:59,282 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 20:49:59,282 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_204959_20250319_204959.png
2025-03-19 20:50:01,003 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_204959_20250319_204959.png
2025-03-19 20:50:01,003 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_204959_20250319_204959.png
2025-03-19 20:50:01,003 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:50:05,973 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 20:50:05,978 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 20:50:05,978 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 20:50:05,978 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:50:05,978 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:50:08,007 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 20:50:16,144 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 20:50:16,145 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:50:16,145 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:50:16,260 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c041c14 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t817}
    * Task{4eb203 #817 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:50:16,260 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:50:16,260 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 20:50:16,260 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 20:50:16,261 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_205016_20250319_205016.png
2025-03-19 20:50:18,005 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_205016_20250319_205016.png
2025-03-19 20:50:18,005 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_205016_20250319_205016.png
2025-03-19 20:50:18,005 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:50:22,612 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 20:50:22,615 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg
2025-03-19 20:50:22,616 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 20:50:22,616 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 20:50:22,616 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:50:22,616 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:50:24,803 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 20:50:24,804 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 20:50:24,804 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 20:50:24,804 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 20:50:25,814 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 20:50:26,820 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 20:50:26,820 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 20:50:26,820 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 158.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 20:50:26,820 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 20:50:36,832 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_204926.mp4 (大小: 2.82MB)
2025-03-19 20:50:36,832 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 20:50:36,941 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.159311秒，无需修复
2025-03-19 20:50:36,942 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 20:50:36,942 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_204926.mp4
2025-03-19 20:50:36,942 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 20:50:45,301 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_208.mp4
2025-03-19 20:50:45,306 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_208.mp4
2025-03-19 20:50:45,307 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:50:45,307 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:50:50,585 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:50:50,586 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_208.mp4
2025-03-19 20:50:50,586 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 20:50:50,587 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 20:50:50,587 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 20:50:51,024 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 20:50:52,028 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 20:50:52,028 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:50:52,028 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:50:53,125 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 20:50:53,126 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 20:50:53,126 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 20:50:55,220 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 20:50:55,220 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 20:50:56,383 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 20:50:56,384 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:50:56,384 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:50:57,517 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 20:50:57,518 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 20:50:57,518 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 20:50:57,519 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 20:48:39\n- 结束时间: 2025-03-19 20:50:57\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_84.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_208.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 20:50:57"}]}]}}
2025-03-19 20:50:57,876 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 20:50:57,878 - QuickAppADBTester - INFO - 测试完成
2025-03-19 20:55:57,969 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 20:55:57,971 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 20:55:57,971 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 20:55:57,971 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 20:55:58,098 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 20:55:58,230 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 20:55:58,230 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 20:55:58,230 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 20:55:58,230 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 20:55:58,497 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 20:55:58,497 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 20:55:58,498 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 20:55:58,498 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 20:55:59,981 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:55:59,982 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:56:01,203 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 20:56:01,203 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 20:56:01,203 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 20:56:01,203 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 20:56:01,203 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 20:56:01,354 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 20:56:01,355 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 20:56:01,355 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 20:56:01,355 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 20:56:02,762 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:56:02,763 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:56:04,024 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 20:56:04,025 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 20:56:04,025 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 20:56:04,025 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:56:04,025 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:56:05,124 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 20:56:05,124 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 20:56:05,236 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 20:56:07,247 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 20:56:07,247 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 20:56:08,325 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 20:56:08,326 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 20:56:08,326 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:56:08,326 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 20:56:08,402 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:56:10,413 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 20:56:10,414 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 20:56:12,577 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 20:56:12,577 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 20:56:14,656 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 20:56:14,657 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 20:56:15,759 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 20:56:15,760 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 20:56:15,760 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:56:15,760 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 20:56:15,832 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:56:17,844 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 20:56:17,844 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 20:56:19,991 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 20:56:19,992 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 20:56:21,394 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 20:56:22,872 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 20:56:22,873 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 20:56:24,047 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 20:56:24,047 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 20:56:25,150 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 20:56:25,151 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 20:56:27,306 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 20:56:27,307 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 20:56:27,307 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 20:56:27,307 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:56:27,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:56:28,487 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 20:56:28,488 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 20:56:28,598 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 20:56:33,608 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 20:56:33,608 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 20:56:35,721 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 20:56:35,722 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 20:56:40,850 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 20:56:40,851 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 20:56:43,016 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 20:56:48,023 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 20:56:48,024 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_205648.mp4
2025-03-19 20:56:48,024 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:56:48,024 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:56:53,292 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:56:53,292 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 20:56:53,332 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 20:56:54,550 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_205648.mp4
2025-03-19 20:56:54,550 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_205648.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 20:56:56,565 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 20:56:59,575 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 20:56:59,575 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 20:57:02,580 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 20:57:02,581 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 20:57:02,581 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 20:57:03,765 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 20:57:03,766 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 20:57:03,766 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 20:57:03,766 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 20:57:03,862 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 20:57:05,878 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 20:57:05,878 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 20:57:05,878 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 20:57:08,199 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 20:57:08,200 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 20:57:16,373 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 20:57:16,374 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 20:57:16,374 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 20:57:16,374 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:16,730 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 20:57:16,731 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:16,953 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 20:57:16,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:17,166 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 20:57:17,167 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:17,433 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 20:57:17,433 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:17,648 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 20:57:17,648 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:17,865 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 20:57:17,866 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:18,089 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 20:57:18,090 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:18,325 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 20:57:18,325 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:18,577 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 20:57:18,577 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 20:57:20,810 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 20:57:20,811 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:57:20,811 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:57:20,941 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{977b03 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t823}
    * Task{eb54fe #823 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:57:20,942 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:57:20,942 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 20:57:20,942 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 20:57:20,942 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_205720_20250319_205720.png
2025-03-19 20:57:22,515 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_205720_20250319_205720.png
2025-03-19 20:57:22,516 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_205720_20250319_205720.png
2025-03-19 20:57:22,516 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:57:29,536 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_209.jpg
2025-03-19 20:57:29,541 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_209.jpg
2025-03-19 20:57:29,541 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 20:57:29,541 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:57:29,541 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:57:29,764 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 20:57:39,686 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 20:57:39,688 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 20:57:39,688 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 20:57:39,808 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{977b03 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t823}
    * Task{eb54fe #823 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 20:57:39,808 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 20:57:39,809 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 20:57:39,810 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 20:57:39,811 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_205739_20250319_205739.png
2025-03-19 20:57:41,318 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_205739_20250319_205739.png
2025-03-19 20:57:41,318 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_205739_20250319_205739.png
2025-03-19 20:57:41,318 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 20:57:45,901 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_209.jpg
2025-03-19 20:57:45,905 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_209.jpg
2025-03-19 20:57:45,905 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 20:57:45,905 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 20:57:45,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:57:45,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:57:48,026 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 20:57:48,027 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 20:57:48,027 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 20:57:48,027 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 20:57:49,035 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 20:57:50,042 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 20:57:50,043 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 20:57:50,043 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 20:57:50,043 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 20:58:00,050 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_205648.mp4 (大小: 3.33MB)
2025-03-19 20:58:00,051 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 20:58:00,162 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.728033秒，无需修复
2025-03-19 20:58:00,162 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 20:58:00,162 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_205648.mp4
2025-03-19 20:58:00,162 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 20:58:07,207 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_210.mp4
2025-03-19 20:58:07,213 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_210.mp4
2025-03-19 20:58:07,213 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 20:58:07,213 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 20:58:12,491 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 20:58:12,491 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_210.mp4
2025-03-19 20:58:12,491 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 20:58:12,491 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 20:58:12,491 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 20:58:12,922 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 20:58:13,931 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 20:58:13,932 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:58:13,932 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:58:15,029 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 20:58:15,030 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 20:58:15,030 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 20:58:17,130 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 20:58:17,131 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 20:58:18,286 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 20:58:18,286 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 20:58:18,287 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 20:58:19,414 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 20:58:19,414 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 20:58:19,414 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 20:58:19,415 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 20:56:01\n- 结束时间: 2025-03-19 20:58:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_209.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_209.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_210.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 20:58:19"}]}]}}
2025-03-19 20:58:19,781 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 20:58:19,783 - QuickAppADBTester - INFO - 测试完成
2025-03-19 21:03:19,800 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 21:03:19,802 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 21:03:19,802 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 21:03:19,802 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 21:03:19,939 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 21:03:20,098 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 21:03:20,099 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 21:03:20,099 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:03:20,099 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:03:20,331 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:03:20,331 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:03:20,331 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:03:20,331 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:03:21,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:03:21,810 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:03:23,067 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:03:23,067 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 21:03:23,067 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 21:03:23,067 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:03:23,067 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:03:23,240 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:03:23,240 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:03:23,240 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:03:23,241 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:03:24,644 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:03:24,645 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:03:25,906 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:03:25,906 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 21:03:25,906 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:03:25,907 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:03:25,907 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:03:27,007 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 21:03:27,008 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 21:03:27,118 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 21:03:29,125 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 21:03:29,125 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 21:03:30,215 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 21:03:30,215 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 21:03:30,215 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:03:30,215 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 21:03:30,289 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:03:32,305 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 21:03:32,305 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 21:03:34,473 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 21:03:34,474 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 21:03:36,560 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 21:03:36,560 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 21:03:37,659 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 21:03:37,661 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 21:03:37,661 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:03:37,661 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 21:03:37,730 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:03:39,747 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 21:03:39,747 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 21:03:41,913 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 21:03:41,914 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 21:03:43,335 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 21:03:44,784 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 21:03:44,785 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 21:03:45,939 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 21:03:45,939 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 21:03:47,047 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 21:03:47,048 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 21:03:49,234 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 21:03:49,235 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 21:03:49,235 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:03:49,235 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:03:49,235 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:03:50,431 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 21:03:50,431 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 21:03:50,536 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 21:03:55,541 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 21:03:55,541 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 21:03:57,688 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 21:03:57,688 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 21:04:02,826 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 21:04:02,827 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 21:04:04,983 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 21:04:09,994 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 21:04:09,995 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_210409.mp4
2025-03-19 21:04:09,995 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:04:09,995 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:04:15,276 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:04:15,276 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 21:04:15,317 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 21:04:16,480 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_210409.mp4
2025-03-19 21:04:16,481 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_210409.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 21:04:18,493 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 21:04:21,500 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 21:04:21,501 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 21:04:24,507 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 21:04:24,507 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 21:04:24,507 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 21:04:25,686 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 21:04:25,687 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 21:04:25,687 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:04:25,687 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 21:04:25,781 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:04:27,792 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 21:04:27,792 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 21:04:27,792 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 21:04:30,061 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 21:04:30,061 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 21:04:38,209 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 21:04:38,211 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 21:04:38,211 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 21:04:38,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:38,488 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 21:04:38,488 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:38,704 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 21:04:38,705 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:38,984 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 21:04:38,984 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:39,241 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 21:04:39,242 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:39,457 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 21:04:39,458 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:39,766 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 21:04:39,766 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:40,010 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 21:04:40,011 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:40,289 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 21:04:40,289 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:40,524 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 21:04:40,525 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:04:42,773 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 21:04:42,774 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:04:42,774 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:04:42,884 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{137c6b4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t829}
    * Task{f43d523 #829 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:04:42,884 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:04:42,885 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 21:04:42,885 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 21:04:42,885 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_210442_20250319_210442.png
2025-03-19 21:04:44,608 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_210442_20250319_210442.png
2025-03-19 21:04:44,609 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_210442_20250319_210442.png
2025-03-19 21:04:44,609 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:04:51,707 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 21:04:51,834 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_211.jpg
2025-03-19 21:04:51,838 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_211.jpg
2025-03-19 21:04:51,839 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 21:04:51,839 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:04:51,839 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:05:01,950 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 21:05:01,951 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:05:01,951 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:05:02,073 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{137c6b4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t829}
    * Task{f43d523 #829 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:05:02,073 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:05:02,073 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 21:05:02,074 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 21:05:02,074 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_210502_20250319_210502.png
2025-03-19 21:05:03,632 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_210502_20250319_210502.png
2025-03-19 21:05:03,633 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_210502_20250319_210502.png
2025-03-19 21:05:03,633 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:05:08,266 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_211.jpg
2025-03-19 21:05:08,270 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_211.jpg
2025-03-19 21:05:08,270 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 21:05:08,270 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 21:05:08,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:05:08,270 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:05:10,378 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 21:05:10,378 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 21:05:10,378 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 21:05:10,378 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 21:05:11,388 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 21:05:12,394 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 21:05:12,395 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 21:05:12,395 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 146.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 21:05:12,395 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 21:05:22,402 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_210409.mp4 (大小: 3.34MB)
2025-03-19 21:05:22,403 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 21:05:22,518 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.169800秒，无需修复
2025-03-19 21:05:22,518 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 21:05:22,518 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_210409.mp4
2025-03-19 21:05:22,518 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 21:05:29,786 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_212.mp4
2025-03-19 21:05:29,790 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_212.mp4
2025-03-19 21:05:29,790 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:05:29,790 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:05:35,016 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:05:35,018 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_212.mp4
2025-03-19 21:05:35,018 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 21:05:35,018 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 21:05:35,018 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 21:05:35,430 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 21:05:36,440 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 21:05:36,441 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:05:36,441 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:05:37,540 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 21:05:37,540 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 21:05:37,540 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 21:05:39,640 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 21:05:39,640 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 21:05:40,793 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 21:05:40,794 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:05:40,794 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:05:41,887 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 21:05:41,888 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 21:05:41,888 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 21:05:41,888 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 21:03:23\n- 结束时间: 2025-03-19 21:05:41\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_211.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_211.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_212.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 21:05:41"}]}]}}
2025-03-19 21:05:42,260 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 21:05:42,262 - QuickAppADBTester - INFO - 测试完成
2025-03-19 21:10:42,342 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 21:10:42,344 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 21:10:42,344 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 21:10:42,344 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 21:10:42,464 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 21:10:42,608 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 21:10:42,609 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 21:10:42,609 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:10:42,609 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:10:42,836 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:10:42,836 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:10:42,836 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:10:42,836 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:10:44,321 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:10:44,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:10:45,564 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:10:45,564 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 21:10:45,564 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 21:10:45,564 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:10:45,564 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:10:45,696 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:10:45,697 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:10:45,697 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:10:45,697 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:10:47,088 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:10:47,088 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:10:48,323 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:10:48,323 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 21:10:48,324 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:10:48,324 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:10:48,324 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:10:49,412 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 21:10:49,413 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 21:10:49,520 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 21:10:51,526 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 21:10:51,526 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 21:10:52,613 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 21:10:52,614 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 21:10:52,614 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:10:52,614 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 21:10:52,685 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:10:54,701 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 21:10:54,702 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 21:10:56,869 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 21:10:56,870 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 21:10:58,944 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 21:10:58,945 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 21:11:00,040 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 21:11:00,041 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 21:11:00,041 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:11:00,041 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 21:11:00,111 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:11:02,127 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 21:11:02,127 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 21:11:04,283 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 21:11:04,284 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 21:11:05,693 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 21:11:07,184 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 21:11:07,185 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 21:11:08,371 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 21:11:08,371 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 21:11:09,474 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 21:11:09,475 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 21:11:11,637 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 21:11:11,638 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 21:11:11,638 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:11:11,638 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:11:11,638 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:11:12,818 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 21:11:12,818 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 21:11:12,940 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 21:11:17,947 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 21:11:17,947 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 21:11:20,102 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 21:11:20,102 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 21:11:25,254 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 21:11:25,255 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 21:11:27,415 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 21:11:32,420 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 21:11:32,420 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_211132.mp4
2025-03-19 21:11:32,421 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:11:32,421 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:11:37,699 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:11:37,700 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 21:11:37,739 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 21:11:38,902 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211132.mp4
2025-03-19 21:11:38,902 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211132.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 21:11:40,908 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 21:11:43,919 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 21:11:43,920 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 21:11:46,929 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 21:11:46,929 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 21:11:46,929 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 21:11:48,128 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 21:11:48,129 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 21:11:48,129 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:11:48,129 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 21:11:48,222 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:11:50,226 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 21:11:50,227 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 21:11:50,227 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 21:11:52,509 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 21:11:52,510 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 21:12:00,676 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 21:12:00,678 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 21:12:00,678 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 21:12:00,678 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:01,001 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 21:12:01,001 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:01,258 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 21:12:01,258 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:01,473 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 21:12:01,474 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:01,740 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 21:12:01,741 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:01,968 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 21:12:01,969 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:02,239 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 21:12:02,240 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:02,473 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 21:12:02,473 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:02,694 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 21:12:02,694 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:02,927 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 21:12:02,928 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:12:05,168 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 21:12:05,168 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:12:05,168 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:12:05,297 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{10a8681 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t835}
    * Task{b38fd14 #835 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:12:05,298 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:12:05,298 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 21:12:05,298 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 21:12:05,298 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_211205_20250319_211205.png
2025-03-19 21:12:07,051 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_211205_20250319_211205.png
2025-03-19 21:12:07,051 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_211205_20250319_211205.png
2025-03-19 21:12:07,051 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:12:14,139 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 21:12:14,410 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_213.jpg
2025-03-19 21:12:14,414 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_213.jpg
2025-03-19 21:12:14,414 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 21:12:14,414 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:12:14,414 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:12:24,594 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 21:12:24,595 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:12:24,595 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:12:24,741 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{10a8681 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t835}
    * Task{b38fd14 #835 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:12:24,741 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:12:24,741 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 21:12:24,741 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 21:12:24,741 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_211224_20250319_211224.png
2025-03-19 21:12:26,451 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_211224_20250319_211224.png
2025-03-19 21:12:26,453 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_211224_20250319_211224.png
2025-03-19 21:12:26,453 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:12:31,142 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_213.jpg
2025-03-19 21:12:31,145 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_213.jpg
2025-03-19 21:12:31,145 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 21:12:31,145 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 21:12:31,145 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:12:31,145 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:12:33,281 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 21:12:33,282 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 21:12:33,282 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 21:12:33,282 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 21:12:34,292 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 21:12:35,297 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 21:12:35,297 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 21:12:35,298 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 128.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 21:12:35,298 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 21:12:45,308 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211132.mp4 (大小: 4.38MB)
2025-03-19 21:12:45,309 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 21:12:45,466 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.518889秒，无需修复
2025-03-19 21:12:45,466 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 21:12:45,466 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211132.mp4
2025-03-19 21:12:45,466 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 21:12:52,782 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_214.mp4
2025-03-19 21:12:52,786 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_214.mp4
2025-03-19 21:12:52,786 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:12:52,786 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:12:58,065 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:12:58,066 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_214.mp4
2025-03-19 21:12:58,066 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 21:12:58,066 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 21:12:58,066 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 21:12:58,458 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 21:12:59,467 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 21:12:59,467 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:12:59,468 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:13:00,565 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 21:13:00,566 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 21:13:00,566 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 21:13:02,669 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 21:13:02,670 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 21:13:03,850 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 21:13:03,851 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:13:03,851 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:13:04,974 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 21:13:04,975 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 21:13:04,975 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 21:13:04,976 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 21:10:45\n- 结束时间: 2025-03-19 21:13:04\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_213.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_213.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_214.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 21:13:04"}]}]}}
2025-03-19 21:13:05,378 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 21:13:05,380 - QuickAppADBTester - INFO - 测试完成
2025-03-19 21:18:05,394 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 21:18:05,397 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 21:18:05,397 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 21:18:05,397 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 21:18:05,526 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 21:18:05,688 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 21:18:05,688 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 21:18:05,688 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:18:05,689 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:18:05,935 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:18:05,936 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:18:05,936 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:18:05,936 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:18:07,387 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:18:07,387 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:18:08,654 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:18:08,654 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 21:18:08,654 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 21:18:08,654 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:18:08,654 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:18:08,817 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:18:08,818 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:18:08,818 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:18:08,818 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:18:10,235 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:18:10,236 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:18:11,490 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:18:11,491 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 21:18:11,491 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:18:11,491 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:18:11,491 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:18:12,589 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 21:18:12,590 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 21:18:12,704 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 21:18:14,712 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 21:18:14,713 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 21:18:15,795 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 21:18:15,795 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 21:18:15,795 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:18:15,795 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 21:18:15,872 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:18:17,891 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 21:18:17,892 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 21:18:20,075 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 21:18:20,076 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 21:18:22,159 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 21:18:22,159 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 21:18:23,264 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 21:18:23,265 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 21:18:23,265 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:18:23,265 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 21:18:23,337 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:18:25,348 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 21:18:25,349 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 21:18:27,518 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 21:18:27,519 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 21:18:28,931 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 21:18:30,392 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 21:18:30,392 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 21:18:31,545 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 21:18:31,546 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 21:18:32,654 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 21:18:32,655 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 21:18:34,802 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 21:18:34,803 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 21:18:34,803 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:18:34,803 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:18:34,803 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:18:35,943 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 21:18:35,943 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 21:18:36,059 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 21:18:41,063 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 21:18:41,064 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 21:18:43,215 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 21:18:43,216 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 21:18:48,365 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 21:18:48,366 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 21:18:50,511 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 21:18:55,522 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 21:18:55,523 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_211855.mp4
2025-03-19 21:18:55,523 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:18:55,523 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:19:00,799 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:19:00,800 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 21:19:00,841 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 21:19:02,054 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211855.mp4
2025-03-19 21:19:02,054 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211855.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 21:19:04,069 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 21:19:07,078 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 21:19:07,079 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 21:19:10,088 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 21:19:10,089 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 21:19:10,089 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 21:19:11,248 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 21:19:11,248 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 21:19:11,249 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:19:11,249 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 21:19:11,344 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:19:13,361 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 21:19:13,362 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 21:19:13,362 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 21:19:15,660 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 21:19:15,661 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 21:19:23,818 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 21:19:23,819 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 21:19:23,819 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 21:19:23,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:24,120 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 21:19:24,121 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:24,337 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 21:19:24,337 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:24,587 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 21:19:24,587 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:24,830 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 21:19:24,831 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:25,084 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 21:19:25,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:25,337 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 21:19:25,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:25,561 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 21:19:25,561 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:25,822 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 21:19:25,822 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:26,080 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 21:19:26,080 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:19:28,334 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 21:19:28,335 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:19:28,335 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:19:28,448 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f6b3b49 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t841}
    * Task{eb3516f #841 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:19:28,449 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:19:28,449 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 21:19:28,449 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 21:19:28,449 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_211928_20250319_211928.png
2025-03-19 21:19:29,751 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_211928_20250319_211928.png
2025-03-19 21:19:29,751 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_211928_20250319_211928.png
2025-03-19 21:19:29,752 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:19:36,740 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_215.jpg
2025-03-19 21:19:36,743 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_215.jpg
2025-03-19 21:19:36,743 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 21:19:36,743 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:19:36,743 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:19:37,279 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 21:19:46,909 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 21:19:46,911 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:19:46,911 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:19:47,031 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f6b3b49 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t841}
    * Task{eb3516f #841 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:19:47,031 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:19:47,031 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 21:19:47,032 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 21:19:47,032 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_211947_20250319_211947.png
2025-03-19 21:19:48,407 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_211947_20250319_211947.png
2025-03-19 21:19:48,408 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_211947_20250319_211947.png
2025-03-19 21:19:48,408 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:19:52,925 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_215.jpg
2025-03-19 21:19:52,929 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_215.jpg
2025-03-19 21:19:52,929 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 21:19:52,929 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 21:19:52,929 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:19:52,929 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:19:55,103 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 21:19:55,103 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 21:19:55,103 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 21:19:55,103 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 21:19:56,108 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 21:19:57,117 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 21:19:57,118 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 21:19:57,118 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 21:19:57,118 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 21:20:07,124 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211855.mp4 (大小: 3.27MB)
2025-03-19 21:20:07,125 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 21:20:07,241 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.171489秒，无需修复
2025-03-19 21:20:07,241 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 21:20:07,241 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_211855.mp4
2025-03-19 21:20:07,241 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 21:20:14,416 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_216.mp4
2025-03-19 21:20:14,421 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_216.mp4
2025-03-19 21:20:14,422 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:20:14,422 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:20:19,645 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:20:19,646 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_216.mp4
2025-03-19 21:20:19,647 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 21:20:19,647 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 21:20:19,647 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 21:20:19,936 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 21:20:20,943 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 21:20:20,944 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:20:20,944 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:20:22,056 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 21:20:22,057 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 21:20:22,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 21:20:24,153 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 21:20:24,153 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 21:20:25,322 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 21:20:25,322 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:20:25,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:20:26,451 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 21:20:26,452 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 21:20:26,452 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 21:20:26,452 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 21:18:08\n- 结束时间: 2025-03-19 21:20:26\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_215.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_215.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_216.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 21:20:26"}]}]}}
2025-03-19 21:20:26,832 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 21:20:26,834 - QuickAppADBTester - INFO - 测试完成
2025-03-19 21:25:26,899 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 21:25:26,901 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 21:25:26,901 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 21:25:26,901 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 21:25:27,029 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 21:25:27,192 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 21:25:27,192 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 21:25:27,192 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:25:27,193 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:25:27,436 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:25:27,436 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:25:27,436 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:25:27,436 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:25:28,876 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:25:28,877 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:25:30,133 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:25:30,133 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 21:25:30,133 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 21:25:30,133 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:25:30,133 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:25:30,282 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:25:30,282 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:25:30,282 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:25:30,282 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:25:31,680 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:25:31,681 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:25:32,936 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:25:32,936 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 21:25:32,936 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:25:32,936 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:25:32,936 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:25:34,036 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 21:25:34,037 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 21:25:34,150 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 21:25:36,159 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 21:25:36,159 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 21:25:37,245 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 21:25:37,246 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 21:25:37,246 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:25:37,246 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 21:25:37,320 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:25:39,336 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 21:25:39,337 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 21:25:41,537 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 21:25:41,538 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 21:25:43,624 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 21:25:43,626 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 21:25:44,727 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 21:25:44,727 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 21:25:44,728 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:25:44,728 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 21:25:44,798 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:25:46,817 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 21:25:46,817 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 21:25:48,977 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 21:25:48,978 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 21:25:50,392 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 21:25:51,864 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 21:25:51,865 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 21:25:53,041 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 21:25:53,041 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 21:25:54,138 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 21:25:54,139 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 21:25:56,288 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 21:25:56,289 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 21:25:56,289 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:25:56,289 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:25:56,289 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:25:57,482 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 21:25:57,482 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 21:25:57,588 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 21:26:02,597 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 21:26:02,599 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 21:26:04,741 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 21:26:04,741 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 21:26:09,881 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 21:26:09,882 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 21:26:12,033 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 21:26:17,043 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 21:26:17,045 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_212617.mp4
2025-03-19 21:26:17,045 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:26:17,045 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:26:22,272 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:26:22,273 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 21:26:22,312 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 21:26:23,468 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_212617.mp4
2025-03-19 21:26:23,468 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_212617.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 21:26:25,481 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 21:26:28,493 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 21:26:28,493 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 21:26:31,501 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 21:26:31,501 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 21:26:31,501 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 21:26:32,663 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 21:26:32,664 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 21:26:32,664 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:26:32,664 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 21:26:32,751 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:26:34,770 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 21:26:34,770 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 21:26:34,770 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 21:26:37,053 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 21:26:37,054 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 21:26:45,247 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 21:26:45,249 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 21:26:45,249 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 21:26:45,249 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:45,612 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 21:26:45,613 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:45,825 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 21:26:45,826 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:46,102 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 21:26:46,103 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:46,320 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 21:26:46,321 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:46,540 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 21:26:46,540 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:46,755 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 21:26:46,756 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:46,993 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 21:26:46,994 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:47,229 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 21:26:47,230 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:47,488 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 21:26:47,489 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:26:49,736 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 21:26:49,737 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:26:49,737 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:26:49,851 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{559159a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t847}
    * Task{a747554 #847 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:26:49,851 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:26:49,851 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 21:26:49,851 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 21:26:49,852 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_212649_20250319_212649.png
2025-03-19 21:26:51,508 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_212649_20250319_212649.png
2025-03-19 21:26:51,509 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_212649_20250319_212649.png
2025-03-19 21:26:51,509 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:26:58,478 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_217.jpg
2025-03-19 21:26:58,482 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_217.jpg
2025-03-19 21:26:58,482 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 21:26:58,482 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:26:58,482 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:26:58,671 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 21:27:08,669 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 21:27:08,670 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:27:08,670 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:27:08,786 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{559159a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t847}
    * Task{a747554 #847 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:27:08,786 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:27:08,787 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 21:27:08,787 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 21:27:08,787 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_212708_20250319_212708.png
2025-03-19 21:27:10,506 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_212708_20250319_212708.png
2025-03-19 21:27:10,506 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_212708_20250319_212708.png
2025-03-19 21:27:10,507 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:27:16,248 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_218.jpg
2025-03-19 21:27:16,252 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_218.jpg
2025-03-19 21:27:16,252 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 21:27:16,252 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 21:27:16,252 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:27:16,252 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:27:18,354 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 21:27:18,355 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 21:27:18,355 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 21:27:18,355 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 21:27:19,363 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 21:27:20,369 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 21:27:20,370 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 21:27:20,370 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 130.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 21:27:20,370 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 21:27:30,373 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_212617.mp4 (大小: 3.80MB)
2025-03-19 21:27:30,374 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 21:27:30,489 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.076611秒，无需修复
2025-03-19 21:27:30,489 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 21:27:30,489 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_212617.mp4
2025-03-19 21:27:30,489 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 21:27:37,855 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_219.mp4
2025-03-19 21:27:37,859 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_219.mp4
2025-03-19 21:27:37,859 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:27:37,859 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:27:43,139 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:27:43,141 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_219.mp4
2025-03-19 21:27:43,141 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 21:27:43,141 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 21:27:43,141 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 21:27:43,539 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 21:27:44,544 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 21:27:44,545 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:27:44,545 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:27:45,635 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 21:27:45,635 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 21:27:45,635 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 21:27:47,721 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 21:27:47,721 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 21:27:48,876 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 21:27:48,876 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:27:48,876 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:27:49,997 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 21:27:49,998 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 21:27:49,998 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 21:27:49,998 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 21:25:30\n- 结束时间: 2025-03-19 21:27:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_217.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_218.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_219.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 21:27:49"}]}]}}
2025-03-19 21:27:50,343 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 21:27:50,346 - QuickAppADBTester - INFO - 测试完成
2025-03-19 21:32:50,451 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 21:32:50,452 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 21:32:50,452 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 21:32:50,452 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 21:32:50,554 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 21:32:50,700 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 21:32:50,700 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 21:32:50,700 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:32:50,700 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:32:50,864 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:32:50,864 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:32:50,864 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:32:50,864 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:32:52,324 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:32:52,325 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:32:53,558 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:32:53,558 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 21:32:53,558 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 21:32:53,558 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:32:53,559 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:32:53,704 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:32:53,704 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:32:53,704 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:32:53,704 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:32:55,102 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:32:55,103 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:32:56,321 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:32:56,321 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 21:32:56,322 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:32:56,322 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:32:56,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:32:57,422 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 21:32:57,423 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 21:32:57,540 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 21:32:59,549 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 21:32:59,549 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 21:33:00,640 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 21:33:00,641 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 21:33:00,641 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:33:00,641 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 21:33:00,712 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:33:02,725 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 21:33:02,726 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 21:33:04,906 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 21:33:04,908 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 21:33:06,993 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 21:33:06,994 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 21:33:08,098 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 21:33:08,099 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 21:33:08,099 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:33:08,099 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 21:33:08,191 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:33:10,206 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 21:33:10,206 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 21:33:12,384 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 21:33:12,385 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 21:33:13,792 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 21:33:15,251 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 21:33:15,251 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 21:33:16,427 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 21:33:16,427 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 21:33:17,531 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 21:33:17,532 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 21:33:19,694 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 21:33:19,695 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 21:33:19,695 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:33:19,695 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:33:19,695 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:33:20,843 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 21:33:20,844 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 21:33:20,952 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 21:33:25,955 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 21:33:25,955 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 21:33:28,118 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 21:33:28,119 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 21:33:33,255 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 21:33:33,255 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 21:33:35,415 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 21:33:40,425 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 21:33:40,425 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_213340.mp4
2025-03-19 21:33:40,426 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:33:40,426 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:33:45,708 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:33:45,708 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 21:33:45,732 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 21:33:46,893 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_213340.mp4
2025-03-19 21:33:46,893 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_213340.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 21:33:48,905 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 21:33:51,911 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 21:33:51,911 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 21:33:54,919 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 21:33:54,920 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 21:33:54,920 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 21:33:56,141 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 21:33:56,142 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 21:33:56,142 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:33:56,142 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 21:33:56,235 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:33:58,247 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 21:33:58,248 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 21:33:58,248 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 21:34:00,557 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 21:34:00,558 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 21:34:08,726 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 21:34:08,726 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 21:34:08,726 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 21:34:08,726 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:09,037 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 21:34:09,038 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:09,292 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 21:34:09,293 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:09,508 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 21:34:09,509 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:09,746 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 21:34:09,747 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:09,972 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 21:34:09,972 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:10,246 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 21:34:10,246 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:10,478 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 21:34:10,479 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:10,717 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 21:34:10,718 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:10,945 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 21:34:10,946 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:34:13,192 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 21:34:13,192 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:34:13,192 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:34:13,342 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{16f0d71 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t853}
    * Task{c0093d7 #853 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:34:13,343 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:34:13,343 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 21:34:13,343 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 21:34:13,343 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_213413_20250319_213413.png
2025-03-19 21:34:14,913 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_213413_20250319_213413.png
2025-03-19 21:34:14,914 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_213413_20250319_213413.png
2025-03-19 21:34:14,914 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:34:21,896 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_220.jpg
2025-03-19 21:34:21,900 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_220.jpg
2025-03-19 21:34:21,900 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 21:34:21,900 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:34:21,900 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:34:22,130 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 21:34:32,031 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 21:34:32,031 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:34:32,031 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:34:32,146 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{16f0d71 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t853}
    * Task{c0093d7 #853 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:34:32,147 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:34:32,147 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 21:34:32,147 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 21:34:32,147 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_213432_20250319_213432.png
2025-03-19 21:34:33,706 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_213432_20250319_213432.png
2025-03-19 21:34:33,706 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_213432_20250319_213432.png
2025-03-19 21:34:33,706 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:34:38,093 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_220.jpg
2025-03-19 21:34:38,097 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_220.jpg
2025-03-19 21:34:38,097 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 21:34:38,097 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 21:34:38,097 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:34:38,097 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:34:40,240 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 21:34:40,241 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 21:34:40,241 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 21:34:40,241 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 21:34:41,251 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 21:34:42,257 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 21:34:42,257 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 21:34:42,257 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 134.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 21:34:42,257 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 21:34:52,263 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_213340.mp4 (大小: 3.31MB)
2025-03-19 21:34:52,265 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 21:34:52,380 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.474289秒，无需修复
2025-03-19 21:34:52,380 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 21:34:52,380 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_213340.mp4
2025-03-19 21:34:52,380 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 21:34:59,406 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_221.mp4
2025-03-19 21:34:59,411 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_221.mp4
2025-03-19 21:34:59,411 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:34:59,411 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:35:04,635 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:35:04,636 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_221.mp4
2025-03-19 21:35:04,636 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 21:35:04,636 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 21:35:04,636 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 21:35:05,005 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 21:35:06,007 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 21:35:06,008 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:35:06,008 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:35:07,106 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 21:35:07,107 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 21:35:07,107 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 21:35:09,204 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 21:35:09,205 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 21:35:10,357 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 21:35:10,357 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:35:10,358 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:35:11,496 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 21:35:11,497 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 21:35:11,497 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 21:35:11,497 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 21:32:53\n- 结束时间: 2025-03-19 21:35:11\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_220.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_220.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_221.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 21:35:11"}]}]}}
2025-03-19 21:35:11,876 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 21:35:11,878 - QuickAppADBTester - INFO - 测试完成
2025-03-19 21:40:11,912 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 21:40:11,915 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 21:40:11,915 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 21:40:11,915 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 21:40:12,038 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 21:40:12,212 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 21:40:12,212 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 21:40:12,212 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:40:12,212 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:40:12,440 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:40:12,441 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:40:12,441 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:40:12,441 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:40:13,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:40:13,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:40:15,161 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:40:15,162 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 21:40:15,162 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 21:40:15,162 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 21:40:15,162 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 21:40:15,307 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 21:40:15,308 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 21:40:15,308 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 21:40:15,308 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 21:40:16,713 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:40:16,713 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:40:17,981 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 21:40:17,981 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 21:40:17,981 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:40:17,981 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:40:17,981 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:40:19,076 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 21:40:19,076 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 21:40:19,191 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 21:40:21,201 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 21:40:21,201 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 21:40:22,290 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 21:40:22,291 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 21:40:22,291 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:40:22,291 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 21:40:22,363 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:40:24,381 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 21:40:24,381 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 21:40:26,574 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 21:40:26,575 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 21:40:28,660 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 21:40:28,661 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 21:40:29,760 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 21:40:29,760 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 21:40:29,760 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:40:29,761 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 21:40:29,832 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:40:31,846 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 21:40:31,847 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 21:40:34,017 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 21:40:34,018 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 21:40:35,437 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 21:40:36,904 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 21:40:36,905 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 21:40:38,078 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 21:40:38,079 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 21:40:39,188 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 21:40:39,188 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 21:40:41,361 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 21:40:41,361 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 21:40:41,362 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 21:40:41,362 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:40:41,362 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:40:42,517 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 21:40:42,518 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 21:40:42,631 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 21:40:47,641 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 21:40:47,643 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 21:40:49,793 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 21:40:49,794 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 21:40:54,931 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 21:40:54,931 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 21:40:57,073 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 21:41:02,081 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 21:41:02,082 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_214102.mp4
2025-03-19 21:41:02,082 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:41:02,082 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:41:07,366 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:41:07,367 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 21:41:07,411 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 21:41:08,572 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_214102.mp4
2025-03-19 21:41:08,572 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_214102.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 21:41:10,587 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 21:41:13,592 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 21:41:13,592 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 21:41:16,601 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 21:41:16,601 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 21:41:16,601 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 21:41:17,765 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 21:41:17,766 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 21:41:17,766 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 21:41:17,766 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 21:41:17,859 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 21:41:19,877 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 21:41:19,877 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 21:41:19,877 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 21:41:22,142 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 21:41:22,143 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 21:41:30,300 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 21:41:30,302 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 21:41:30,302 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 21:41:30,302 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:30,636 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 21:41:30,638 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:30,890 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 21:41:30,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:31,099 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 21:41:31,099 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:31,343 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 21:41:31,344 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:31,591 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 21:41:31,592 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:31,860 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 21:41:31,861 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:32,106 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 21:41:32,106 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:32,326 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 21:41:32,326 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:32,565 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 21:41:32,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 21:41:34,801 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 21:41:34,801 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:41:34,801 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:41:34,909 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76c1952 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t859}
    * Task{51cd20 #859 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:41:34,909 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:41:34,909 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 21:41:34,909 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 21:41:34,910 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_214134_20250319_214134.png
2025-03-19 21:41:36,663 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_214134_20250319_214134.png
2025-03-19 21:41:36,663 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_214134_20250319_214134.png
2025-03-19 21:41:36,663 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:41:43,651 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_222.jpg
2025-03-19 21:41:43,653 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_222.jpg
2025-03-19 21:41:43,653 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 21:41:43,653 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:41:43,653 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:41:43,789 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 21:41:53,786 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 21:41:53,787 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 21:41:53,787 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 21:41:53,924 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{76c1952 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t859}
    * Task{51cd20 #859 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 21:41:53,925 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 21:41:53,925 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 21:41:53,925 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 21:41:53,925 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_214153_20250319_214153.png
2025-03-19 21:41:55,644 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_214153_20250319_214153.png
2025-03-19 21:41:55,644 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_214153_20250319_214153.png
2025-03-19 21:41:55,644 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 21:42:00,206 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_222.jpg
2025-03-19 21:42:00,210 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_222.jpg
2025-03-19 21:42:00,210 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 21:42:00,210 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 21:42:00,210 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:42:00,210 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:42:02,344 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 21:42:02,345 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 21:42:02,345 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 21:42:02,345 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 21:42:03,354 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 21:42:04,364 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 21:42:04,365 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 21:42:04,365 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 134.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 21:42:04,365 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 21:42:14,372 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_214102.mp4 (大小: 3.81MB)
2025-03-19 21:42:14,373 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 21:42:14,500 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.933289秒，无需修复
2025-03-19 21:42:14,500 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 21:42:14,500 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_214102.mp4
2025-03-19 21:42:14,500 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 21:42:21,746 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_223.mp4
2025-03-19 21:42:21,750 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_223.mp4
2025-03-19 21:42:21,750 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 21:42:21,750 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 21:42:26,969 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 21:42:26,970 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_223.mp4
2025-03-19 21:42:26,971 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 21:42:26,971 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 21:42:26,971 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 21:42:27,338 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 21:42:28,346 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 21:42:28,347 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:42:28,347 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:42:29,447 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 21:42:29,447 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 21:42:29,448 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 21:42:31,547 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 21:42:31,547 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 21:42:32,732 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 21:42:32,733 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 21:42:32,733 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 21:42:33,863 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 21:42:33,864 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 21:42:33,865 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 21:42:33,865 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 21:40:15\n- 结束时间: 2025-03-19 21:42:33\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_222.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_222.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_223.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 21:42:33"}]}]}}
2025-03-19 21:42:34,277 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 21:42:34,279 - QuickAppADBTester - INFO - 测试完成
2025-03-19 22:02:43,995 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 22:02:43,998 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 22:02:43,998 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 22:02:43,998 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 22:02:44,130 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 22:02:44,271 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 22:02:44,271 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 22:02:44,271 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:02:44,272 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:02:44,408 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:02:44,408 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:02:44,408 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:02:44,408 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:02:45,875 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:02:45,876 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:02:47,143 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:02:47,143 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 22:02:47,144 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 22:02:47,144 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:02:47,144 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:02:47,295 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:02:47,295 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:02:47,296 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:02:47,296 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:02:48,690 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:02:48,691 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:02:49,949 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:02:49,950 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 22:02:49,950 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:02:49,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:02:49,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:02:51,046 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 22:02:51,046 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 22:02:51,159 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 22:02:53,169 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 22:02:53,170 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 22:02:54,268 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 22:02:54,270 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 22:02:54,270 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:02:54,270 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 22:02:54,364 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:02:56,384 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 22:02:56,385 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 22:02:58,556 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 22:02:58,557 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 22:03:00,652 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 22:03:00,652 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 22:03:01,741 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 22:03:01,742 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 22:03:01,742 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:03:01,742 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 22:03:01,818 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:03:03,833 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 22:03:03,834 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 22:03:06,029 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 22:03:06,030 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 22:03:07,457 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 22:03:08,904 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 22:03:08,905 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 22:03:10,112 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 22:03:10,113 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 22:03:11,225 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 22:03:11,226 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 22:03:13,419 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 22:03:13,420 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 22:03:13,420 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:03:13,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:03:13,420 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:03:14,588 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 22:03:14,589 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 22:03:14,698 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 22:03:19,706 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 22:03:19,707 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 22:03:21,828 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 22:03:21,829 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 22:03:26,980 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 22:03:26,981 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 22:03:29,147 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 22:03:34,155 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 22:03:34,156 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_220334.mp4
2025-03-19 22:03:34,156 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:03:34,156 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:03:39,454 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:03:39,455 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 22:03:39,504 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 22:03:40,666 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_220334.mp4
2025-03-19 22:03:40,667 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_220334.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 22:03:42,675 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 22:03:45,680 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 22:03:45,680 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 22:03:48,688 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 22:03:48,688 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 22:03:48,689 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 22:03:49,885 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 22:03:49,886 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 22:03:49,886 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:03:49,886 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 22:03:49,980 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:03:51,995 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 22:03:51,996 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 22:03:51,996 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 22:20:00,578 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 22:20:00,629 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 22:20:08,820 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 22:20:08,821 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 22:20:08,821 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 22:20:08,821 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:09,213 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 22:20:09,214 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:09,475 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 22:20:09,476 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:09,759 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 22:20:09,760 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:09,989 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 22:20:09,993 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:10,206 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 22:20:10,206 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:10,468 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 22:20:10,469 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:10,737 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 22:20:10,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:10,977 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 22:20:10,978 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:11,244 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 22:20:11,245 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:20:13,510 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 22:20:13,511 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:20:13,511 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:20:13,655 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2a45dd9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t865}
    * Task{ef3fe95 #865 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:20:13,656 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:20:13,656 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 22:20:13,656 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 22:20:13,657 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_222013_20250319_222013.png
2025-03-19 22:20:15,512 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_222013_20250319_222013.png
2025-03-19 22:20:15,513 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_222013_20250319_222013.png
2025-03-19 22:20:15,513 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:20:16,097 - QuickAppADBTester - INFO - 录制进行中，已录制约 990 秒
2025-03-19 22:20:23,589 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_224.jpg
2025-03-19 22:20:23,594 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_224.jpg
2025-03-19 22:20:23,594 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 22:20:23,594 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:20:23,594 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:20:33,715 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 22:20:33,717 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:20:33,717 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:20:33,866 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2a45dd9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t865}
    * Task{ef3fe95 #865 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:20:33,866 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:20:33,866 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 22:20:33,867 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 22:20:33,867 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_222033_20250319_222033.png
2025-03-19 22:20:35,759 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_222033_20250319_222033.png
2025-03-19 22:20:35,760 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_222033_20250319_222033.png
2025-03-19 22:20:35,760 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:20:41,848 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_225.jpg
2025-03-19 22:20:41,855 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_225.jpg
2025-03-19 22:20:41,855 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 22:20:41,856 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 22:20:41,856 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:20:41,856 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:20:44,000 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 22:20:44,001 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 22:20:44,002 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 22:20:44,002 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 22:20:45,011 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 22:20:46,020 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 22:20:46,021 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 22:20:46,021 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 119.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 22:20:46,021 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 22:32:26,263 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_220334.mp4 (大小: 3.78MB)
2025-03-19 22:32:26,265 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 22:32:26,388 - QuickAppADBTester - INFO - 录制文件完整，时长: 1022.463978秒，无需修复
2025-03-19 22:32:26,388 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 22:32:26,388 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_220334.mp4
2025-03-19 22:32:26,388 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 22:32:52,318 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-19 22:32:52,327 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-19 22:32:52,330 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-19 22:32:52,330 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:32:52,331 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:32:57,553 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:32:57,555 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-19 22:32:57,555 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 22:32:57,555 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 22:32:57,555 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 22:32:58,022 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 22:32:59,031 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 22:32:59,031 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:32:59,032 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:33:00,138 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 22:33:00,139 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 22:33:00,139 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 22:33:02,257 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 22:33:02,258 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 22:33:03,383 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 22:33:03,384 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:33:03,385 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:33:04,538 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 22:33:04,539 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 22:33:04,539 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-19 22:33:04,540 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 22:02:47\n- 结束时间: 2025-03-19 22:33:04\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_224.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_225.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 22:33:04"}]}]}}
2025-03-19 22:33:04,973 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 22:33:04,976 - QuickAppADBTester - INFO - 测试完成
2025-03-19 22:38:05,148 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 22:38:05,149 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 22:38:05,149 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 22:38:05,149 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 22:38:05,290 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 22:38:05,449 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 22:38:05,450 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 22:38:05,450 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:38:05,450 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:38:05,670 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:38:05,670 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:38:05,671 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:38:05,671 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:38:07,170 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:38:07,171 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:38:08,458 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:38:08,458 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 22:38:08,458 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 22:38:08,458 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:38:08,458 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:38:08,624 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:38:08,624 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:38:08,625 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:38:08,625 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:38:10,038 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:38:10,039 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:38:11,319 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:38:11,320 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 22:38:11,320 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:38:11,320 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:38:11,320 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:38:12,419 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 22:38:12,420 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 22:38:12,556 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 22:38:14,561 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 22:38:14,562 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 22:38:15,659 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 22:38:15,660 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 22:38:15,660 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:38:15,660 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 22:38:15,750 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:38:17,762 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 22:38:17,763 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 22:38:19,929 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 22:38:19,930 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 22:38:22,022 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 22:38:22,022 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 22:38:23,121 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 22:38:23,123 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 22:38:23,123 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:38:23,123 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 22:38:23,218 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:38:25,233 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 22:38:25,233 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 22:38:27,409 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 22:38:27,410 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 22:38:28,830 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 22:38:30,297 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 22:38:30,298 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 22:38:31,453 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 22:38:31,455 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 22:38:32,559 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 22:38:32,560 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 22:38:34,744 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 22:38:34,745 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 22:38:34,745 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:38:34,745 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:38:34,745 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:38:35,927 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 22:38:35,928 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 22:38:36,045 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 22:38:41,052 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 22:38:41,053 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 22:38:43,267 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 22:38:43,268 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 22:38:48,417 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 22:38:48,418 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 22:38:50,587 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 22:38:55,594 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 22:38:55,594 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_223855.mp4
2025-03-19 22:38:55,594 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:38:55,595 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:39:00,888 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:39:00,889 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 22:39:00,934 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 22:39:02,092 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_223855.mp4
2025-03-19 22:39:02,092 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_223855.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 22:39:04,107 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 22:39:07,116 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 22:39:07,116 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 22:39:10,126 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 22:39:10,127 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 22:39:10,127 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 22:39:11,301 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 22:39:11,302 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 22:39:11,302 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:39:11,303 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 22:39:11,411 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:39:13,427 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 22:39:13,427 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 22:39:13,428 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 22:39:15,728 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 22:39:15,729 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 22:39:23,898 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 22:39:23,899 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 22:39:23,899 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 22:39:23,899 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:24,192 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 22:39:24,193 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:24,426 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 22:39:24,427 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:24,668 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 22:39:24,669 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:24,900 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 22:39:24,901 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:25,135 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 22:39:25,136 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:25,385 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 22:39:25,385 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:25,620 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 22:39:25,621 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:25,874 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 22:39:25,875 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:26,103 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 22:39:26,104 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:39:28,392 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 22:39:28,393 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:39:28,393 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:39:28,512 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f9ac94d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t871}
    * Task{757ad49 #871 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:39:28,513 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:39:28,513 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 22:39:28,513 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 22:39:28,513 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_223928_20250319_223928.png
2025-03-19 22:39:30,542 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_223928_20250319_223928.png
2025-03-19 22:39:30,542 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_223928_20250319_223928.png
2025-03-19 22:39:30,542 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:39:37,347 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 22:39:38,296 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_226.jpg
2025-03-19 22:39:38,302 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_226.jpg
2025-03-19 22:39:38,302 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 22:39:38,302 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:39:38,303 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:39:48,423 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 22:39:48,424 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:39:48,424 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:39:48,515 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f9ac94d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t871}
    * Task{757ad49 #871 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:39:48,515 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:39:48,515 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 22:39:48,515 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 22:39:48,515 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_223948_20250319_223948.png
2025-03-19 22:39:50,515 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_223948_20250319_223948.png
2025-03-19 22:39:50,515 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_223948_20250319_223948.png
2025-03-19 22:39:50,515 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:39:56,755 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_227.jpg
2025-03-19 22:39:56,761 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_227.jpg
2025-03-19 22:39:56,761 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 22:39:56,761 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 22:39:56,761 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:39:56,762 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:39:58,886 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 22:39:58,886 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 22:39:58,886 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 22:39:58,887 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 22:39:59,895 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 22:40:00,903 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 22:40:00,904 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 22:40:00,904 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 120.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 22:40:00,904 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 22:40:10,908 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_223855.mp4 (大小: 3.44MB)
2025-03-19 22:40:10,909 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 22:40:11,023 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.876711秒，无需修复
2025-03-19 22:40:11,023 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 22:40:11,023 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_223855.mp4
2025-03-19 22:40:11,023 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 22:40:18,339 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_228.mp4
2025-03-19 22:40:18,345 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_228.mp4
2025-03-19 22:40:18,345 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:40:18,345 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:40:23,637 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:40:23,639 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_228.mp4
2025-03-19 22:40:23,639 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 22:40:23,639 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 22:40:23,639 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 22:40:24,053 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 22:40:25,062 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 22:40:25,062 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:40:25,062 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:40:26,175 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 22:40:26,176 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 22:40:26,176 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 22:40:28,289 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 22:40:28,290 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 22:40:29,457 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 22:40:29,458 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:40:29,458 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:40:30,572 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 22:40:30,573 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 22:40:30,573 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 22:40:30,574 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 22:38:08\n- 结束时间: 2025-03-19 22:40:30\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_226.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_227.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_228.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 22:40:30"}]}]}}
2025-03-19 22:40:30,982 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 22:40:30,985 - QuickAppADBTester - INFO - 测试完成
2025-03-19 22:45:31,175 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 22:45:31,176 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 22:45:31,176 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 22:45:31,176 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 22:45:31,313 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 22:45:31,455 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 22:45:31,456 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 22:45:31,456 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:45:31,456 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:45:31,706 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:45:31,707 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:45:31,707 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:45:31,708 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:45:33,201 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:45:33,202 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:45:34,473 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:45:34,473 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 22:45:34,474 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 22:45:34,474 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:45:34,474 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:45:34,643 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:45:34,644 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:45:34,644 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:45:34,644 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:45:36,053 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:45:36,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:45:37,319 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:45:37,320 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 22:45:37,320 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:45:37,320 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:45:37,320 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:45:38,417 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 22:45:38,418 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 22:45:38,528 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 22:45:40,535 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 22:45:40,536 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 22:45:41,627 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 22:45:41,628 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 22:45:41,629 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:45:41,629 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 22:45:41,708 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:45:43,726 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 22:45:43,727 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 22:45:45,907 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 22:45:45,908 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 22:45:47,999 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 22:45:48,000 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 22:45:49,104 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 22:45:49,105 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 22:45:49,105 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:45:49,106 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 22:45:49,182 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:45:51,200 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 22:45:51,201 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 22:45:53,350 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 22:45:53,351 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 22:45:54,769 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 22:45:56,249 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 22:45:56,250 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 22:45:57,422 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 22:45:57,423 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 22:45:58,538 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 22:45:58,539 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 22:46:00,736 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 22:46:00,737 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 22:46:00,737 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:46:00,737 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:46:00,737 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:46:01,908 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 22:46:01,908 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 22:46:02,005 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 22:46:07,015 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 22:46:07,016 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 22:46:09,169 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 22:46:09,170 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 22:46:14,299 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 22:46:14,300 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 22:46:16,466 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 22:46:21,477 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 22:46:21,477 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_224621.mp4
2025-03-19 22:46:21,477 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:46:21,477 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:46:26,765 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:46:26,766 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 22:46:26,813 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 22:46:28,033 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_224621.mp4
2025-03-19 22:46:28,034 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_224621.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 22:46:30,051 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 22:46:33,057 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 22:46:33,057 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 22:46:36,059 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 22:46:36,059 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 22:46:36,059 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 22:46:37,240 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 22:46:37,240 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 22:46:37,240 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:46:37,240 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 22:46:37,330 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:46:39,350 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 22:46:39,351 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 22:46:39,351 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 22:46:41,656 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 22:46:41,657 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 22:46:49,843 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 22:46:49,844 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 22:46:49,844 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 22:46:49,844 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:50,115 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 22:46:50,116 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:50,338 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 22:46:50,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:50,591 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 22:46:50,592 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:50,828 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 22:46:50,829 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:51,069 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 22:46:51,069 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:51,324 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 22:46:51,324 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:51,562 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 22:46:51,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:51,792 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 22:46:51,793 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:52,054 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 22:46:52,054 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:46:54,357 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 22:46:54,358 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:46:54,358 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:46:54,510 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{42db8b7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t877}
    * Task{d88ef8d #877 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:46:54,511 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:46:54,511 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 22:46:54,511 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 22:46:54,511 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_224654_20250319_224654.png
2025-03-19 22:46:56,285 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_224654_20250319_224654.png
2025-03-19 22:46:56,286 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_224654_20250319_224654.png
2025-03-19 22:46:56,286 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:47:03,277 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 22:47:03,572 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_229.jpg
2025-03-19 22:47:03,579 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_229.jpg
2025-03-19 22:47:03,579 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 22:47:03,579 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:47:03,579 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:47:13,723 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 22:47:13,724 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:47:13,724 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:47:13,826 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{42db8b7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t877}
    * Task{d88ef8d #877 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:47:13,827 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:47:13,827 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 22:47:13,827 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 22:47:13,827 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_224713_20250319_224713.png
2025-03-19 22:47:15,531 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_224713_20250319_224713.png
2025-03-19 22:47:15,531 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_224713_20250319_224713.png
2025-03-19 22:47:15,531 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:47:20,268 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_229.jpg
2025-03-19 22:47:20,274 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_229.jpg
2025-03-19 22:47:20,275 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 22:47:20,275 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 22:47:20,275 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:47:20,275 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:47:22,440 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 22:47:22,441 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 22:47:22,442 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 22:47:22,442 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 22:47:23,449 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 22:47:24,459 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 22:47:24,460 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 22:47:24,460 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 149.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 22:47:24,460 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 22:47:34,470 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_224621.mp4 (大小: 3.63MB)
2025-03-19 22:47:34,470 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 22:47:34,572 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.521044秒，无需修复
2025-03-19 22:47:34,572 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 22:47:34,572 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_224621.mp4
2025-03-19 22:47:34,572 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 22:47:41,539 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_230.mp4
2025-03-19 22:47:41,545 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_230.mp4
2025-03-19 22:47:41,545 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:47:41,545 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:47:46,776 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:47:46,777 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_230.mp4
2025-03-19 22:47:46,777 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 22:47:46,777 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 22:47:46,778 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 22:47:47,130 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 22:47:48,138 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 22:47:48,139 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:47:48,139 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:47:49,241 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 22:47:49,242 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 22:47:49,242 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 22:47:51,354 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 22:47:51,355 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 22:47:52,529 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 22:47:52,530 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:47:52,530 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:47:53,687 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 22:47:53,688 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 22:47:53,688 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 22:47:53,689 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 22:45:34\n- 结束时间: 2025-03-19 22:47:53\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_229.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_229.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_230.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 22:47:53"}]}]}}
2025-03-19 22:47:54,072 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 22:47:54,075 - QuickAppADBTester - INFO - 测试完成
2025-03-19 22:52:54,314 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 22:52:54,315 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 22:52:54,315 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 22:52:54,315 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 22:52:54,460 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 22:52:54,618 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 22:52:54,619 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 22:52:54,619 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:52:54,619 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:52:54,865 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:52:54,865 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:52:54,866 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:52:54,866 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:52:56,357 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:52:56,358 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:52:57,641 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:52:57,642 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 22:52:57,642 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 22:52:57,642 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 22:52:57,642 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 22:52:57,801 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 22:52:57,802 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 22:52:57,802 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 22:52:57,803 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 22:52:59,209 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:52:59,210 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:53:00,475 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 22:53:00,475 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 22:53:00,476 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:53:00,476 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:53:00,476 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:53:01,564 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 22:53:01,565 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 22:53:01,691 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 22:53:03,700 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 22:53:03,700 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 22:53:04,794 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 22:53:04,795 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 22:53:04,795 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:53:04,795 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 22:53:04,873 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:53:06,891 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 22:53:06,891 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 22:53:09,107 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 22:53:09,108 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 22:53:11,199 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 22:53:11,200 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 22:53:12,303 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 22:53:12,304 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 22:53:12,304 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:53:12,304 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 22:53:12,379 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:53:14,390 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 22:53:14,390 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 22:53:16,601 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 22:53:16,602 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 22:53:18,023 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 22:53:19,498 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 22:53:19,499 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 22:53:20,693 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 22:53:20,694 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 22:53:21,804 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 22:53:21,805 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 22:53:23,993 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 22:53:23,994 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 22:53:23,994 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 22:53:23,994 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:53:23,995 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:53:25,123 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 22:53:25,124 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 22:53:25,252 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 22:53:30,254 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 22:53:30,254 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 22:53:32,406 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 22:53:32,407 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 22:53:37,554 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 22:53:37,555 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 22:53:39,700 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 22:53:44,705 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 22:53:44,705 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_225344.mp4
2025-03-19 22:53:44,706 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:53:44,706 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:53:50,001 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:53:50,002 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 22:53:50,049 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 22:53:51,206 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_225344.mp4
2025-03-19 22:53:51,207 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_225344.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 22:53:53,223 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 22:53:56,235 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 22:53:56,236 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 22:53:59,241 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 22:53:59,242 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 22:53:59,242 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 22:54:00,421 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 22:54:00,422 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 22:54:00,422 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 22:54:00,423 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 22:54:00,524 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 22:54:02,537 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 22:54:02,537 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 22:54:02,538 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 22:54:04,836 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 22:54:04,837 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 22:54:13,014 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 22:54:13,015 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 22:54:13,015 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 22:54:13,015 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:13,386 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 22:54:13,387 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:13,639 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 22:54:13,640 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:13,863 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 22:54:13,864 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:14,112 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 22:54:14,113 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:14,351 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 22:54:14,352 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:14,585 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 22:54:14,585 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:14,829 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 22:54:14,830 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:15,066 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 22:54:15,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:15,308 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 22:54:15,308 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 22:54:17,552 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 22:54:17,554 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:54:17,555 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:54:17,687 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c83a8d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t883}
    * Task{e0af289 #883 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:54:17,688 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:54:17,688 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 22:54:17,688 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 22:54:17,688 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_225417_20250319_225417.png
2025-03-19 22:54:19,366 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_225417_20250319_225417.png
2025-03-19 22:54:19,367 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_225417_20250319_225417.png
2025-03-19 22:54:19,367 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:54:26,446 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 22:54:27,285 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_231.jpg
2025-03-19 22:54:27,289 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_231.jpg
2025-03-19 22:54:27,290 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 22:54:27,290 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:54:27,290 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:54:37,403 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 22:54:37,405 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 22:54:37,405 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 22:54:37,546 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c83a8d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t883}
    * Task{e0af289 #883 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 22:54:37,547 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 22:54:37,547 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 22:54:37,547 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 22:54:37,547 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_225437_20250319_225437.png
2025-03-19 22:54:39,188 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_225437_20250319_225437.png
2025-03-19 22:54:39,188 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_225437_20250319_225437.png
2025-03-19 22:54:39,188 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 22:54:44,055 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_231.jpg
2025-03-19 22:54:44,057 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_231.jpg
2025-03-19 22:54:44,057 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 22:54:44,057 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 22:54:44,057 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:54:44,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:54:46,169 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 22:54:46,171 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 22:54:46,171 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 22:54:46,171 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 22:54:47,178 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 22:54:48,187 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 22:54:48,188 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 22:54:48,188 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 156.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 22:54:48,188 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 22:54:58,194 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_225344.mp4 (大小: 3.53MB)
2025-03-19 22:54:58,194 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 22:54:58,308 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.190678秒，无需修复
2025-03-19 22:54:58,308 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 22:54:58,308 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_225344.mp4
2025-03-19 22:54:58,308 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 22:55:05,658 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_232.mp4
2025-03-19 22:55:05,665 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_232.mp4
2025-03-19 22:55:05,665 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 22:55:05,665 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 22:55:10,958 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 22:55:10,960 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_232.mp4
2025-03-19 22:55:10,960 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 22:55:10,960 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 22:55:10,960 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 22:55:11,430 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 22:55:12,439 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 22:55:12,440 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:55:12,440 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:55:13,548 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 22:55:13,549 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 22:55:13,549 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 22:55:15,664 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 22:55:15,665 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 22:55:16,852 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 22:55:16,853 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 22:55:16,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 22:55:17,989 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 22:55:17,990 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 22:55:17,990 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 22:55:17,991 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 22:52:57\n- 结束时间: 2025-03-19 22:55:17\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_231.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_231.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_232.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 22:55:17"}]}]}}
2025-03-19 22:55:18,358 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 22:55:18,361 - QuickAppADBTester - INFO - 测试完成
2025-03-19 23:00:18,516 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 23:00:18,517 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 23:00:18,517 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 23:00:18,517 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 23:00:18,658 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 23:00:18,836 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 23:00:18,836 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 23:00:18,837 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:00:18,837 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:00:19,070 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:00:19,071 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:00:19,071 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:00:19,071 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:00:20,586 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:00:20,587 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:00:21,854 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:00:21,855 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 23:00:21,855 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 23:00:21,855 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:00:21,855 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:00:22,031 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:00:22,032 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:00:22,032 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:00:22,032 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:00:23,450 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:00:23,451 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:00:24,720 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:00:24,721 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 23:00:24,721 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:00:24,721 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:00:24,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:00:25,817 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 23:00:25,818 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 23:00:25,932 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 23:00:27,940 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 23:00:27,941 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 23:00:29,034 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 23:00:29,035 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 23:00:29,035 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:00:29,035 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 23:00:29,123 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:00:31,142 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 23:00:31,142 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 23:00:33,335 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 23:00:33,336 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 23:00:35,423 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 23:00:35,423 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 23:00:36,529 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 23:00:36,529 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 23:00:36,530 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:00:36,530 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 23:00:36,608 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:00:38,624 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 23:00:38,625 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 23:00:40,811 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 23:00:40,813 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 23:00:42,238 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 23:00:43,733 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 23:00:43,734 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 23:00:44,899 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 23:00:44,900 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 23:00:46,005 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 23:00:46,006 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 23:00:48,191 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 23:00:48,192 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 23:00:48,192 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:00:48,192 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:00:48,192 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:00:49,347 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 23:00:49,348 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 23:00:49,479 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 23:00:54,487 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 23:00:54,488 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 23:00:56,639 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 23:00:56,640 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 23:01:01,797 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 23:01:01,798 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 23:01:03,982 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 23:01:08,992 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 23:01:08,992 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_230108.mp4
2025-03-19 23:01:08,992 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:01:08,992 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:01:14,264 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:01:14,265 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 23:01:14,311 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 23:01:15,531 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230108.mp4
2025-03-19 23:01:15,532 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230108.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 23:01:17,550 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 23:01:20,557 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 23:01:20,557 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 23:01:23,566 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 23:01:23,567 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 23:01:23,567 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 23:01:24,745 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 23:01:24,746 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 23:01:24,746 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:01:24,746 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 23:01:24,847 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:01:26,857 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 23:01:26,858 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 23:01:26,858 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 23:01:29,162 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 23:01:29,162 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 23:01:37,347 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 23:01:37,348 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 23:01:37,348 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 23:01:37,348 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:37,704 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 23:01:37,705 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:37,953 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 23:01:37,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:38,182 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 23:01:38,183 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:38,421 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 23:01:38,422 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:38,644 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 23:01:38,645 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:38,862 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 23:01:38,863 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:39,084 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 23:01:39,084 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:39,344 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 23:01:39,345 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:39,586 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 23:01:39,587 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:01:41,811 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 23:01:41,812 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:01:41,812 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:01:41,968 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{33e0b7b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t889}
    * Task{50cc9f1 #889 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:01:41,969 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:01:41,969 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 23:01:41,969 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 23:01:41,970 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_230141_20250319_230141.png
2025-03-19 23:01:43,306 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_230141_20250319_230141.png
2025-03-19 23:01:43,307 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_230141_20250319_230141.png
2025-03-19 23:01:43,307 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:01:50,108 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_233.jpg
2025-03-19 23:01:50,113 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_233.jpg
2025-03-19 23:01:50,114 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 23:01:50,114 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:01:50,114 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:01:50,795 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 23:02:00,221 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 23:02:00,221 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:02:00,222 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:02:00,374 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{33e0b7b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t889}
    * Task{50cc9f1 #889 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:02:00,375 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:02:00,375 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 23:02:00,375 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 23:02:00,376 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_230200_20250319_230200.png
2025-03-19 23:02:01,774 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_230200_20250319_230200.png
2025-03-19 23:02:01,774 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_230200_20250319_230200.png
2025-03-19 23:02:01,774 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:02:06,434 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_233.jpg
2025-03-19 23:02:06,440 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_233.jpg
2025-03-19 23:02:06,440 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 23:02:06,440 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 23:02:06,441 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:02:06,441 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:02:08,619 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 23:02:08,620 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 23:02:08,620 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 23:02:08,620 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 23:02:09,626 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 23:02:10,629 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 23:02:10,629 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 23:02:10,630 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 173.0 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-19 23:02:10,630 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 23:02:20,640 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230108.mp4 (大小: 3.17MB)
2025-03-19 23:02:20,641 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 23:02:20,743 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.299033秒，无需修复
2025-03-19 23:02:20,744 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 23:02:20,744 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230108.mp4
2025-03-19 23:02:20,744 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 23:02:28,137 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_234.mp4
2025-03-19 23:02:28,141 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_234.mp4
2025-03-19 23:02:28,141 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:02:28,142 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:02:33,403 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:02:33,406 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_234.mp4
2025-03-19 23:02:33,406 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 23:02:33,406 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 23:02:33,406 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 23:02:33,799 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 23:02:34,806 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 23:02:34,807 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:02:34,807 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:02:35,919 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 23:02:35,919 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 23:02:35,919 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 23:02:38,022 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 23:02:38,023 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 23:02:39,184 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 23:02:39,185 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:02:39,186 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:02:40,325 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 23:02:40,326 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 23:02:40,327 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 23:02:40,327 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 23:00:21\n- 结束时间: 2025-03-19 23:02:40\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_233.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_233.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_234.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 23:02:40"}]}]}}
2025-03-19 23:02:40,696 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 23:02:40,699 - QuickAppADBTester - INFO - 测试完成
2025-03-19 23:07:40,888 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 23:07:40,890 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 23:07:40,890 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 23:07:40,890 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 23:07:41,017 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 23:07:41,174 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 23:07:41,174 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 23:07:41,174 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:07:41,175 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:07:41,414 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:07:41,414 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:07:41,415 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:07:41,415 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:07:42,919 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:07:42,920 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:07:44,186 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:07:44,187 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 23:07:44,187 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 23:07:44,187 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:07:44,187 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:07:44,327 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:07:44,327 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:07:44,327 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:07:44,327 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:07:45,736 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:07:45,737 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:07:47,022 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:07:47,022 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 23:07:47,022 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:07:47,022 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:07:47,022 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:07:48,124 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 23:07:48,125 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 23:07:48,236 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 23:07:50,245 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 23:07:50,246 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 23:07:51,342 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 23:07:51,343 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 23:07:51,343 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:07:51,344 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 23:07:51,425 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:07:53,440 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 23:07:53,440 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 23:07:55,645 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 23:07:55,646 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 23:07:57,740 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 23:07:57,741 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 23:07:58,846 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 23:07:58,847 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 23:07:58,847 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:07:58,847 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 23:07:58,924 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:08:00,939 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 23:08:00,939 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 23:08:03,146 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 23:08:03,147 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 23:08:04,574 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 23:08:06,040 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 23:08:06,040 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 23:08:07,187 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 23:08:07,188 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 23:08:08,301 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 23:08:08,302 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 23:08:10,484 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 23:08:10,484 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 23:08:10,485 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:08:10,485 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:08:10,485 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:08:11,648 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 23:08:11,649 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 23:08:11,757 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 23:08:16,763 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 23:08:16,763 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 23:08:18,920 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 23:08:18,921 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 23:08:24,063 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 23:08:24,064 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 23:08:26,227 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 23:08:31,238 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 23:08:31,238 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_230831.mp4
2025-03-19 23:08:31,239 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:08:31,239 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:08:36,533 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:08:36,534 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 23:08:36,580 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 23:08:37,796 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230831.mp4
2025-03-19 23:08:37,797 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230831.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 23:08:39,807 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 23:08:42,817 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 23:08:42,817 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 23:08:45,821 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 23:08:45,822 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 23:08:45,822 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 23:08:47,020 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 23:08:47,021 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 23:08:47,022 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:08:47,022 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 23:08:47,120 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:08:49,132 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 23:08:49,132 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 23:08:49,133 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 23:08:51,428 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 23:08:51,429 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 23:08:59,626 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 23:08:59,627 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 23:08:59,627 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 23:08:59,627 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:08:59,991 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 23:08:59,991 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:00,209 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 23:09:00,210 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:00,443 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 23:09:00,444 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:00,705 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 23:09:00,706 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:00,933 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 23:09:00,934 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:01,193 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 23:09:01,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:01,434 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 23:09:01,435 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:01,662 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 23:09:01,663 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:01,919 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 23:09:01,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:09:04,143 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 23:09:04,144 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:09:04,144 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:09:04,302 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4586435 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t895}
    * Task{bef123b #895 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:09:04,303 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:09:04,304 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 23:09:04,304 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 23:09:04,304 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_230904_20250319_230904.png
2025-03-19 23:09:06,258 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_230904_20250319_230904.png
2025-03-19 23:09:06,259 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_230904_20250319_230904.png
2025-03-19 23:09:06,259 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:09:13,004 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 23:09:14,300 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_235.jpg
2025-03-19 23:09:14,307 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_235.jpg
2025-03-19 23:09:14,307 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 23:09:14,307 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:09:14,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:09:24,445 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 23:09:24,446 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:09:24,446 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:09:24,574 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4586435 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t895}
    * Task{bef123b #895 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:09:24,575 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:09:24,575 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 23:09:24,575 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 23:09:24,576 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_230924_20250319_230924.png
2025-03-19 23:09:26,621 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_230924_20250319_230924.png
2025-03-19 23:09:26,622 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_230924_20250319_230924.png
2025-03-19 23:09:26,622 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:09:32,945 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_236.jpg
2025-03-19 23:09:32,950 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_236.jpg
2025-03-19 23:09:32,950 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 23:09:32,950 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 23:09:32,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:09:32,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:09:35,084 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 23:09:35,084 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 23:09:35,084 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 23:09:35,084 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 23:09:36,094 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 23:09:37,102 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 23:09:37,102 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 23:09:37,103 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 152.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 23:09:37,103 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 23:09:47,110 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230831.mp4 (大小: 3.43MB)
2025-03-19 23:09:47,111 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 23:09:47,222 - QuickAppADBTester - INFO - 录制文件完整，时长: 56.443689秒，无需修复
2025-03-19 23:09:47,223 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 23:09:47,223 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_230831.mp4
2025-03-19 23:09:47,223 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 23:09:54,869 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_237.mp4
2025-03-19 23:09:54,873 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_237.mp4
2025-03-19 23:09:54,874 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:09:54,874 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:10:00,102 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:10:00,104 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_237.mp4
2025-03-19 23:10:00,104 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 23:10:00,104 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 23:10:00,105 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 23:10:00,476 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 23:10:01,485 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 23:10:01,485 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:10:01,486 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:10:02,591 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 23:10:02,592 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 23:10:02,592 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 23:10:04,707 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 23:10:04,708 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 23:10:05,867 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 23:10:05,868 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:10:05,868 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:10:06,986 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 23:10:06,987 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 23:10:06,987 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 23:10:06,988 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 23:07:44\n- 结束时间: 2025-03-19 23:10:06\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_235.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_236.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_237.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 23:10:06"}]}]}}
2025-03-19 23:10:07,356 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 23:10:07,359 - QuickAppADBTester - INFO - 测试完成
2025-03-19 23:15:07,580 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 23:15:07,581 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 23:15:07,581 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 23:15:07,582 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 23:15:07,722 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 23:15:07,865 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 23:15:07,866 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 23:15:07,866 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:15:07,866 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:15:08,130 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:15:08,130 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:15:08,131 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:15:08,131 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:15:09,623 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:15:09,624 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:15:10,903 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:15:10,904 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 23:15:10,904 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 23:15:10,904 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:15:10,904 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:15:11,055 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:15:11,056 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:15:11,056 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:15:11,056 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:15:12,469 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:15:12,470 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:15:13,761 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:15:13,761 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 23:15:13,762 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:15:13,762 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:15:13,762 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:15:14,856 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 23:15:14,857 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 23:15:14,980 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 23:15:16,987 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 23:15:16,988 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 23:15:18,075 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 23:15:18,076 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 23:15:18,076 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:15:18,076 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 23:15:18,151 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:15:20,169 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 23:15:20,170 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 23:15:22,373 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 23:15:22,374 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 23:15:24,467 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 23:15:24,468 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 23:15:25,574 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 23:15:25,575 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 23:15:25,575 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:15:25,575 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 23:15:25,650 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:15:27,668 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 23:15:27,669 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 23:15:29,830 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 23:15:29,831 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 23:15:31,257 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 23:15:32,720 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 23:15:32,721 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 23:15:33,929 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 23:15:33,930 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 23:15:35,030 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 23:15:35,031 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 23:15:37,229 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 23:15:37,229 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 23:15:37,230 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:15:37,230 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:15:37,230 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:15:38,396 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 23:15:38,398 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 23:15:38,520 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 23:15:43,529 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 23:15:43,530 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 23:15:45,689 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 23:15:45,690 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 23:15:50,836 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 23:15:50,837 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 23:15:52,996 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 23:15:58,006 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 23:15:58,007 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_231558.mp4
2025-03-19 23:15:58,007 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:15:58,007 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:16:03,301 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:16:03,302 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 23:16:03,349 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 23:16:04,511 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_231558.mp4
2025-03-19 23:16:04,512 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_231558.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 23:16:06,527 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 23:16:09,539 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 23:16:09,540 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 23:16:12,544 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 23:16:12,544 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 23:16:12,544 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 23:16:13,774 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 23:16:13,775 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 23:16:13,775 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:16:13,775 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 23:16:13,877 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:16:15,895 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 23:16:15,895 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 23:16:15,895 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 23:16:18,212 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 23:16:18,213 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 23:16:26,405 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 23:16:26,406 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 23:16:26,406 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 23:16:26,407 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:26,737 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 23:16:26,738 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:26,972 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 23:16:26,973 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:27,204 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 23:16:27,205 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:27,439 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 23:16:27,440 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:27,694 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 23:16:27,695 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:27,918 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 23:16:27,919 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:28,197 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 23:16:28,198 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:28,437 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 23:16:28,438 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:28,704 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 23:16:28,705 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:16:30,959 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 23:16:30,960 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:16:30,960 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:16:31,085 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{93a6b52 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t901}
    * Task{f456f20 #901 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:16:31,086 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:16:31,086 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 23:16:31,086 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 23:16:31,086 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_231631_20250319_231631.png
2025-03-19 23:16:33,010 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_231631_20250319_231631.png
2025-03-19 23:16:33,012 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_231631_20250319_231631.png
2025-03-19 23:16:33,012 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:16:39,776 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 23:16:41,114 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_238.jpg
2025-03-19 23:16:41,119 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_238.jpg
2025-03-19 23:16:41,119 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 23:16:41,120 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:16:41,120 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:16:51,226 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 23:16:51,228 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:16:51,228 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:16:51,330 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{93a6b52 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t901}
    * Task{f456f20 #901 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:16:51,330 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:16:51,330 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 23:16:51,330 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 23:16:51,331 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_231651_20250319_231651.png
2025-03-19 23:16:53,251 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_231651_20250319_231651.png
2025-03-19 23:16:53,251 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_231651_20250319_231651.png
2025-03-19 23:16:53,251 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:16:58,609 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_238.jpg
2025-03-19 23:16:58,615 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_238.jpg
2025-03-19 23:16:58,615 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 23:16:58,616 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 23:16:58,616 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:16:58,616 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:17:00,737 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 23:17:00,738 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 23:17:00,738 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 23:17:00,739 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 23:17:01,743 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 23:17:02,751 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 23:17:02,751 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 23:17:02,752 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 157.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 23:17:02,752 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 23:17:12,762 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_231558.mp4 (大小: 3.68MB)
2025-03-19 23:17:12,763 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 23:17:12,873 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.392944秒，无需修复
2025-03-19 23:17:12,873 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 23:17:12,873 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_231558.mp4
2025-03-19 23:17:12,873 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 23:17:20,843 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_239.mp4
2025-03-19 23:17:20,849 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_239.mp4
2025-03-19 23:17:20,849 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:17:20,850 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:17:26,076 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:17:26,078 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_239.mp4
2025-03-19 23:17:26,078 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 23:17:26,078 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 23:17:26,078 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 23:17:26,495 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 23:17:27,505 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 23:17:27,506 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:17:27,506 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:17:28,609 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 23:17:28,610 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 23:17:28,610 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 23:17:30,726 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 23:17:30,727 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 23:17:31,902 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 23:17:31,903 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:17:31,903 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:17:33,049 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 23:17:33,050 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 23:17:33,051 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 23:17:33,051 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 23:15:10\n- 结束时间: 2025-03-19 23:17:33\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_238.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_238.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_239.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 23:17:33"}]}]}}
2025-03-19 23:17:33,439 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 23:17:33,442 - QuickAppADBTester - INFO - 测试完成
2025-03-19 23:22:33,672 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 23:22:33,674 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 23:22:33,674 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 23:22:33,674 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 23:22:33,805 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 23:22:33,933 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 23:22:33,934 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 23:22:33,934 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:22:33,934 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:22:34,192 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:22:34,193 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:22:34,193 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:22:34,193 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:22:35,687 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:22:35,688 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:22:36,951 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:22:36,951 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 23:22:36,952 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 23:22:36,952 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:22:36,952 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:22:37,115 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:22:37,115 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:22:37,116 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:22:37,116 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:22:38,533 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:22:38,534 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:22:39,825 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:22:39,826 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 23:22:39,826 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:22:39,826 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:22:39,826 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:22:40,918 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 23:22:40,918 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 23:22:41,043 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 23:22:43,045 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 23:22:43,046 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 23:22:44,145 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 23:22:44,146 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 23:22:44,146 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:22:44,146 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 23:22:44,239 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:22:46,250 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 23:22:46,251 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 23:22:48,440 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 23:22:48,441 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 23:22:50,532 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 23:22:50,533 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 23:22:51,641 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 23:22:51,642 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 23:22:51,642 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:22:51,642 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 23:22:51,733 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:22:53,746 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 23:22:53,746 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 23:22:55,906 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 23:22:55,907 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 23:22:57,323 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 23:22:58,820 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 23:22:58,821 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 23:23:00,005 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 23:23:00,006 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 23:23:01,112 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 23:23:01,112 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 23:23:03,282 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 23:23:03,283 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 23:23:03,283 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:23:03,283 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:23:03,284 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:23:04,447 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 23:23:04,448 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 23:23:04,559 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 23:23:09,570 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 23:23:09,571 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 23:23:11,728 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 23:23:11,729 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 23:23:16,913 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 23:23:16,913 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 23:23:19,073 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 23:23:24,079 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 23:23:24,079 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_232324.mp4
2025-03-19 23:23:24,080 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:23:24,080 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:23:29,372 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:23:29,373 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 23:23:29,418 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 23:23:30,570 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_232324.mp4
2025-03-19 23:23:30,571 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_232324.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 23:23:32,585 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 23:23:35,596 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 23:23:35,597 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 23:23:38,603 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 23:23:38,604 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 23:23:38,604 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 23:23:39,779 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 23:23:39,780 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 23:23:39,780 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:23:39,780 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 23:23:39,882 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:23:41,899 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 23:23:41,899 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 23:23:41,899 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 23:23:44,174 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 23:23:44,174 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 23:23:52,352 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 23:23:52,353 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 23:23:52,353 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 23:23:52,353 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:52,608 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 23:23:52,609 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:52,841 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 23:23:52,842 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:53,100 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 23:23:53,100 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:53,340 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 23:23:53,340 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:53,592 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 23:23:53,592 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:53,820 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 23:23:53,821 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:54,057 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 23:23:54,058 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:54,330 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 23:23:54,331 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:54,558 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 23:23:54,559 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:23:56,844 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 23:23:56,845 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:23:56,845 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:23:56,964 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{67afb6b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t907}
    * Task{7419361 #907 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:23:56,964 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:23:56,964 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 23:23:56,964 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 23:23:56,965 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_232356_20250319_232356.png
2025-03-19 23:23:58,540 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_232356_20250319_232356.png
2025-03-19 23:23:58,540 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_232356_20250319_232356.png
2025-03-19 23:23:58,540 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:24:05,747 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_240.jpg
2025-03-19 23:24:05,753 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_240.jpg
2025-03-19 23:24:05,753 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 23:24:05,754 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:24:05,754 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:24:05,831 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 23:24:15,863 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 23:24:15,863 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:24:15,863 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:24:15,983 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{67afb6b u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t907}
    * Task{7419361 #907 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:24:15,984 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:24:15,984 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 23:24:15,985 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 23:24:15,985 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_232415_20250319_232415.png
2025-03-19 23:24:17,564 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_232415_20250319_232415.png
2025-03-19 23:24:17,565 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_232415_20250319_232415.png
2025-03-19 23:24:17,565 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:24:22,676 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_240.jpg
2025-03-19 23:24:22,682 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_240.jpg
2025-03-19 23:24:22,682 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 23:24:22,682 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 23:24:22,683 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:24:22,683 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:24:24,855 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 23:24:24,856 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 23:24:24,857 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 23:24:24,857 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 23:24:25,860 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 23:24:26,869 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 23:24:26,870 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 23:24:26,870 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 154.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 23:24:26,870 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 23:24:36,879 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_232324.mp4 (大小: 3.39MB)
2025-03-19 23:24:36,879 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 23:24:36,983 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.404944秒，无需修复
2025-03-19 23:24:36,983 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 23:24:36,983 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_232324.mp4
2025-03-19 23:24:36,983 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 23:24:44,510 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_241.mp4
2025-03-19 23:24:44,516 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_241.mp4
2025-03-19 23:24:44,516 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:24:44,517 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:24:49,804 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:24:49,806 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_241.mp4
2025-03-19 23:24:49,806 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 23:24:49,806 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 23:24:49,806 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 23:24:50,224 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 23:24:51,232 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 23:24:51,233 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:24:51,233 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:24:52,336 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 23:24:52,337 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 23:24:52,338 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 23:24:54,453 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 23:24:54,454 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 23:24:55,609 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 23:24:55,610 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:24:55,611 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:24:56,725 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 23:24:56,726 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 23:24:56,726 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 23:24:56,727 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 23:22:36\n- 结束时间: 2025-03-19 23:24:56\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_240.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_240.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_241.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 23:24:56"}]}]}}
2025-03-19 23:24:57,083 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 23:24:57,085 - QuickAppADBTester - INFO - 测试完成
2025-03-19 23:29:57,308 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 23:29:57,309 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 23:29:57,310 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 23:29:57,310 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 23:29:57,443 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 23:29:57,602 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 23:29:57,602 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 23:29:57,603 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:29:57,603 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:29:57,854 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:29:57,855 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:29:57,855 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:29:57,855 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:29:59,354 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:29:59,355 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:30:00,633 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:30:00,634 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 23:30:00,634 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 23:30:00,634 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:30:00,634 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:30:00,776 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:30:00,777 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:30:00,777 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:30:00,777 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:30:02,180 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:30:02,181 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:30:03,453 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:30:03,454 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 23:30:03,454 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:30:03,454 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:30:03,454 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:30:04,551 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 23:30:04,552 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 23:30:04,668 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 23:30:06,678 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 23:30:06,678 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 23:30:07,768 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 23:30:07,768 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 23:30:07,769 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:30:07,769 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 23:30:07,844 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:30:09,864 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 23:30:09,865 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 23:30:12,039 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 23:30:12,040 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 23:30:14,129 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 23:30:14,130 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 23:30:15,235 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 23:30:15,236 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 23:30:15,236 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:30:15,236 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 23:30:15,314 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:30:17,330 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 23:30:17,331 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 23:30:19,531 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 23:30:19,532 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 23:30:20,950 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 23:30:22,408 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 23:30:22,409 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 23:30:23,595 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 23:30:23,595 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 23:30:24,695 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 23:30:24,696 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 23:30:26,841 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 23:30:26,842 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 23:30:26,842 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:30:26,842 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:30:26,842 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:30:28,007 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 23:30:28,008 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 23:30:28,123 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 23:30:33,133 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 23:30:33,133 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 23:30:35,297 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 23:30:35,298 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 23:30:40,488 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 23:30:40,489 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 23:30:42,645 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 23:30:47,649 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 23:30:47,650 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_233047.mp4
2025-03-19 23:30:47,650 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:30:47,650 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:30:52,942 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:30:52,943 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 23:30:52,987 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 23:30:54,205 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_233047.mp4
2025-03-19 23:30:54,206 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_233047.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 23:30:56,222 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 23:30:59,230 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 23:30:59,231 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 23:31:02,240 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 23:31:02,241 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 23:31:02,241 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 23:31:03,440 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 23:31:03,441 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 23:31:03,441 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:31:03,441 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 23:31:03,548 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:31:05,565 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-19 23:31:05,566 - QuickAppADBTester - INFO - 按下回车键
2025-03-19 23:31:05,566 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-19 23:31:07,828 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-19 23:31:07,829 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-19 23:31:16,029 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-19 23:31:16,030 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-19 23:31:16,030 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-19 23:31:16,030 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:16,388 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-19 23:31:16,388 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:16,622 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-19 23:31:16,623 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:16,861 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-19 23:31:16,862 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:17,133 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-19 23:31:17,134 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:17,378 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-19 23:31:17,379 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:17,622 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-19 23:31:17,623 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:17,881 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-19 23:31:17,882 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:18,131 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-19 23:31:18,132 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:18,362 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-19 23:31:18,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-19 23:31:20,603 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-19 23:31:20,604 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:31:20,604 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:31:20,716 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{29250a4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t913}
    * Task{bc39bd3 #913 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:31:20,717 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:31:20,717 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-19 23:31:20,717 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-19 23:31:20,717 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_233120_20250319_233120.png
2025-03-19 23:31:21,964 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_233120_20250319_233120.png
2025-03-19 23:31:21,965 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250319_233120_20250319_233120.png
2025-03-19 23:31:21,965 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:31:28,876 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg
2025-03-19 23:31:28,880 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg
2025-03-19 23:31:28,881 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-19 23:31:28,881 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:31:28,881 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:31:29,419 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-19 23:31:38,999 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-19 23:31:38,999 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-19 23:31:38,999 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-19 23:31:39,095 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{29250a4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t913}
    * Task{bc39bd3 #913 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-19 23:31:39,095 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-19 23:31:39,095 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-19 23:31:39,095 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-19 23:31:39,096 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_233139_20250319_233139.png
2025-03-19 23:31:40,296 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_233139_20250319_233139.png
2025-03-19 23:31:40,296 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250319_233139_20250319_233139.png
2025-03-19 23:31:40,297 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-19 23:31:45,194 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg
2025-03-19 23:31:45,199 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg
2025-03-19 23:31:45,199 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-19 23:31:45,199 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-19 23:31:45,199 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:31:45,199 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:31:47,313 - QuickAppADBTester - INFO - 停止录制...
2025-03-19 23:31:47,313 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-19 23:31:47,314 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-19 23:31:47,314 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-19 23:31:48,323 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-19 23:31:49,333 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-19 23:31:49,334 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-19 23:31:49,334 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 153.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-19 23:31:49,335 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-19 23:31:59,344 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_233047.mp4 (大小: 2.85MB)
2025-03-19 23:31:59,345 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-19 23:31:59,498 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.282378秒，无需修复
2025-03-19 23:31:59,498 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-19 23:31:59,498 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_233047.mp4
2025-03-19 23:31:59,498 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-19 23:32:07,273 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_243.mp4
2025-03-19 23:32:07,280 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_243.mp4
2025-03-19 23:32:07,280 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:32:07,280 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:32:12,510 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:32:12,511 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_243.mp4
2025-03-19 23:32:12,511 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-19 23:32:12,511 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-19 23:32:12,511 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-19 23:32:12,929 - QuickAppADBTester - INFO - 命令输出: 
2025-03-19 23:32:13,938 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-19 23:32:13,938 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:32:13,938 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:32:15,044 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-19 23:32:15,045 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-19 23:32:15,045 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-19 23:32:17,160 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-19 23:32:17,161 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-19 23:32:18,345 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-19 23:32:18,346 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:32:18,346 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:32:19,492 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-19 23:32:19,493 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-19 23:32:19,493 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-19 23:32:19,494 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 23:30:00\n- 结束时间: 2025-03-19 23:32:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_243.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-19 23:32:19"}]}]}}
2025-03-19 23:32:19,830 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-19 23:32:19,834 - QuickAppADBTester - INFO - 测试完成
2025-03-19 23:43:54,677 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-19 23:43:54,736 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-19 23:43:54,736 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-19 23:43:54,736 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-19 23:43:54,849 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-19 23:43:55,006 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-19 23:43:55,006 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-19 23:43:55,006 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:43:55,007 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:43:55,211 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:43:55,212 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:43:55,212 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:43:55,212 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:43:56,642 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:43:56,643 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:43:57,902 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:43:57,903 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-19 23:43:57,903 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-19 23:43:57,903 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-19 23:43:57,903 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-19 23:43:58,073 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-19 23:43:58,074 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-19 23:43:58,074 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-19 23:43:58,074 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-19 23:43:59,474 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:43:59,474 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:44:00,725 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-19 23:44:00,726 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-19 23:44:00,726 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:44:00,726 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:44:00,726 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:44:01,828 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-19 23:44:01,829 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-19 23:44:01,938 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-19 23:44:03,946 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-19 23:44:03,947 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-19 23:44:05,041 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-19 23:44:05,042 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-19 23:44:05,042 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:44:05,042 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-19 23:44:05,139 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:44:07,161 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-19 23:44:07,161 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-19 23:44:09,338 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-19 23:44:09,339 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-19 23:44:11,431 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-19 23:44:11,432 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-19 23:44:12,543 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-19 23:44:12,544 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-19 23:44:12,544 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:44:12,544 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-19 23:44:12,618 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-19 23:44:14,640 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-19 23:44:14,640 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-19 23:44:16,825 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-19 23:44:16,826 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-19 23:44:18,259 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-19 23:44:19,747 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-19 23:44:19,748 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-19 23:44:20,912 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-19 23:44:20,913 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-19 23:44:22,025 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-19 23:44:22,026 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-19 23:44:24,199 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-19 23:44:24,200 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-19 23:44:24,200 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-19 23:44:24,200 - QuickAppADBTester - INFO - 按下Home键
2025-03-19 23:44:24,200 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-19 23:44:25,372 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-19 23:44:25,373 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-19 23:44:25,491 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-19 23:44:30,500 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-19 23:44:30,501 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-19 23:44:32,651 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-19 23:44:32,652 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-19 23:44:37,782 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-19 23:44:37,783 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-19 23:44:39,945 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-19 23:59:42,696 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-19 23:59:42,698 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250319_235942.mp4
2025-03-19 23:59:42,698 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-19 23:59:42,698 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-19 23:59:47,992 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-19 23:59:47,993 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-19 23:59:48,035 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-19 23:59:49,195 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_235942.mp4
2025-03-19 23:59:49,196 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_235942.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-19 23:59:51,213 - QuickAppADBTester - INFO - 录制已开始...
2025-03-19 23:59:54,224 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-19 23:59:54,224 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-19 23:59:57,233 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-19 23:59:57,233 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-19 23:59:57,234 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-19 23:59:58,430 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-19 23:59:58,431 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-19 23:59:58,431 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-19 23:59:58,431 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-19 23:59:58,533 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:00:00,545 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 00:00:00,546 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 00:00:00,546 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 00:00:02,782 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 00:00:02,782 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 00:00:10,948 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 00:00:10,950 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 00:00:10,950 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 00:00:10,950 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:11,305 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 00:00:11,306 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:11,570 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 00:00:11,571 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:11,803 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 00:00:11,804 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:12,043 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 00:00:12,044 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:12,271 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 00:00:12,272 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:12,512 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 00:00:12,513 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:12,752 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 00:00:12,753 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:13,030 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 00:00:13,031 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:13,297 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 00:00:13,298 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:00:15,524 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 00:00:15,525 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:00:15,525 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:00:15,641 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{711acad u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t919}
    * Task{1cb4a30 #919 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:00:15,641 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:00:15,641 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 00:00:15,642 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 00:00:15,642 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_000015_20250320_000015.png
2025-03-20 00:00:17,079 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_000015_20250320_000015.png
2025-03-20 00:00:17,080 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_000015_20250320_000015.png
2025-03-20 00:00:17,080 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:00:24,440 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 00:00:24,592 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_244.jpg
2025-03-20 00:00:24,598 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_244.jpg
2025-03-20 00:00:24,598 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 00:00:24,599 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:00:24,599 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:17:23,307 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 00:17:23,308 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:17:23,308 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:17:23,449 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{711acad u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t919}
    * Task{1cb4a30 #919 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:17:23,450 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:17:23,450 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 00:17:23,450 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 00:17:23,450 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_001723_20250320_001723.png
2025-03-20 00:17:24,770 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_001723_20250320_001723.png
2025-03-20 00:17:24,770 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_001723_20250320_001723.png
2025-03-20 00:17:24,771 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:17:25,029 - QuickAppADBTester - INFO - 录制进行中，已录制约 1050 秒
2025-03-20 00:17:51,743 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 00:17:51,746 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 00:17:51,749 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-20 00:17:51,750 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 00:17:51,750 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 00:17:51,750 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:17:51,750 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:17:53,871 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 00:17:53,872 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 00:17:53,872 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 00:17:53,872 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 00:17:54,237 - QuickAppADBTester - INFO - 录制进行中，已录制约 1080 秒
2025-03-20 00:17:54,878 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 00:17:55,888 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 00:17:55,889 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 00:17:55,889 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 163.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 00:17:55,890 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 00:34:07,500 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_235942.mp4 (大小: 3.07MB)
2025-03-20 00:34:07,500 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 00:34:07,625 - QuickAppADBTester - INFO - 录制文件完整，时长: 1083.805700秒，无需修复
2025-03-20 00:34:07,625 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 00:34:07,625 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250319_235942.mp4
2025-03-20 00:34:07,625 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 00:34:16,798 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_245.mp4
2025-03-20 00:34:16,804 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_245.mp4
2025-03-20 00:34:16,804 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:34:16,804 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:34:22,099 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:34:22,101 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_245.mp4
2025-03-20 00:34:22,102 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 00:34:22,102 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 00:34:22,102 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 00:34:22,478 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 00:34:23,489 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 00:34:23,489 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:34:23,489 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:34:24,599 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 00:34:24,600 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 00:34:24,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 00:34:26,703 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 00:34:26,704 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 00:34:27,858 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 00:34:27,858 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:34:27,859 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:34:28,972 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 00:34:28,974 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 00:34:28,974 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-20 00:34:28,975 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-19 23:43:57\n- 结束时间: 2025-03-20 00:34:28\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_244.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_245.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 00:34:28"}]}]}}
2025-03-20 00:34:29,393 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 00:34:29,395 - QuickAppADBTester - INFO - 测试完成
2025-03-20 00:39:29,489 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 00:39:29,491 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 00:39:29,491 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 00:39:29,491 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 00:39:29,614 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 00:39:29,785 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 00:39:29,785 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 00:39:29,785 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 00:39:29,785 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 00:39:29,979 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 00:39:29,979 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 00:39:29,979 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 00:39:29,979 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 00:39:31,459 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:39:31,460 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:39:32,717 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 00:39:32,717 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 00:39:32,717 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 00:39:32,717 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 00:39:32,717 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 00:39:32,866 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 00:39:32,866 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 00:39:32,866 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 00:39:32,866 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 00:39:34,262 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:39:34,263 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:39:35,532 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 00:39:35,533 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 00:39:35,533 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 00:39:35,533 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:39:35,533 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:39:36,624 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 00:39:36,625 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 00:39:36,730 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 00:39:38,738 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 00:39:38,739 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 00:39:39,800 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 00:39:39,800 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 00:39:39,800 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:39:39,800 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 00:39:39,863 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:39:41,878 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 00:39:41,879 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 00:39:44,068 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 00:39:44,069 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 00:39:46,152 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 00:39:46,153 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 00:39:47,253 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 00:39:47,253 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 00:39:47,253 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:39:47,254 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 00:39:47,322 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:39:49,342 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 00:39:49,343 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 00:39:51,552 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 00:39:51,553 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 00:39:52,971 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 00:39:54,429 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 00:39:54,429 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 00:39:55,617 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 00:39:55,618 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 00:39:56,725 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 00:39:56,726 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 00:39:58,909 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 00:39:58,910 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 00:39:58,910 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 00:39:58,910 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:39:58,910 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:40:00,096 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 00:40:00,097 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 00:40:00,210 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 00:40:05,219 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 00:40:05,219 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 00:40:07,662 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 00:40:07,664 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 00:40:12,795 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 00:40:12,796 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 00:40:14,950 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 00:40:19,957 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 00:40:19,958 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_004019.mp4
2025-03-20 00:40:19,958 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:40:19,958 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:40:25,245 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:40:25,246 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 00:40:25,287 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 00:40:26,449 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004019.mp4
2025-03-20 00:40:26,449 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004019.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 00:40:28,463 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 00:40:31,472 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 00:40:31,472 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 00:40:34,479 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 00:40:34,480 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 00:40:34,480 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 00:40:35,685 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 00:40:35,686 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 00:40:35,686 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:40:35,686 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 00:40:35,774 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:40:37,784 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 00:40:37,784 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 00:40:37,784 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 00:40:40,043 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 00:40:40,043 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 00:40:48,226 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 00:40:48,227 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 00:40:48,227 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 00:40:48,227 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:48,546 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 00:40:48,547 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:48,793 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 00:40:48,793 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:49,048 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 00:40:49,048 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:49,266 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 00:40:49,267 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:49,485 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 00:40:49,485 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:49,700 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 00:40:49,700 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:49,932 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 00:40:49,932 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:50,183 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 00:40:50,183 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:50,400 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 00:40:50,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:40:52,629 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 00:40:52,629 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:40:52,629 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:40:52,717 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9014693 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t925}
    * Task{2efb8ef #925 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:40:52,718 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:40:52,718 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 00:40:52,718 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 00:40:52,718 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_004052_20250320_004052.png
2025-03-20 00:40:53,987 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_004052_20250320_004052.png
2025-03-20 00:40:53,987 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_004052_20250320_004052.png
2025-03-20 00:40:53,987 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:41:00,959 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg
2025-03-20 00:41:00,964 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg
2025-03-20 00:41:00,964 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 00:41:00,964 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:41:00,964 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:41:01,682 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 00:41:11,112 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 00:41:11,113 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:41:11,113 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:41:11,245 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9014693 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t925}
    * Task{2efb8ef #925 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:41:11,246 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:41:11,246 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 00:41:11,246 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 00:41:11,246 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_004111_20250320_004111.png
2025-03-20 00:41:12,573 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_004111_20250320_004111.png
2025-03-20 00:41:12,573 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_004111_20250320_004111.png
2025-03-20 00:41:12,573 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:41:17,210 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg
2025-03-20 00:41:17,214 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg
2025-03-20 00:41:17,215 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 00:41:17,215 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 00:41:17,215 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:41:17,215 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:41:19,330 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 00:41:19,331 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 00:41:19,331 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 00:41:19,331 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 00:41:20,336 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 00:41:21,345 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 00:41:21,346 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 00:41:21,346 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 00:41:21,346 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 00:41:31,348 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004019.mp4 (大小: 2.95MB)
2025-03-20 00:41:31,350 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 00:41:31,490 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.034144秒，无需修复
2025-03-20 00:41:31,490 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 00:41:31,490 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004019.mp4
2025-03-20 00:41:31,490 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 00:41:39,301 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_247.mp4
2025-03-20 00:41:39,305 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_247.mp4
2025-03-20 00:41:39,306 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:41:39,306 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:41:44,589 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:41:44,590 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_247.mp4
2025-03-20 00:41:44,590 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 00:41:44,590 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 00:41:44,590 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 00:41:45,039 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 00:41:46,048 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 00:41:46,049 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:41:46,049 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:41:47,160 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 00:41:47,161 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 00:41:47,161 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 00:41:49,263 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 00:41:49,263 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 00:41:50,443 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 00:41:50,444 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:41:50,444 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:41:51,545 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 00:41:51,546 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 00:41:51,546 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 00:41:51,547 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 00:39:32\n- 结束时间: 2025-03-20 00:41:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_247.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 00:41:51"}]}]}}
2025-03-20 00:41:51,922 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 00:41:51,924 - QuickAppADBTester - INFO - 测试完成
2025-03-20 00:46:51,987 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 00:46:51,989 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 00:46:51,989 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 00:46:51,989 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 00:46:52,108 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 00:46:52,242 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 00:46:52,243 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 00:46:52,243 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 00:46:52,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 00:46:52,513 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 00:46:52,514 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 00:46:52,514 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 00:46:52,514 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 00:46:53,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:46:53,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:46:55,219 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 00:46:55,220 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 00:46:55,220 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 00:46:55,220 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 00:46:55,220 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 00:46:55,366 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 00:46:55,366 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 00:46:55,366 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 00:46:55,366 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 00:46:56,776 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:46:56,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:46:58,053 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 00:46:58,054 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 00:46:58,054 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 00:46:58,054 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:46:58,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:46:59,158 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 00:46:59,158 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 00:46:59,266 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 00:47:01,274 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 00:47:01,274 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 00:47:02,359 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 00:47:02,360 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 00:47:02,360 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:47:02,360 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 00:47:02,435 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:47:04,455 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 00:47:04,455 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 00:47:06,642 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 00:47:06,642 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 00:47:08,719 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 00:47:08,719 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 00:47:09,800 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 00:47:09,801 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 00:47:09,801 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:47:09,801 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 00:47:09,868 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:47:11,880 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 00:47:11,880 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 00:47:14,057 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 00:47:14,057 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 00:47:15,476 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 00:47:16,950 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 00:47:16,951 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 00:47:18,133 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 00:47:18,133 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 00:47:19,242 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 00:47:19,243 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 00:47:21,432 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 00:47:21,433 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 00:47:21,433 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 00:47:21,433 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:47:21,433 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:47:22,601 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 00:47:22,602 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 00:47:22,708 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 00:47:27,714 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 00:47:27,716 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 00:47:29,829 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 00:47:29,829 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 00:47:34,973 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 00:47:34,974 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 00:47:37,123 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 00:47:42,130 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 00:47:42,131 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_004742.mp4
2025-03-20 00:47:42,131 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:47:42,131 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:47:47,417 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:47:47,417 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 00:47:47,458 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 00:47:48,669 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004742.mp4
2025-03-20 00:47:48,670 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004742.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 00:47:50,678 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 00:47:53,685 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 00:47:53,685 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 00:47:56,694 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 00:47:56,695 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 00:47:56,695 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 00:47:57,871 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 00:47:57,872 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 00:47:57,872 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:47:57,872 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 00:47:57,967 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:47:59,978 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 00:47:59,979 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 00:47:59,980 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 00:48:02,240 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 00:48:02,241 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 00:48:10,425 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 00:48:10,427 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 00:48:10,427 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 00:48:10,427 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:10,723 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 00:48:10,724 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:10,962 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 00:48:10,962 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:11,187 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 00:48:11,188 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:11,415 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 00:48:11,416 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:11,677 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 00:48:11,678 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:11,939 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 00:48:11,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:12,188 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 00:48:12,189 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:12,453 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 00:48:12,454 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:12,691 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 00:48:12,692 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:48:14,936 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 00:48:14,937 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:48:14,937 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:48:15,035 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3d83b1 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t931}
    * Task{ca54004 #931 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:48:15,036 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:48:15,036 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 00:48:15,036 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 00:48:15,036 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_004815_20250320_004815.png
2025-03-20 00:48:16,289 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_004815_20250320_004815.png
2025-03-20 00:48:16,289 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_004815_20250320_004815.png
2025-03-20 00:48:16,289 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:48:23,424 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_248.jpg
2025-03-20 00:48:23,428 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_248.jpg
2025-03-20 00:48:23,429 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 00:48:23,429 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:48:23,429 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:48:23,897 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 00:48:33,545 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 00:48:33,546 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:48:33,546 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:48:33,649 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3d83b1 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t931}
    * Task{ca54004 #931 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:48:33,649 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:48:33,650 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 00:48:33,650 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 00:48:33,650 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_004833_20250320_004833.png
2025-03-20 00:48:34,918 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_004833_20250320_004833.png
2025-03-20 00:48:34,918 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_004833_20250320_004833.png
2025-03-20 00:48:34,918 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:48:39,384 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_248.jpg
2025-03-20 00:48:39,388 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_248.jpg
2025-03-20 00:48:39,388 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 00:48:39,388 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 00:48:39,389 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:48:39,389 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:48:41,542 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 00:48:41,542 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 00:48:41,542 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 00:48:41,543 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 00:48:42,550 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 00:48:43,558 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 00:48:43,559 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 00:48:43,559 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 136.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 00:48:43,559 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 00:48:53,569 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004742.mp4 (大小: 3.07MB)
2025-03-20 00:48:53,569 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 00:48:53,682 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.075611秒，无需修复
2025-03-20 00:48:53,682 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 00:48:53,682 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_004742.mp4
2025-03-20 00:48:53,682 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 00:49:01,235 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_249.mp4
2025-03-20 00:49:01,239 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_249.mp4
2025-03-20 00:49:01,239 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:49:01,239 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:49:06,526 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:49:06,527 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_249.mp4
2025-03-20 00:49:06,527 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 00:49:06,527 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 00:49:06,527 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 00:49:06,963 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 00:49:07,970 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 00:49:07,970 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:49:07,970 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:49:09,067 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 00:49:09,067 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 00:49:09,067 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 00:49:11,154 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 00:49:11,155 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 00:49:12,317 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 00:49:12,318 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:49:12,318 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:49:13,447 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 00:49:13,448 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 00:49:13,448 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 00:49:13,449 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 00:46:55\n- 结束时间: 2025-03-20 00:49:13\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_248.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_248.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_249.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 00:49:13"}]}]}}
2025-03-20 00:49:13,785 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 00:49:13,787 - QuickAppADBTester - INFO - 测试完成
2025-03-20 00:54:13,869 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 00:54:13,871 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 00:54:13,871 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 00:54:13,871 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 00:54:14,007 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 00:54:14,162 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 00:54:14,163 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 00:54:14,163 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 00:54:14,163 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 00:54:14,385 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 00:54:14,385 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 00:54:14,386 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 00:54:14,386 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 00:54:15,865 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:54:15,866 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:54:17,094 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 00:54:17,094 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 00:54:17,094 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 00:54:17,094 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 00:54:17,094 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 00:54:17,241 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 00:54:17,242 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 00:54:17,242 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 00:54:17,242 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 00:54:18,649 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:54:18,649 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:54:19,893 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 00:54:19,894 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 00:54:19,894 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 00:54:19,894 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:54:19,894 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:54:20,991 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 00:54:20,992 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 00:54:21,105 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 00:54:23,111 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 00:54:23,112 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 00:54:24,196 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 00:54:24,196 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 00:54:24,196 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:54:24,196 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 00:54:24,278 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:54:26,295 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 00:54:26,295 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 00:54:28,488 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 00:54:28,490 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 00:54:30,576 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 00:54:30,576 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 00:54:31,672 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 00:54:31,672 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 00:54:31,672 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:54:31,672 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 00:54:31,743 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:54:33,760 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 00:54:33,761 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 00:54:35,900 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 00:54:35,901 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 00:54:37,293 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 00:54:38,754 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 00:54:38,754 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 00:54:39,925 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 00:54:39,926 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 00:54:41,031 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 00:54:41,031 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 00:54:43,195 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 00:54:43,195 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 00:54:43,195 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 00:54:43,195 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:54:43,195 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:54:44,359 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 00:54:44,361 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 00:54:44,469 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 00:54:49,478 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 00:54:49,480 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 00:54:51,727 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 00:54:51,727 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 00:54:56,861 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 00:54:56,862 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 00:54:59,012 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 00:55:04,021 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 00:55:04,021 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_005504.mp4
2025-03-20 00:55:04,022 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:55:04,022 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:55:09,249 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:55:09,251 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 00:55:09,295 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 00:55:10,509 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_005504.mp4
2025-03-20 00:55:10,510 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_005504.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 00:55:12,523 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 00:55:15,531 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 00:55:15,533 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 00:55:18,536 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 00:55:18,537 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 00:55:18,537 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 00:55:19,699 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 00:55:19,700 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 00:55:19,700 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 00:55:19,700 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 00:55:19,790 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 00:55:21,809 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 00:55:21,810 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 00:55:21,810 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 00:55:24,111 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 00:55:24,111 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 00:55:32,269 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 00:55:32,270 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 00:55:32,270 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 00:55:32,270 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:32,557 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 00:55:32,558 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:32,788 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 00:55:32,788 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:33,015 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 00:55:33,016 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:33,265 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 00:55:33,266 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:33,484 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 00:55:33,484 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:33,701 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 00:55:33,701 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:33,917 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 00:55:33,918 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:34,149 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 00:55:34,149 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:34,399 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 00:55:34,400 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 00:55:36,624 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 00:55:36,625 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:55:36,625 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:55:36,710 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d95b24a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t937}
    * Task{eeb8e31 #937 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:55:36,710 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:55:36,711 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 00:55:36,711 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 00:55:36,711 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_005536_20250320_005536.png
2025-03-20 00:55:38,765 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_005536_20250320_005536.png
2025-03-20 00:55:38,765 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_005536_20250320_005536.png
2025-03-20 00:55:38,765 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:55:45,741 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 00:55:46,130 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_250.jpg
2025-03-20 00:55:46,133 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_250.jpg
2025-03-20 00:55:46,134 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 00:55:46,134 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:55:46,134 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:55:56,252 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 00:55:56,254 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 00:55:56,254 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 00:55:56,355 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d95b24a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t937}
    * Task{eeb8e31 #937 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 00:55:56,355 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 00:55:56,356 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 00:55:56,356 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 00:55:56,356 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_005556_20250320_005556.png
2025-03-20 00:55:58,423 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_005556_20250320_005556.png
2025-03-20 00:55:58,424 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_005556_20250320_005556.png
2025-03-20 00:55:58,424 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 00:56:03,338 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_250.jpg
2025-03-20 00:56:03,342 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_250.jpg
2025-03-20 00:56:03,342 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 00:56:03,342 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 00:56:03,343 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:56:03,343 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:56:05,477 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 00:56:05,477 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 00:56:05,478 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 00:56:05,478 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 00:56:06,487 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 00:56:07,495 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 00:56:07,495 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 00:56:07,496 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 131.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 00:56:07,496 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 00:56:17,504 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_005504.mp4 (大小: 3.94MB)
2025-03-20 00:56:17,506 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 00:56:17,622 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.057967秒，无需修复
2025-03-20 00:56:17,622 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 00:56:17,622 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_005504.mp4
2025-03-20 00:56:17,622 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 00:56:24,741 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_251.mp4
2025-03-20 00:56:24,744 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_251.mp4
2025-03-20 00:56:24,744 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 00:56:24,744 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 00:56:30,030 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 00:56:30,031 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_251.mp4
2025-03-20 00:56:30,031 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 00:56:30,031 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 00:56:30,031 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 00:56:30,438 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 00:56:31,445 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 00:56:31,446 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:56:31,446 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:56:32,551 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 00:56:32,552 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 00:56:32,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 00:56:34,631 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 00:56:34,632 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 00:56:35,784 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 00:56:35,785 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 00:56:35,785 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 00:56:36,892 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 00:56:36,892 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 00:56:36,892 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 00:56:36,893 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 00:54:17\n- 结束时间: 2025-03-20 00:56:36\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_250.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_250.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_251.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 00:56:36"}]}]}}
2025-03-20 00:56:37,221 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 00:56:37,223 - QuickAppADBTester - INFO - 测试完成
2025-03-20 01:01:37,306 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 01:01:37,309 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 01:01:37,309 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 01:01:37,309 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 01:01:37,441 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 01:01:37,587 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 01:01:37,588 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 01:01:37,588 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:01:37,588 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:01:37,836 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:01:37,836 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:01:37,836 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:01:37,836 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:01:39,276 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:01:39,277 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:01:40,529 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:01:40,529 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 01:01:40,530 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 01:01:40,530 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:01:40,530 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:01:40,677 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:01:40,678 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:01:40,678 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:01:40,678 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:01:42,080 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:01:42,081 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:01:43,345 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:01:43,345 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 01:01:43,345 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:01:43,346 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:01:43,346 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:01:44,431 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 01:01:44,431 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 01:01:44,545 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 01:01:46,553 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 01:01:46,554 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 01:01:47,628 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 01:01:47,629 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 01:01:47,629 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:01:47,629 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 01:01:47,699 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:01:49,716 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 01:01:49,717 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 01:01:51,895 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 01:01:51,895 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 01:01:53,978 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 01:01:53,979 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 01:01:55,075 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 01:01:55,075 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 01:01:55,075 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:01:55,075 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 01:01:55,147 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:01:57,157 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 01:01:57,158 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 01:01:59,312 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 01:01:59,313 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 01:02:00,717 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 01:02:02,197 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 01:02:02,197 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 01:02:03,385 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 01:02:03,386 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 01:02:04,494 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 01:02:04,494 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 01:02:06,698 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 01:02:06,699 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 01:02:06,699 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:02:06,699 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:02:06,699 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:02:07,883 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 01:02:07,883 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 01:02:08,001 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 01:02:13,008 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 01:02:13,008 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 01:02:15,142 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 01:02:15,143 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 01:02:20,285 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 01:02:20,287 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 01:02:22,444 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 01:02:27,453 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 01:02:27,455 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_010227.mp4
2025-03-20 01:02:27,455 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:02:27,455 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:02:32,739 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:02:32,741 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 01:02:32,783 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 01:02:34,004 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010227.mp4
2025-03-20 01:02:34,004 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010227.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 01:02:36,013 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 01:02:39,021 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 01:02:39,021 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 01:02:42,024 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 01:02:42,025 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 01:02:42,025 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 01:02:43,222 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 01:02:43,223 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 01:02:43,223 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:02:43,223 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 01:02:43,318 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:02:45,331 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 01:02:45,331 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 01:02:45,331 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 01:02:47,644 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 01:02:47,645 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 01:02:55,825 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 01:02:55,826 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 01:02:55,826 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 01:02:55,826 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:56,194 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 01:02:56,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:56,443 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 01:02:56,444 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:56,708 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 01:02:56,709 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:56,945 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 01:02:56,945 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:57,157 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 01:02:57,158 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:57,382 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 01:02:57,383 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:57,627 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 01:02:57,627 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:57,875 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 01:02:57,876 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:02:58,101 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 01:02:58,102 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:03:00,373 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 01:03:00,374 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:03:00,374 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:03:00,495 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bcc28d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t943}
    * Task{58ab453 #943 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:03:00,496 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:03:00,496 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 01:03:00,496 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 01:03:00,496 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_010300_20250320_010300.png
2025-03-20 01:03:01,736 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_010300_20250320_010300.png
2025-03-20 01:03:01,736 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_010300_20250320_010300.png
2025-03-20 01:03:01,737 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:03:08,431 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_252.jpg
2025-03-20 01:03:08,436 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_252.jpg
2025-03-20 01:03:08,436 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 01:03:08,436 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:03:08,436 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:03:09,232 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 01:03:18,560 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 01:03:18,561 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:03:18,561 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:03:18,691 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bcc28d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t943}
    * Task{58ab453 #943 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:03:18,691 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:03:18,691 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 01:03:18,691 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 01:03:18,692 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_010318_20250320_010318.png
2025-03-20 01:03:19,965 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_010318_20250320_010318.png
2025-03-20 01:03:19,966 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_010318_20250320_010318.png
2025-03-20 01:03:19,966 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:03:25,759 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg
2025-03-20 01:03:25,763 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg
2025-03-20 01:03:25,763 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 01:03:25,763 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 01:03:25,763 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:03:25,763 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:03:27,889 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 01:03:27,890 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 01:03:27,890 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 01:03:27,890 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 01:03:28,898 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 01:03:29,905 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 01:03:29,906 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 01:03:29,906 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 137.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 01:03:29,906 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 01:03:39,916 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010227.mp4 (大小: 3.18MB)
2025-03-20 01:03:39,917 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 01:03:40,032 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.110178秒，无需修复
2025-03-20 01:03:40,032 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 01:03:40,033 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010227.mp4
2025-03-20 01:03:40,033 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 01:03:47,275 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_254.mp4
2025-03-20 01:03:47,278 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_254.mp4
2025-03-20 01:03:47,279 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:03:47,279 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:03:52,569 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:03:52,571 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_254.mp4
2025-03-20 01:03:52,571 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 01:03:52,571 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 01:03:52,571 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 01:03:52,897 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 01:03:53,901 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 01:03:53,901 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:03:53,901 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:03:55,013 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 01:03:55,014 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 01:03:55,014 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 01:03:57,115 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 01:03:57,115 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 01:03:58,281 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 01:03:58,282 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:03:58,282 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:03:59,391 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 01:03:59,393 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 01:03:59,393 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 01:03:59,394 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 01:01:40\n- 结束时间: 2025-03-20 01:03:59\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_252.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_254.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 01:03:59"}]}]}}
2025-03-20 01:03:59,749 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 01:03:59,751 - QuickAppADBTester - INFO - 测试完成
2025-03-20 01:08:59,786 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 01:08:59,787 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 01:08:59,787 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 01:08:59,788 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 01:08:59,907 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 01:09:00,073 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 01:09:00,074 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 01:09:00,074 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:09:00,074 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:09:00,333 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:09:00,333 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:09:00,333 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:09:00,333 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:09:01,803 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:09:01,803 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:09:03,028 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:09:03,028 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 01:09:03,028 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 01:09:03,028 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:09:03,028 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:09:03,173 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:09:03,173 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:09:03,173 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:09:03,173 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:09:04,571 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:09:04,572 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:09:05,831 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:09:05,831 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 01:09:05,831 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:09:05,831 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:09:05,831 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:09:06,930 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 01:09:06,930 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 01:09:07,043 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 01:09:09,054 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 01:09:09,054 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 01:09:10,141 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 01:09:10,142 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 01:09:10,142 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:09:10,142 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 01:09:10,214 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:09:12,230 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 01:09:12,231 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 01:09:14,396 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 01:09:14,396 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 01:09:16,479 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 01:09:16,479 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 01:09:17,573 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 01:09:17,574 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 01:09:17,574 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:09:17,574 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 01:09:17,634 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:09:19,648 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 01:09:19,649 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 01:09:21,843 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 01:09:21,844 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 01:09:23,260 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 01:09:24,736 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 01:09:24,736 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 01:09:25,920 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 01:09:25,922 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 01:09:27,022 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 01:09:27,022 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 01:09:29,195 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 01:09:29,196 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 01:09:29,196 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:09:29,196 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:09:29,196 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:09:30,379 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 01:09:30,380 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 01:09:30,483 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 01:09:35,490 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 01:09:35,492 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 01:09:37,610 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 01:09:37,610 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 01:09:42,775 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 01:09:42,776 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 01:09:44,937 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 01:09:49,943 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 01:09:49,944 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_010949.mp4
2025-03-20 01:09:49,944 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:09:49,944 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:09:55,232 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:09:55,233 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 01:09:55,281 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 01:09:56,440 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010949.mp4
2025-03-20 01:09:56,441 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010949.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 01:09:58,448 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 01:10:01,457 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 01:10:01,457 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 01:10:04,467 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 01:10:04,467 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 01:10:04,468 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 01:10:05,639 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 01:10:05,639 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 01:10:05,639 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:10:05,639 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 01:10:05,728 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:10:07,735 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 01:10:07,735 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 01:10:07,735 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 01:10:10,027 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 01:10:10,029 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 01:10:18,237 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 01:10:18,238 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 01:10:18,238 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 01:10:18,238 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:18,574 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 01:10:18,575 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:18,804 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 01:10:18,805 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:19,034 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 01:10:19,035 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:19,283 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 01:10:19,283 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:19,539 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 01:10:19,539 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:19,772 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 01:10:19,772 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:20,001 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 01:10:20,002 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:20,255 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 01:10:20,256 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:20,508 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 01:10:20,509 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:10:22,748 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 01:10:22,748 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:10:22,748 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:10:22,848 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4732c57 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t949}
    * Task{77d6562 #949 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:10:22,849 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:10:22,849 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 01:10:22,849 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 01:10:22,849 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_011022_20250320_011022.png
2025-03-20 01:10:24,263 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_011022_20250320_011022.png
2025-03-20 01:10:24,263 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_011022_20250320_011022.png
2025-03-20 01:10:24,264 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:10:31,411 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg
2025-03-20 01:10:31,416 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg
2025-03-20 01:10:31,416 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 01:10:31,416 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:10:31,416 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:10:31,622 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 01:10:41,558 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 01:10:41,560 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:10:41,560 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:10:41,691 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4732c57 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t949}
    * Task{77d6562 #949 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:10:41,692 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:10:41,692 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 01:10:41,692 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 01:10:41,692 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_011041_20250320_011041.png
2025-03-20 01:10:43,105 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_011041_20250320_011041.png
2025-03-20 01:10:43,106 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_011041_20250320_011041.png
2025-03-20 01:10:43,106 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:10:47,673 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg
2025-03-20 01:10:47,677 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg
2025-03-20 01:10:47,677 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 01:10:47,677 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 01:10:47,677 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:10:47,677 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:10:49,837 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 01:10:49,837 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 01:10:49,837 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 01:10:49,837 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 01:10:50,846 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 01:10:51,848 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 01:10:51,848 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 01:10:51,848 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 133.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 01:10:51,848 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 01:11:01,854 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010949.mp4 (大小: 3.22MB)
2025-03-20 01:11:01,856 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 01:11:01,971 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.547656秒，无需修复
2025-03-20 01:11:01,971 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 01:11:01,971 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_010949.mp4
2025-03-20 01:11:01,971 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 01:11:09,177 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_256.mp4
2025-03-20 01:11:09,179 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_256.mp4
2025-03-20 01:11:09,179 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:11:09,179 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:11:14,399 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:11:14,400 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_256.mp4
2025-03-20 01:11:14,400 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 01:11:14,400 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 01:11:14,400 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 01:11:14,878 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 01:11:15,886 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 01:11:15,887 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:11:15,887 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:11:16,992 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 01:11:16,992 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 01:11:16,992 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 01:11:19,094 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 01:11:19,094 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 01:11:20,247 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 01:11:20,249 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:11:20,249 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:11:21,376 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 01:11:21,377 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 01:11:21,377 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 01:11:21,377 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 01:09:03\n- 结束时间: 2025-03-20 01:11:21\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_256.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 01:11:21"}]}]}}
2025-03-20 01:11:21,721 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 01:11:21,723 - QuickAppADBTester - INFO - 测试完成
2025-03-20 01:16:22,712 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 01:16:22,715 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 01:16:22,715 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 01:16:22,715 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 01:16:22,845 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 01:16:22,997 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 01:16:22,998 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 01:16:22,998 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:16:22,998 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:16:23,248 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:16:23,249 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:16:23,249 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:16:23,249 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:16:24,722 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:16:24,722 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:16:25,992 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:16:25,992 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 01:16:25,993 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 01:16:25,993 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:16:25,993 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:16:26,136 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:16:26,137 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:16:26,137 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:16:26,137 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:16:27,534 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:16:27,535 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:16:28,807 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:16:28,808 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 01:16:28,808 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:16:28,808 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:16:28,808 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:16:29,906 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 01:16:29,906 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 01:16:30,022 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 01:16:32,029 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 01:16:32,029 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 01:16:33,122 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 01:16:33,122 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 01:16:33,123 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:16:33,123 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 01:16:33,196 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:16:35,208 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 01:16:35,209 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 01:16:37,371 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 01:16:37,371 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 01:16:39,455 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 01:16:39,456 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 01:16:40,546 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 01:16:40,546 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 01:16:40,546 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:16:40,546 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 01:16:40,621 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:16:42,638 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 01:16:42,638 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 01:16:44,797 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 01:16:44,798 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 01:16:46,221 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 01:16:47,697 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 01:16:47,698 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 01:16:48,861 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 01:16:48,862 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 01:16:49,967 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 01:16:49,968 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 01:16:52,128 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 01:16:52,129 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 01:16:52,129 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:16:52,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:16:52,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:16:53,286 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 01:16:53,287 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 01:16:53,401 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 01:16:58,409 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 01:16:58,411 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 01:17:00,544 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 01:17:00,544 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 01:17:05,710 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 01:17:05,711 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 01:17:07,871 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 01:17:12,877 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 01:17:12,877 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_011712.mp4
2025-03-20 01:17:12,877 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:17:12,877 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:17:18,164 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:17:18,165 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 01:17:18,207 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 01:17:19,369 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_011712.mp4
2025-03-20 01:17:19,369 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_011712.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 01:17:21,375 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 01:17:24,384 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 01:17:24,384 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 01:17:27,394 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 01:17:27,395 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 01:17:27,395 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 01:17:28,586 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 01:17:28,587 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 01:17:28,587 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:17:28,587 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 01:17:28,679 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:17:30,694 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 01:17:30,695 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 01:17:30,695 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 01:17:32,976 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 01:17:32,976 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 01:17:41,174 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 01:17:41,175 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 01:17:41,175 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 01:17:41,175 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:41,471 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 01:17:41,471 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:41,698 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 01:17:41,698 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:41,945 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 01:17:41,945 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:42,193 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 01:17:42,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:42,419 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 01:17:42,420 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:42,650 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 01:17:42,650 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:42,888 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 01:17:42,889 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:43,111 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 01:17:43,112 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:43,325 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 01:17:43,325 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:17:45,590 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 01:17:45,591 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:17:45,591 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:17:45,685 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bd75fbe u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t955}
    * Task{106a76c #955 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:17:45,685 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:17:45,685 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 01:17:45,685 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 01:17:45,685 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_011745_20250320_011745.png
2025-03-20 01:17:46,872 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_011745_20250320_011745.png
2025-03-20 01:17:46,872 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_011745_20250320_011745.png
2025-03-20 01:17:46,872 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:17:53,842 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_257.jpg
2025-03-20 01:17:53,845 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_257.jpg
2025-03-20 01:17:53,845 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 01:17:53,845 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:17:53,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:17:54,590 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 01:18:04,014 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 01:18:04,016 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:18:04,016 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:18:04,133 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{bd75fbe u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t955}
    * Task{106a76c #955 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:18:04,133 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:18:04,133 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 01:18:04,133 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 01:18:04,133 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_011804_20250320_011804.png
2025-03-20 01:18:05,299 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_011804_20250320_011804.png
2025-03-20 01:18:05,299 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_011804_20250320_011804.png
2025-03-20 01:18:05,300 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:18:10,801 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_258.jpg
2025-03-20 01:18:10,805 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_258.jpg
2025-03-20 01:18:10,805 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 01:18:10,806 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 01:18:10,806 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:18:10,806 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:18:12,947 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 01:18:12,947 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 01:18:12,947 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 01:18:12,947 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 01:18:13,957 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 01:18:14,967 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 01:18:14,967 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 01:18:14,967 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 01:18:14,967 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 01:18:24,976 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_011712.mp4 (大小: 2.62MB)
2025-03-20 01:18:24,978 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 01:18:25,131 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.711222秒，无需修复
2025-03-20 01:18:25,131 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 01:18:25,131 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_011712.mp4
2025-03-20 01:18:25,131 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 01:18:32,426 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_259.mp4
2025-03-20 01:18:32,430 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_259.mp4
2025-03-20 01:18:32,431 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:18:32,431 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:18:37,656 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:18:37,656 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_259.mp4
2025-03-20 01:18:37,657 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 01:18:37,657 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 01:18:37,657 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 01:18:38,044 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 01:18:39,053 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 01:18:39,055 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:18:39,055 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:18:40,149 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 01:18:40,150 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 01:18:40,150 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 01:18:42,255 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 01:18:42,256 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 01:18:43,420 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 01:18:43,421 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:18:43,421 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:18:44,570 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 01:18:44,570 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 01:18:44,571 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 01:18:44,571 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 01:16:25\n- 结束时间: 2025-03-20 01:18:44\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_257.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_258.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_259.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 01:18:44"}]}]}}
2025-03-20 01:18:44,941 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 01:18:44,943 - QuickAppADBTester - INFO - 测试完成
2025-03-20 01:23:45,067 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 01:23:45,070 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 01:23:45,070 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 01:23:45,070 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 01:23:45,201 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 01:23:45,361 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 01:23:45,361 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 01:23:45,361 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:23:45,362 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:23:45,570 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:23:45,570 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:23:45,571 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:23:45,571 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:23:47,056 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:23:47,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:23:48,326 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:23:48,326 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 01:23:48,326 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 01:23:48,326 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:23:48,326 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:23:48,479 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:23:48,479 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:23:48,479 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:23:48,479 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:23:49,875 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:23:49,876 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:23:51,126 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:23:51,127 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 01:23:51,127 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:23:51,127 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:23:51,127 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:23:52,228 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 01:23:52,229 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 01:23:52,338 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 01:23:54,349 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 01:23:54,350 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 01:23:55,441 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 01:23:55,441 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 01:23:55,441 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:23:55,441 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 01:23:55,513 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:23:57,533 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 01:23:57,534 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 01:23:59,719 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 01:23:59,720 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 01:24:01,806 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 01:24:01,807 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 01:24:02,904 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 01:24:02,905 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 01:24:02,905 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:24:02,905 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 01:24:02,973 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:24:04,991 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 01:24:04,991 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 01:24:07,147 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 01:24:07,148 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 01:24:08,566 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 01:24:10,054 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 01:24:10,054 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 01:24:11,235 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 01:24:11,235 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 01:24:12,333 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 01:24:12,334 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 01:24:14,504 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 01:24:14,504 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 01:24:14,504 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:24:14,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:24:14,505 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:24:15,678 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 01:24:15,679 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 01:24:15,791 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 01:24:20,800 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 01:24:20,802 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 01:24:22,971 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 01:24:22,972 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 01:24:28,103 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 01:24:28,104 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 01:24:30,253 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 01:24:35,256 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 01:24:35,256 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_012435.mp4
2025-03-20 01:24:35,257 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:24:35,257 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:24:40,536 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:24:40,536 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 01:24:40,578 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 01:24:41,797 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_012435.mp4
2025-03-20 01:24:41,798 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_012435.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 01:24:43,804 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 01:24:46,812 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 01:24:46,813 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 01:24:49,818 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 01:24:49,819 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 01:24:49,819 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 01:24:50,986 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 01:24:50,987 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 01:24:50,987 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:24:50,987 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 01:24:51,080 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:24:53,096 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 01:24:53,097 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 01:24:53,097 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 01:24:55,346 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 01:24:55,347 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 01:25:03,538 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 01:25:03,540 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 01:25:03,540 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 01:25:03,540 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:03,825 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 01:25:03,826 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:04,047 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 01:25:04,047 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:04,297 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 01:25:04,298 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:04,526 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 01:25:04,527 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:04,769 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 01:25:04,770 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:05,012 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 01:25:05,012 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:05,285 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 01:25:05,286 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:05,517 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 01:25:05,518 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:05,741 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 01:25:05,742 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:25:07,988 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 01:25:07,988 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:25:07,988 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:25:08,114 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8c43035 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t961}
    * Task{7022958 #961 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:25:08,115 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:25:08,115 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 01:25:08,115 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 01:25:08,115 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_012508_20250320_012508.png
2025-03-20 01:25:09,651 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_012508_20250320_012508.png
2025-03-20 01:25:09,652 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_012508_20250320_012508.png
2025-03-20 01:25:09,652 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:25:17,012 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 01:25:17,016 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 01:25:17,016 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 01:25:17,016 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:25:17,016 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:25:17,034 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 01:25:27,139 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 01:25:27,139 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:25:27,139 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:25:27,212 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8c43035 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t961}
    * Task{7022958 #961 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:25:27,212 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:25:27,213 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 01:25:27,213 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 01:25:27,213 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_012527_20250320_012527.png
2025-03-20 01:25:28,777 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_012527_20250320_012527.png
2025-03-20 01:25:28,778 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_012527_20250320_012527.png
2025-03-20 01:25:28,778 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:25:33,400 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 01:25:33,404 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 01:25:33,405 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 01:25:33,405 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 01:25:33,405 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:25:33,405 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:25:35,573 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 01:25:35,574 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 01:25:35,575 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 01:25:35,575 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 01:25:36,583 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 01:25:37,590 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 01:25:37,591 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 01:25:37,591 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 107.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 01:25:37,591 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 01:25:47,601 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_012435.mp4 (大小: 3.55MB)
2025-03-20 01:25:47,601 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 01:25:47,717 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.993444秒，无需修复
2025-03-20 01:25:47,717 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 01:25:47,717 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_012435.mp4
2025-03-20 01:25:47,717 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 01:25:55,265 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_261.mp4
2025-03-20 01:25:55,270 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_261.mp4
2025-03-20 01:25:55,270 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:25:55,270 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:26:00,494 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:26:00,495 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_261.mp4
2025-03-20 01:26:00,495 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 01:26:00,495 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 01:26:00,495 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 01:26:00,839 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 01:26:01,843 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 01:26:01,843 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:26:01,844 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:26:02,947 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 01:26:02,948 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 01:26:02,948 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 01:26:05,047 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 01:26:05,048 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 01:26:06,196 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 01:26:06,197 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:26:06,197 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:26:07,306 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 01:26:07,307 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 01:26:07,307 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 01:26:07,308 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 01:23:48\n- 结束时间: 2025-03-20 01:26:07\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_261.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 01:26:07"}]}]}}
2025-03-20 01:26:07,659 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 01:26:07,661 - QuickAppADBTester - INFO - 测试完成
2025-03-20 01:31:07,773 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 01:31:07,776 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 01:31:07,776 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 01:31:07,776 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 01:31:07,889 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 01:31:08,024 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 01:31:08,024 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 01:31:08,024 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:31:08,024 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:31:08,264 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:31:08,264 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:31:08,265 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:31:08,265 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:31:09,725 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:31:09,726 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:31:10,979 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:31:10,979 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 01:31:10,979 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 01:31:10,979 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:31:10,979 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:31:11,147 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:31:11,148 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:31:11,148 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:31:11,148 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:31:12,543 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:31:12,544 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:31:13,778 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:31:13,779 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 01:31:13,779 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:31:13,779 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:31:13,779 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:31:14,878 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 01:31:14,878 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 01:31:14,991 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 01:31:16,993 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 01:31:16,993 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 01:31:18,069 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 01:31:18,070 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 01:31:18,070 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:31:18,070 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 01:31:18,143 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:31:20,158 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 01:31:20,159 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 01:31:22,315 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 01:31:22,316 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 01:31:24,407 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 01:31:24,408 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 01:31:25,501 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 01:31:25,502 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 01:31:25,502 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:31:25,502 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 01:31:25,572 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:31:27,593 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 01:31:27,594 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 01:31:29,767 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 01:31:29,767 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 01:31:31,181 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 01:31:32,649 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 01:31:32,651 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 01:31:33,832 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 01:31:33,832 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 01:31:34,940 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 01:31:34,940 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 01:31:37,098 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 01:31:37,098 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 01:31:37,098 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:31:37,099 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:31:37,099 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:31:38,269 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 01:31:38,270 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 01:31:38,370 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 01:31:43,376 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 01:31:43,378 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 01:31:45,517 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 01:31:45,517 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 01:31:50,646 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 01:31:50,647 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 01:31:52,808 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 01:31:57,813 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 01:31:57,813 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_013157.mp4
2025-03-20 01:31:57,813 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:31:57,813 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:32:03,088 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:32:03,090 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 01:32:03,130 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 01:32:04,290 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_013157.mp4
2025-03-20 01:32:04,290 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_013157.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 01:32:06,300 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 01:32:09,310 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 01:32:09,310 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 01:32:12,320 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 01:32:12,320 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 01:32:12,320 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 01:32:13,507 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 01:32:13,507 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 01:32:13,508 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:32:13,508 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 01:32:13,608 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:32:15,625 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 01:32:15,626 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 01:32:15,626 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 01:32:17,887 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 01:32:17,888 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 01:32:26,072 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 01:32:26,073 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 01:32:26,073 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 01:32:26,073 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:26,317 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 01:32:26,317 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:26,657 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 01:32:26,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:26,873 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 01:32:26,874 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:27,101 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 01:32:27,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:27,327 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 01:32:27,327 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:27,556 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 01:32:27,556 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:27,783 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 01:32:27,784 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:28,002 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 01:32:28,002 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:28,255 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 01:32:28,256 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 01:32:30,495 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 01:32:30,495 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:32:30,495 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:32:30,619 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fd67f6f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t967}
    * Task{b75a38b #967 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:32:30,620 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:32:30,620 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 01:32:30,620 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 01:32:30,620 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_013230_20250320_013230.png
2025-03-20 01:32:32,335 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_013230_20250320_013230.png
2025-03-20 01:32:32,336 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_013230_20250320_013230.png
2025-03-20 01:32:32,336 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:32:39,512 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 01:32:39,999 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_262.jpg
2025-03-20 01:32:40,003 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_262.jpg
2025-03-20 01:32:40,003 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 01:32:40,003 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:32:40,003 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:32:50,128 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 01:32:50,129 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 01:32:50,129 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 01:32:50,251 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fd67f6f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t967}
    * Task{b75a38b #967 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 01:32:50,252 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 01:32:50,252 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 01:32:50,252 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 01:32:50,252 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_013250_20250320_013250.png
2025-03-20 01:32:51,888 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_013250_20250320_013250.png
2025-03-20 01:32:51,888 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_013250_20250320_013250.png
2025-03-20 01:32:51,888 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 01:32:56,597 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_262.jpg
2025-03-20 01:32:56,599 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_262.jpg
2025-03-20 01:32:56,599 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 01:32:56,599 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 01:32:56,599 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:32:56,599 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:32:58,694 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 01:32:58,694 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 01:32:58,694 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 01:32:58,694 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 01:32:59,700 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 01:33:00,705 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 01:33:00,705 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 01:33:00,706 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 128.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 01:33:00,706 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 01:33:10,716 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_013157.mp4 (大小: 3.70MB)
2025-03-20 01:33:10,716 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 01:33:10,831 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.469100秒，无需修复
2025-03-20 01:33:10,831 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 01:33:10,831 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_013157.mp4
2025-03-20 01:33:10,831 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 01:33:18,274 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_263.mp4
2025-03-20 01:33:18,278 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_263.mp4
2025-03-20 01:33:18,278 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 01:33:18,278 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 01:33:23,506 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 01:33:23,506 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_263.mp4
2025-03-20 01:33:23,507 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 01:33:23,507 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 01:33:23,507 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 01:33:23,896 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 01:33:24,904 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 01:33:24,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:33:24,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:33:26,017 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 01:33:26,018 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 01:33:26,018 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 01:33:28,115 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 01:33:28,116 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 01:33:29,286 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 01:33:29,287 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:33:29,287 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:33:30,418 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 01:33:30,419 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 01:33:30,419 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 01:33:30,419 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 01:31:10\n- 结束时间: 2025-03-20 01:33:30\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_262.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_262.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_263.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 01:33:30"}]}]}}
2025-03-20 01:33:30,740 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 01:33:30,742 - QuickAppADBTester - INFO - 测试完成
2025-03-20 01:44:55,121 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 01:44:55,123 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 01:44:55,123 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 01:44:55,123 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 01:44:55,223 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 01:44:55,344 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 01:44:55,344 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 01:44:55,344 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:44:55,344 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:44:55,578 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:44:55,578 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:44:55,578 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:44:55,579 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:44:57,009 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:44:57,010 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:44:58,310 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:44:58,310 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 01:44:58,310 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 01:44:58,310 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 01:44:58,311 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 01:44:58,431 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 01:44:58,431 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 01:44:58,431 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 01:44:58,431 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 01:44:59,878 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:44:59,878 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:45:01,128 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 01:45:01,129 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 01:45:01,129 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:45:01,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:45:01,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:45:02,238 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 01:45:02,239 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 01:45:02,359 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 01:45:04,368 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 01:45:04,369 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 01:45:05,463 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 01:45:05,463 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 01:45:05,463 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:45:05,464 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 01:45:05,542 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:45:07,556 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 01:45:07,557 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 01:45:09,734 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 01:45:09,736 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 01:45:11,823 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 01:45:11,824 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 01:45:12,922 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 01:45:12,923 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 01:45:12,924 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 01:45:12,924 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 01:45:12,997 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 01:45:15,016 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 01:45:15,017 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 01:45:17,197 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 01:45:17,199 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 01:45:18,623 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 01:45:20,079 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 01:45:20,080 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 01:45:21,238 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 01:45:21,239 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 01:45:22,351 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 01:45:22,352 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 01:45:24,534 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 01:45:24,535 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 01:45:24,535 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 01:45:24,535 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 01:45:24,536 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 01:45:25,732 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 01:45:25,733 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 01:45:25,861 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 01:45:30,864 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 01:45:30,864 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 01:45:33,006 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 01:45:33,006 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 01:45:38,159 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 01:45:38,161 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 01:45:40,326 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 02:01:56,158 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 02:01:56,159 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_020156.mp4
2025-03-20 02:01:56,159 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:01:56,159 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:02:01,451 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:02:01,454 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 02:02:01,498 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 02:02:02,657 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_020156.mp4
2025-03-20 02:02:02,658 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_020156.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 02:02:04,666 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 02:02:07,674 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 02:02:07,675 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 02:02:10,677 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 02:02:10,678 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 02:02:10,678 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 02:02:11,851 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 02:02:11,852 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 02:02:11,852 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:02:11,852 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 02:02:11,955 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:02:13,973 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 02:02:13,973 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 02:02:13,973 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 02:02:16,247 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 02:02:16,248 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 02:02:24,464 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 02:02:24,465 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 02:02:24,465 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 02:02:24,465 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:24,874 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 02:02:24,875 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:25,121 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 02:02:25,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:25,362 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 02:02:25,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:25,594 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 02:02:25,595 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:25,846 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 02:02:25,847 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:26,101 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 02:02:26,102 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:26,335 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 02:02:26,336 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:26,590 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 02:02:26,591 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:26,845 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 02:02:26,845 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:02:29,109 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 02:02:29,110 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:02:29,110 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:02:29,238 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{320c14a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t973}
    * Task{565e1d8 #973 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:02:29,238 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:02:29,239 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 02:02:29,239 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 02:02:29,239 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_020229_20250320_020229.png
2025-03-20 02:02:30,914 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_020229_20250320_020229.png
2025-03-20 02:02:30,914 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_020229_20250320_020229.png
2025-03-20 02:02:30,915 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:02:37,881 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 02:02:51,843 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_264.jpg
2025-03-20 02:02:51,845 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_264.jpg
2025-03-20 02:02:51,845 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 02:02:51,845 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:02:51,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:18:30,683 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 02:18:30,686 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:18:30,686 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:18:30,819 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{320c14a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t973}
    * Task{565e1d8 #973 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:18:30,819 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:18:30,820 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 02:18:30,820 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 02:18:30,820 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_021830_20250320_021830.png
2025-03-20 02:18:32,153 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_021830_20250320_021830.png
2025-03-20 02:18:32,154 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_021830_20250320_021830.png
2025-03-20 02:18:32,154 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:19:00,766 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 02:19:00,774 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 02:19:00,777 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-20 02:19:00,777 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 02:19:00,778 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 02:19:00,778 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:19:00,778 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:19:02,919 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 02:19:02,920 - QuickAppADBTester - INFO - 录制进程已经退出，退出码: 2
2025-03-20 02:19:02,920 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 114.2 MB/s (90640 bytes in 0.001s)
WARN: Device disconnected

2025-03-20 02:19:02,920 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 02:19:12,914 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_020156.mp4 (大小: 1.51MB)
2025-03-20 02:19:12,916 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 02:19:13,078 - QuickAppADBTester - INFO - 录制文件完整，时长: 38.262122秒，无需修复
2025-03-20 02:19:13,078 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 02:19:13,078 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_020156.mp4
2025-03-20 02:19:13,078 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 02:36:05,200 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:2423)')))
2025-03-20 02:36:05,207 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 716, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1286, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1332, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1281, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1080, in _send_output
    self.send(chunk)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1002, in send
    self.sock.sendall(data)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1241, in sendall
    v = self.send(byte_view[count:])
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1210, in send
    return self._sslobj.write(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:2423)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:2423)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:2423)')))

2025-03-20 02:36:05,211 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-20 02:36:05,211 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:36:05,211 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:36:10,504 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:36:10,505 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 02:36:10,505 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 02:36:10,505 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 02:36:10,505 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 02:36:10,851 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 02:36:11,858 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 02:36:11,859 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:36:11,859 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:36:12,974 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 02:36:12,976 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 02:36:12,977 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 02:36:15,094 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 02:36:15,095 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 02:36:16,224 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 02:36:16,225 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:36:16,225 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:36:17,357 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 02:36:17,358 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 02:36:17,358 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-20 02:36:17,359 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 01:44:58\n- 结束时间: 2025-03-20 02:36:17\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_264.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 02:36:17"}]}]}}
2025-03-20 02:36:17,712 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 02:36:17,715 - QuickAppADBTester - INFO - 测试完成
2025-03-20 02:41:17,932 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 02:41:17,935 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 02:41:17,935 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 02:41:17,935 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 02:41:18,062 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 02:41:18,222 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 02:41:18,223 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 02:41:18,223 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 02:41:18,223 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 02:41:18,492 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 02:41:18,493 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 02:41:18,493 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 02:41:18,493 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 02:41:19,994 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:41:19,995 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:41:21,255 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 02:41:21,255 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 02:41:21,255 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 02:41:21,255 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 02:41:21,255 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 02:41:21,399 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 02:41:21,400 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 02:41:21,400 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 02:41:21,400 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 02:41:22,807 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:41:22,808 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:41:24,092 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 02:41:24,093 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 02:41:24,093 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 02:41:24,093 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:41:24,093 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:41:25,191 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 02:41:25,192 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 02:41:25,300 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 02:41:27,307 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 02:41:27,308 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 02:41:28,420 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 02:41:28,421 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 02:41:28,421 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:41:28,422 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 02:41:28,499 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:41:30,513 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 02:41:30,514 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 02:41:32,604 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 02:41:32,605 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 02:41:34,707 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 02:41:34,708 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 02:41:35,898 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 02:41:35,899 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 02:41:35,899 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:41:35,899 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 02:41:36,056 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:41:38,074 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 02:41:38,075 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 02:41:40,269 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 02:41:40,270 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 02:41:41,699 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 02:41:43,171 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 02:41:43,172 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 02:41:44,332 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 02:41:44,333 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 02:41:45,432 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 02:41:45,432 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 02:41:47,633 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 02:41:47,634 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 02:41:47,634 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 02:41:47,634 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:41:47,634 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:41:48,831 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 02:41:48,832 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 02:41:48,969 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 02:41:53,977 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 02:41:53,978 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 02:41:56,113 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 02:41:56,114 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 02:42:01,262 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 02:42:01,263 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 02:42:03,431 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 02:42:08,439 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 02:42:08,440 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_024208.mp4
2025-03-20 02:42:08,440 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:42:08,440 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:42:13,705 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:42:13,706 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 02:42:13,753 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 02:42:14,916 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024208.mp4
2025-03-20 02:42:14,917 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024208.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 02:42:16,930 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 02:42:19,940 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 02:42:19,941 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 02:42:22,951 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 02:42:22,951 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 02:42:22,952 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 02:42:24,144 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 02:42:24,145 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 02:42:24,145 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:42:24,145 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 02:42:24,238 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:42:26,248 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 02:42:26,249 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 02:42:26,249 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 02:42:28,529 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 02:42:28,529 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 02:42:36,735 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 02:42:36,736 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 02:42:36,737 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 02:42:36,737 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:37,123 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 02:42:37,123 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:37,397 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 02:42:37,398 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:37,668 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 02:42:37,669 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:37,891 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 02:42:37,892 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:38,121 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 02:42:38,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:38,385 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 02:42:38,386 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:38,645 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 02:42:38,646 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:38,905 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 02:42:38,906 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:39,131 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 02:42:39,132 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:42:41,372 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 02:42:41,372 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:42:41,373 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:42:41,510 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fd5291f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t977}
    * Task{a49a35 #977 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:42:41,511 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:42:41,511 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 02:42:41,511 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 02:42:41,511 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_024241_20250320_024241.png
2025-03-20 02:42:42,721 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_024241_20250320_024241.png
2025-03-20 02:42:42,722 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_024241_20250320_024241.png
2025-03-20 02:42:42,722 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:42:47,625 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg
2025-03-20 02:42:47,629 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg
2025-03-20 02:42:47,630 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 02:42:47,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:42:47,630 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:42:50,165 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 02:42:57,813 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 02:42:57,814 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:42:57,814 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:42:57,939 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fd5291f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t977}
    * Task{a49a35 #977 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:42:57,940 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:42:57,940 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 02:42:57,940 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 02:42:57,940 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_024257_20250320_024257.png
2025-03-20 02:42:59,203 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_024257_20250320_024257.png
2025-03-20 02:42:59,203 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_024257_20250320_024257.png
2025-03-20 02:42:59,203 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:43:04,766 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg
2025-03-20 02:43:04,773 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg
2025-03-20 02:43:04,773 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 02:43:04,773 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 02:43:04,773 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:43:04,774 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:43:06,895 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 02:43:06,896 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 02:43:06,896 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 02:43:06,897 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 02:43:07,903 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 02:43:08,912 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 02:43:08,913 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 02:43:08,913 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 119.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 02:43:08,913 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 02:43:18,921 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024208.mp4 (大小: 2.82MB)
2025-03-20 02:43:18,922 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 02:43:19,030 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.181389秒，无需修复
2025-03-20 02:43:19,030 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 02:43:19,030 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024208.mp4
2025-03-20 02:43:19,030 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 02:43:28,217 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_265.mp4
2025-03-20 02:43:28,223 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_265.mp4
2025-03-20 02:43:28,224 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:43:28,224 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:43:33,449 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:43:33,450 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_265.mp4
2025-03-20 02:43:33,450 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 02:43:33,451 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 02:43:33,451 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 02:43:33,845 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 02:43:34,854 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 02:43:34,854 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:43:34,854 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:43:35,966 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 02:43:35,967 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 02:43:35,968 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 02:43:38,086 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 02:43:38,087 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 02:43:39,243 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 02:43:39,244 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:43:39,244 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:43:40,387 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 02:43:40,388 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 02:43:40,388 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 02:43:40,389 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 02:41:21\n- 结束时间: 2025-03-20 02:43:40\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_253.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_265.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 02:43:40"}]}]}}
2025-03-20 02:43:40,716 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 02:43:40,718 - QuickAppADBTester - INFO - 测试完成
2025-03-20 02:48:40,839 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 02:48:40,842 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 02:48:40,842 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 02:48:40,842 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 02:48:40,966 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 02:48:41,116 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 02:48:41,117 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 02:48:41,117 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 02:48:41,117 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 02:48:41,356 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 02:48:41,357 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 02:48:41,357 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 02:48:41,357 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 02:48:42,805 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:48:42,806 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:48:44,089 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 02:48:44,089 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 02:48:44,090 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 02:48:44,090 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 02:48:44,090 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 02:48:44,256 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 02:48:44,256 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 02:48:44,256 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 02:48:44,257 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 02:48:45,659 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:48:45,660 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:48:46,921 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 02:48:46,922 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 02:48:46,922 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 02:48:46,922 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:48:46,922 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:48:48,025 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 02:48:48,026 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 02:48:48,142 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 02:48:50,149 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 02:48:50,149 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 02:48:51,244 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 02:48:51,245 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 02:48:51,245 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:48:51,245 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 02:48:51,324 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:48:53,338 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 02:48:53,339 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 02:48:55,497 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 02:48:55,498 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 02:48:57,593 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 02:48:57,594 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 02:48:58,707 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 02:48:58,708 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 02:48:58,708 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:48:58,708 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 02:48:58,785 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:49:00,804 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 02:49:00,804 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 02:49:03,058 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 02:49:03,059 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 02:49:04,489 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 02:49:05,976 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 02:49:05,977 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 02:49:07,146 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 02:49:07,147 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 02:49:08,257 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 02:49:08,258 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 02:49:10,439 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 02:49:10,440 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 02:49:10,440 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 02:49:10,440 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:49:10,441 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:49:11,607 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 02:49:11,608 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 02:49:11,720 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 02:49:16,731 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 02:49:16,733 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 02:49:18,905 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 02:49:18,906 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 02:49:24,065 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 02:49:24,066 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 02:49:26,212 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 02:49:31,221 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 02:49:31,221 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_024931.mp4
2025-03-20 02:49:31,222 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:49:31,222 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:49:36,509 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:49:36,510 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 02:49:36,557 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 02:49:37,712 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024931.mp4
2025-03-20 02:49:37,713 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024931.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 02:49:39,727 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 02:49:42,736 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 02:49:42,737 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 02:49:45,738 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 02:49:45,739 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 02:49:45,739 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 02:49:46,921 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 02:49:46,922 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 02:49:46,922 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:49:46,922 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 02:49:47,022 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:49:49,037 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 02:49:49,038 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 02:49:49,038 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 02:49:51,327 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 02:49:51,329 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 02:49:59,530 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 02:49:59,531 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 02:49:59,532 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 02:49:59,532 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:49:59,820 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 02:49:59,821 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:00,109 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 02:50:00,110 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:00,328 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 02:50:00,328 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:00,568 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 02:50:00,569 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:00,820 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 02:50:00,821 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:01,053 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 02:50:01,054 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:01,311 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 02:50:01,312 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:01,526 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 02:50:01,527 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:01,781 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 02:50:01,782 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:50:04,035 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 02:50:04,036 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:50:04,036 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:50:04,199 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4e9ce19 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t983}
    * Task{c10baea #983 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:50:04,200 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:50:04,200 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 02:50:04,200 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 02:50:04,200 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_025004_20250320_025004.png
2025-03-20 02:50:05,680 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_025004_20250320_025004.png
2025-03-20 02:50:05,680 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_025004_20250320_025004.png
2025-03-20 02:50:05,681 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:50:12,931 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 02:50:13,860 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_266.jpg
2025-03-20 02:50:13,866 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_266.jpg
2025-03-20 02:50:13,866 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 02:50:13,866 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:50:13,866 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:50:24,027 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 02:50:24,027 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:50:24,028 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:50:24,135 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4e9ce19 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t983}
    * Task{c10baea #983 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:50:24,135 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:50:24,135 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 02:50:24,135 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 02:50:24,135 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_025024_20250320_025024.png
2025-03-20 02:50:25,580 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_025024_20250320_025024.png
2025-03-20 02:50:25,581 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_025024_20250320_025024.png
2025-03-20 02:50:25,581 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:50:30,124 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_266.jpg
2025-03-20 02:50:30,129 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_266.jpg
2025-03-20 02:50:30,130 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 02:50:30,130 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 02:50:30,130 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:50:30,130 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:50:32,253 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 02:50:32,254 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 02:50:32,254 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 02:50:32,254 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 02:50:33,259 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 02:50:34,268 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 02:50:34,269 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 02:50:34,269 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 117.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 02:50:34,269 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 02:50:44,275 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024931.mp4 (大小: 3.41MB)
2025-03-20 02:50:44,276 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 02:50:44,388 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.697767秒，无需修复
2025-03-20 02:50:44,388 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 02:50:44,388 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_024931.mp4
2025-03-20 02:50:44,388 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 02:50:52,229 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_267.mp4
2025-03-20 02:50:52,235 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_267.mp4
2025-03-20 02:50:52,235 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:50:52,235 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:50:57,515 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:50:57,516 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_267.mp4
2025-03-20 02:50:57,516 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 02:50:57,516 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 02:50:57,516 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 02:50:57,872 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 02:50:58,880 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 02:50:58,880 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:50:58,880 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:50:59,979 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 02:50:59,980 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 02:50:59,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 02:51:02,093 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 02:51:02,094 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 02:51:03,269 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 02:51:03,270 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:51:03,270 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:51:04,384 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 02:51:04,385 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 02:51:04,385 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 02:51:04,386 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 02:48:44\n- 结束时间: 2025-03-20 02:51:04\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_266.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_266.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_267.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 02:51:04"}]}]}}
2025-03-20 02:51:04,718 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 02:51:04,721 - QuickAppADBTester - INFO - 测试完成
2025-03-20 02:56:04,916 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 02:56:04,918 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 02:56:04,918 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 02:56:04,918 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 02:56:05,045 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 02:56:05,197 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 02:56:05,198 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 02:56:05,198 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 02:56:05,198 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 02:56:05,439 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 02:56:05,440 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 02:56:05,440 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 02:56:05,440 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 02:56:06,952 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:56:06,953 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:56:08,228 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 02:56:08,229 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 02:56:08,229 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 02:56:08,229 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 02:56:08,229 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 02:56:08,381 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 02:56:08,382 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 02:56:08,382 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 02:56:08,383 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 02:56:09,790 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:56:09,791 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:56:11,070 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 02:56:11,070 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 02:56:11,070 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 02:56:11,070 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:56:11,070 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:56:12,171 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 02:56:12,172 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 02:56:12,300 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 02:56:14,307 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 02:56:14,308 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 02:56:15,406 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 02:56:15,407 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 02:56:15,407 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:56:15,407 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 02:56:15,485 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:56:17,505 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 02:56:17,506 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 02:56:19,706 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 02:56:19,707 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 02:56:21,800 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 02:56:21,801 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 02:56:22,906 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 02:56:22,907 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 02:56:22,907 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:56:22,907 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 02:56:22,983 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:56:25,001 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 02:56:25,001 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 02:56:27,208 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 02:56:27,209 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 02:56:28,621 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 02:56:30,107 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 02:56:30,108 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 02:56:31,313 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 02:56:31,314 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 02:56:32,434 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 02:56:32,435 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 02:56:34,633 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 02:56:34,634 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 02:56:34,634 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 02:56:34,634 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:56:34,634 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:56:35,822 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 02:56:35,823 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 02:56:35,942 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 02:56:40,952 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 02:56:40,952 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 02:56:43,111 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 02:56:43,112 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 02:56:48,273 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 02:56:48,274 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 02:56:50,436 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 02:56:55,448 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 02:56:55,449 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_025655.mp4
2025-03-20 02:56:55,449 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:56:55,449 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:57:00,739 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:57:00,742 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 02:57:00,787 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 02:57:01,947 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_025655.mp4
2025-03-20 02:57:01,948 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_025655.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 02:57:03,961 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 02:57:06,969 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 02:57:06,971 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 02:57:09,980 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 02:57:09,981 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 02:57:09,981 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 02:57:11,181 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 02:57:11,182 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 02:57:11,182 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 02:57:11,183 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 02:57:11,282 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 02:57:13,289 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 02:57:13,290 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 02:57:13,290 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 02:57:15,587 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 02:57:15,589 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 02:57:23,792 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 02:57:23,793 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 02:57:23,793 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 02:57:23,794 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:24,135 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 02:57:24,136 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:24,368 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 02:57:24,368 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:24,604 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 02:57:24,605 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:24,835 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 02:57:24,836 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:25,091 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 02:57:25,092 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:25,321 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 02:57:25,322 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:25,549 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 02:57:25,550 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:25,768 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 02:57:25,769 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:26,014 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 02:57:26,015 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 02:57:28,266 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 02:57:28,267 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:57:28,267 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:57:28,370 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7a76c12 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t989}
    * Task{88ac899 #989 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:57:28,370 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:57:28,370 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 02:57:28,370 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 02:57:28,371 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_025728_20250320_025728.png
2025-03-20 02:57:29,741 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_025728_20250320_025728.png
2025-03-20 02:57:29,742 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_025728_20250320_025728.png
2025-03-20 02:57:29,742 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:57:37,159 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 02:57:37,315 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_268.jpg
2025-03-20 02:57:37,321 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_268.jpg
2025-03-20 02:57:37,321 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 02:57:37,321 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:57:37,321 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:57:47,434 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 02:57:47,435 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 02:57:47,435 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 02:57:47,542 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7a76c12 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t989}
    * Task{88ac899 #989 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 02:57:47,542 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 02:57:47,542 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 02:57:47,542 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 02:57:47,542 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_025747_20250320_025747.png
2025-03-20 02:57:48,885 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_025747_20250320_025747.png
2025-03-20 02:57:48,885 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_025747_20250320_025747.png
2025-03-20 02:57:48,886 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 02:57:53,421 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg
2025-03-20 02:57:53,427 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg
2025-03-20 02:57:53,427 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 02:57:53,427 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 02:57:53,427 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:57:53,427 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:57:55,538 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 02:57:55,539 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 02:57:55,539 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 02:57:55,539 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 02:57:56,545 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 02:57:57,554 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 02:57:57,555 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 02:57:57,555 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 115.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 02:57:57,555 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 02:58:07,562 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_025655.mp4 (大小: 3.04MB)
2025-03-20 02:58:07,563 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 02:58:07,674 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.730600秒，无需修复
2025-03-20 02:58:07,675 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 02:58:07,675 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_025655.mp4
2025-03-20 02:58:07,675 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 02:58:15,435 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_269.mp4
2025-03-20 02:58:15,440 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_269.mp4
2025-03-20 02:58:15,440 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 02:58:15,440 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 02:58:20,718 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 02:58:20,720 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_269.mp4
2025-03-20 02:58:20,720 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 02:58:20,720 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 02:58:20,720 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 02:58:21,076 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 02:58:22,086 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 02:58:22,086 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:58:22,086 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:58:23,194 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 02:58:23,195 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 02:58:23,195 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 02:58:25,306 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 02:58:25,307 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 02:58:26,474 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 02:58:26,475 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 02:58:26,475 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 02:58:27,616 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 02:58:27,617 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 02:58:27,618 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 02:58:27,618 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 02:56:08\n- 结束时间: 2025-03-20 02:58:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_268.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_246.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_269.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 02:58:27"}]}]}}
2025-03-20 02:58:27,946 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 02:58:27,949 - QuickAppADBTester - INFO - 测试完成
2025-03-20 03:03:28,171 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 03:03:28,173 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 03:03:28,173 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 03:03:28,173 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 03:03:28,304 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 03:03:28,452 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 03:03:28,453 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 03:03:28,453 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:03:28,453 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:03:28,671 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:03:28,672 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:03:28,672 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:03:28,673 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:03:30,168 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:03:30,169 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:03:31,444 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:03:31,445 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 03:03:31,445 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 03:03:31,445 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:03:31,445 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:03:31,597 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:03:31,598 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:03:31,598 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:03:31,598 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:03:33,017 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:03:33,018 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:03:34,286 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:03:34,286 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 03:03:34,286 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:03:34,286 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:03:34,286 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:03:35,385 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 03:03:35,385 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 03:03:35,500 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 03:03:37,509 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 03:03:37,509 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 03:03:38,602 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 03:03:38,603 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 03:03:38,603 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:03:38,604 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 03:03:38,679 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:03:40,698 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 03:03:40,698 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 03:03:42,916 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 03:03:42,917 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 03:03:45,010 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 03:03:45,011 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 03:03:46,123 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 03:03:46,124 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 03:03:46,124 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:03:46,124 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 03:03:46,202 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:03:48,220 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 03:03:48,221 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 03:03:50,415 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 03:03:50,416 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 03:03:51,849 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 03:03:53,349 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 03:03:53,350 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 03:03:54,544 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 03:03:54,544 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 03:03:55,653 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 03:03:55,654 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 03:03:57,836 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 03:03:57,837 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 03:03:57,837 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:03:57,837 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:03:57,837 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:03:59,000 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 03:03:59,001 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 03:03:59,117 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 03:04:04,126 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 03:04:04,127 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 03:04:06,282 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 03:04:06,283 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 03:04:11,421 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 03:04:11,422 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 03:04:13,573 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 03:04:18,582 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 03:04:18,583 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_030418.mp4
2025-03-20 03:04:18,583 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:04:18,584 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:04:23,873 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:04:23,874 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 03:04:23,920 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 03:04:25,130 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_030418.mp4
2025-03-20 03:04:25,131 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_030418.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 03:04:27,147 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 03:04:30,157 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 03:04:30,158 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 03:04:33,167 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 03:04:33,168 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 03:04:33,168 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 03:04:34,350 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 03:04:34,351 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 03:04:34,351 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:04:34,352 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 03:04:34,455 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:04:36,473 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 03:04:36,473 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 03:04:36,473 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 03:04:38,783 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 03:04:38,784 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 03:04:46,983 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 03:04:46,984 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 03:04:46,985 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 03:04:46,985 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:47,330 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 03:04:47,331 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:47,565 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 03:04:47,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:47,805 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 03:04:47,805 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:48,031 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 03:04:48,032 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:48,281 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 03:04:48,281 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:48,514 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 03:04:48,515 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:48,753 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 03:04:48,754 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:48,985 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 03:04:48,986 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:49,232 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 03:04:49,233 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:04:51,464 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 03:04:51,465 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:04:51,465 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:04:51,590 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a2dabfd u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t995}
    * Task{e258dc0 #995 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:04:51,591 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:04:51,591 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 03:04:51,592 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 03:04:51,592 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_030451_20250320_030451.png
2025-03-20 03:04:52,814 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_030451_20250320_030451.png
2025-03-20 03:04:52,816 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_030451_20250320_030451.png
2025-03-20 03:04:52,816 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:05:00,099 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_270.jpg
2025-03-20 03:05:00,106 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_270.jpg
2025-03-20 03:05:00,106 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 03:05:00,106 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:05:00,106 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:05:00,387 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 03:05:10,260 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 03:05:10,260 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:05:10,260 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:05:10,387 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a2dabfd u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t995}
    * Task{e258dc0 #995 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:05:10,388 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:05:10,388 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 03:05:10,388 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 03:05:10,388 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_030510_20250320_030510.png
2025-03-20 03:05:11,634 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_030510_20250320_030510.png
2025-03-20 03:05:11,635 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_030510_20250320_030510.png
2025-03-20 03:05:11,635 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:05:16,081 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg
2025-03-20 03:05:16,087 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg
2025-03-20 03:05:16,087 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 03:05:16,087 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 03:05:16,088 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:05:16,088 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:05:18,234 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 03:05:18,235 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 03:05:18,235 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 03:05:18,235 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 03:05:19,240 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 03:05:20,248 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 03:05:20,248 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 03:05:20,249 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 121.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 03:05:20,249 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 03:05:30,258 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_030418.mp4 (大小: 2.93MB)
2025-03-20 03:05:30,258 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 03:05:30,378 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.149900秒，无需修复
2025-03-20 03:05:30,378 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 03:05:30,378 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_030418.mp4
2025-03-20 03:05:30,378 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 03:05:37,803 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_271.mp4
2025-03-20 03:05:37,811 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_271.mp4
2025-03-20 03:05:37,812 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:05:37,812 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:05:43,032 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:05:43,034 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_271.mp4
2025-03-20 03:05:43,034 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 03:05:43,034 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 03:05:43,034 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 03:05:43,371 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 03:05:44,380 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 03:05:44,380 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:05:44,381 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:05:45,490 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 03:05:45,491 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 03:05:45,491 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 03:05:47,606 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 03:05:47,606 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 03:05:48,777 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 03:05:48,778 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:05:48,778 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:05:49,924 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 03:05:49,924 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 03:05:49,924 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 03:05:49,924 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 03:03:31\n- 结束时间: 2025-03-20 03:05:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_270.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_242.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_271.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 03:05:49"}]}]}}
2025-03-20 03:05:50,266 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 03:05:50,267 - QuickAppADBTester - INFO - 测试完成
2025-03-20 03:10:50,375 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 03:10:50,377 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 03:10:50,377 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 03:10:50,377 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 03:10:50,504 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 03:10:50,648 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 03:10:50,649 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 03:10:50,649 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:10:50,649 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:10:50,891 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:10:50,891 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:10:50,891 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:10:50,892 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:10:52,341 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:10:52,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:10:53,627 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:10:53,627 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 03:10:53,627 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 03:10:53,627 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:10:53,627 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:10:53,772 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:10:53,772 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:10:53,773 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:10:53,773 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:10:55,188 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:10:55,189 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:10:56,446 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:10:56,447 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 03:10:56,447 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:10:56,447 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:10:56,447 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:10:57,548 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 03:10:57,549 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 03:10:57,677 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 03:10:59,680 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 03:10:59,680 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 03:11:00,775 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 03:11:00,776 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 03:11:00,776 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:11:00,776 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 03:11:00,854 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:11:02,874 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 03:11:02,874 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 03:11:05,067 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 03:11:05,068 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 03:11:07,158 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 03:11:07,159 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 03:11:08,262 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 03:11:08,263 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 03:11:08,263 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:11:08,263 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 03:11:08,334 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:11:10,352 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 03:11:10,352 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 03:11:12,522 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 03:11:12,523 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 03:11:13,942 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 03:11:15,405 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 03:11:15,406 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 03:11:16,611 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 03:11:16,611 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 03:11:17,723 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 03:11:17,724 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 03:11:19,929 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 03:11:19,929 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 03:11:19,929 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:11:19,929 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:11:19,929 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:11:21,095 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 03:11:21,096 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 03:11:21,219 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 03:11:26,228 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 03:11:26,229 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 03:11:28,380 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 03:11:28,381 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 03:11:33,521 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 03:11:33,522 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 03:11:35,677 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 03:11:40,678 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 03:11:40,679 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_031140.mp4
2025-03-20 03:11:40,679 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:11:40,679 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:11:45,963 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:11:45,964 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 03:11:46,010 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 03:11:47,171 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031140.mp4
2025-03-20 03:11:47,172 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031140.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 03:11:49,188 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 03:11:52,198 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 03:11:52,198 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 03:11:55,207 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 03:11:55,207 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 03:11:55,207 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 03:11:56,389 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 03:11:56,390 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 03:11:56,391 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:11:56,391 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 03:11:56,495 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:11:58,508 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 03:11:58,509 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 03:11:58,509 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 03:12:00,793 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 03:12:00,794 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 03:12:09,003 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 03:12:09,004 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 03:12:09,004 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 03:12:09,004 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:09,347 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 03:12:09,348 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:09,608 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 03:12:09,609 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:09,882 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 03:12:09,884 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:10,108 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 03:12:10,109 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:10,338 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 03:12:10,339 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:10,593 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 03:12:10,594 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:10,863 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 03:12:10,864 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:11,092 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 03:12:11,093 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:11,320 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 03:12:11,321 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:12:13,544 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 03:12:13,545 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:12:13,545 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:12:13,649 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{acced1c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1001}
    * Task{e49bf08 #1001 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:12:13,649 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:12:13,649 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 03:12:13,649 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 03:12:13,650 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_031213_20250320_031213.png
2025-03-20 03:12:15,295 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_031213_20250320_031213.png
2025-03-20 03:12:15,295 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_031213_20250320_031213.png
2025-03-20 03:12:15,296 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:12:19,972 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 03:12:19,973 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 03:12:19,973 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 03:12:19,973 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:12:19,973 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:12:22,402 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 03:12:30,076 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 03:12:30,077 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:12:30,077 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:12:30,217 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{acced1c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1001}
    * Task{e49bf08 #1001 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:12:30,218 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:12:30,218 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 03:12:30,218 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 03:12:30,219 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_031230_20250320_031230.png
2025-03-20 03:12:31,805 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_031230_20250320_031230.png
2025-03-20 03:12:31,806 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_031230_20250320_031230.png
2025-03-20 03:12:31,806 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:12:36,346 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 03:12:36,352 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg
2025-03-20 03:12:36,353 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 03:12:36,353 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 03:12:36,353 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:12:36,353 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:12:38,528 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 03:12:38,528 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 03:12:38,529 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 03:12:38,529 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 03:12:39,535 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 03:12:40,544 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 03:12:40,545 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 03:12:40,545 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 113.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 03:12:40,545 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 03:12:50,552 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031140.mp4 (大小: 3.38MB)
2025-03-20 03:12:50,552 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 03:12:50,682 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.504244秒，无需修复
2025-03-20 03:12:50,682 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 03:12:50,682 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031140.mp4
2025-03-20 03:12:50,682 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 03:13:00,197 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_272.mp4
2025-03-20 03:13:00,205 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_272.mp4
2025-03-20 03:13:00,205 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:13:00,205 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:13:05,433 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:13:05,434 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_272.mp4
2025-03-20 03:13:05,435 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 03:13:05,435 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 03:13:05,435 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 03:13:05,768 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 03:13:06,773 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 03:13:06,773 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:13:06,773 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:13:07,883 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 03:13:07,884 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 03:13:07,884 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 03:13:09,989 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 03:13:09,990 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 03:13:11,135 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 03:13:11,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:13:11,136 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:13:12,272 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 03:13:12,272 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 03:13:12,273 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 03:13:12,273 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 03:10:53\n- 结束时间: 2025-03-20 03:13:12\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_260.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_272.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 03:13:12"}]}]}}
2025-03-20 03:13:12,602 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 03:13:12,606 - QuickAppADBTester - INFO - 测试完成
2025-03-20 03:18:12,790 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 03:18:12,792 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 03:18:12,792 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 03:18:12,792 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 03:18:12,938 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 03:18:13,072 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 03:18:13,073 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 03:18:13,073 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:18:13,073 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:18:13,288 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:18:13,289 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:18:13,289 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:18:13,289 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:18:14,767 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:18:14,768 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:18:16,043 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:18:16,043 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 03:18:16,043 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 03:18:16,044 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:18:16,044 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:18:16,189 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:18:16,190 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:18:16,190 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:18:16,190 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:18:17,603 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:18:17,604 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:18:18,884 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:18:18,884 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 03:18:18,884 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:18:18,884 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:18:18,884 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:18:19,985 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 03:18:19,985 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 03:18:20,091 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 03:18:22,101 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 03:18:22,102 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 03:18:23,197 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 03:18:23,198 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 03:18:23,199 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:18:23,199 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 03:18:23,275 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:18:25,290 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 03:18:25,290 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 03:18:27,484 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 03:18:27,485 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 03:18:29,576 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 03:18:29,577 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 03:18:30,689 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 03:18:30,690 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 03:18:30,690 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:18:30,690 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 03:18:30,763 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:18:32,780 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 03:18:32,781 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 03:18:35,000 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 03:18:35,001 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 03:18:36,417 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 03:18:37,902 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 03:18:37,903 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 03:18:39,098 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 03:18:39,099 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 03:18:40,205 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 03:18:40,206 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 03:18:42,365 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 03:18:42,366 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 03:18:42,366 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:18:42,366 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:18:42,366 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:18:43,550 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 03:18:43,551 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 03:18:43,674 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 03:18:48,684 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 03:18:48,684 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 03:18:50,853 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 03:18:50,854 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 03:18:56,002 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 03:18:56,003 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 03:18:58,156 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 03:19:03,166 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 03:19:03,167 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_031903.mp4
2025-03-20 03:19:03,167 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:19:03,167 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:19:08,450 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:19:08,451 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 03:19:08,496 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 03:19:09,708 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031903.mp4
2025-03-20 03:19:09,709 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031903.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 03:19:11,722 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 03:19:14,732 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 03:19:14,732 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 03:19:17,737 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 03:19:17,738 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 03:19:17,738 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 03:19:18,920 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 03:19:18,921 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 03:19:18,921 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:19:18,922 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 03:19:19,017 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:19:21,028 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 03:19:21,029 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 03:19:21,029 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 03:19:23,340 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 03:19:23,341 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 03:19:31,516 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 03:19:31,517 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 03:19:31,517 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 03:19:31,518 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:31,829 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 03:19:31,830 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:32,100 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 03:19:32,101 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:32,324 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 03:19:32,325 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:32,545 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 03:19:32,546 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:32,805 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 03:19:32,805 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:33,066 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 03:19:33,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:33,329 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 03:19:33,330 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:33,562 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 03:19:33,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:33,825 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 03:19:33,826 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:19:36,071 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 03:19:36,072 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:19:36,072 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:19:36,215 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{327403a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1007}
    * Task{14128e1 #1007 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:19:36,216 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:19:36,216 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 03:19:36,217 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 03:19:36,217 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_031936_20250320_031936.png
2025-03-20 03:19:37,900 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_031936_20250320_031936.png
2025-03-20 03:19:37,900 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_031936_20250320_031936.png
2025-03-20 03:19:37,901 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:19:44,966 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 03:19:45,922 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_273.jpg
2025-03-20 03:19:45,928 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_273.jpg
2025-03-20 03:19:45,928 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 03:19:45,929 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:19:45,929 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:19:56,054 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 03:19:56,055 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:19:56,055 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:19:56,139 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{327403a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1007}
    * Task{14128e1 #1007 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:19:56,139 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:19:56,139 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 03:19:56,139 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 03:19:56,139 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_031956_20250320_031956.png
2025-03-20 03:19:57,789 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_031956_20250320_031956.png
2025-03-20 03:19:57,789 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_031956_20250320_031956.png
2025-03-20 03:19:57,790 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:20:03,788 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_274.jpg
2025-03-20 03:20:03,792 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_274.jpg
2025-03-20 03:20:03,792 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 03:20:03,792 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 03:20:03,792 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:20:03,792 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:20:05,927 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 03:20:05,927 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 03:20:05,928 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 03:20:05,928 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 03:20:06,935 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 03:20:07,944 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 03:20:07,945 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 03:20:07,945 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 03:20:07,945 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 03:20:17,955 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031903.mp4 (大小: 3.41MB)
2025-03-20 03:20:17,956 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 03:20:18,063 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.377133秒，无需修复
2025-03-20 03:20:18,063 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 03:20:18,063 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_031903.mp4
2025-03-20 03:20:18,063 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 03:20:25,101 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_275.mp4
2025-03-20 03:20:25,107 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_275.mp4
2025-03-20 03:20:25,107 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:20:25,108 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:20:30,395 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:20:30,396 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_275.mp4
2025-03-20 03:20:30,397 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 03:20:30,397 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 03:20:30,397 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 03:20:30,840 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 03:20:31,843 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 03:20:31,844 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:20:31,844 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:20:32,952 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 03:20:32,953 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 03:20:32,953 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 03:20:35,067 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 03:20:35,068 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 03:20:36,221 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 03:20:36,222 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:20:36,222 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:20:37,353 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 03:20:37,353 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 03:20:37,354 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 03:20:37,354 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 03:18:16\n- 结束时间: 2025-03-20 03:20:37\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_273.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_274.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_275.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 03:20:37"}]}]}}
2025-03-20 03:20:37,687 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 03:20:37,690 - QuickAppADBTester - INFO - 测试完成
2025-03-20 03:25:37,897 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 03:25:37,899 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 03:25:37,899 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 03:25:37,899 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 03:25:38,035 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 03:25:38,217 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 03:25:38,218 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 03:25:38,218 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:25:38,218 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:25:38,453 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:25:38,454 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:25:38,454 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:25:38,454 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:25:39,937 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:25:39,938 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:25:41,195 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:25:41,195 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 03:25:41,196 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 03:25:41,196 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:25:41,196 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:25:41,353 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:25:41,353 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:25:41,353 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:25:41,353 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:25:42,764 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:25:42,765 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:25:44,057 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:25:44,057 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 03:25:44,057 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:25:44,057 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:25:44,057 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:25:45,162 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 03:25:45,163 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 03:25:45,289 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 03:25:47,294 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 03:25:47,295 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 03:25:48,391 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 03:25:48,392 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 03:25:48,392 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:25:48,392 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 03:25:48,472 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:25:50,487 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 03:25:50,488 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 03:25:52,669 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 03:25:52,670 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 03:25:54,763 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 03:25:54,764 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 03:25:55,882 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 03:25:55,883 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 03:25:55,883 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:25:55,883 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 03:25:55,959 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:25:57,977 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 03:25:57,977 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 03:26:00,162 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 03:26:00,163 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 03:26:01,595 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 03:26:03,084 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 03:26:03,085 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 03:26:04,259 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 03:26:04,260 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 03:26:05,363 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 03:26:05,364 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 03:26:07,549 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 03:26:07,550 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 03:26:07,550 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:26:07,550 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:26:07,551 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:26:08,721 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 03:26:08,722 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 03:26:08,845 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 03:26:13,856 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 03:26:13,857 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 03:26:16,017 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 03:26:16,018 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 03:26:21,278 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 03:26:21,279 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 03:26:23,422 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 03:26:28,432 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 03:26:28,432 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_032628.mp4
2025-03-20 03:26:28,433 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:26:28,433 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:26:33,650 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:26:33,651 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 03:26:33,699 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 03:26:34,861 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_032628.mp4
2025-03-20 03:26:34,862 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_032628.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 03:26:36,877 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 03:26:39,884 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 03:26:39,885 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 03:26:42,893 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 03:26:42,894 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 03:26:42,894 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 03:26:44,074 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 03:26:44,075 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 03:26:44,075 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:26:44,075 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 03:26:44,173 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:26:46,190 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 03:26:46,190 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 03:26:46,190 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 03:26:48,454 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 03:26:48,454 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 03:26:56,656 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 03:26:56,657 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 03:26:56,657 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 03:26:56,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:56,964 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 03:26:56,965 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:57,231 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 03:26:57,231 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:57,459 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 03:26:57,459 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:57,709 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 03:26:57,710 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:57,944 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 03:26:57,945 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:58,195 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 03:26:58,196 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:58,423 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 03:26:58,424 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:58,660 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 03:26:58,661 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:26:58,917 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 03:26:58,918 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:27:01,149 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 03:27:01,150 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:27:01,151 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:27:01,265 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4fe0ca5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1013}
    * Task{c7d4488 #1013 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:27:01,266 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:27:01,266 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 03:27:01,266 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 03:27:01,266 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_032701_20250320_032701.png
2025-03-20 03:27:02,691 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_032701_20250320_032701.png
2025-03-20 03:27:02,692 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_032701_20250320_032701.png
2025-03-20 03:27:02,692 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:27:09,977 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_276.jpg
2025-03-20 03:27:09,983 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_276.jpg
2025-03-20 03:27:09,983 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 03:27:09,983 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:27:09,983 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:27:10,064 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 03:27:20,091 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 03:27:20,091 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:27:20,091 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:27:20,192 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4fe0ca5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1013}
    * Task{c7d4488 #1013 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:27:20,192 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:27:20,192 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 03:27:20,192 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 03:27:20,192 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_032720_20250320_032720.png
2025-03-20 03:27:21,614 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_032720_20250320_032720.png
2025-03-20 03:27:21,615 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_032720_20250320_032720.png
2025-03-20 03:27:21,615 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:27:26,259 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg
2025-03-20 03:27:26,264 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg
2025-03-20 03:27:26,264 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 03:27:26,264 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 03:27:26,265 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:27:26,265 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:27:28,408 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 03:27:28,409 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 03:27:28,409 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 03:27:28,410 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 03:27:29,416 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 03:27:30,426 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 03:27:30,426 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 03:27:30,426 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 151.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 03:27:30,427 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 03:27:40,435 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_032628.mp4 (大小: 3.29MB)
2025-03-20 03:27:40,435 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 03:27:40,539 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.595556秒，无需修复
2025-03-20 03:27:40,539 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 03:27:40,539 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_032628.mp4
2025-03-20 03:27:40,539 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 03:27:47,956 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_277.mp4
2025-03-20 03:27:47,961 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_277.mp4
2025-03-20 03:27:47,961 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:27:47,961 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:27:53,169 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:27:53,170 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_277.mp4
2025-03-20 03:27:53,170 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 03:27:53,170 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 03:27:53,170 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 03:27:53,618 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 03:27:54,629 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 03:27:54,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:27:54,630 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:27:55,735 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 03:27:55,736 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 03:27:55,736 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 03:27:57,842 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 03:27:57,843 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 03:27:59,011 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 03:27:59,011 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:27:59,012 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:28:00,161 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 03:28:00,162 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 03:28:00,162 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 03:28:00,162 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 03:25:41\n- 结束时间: 2025-03-20 03:28:00\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_276.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_255.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_277.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 03:28:00"}]}]}}
2025-03-20 03:28:00,494 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 03:28:00,497 - QuickAppADBTester - INFO - 测试完成
2025-03-20 03:33:00,732 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 03:33:00,735 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 03:33:00,735 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 03:33:00,735 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 03:33:00,860 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 03:33:01,020 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 03:33:01,021 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 03:33:01,021 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:33:01,021 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:33:01,271 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:33:01,272 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:33:01,272 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:33:01,272 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:33:02,770 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:33:02,771 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:33:04,065 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:33:04,065 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 03:33:04,066 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 03:33:04,066 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:33:04,066 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:33:04,212 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:33:04,212 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:33:04,213 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:33:04,213 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:33:05,612 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:33:05,613 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:33:06,882 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:33:06,883 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 03:33:06,883 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:33:06,883 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:33:06,883 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:33:07,973 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 03:33:07,974 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 03:33:08,103 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 03:33:10,113 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 03:33:10,114 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 03:33:11,212 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 03:33:11,213 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 03:33:11,213 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:33:11,213 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 03:33:11,287 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:33:13,307 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 03:33:13,308 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 03:33:15,499 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 03:33:15,500 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 03:33:17,591 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 03:33:17,592 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 03:33:18,704 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 03:33:18,705 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 03:33:18,705 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:33:18,705 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 03:33:18,781 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:33:20,800 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 03:33:20,801 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 03:33:23,024 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 03:33:23,025 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 03:33:24,442 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 03:33:25,920 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 03:33:25,921 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 03:33:27,078 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 03:33:27,079 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 03:33:28,187 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 03:33:28,188 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 03:33:30,379 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 03:33:30,380 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 03:33:30,380 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:33:30,380 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:33:30,380 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:33:31,537 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 03:33:31,538 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 03:33:31,656 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 03:33:36,661 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 03:33:36,662 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 03:33:38,841 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 03:33:38,843 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 03:33:44,004 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 03:33:44,005 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 03:33:46,178 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 03:33:51,184 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 03:33:51,184 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_033351.mp4
2025-03-20 03:33:51,185 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:33:51,185 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:33:56,473 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:33:56,475 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 03:33:56,521 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 03:33:57,682 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_033351.mp4
2025-03-20 03:33:57,683 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_033351.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 03:33:59,698 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 03:34:02,702 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 03:34:02,704 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 03:34:05,711 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 03:34:05,712 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 03:34:05,712 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 03:34:06,913 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 03:34:06,914 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 03:34:06,914 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:34:06,915 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 03:34:07,017 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:34:09,028 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 03:34:09,028 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 03:34:09,029 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 03:34:11,283 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 03:34:11,284 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 03:34:19,486 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 03:34:19,487 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 03:34:19,488 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 03:34:19,488 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:19,789 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 03:34:19,790 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:20,081 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 03:34:20,081 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:20,293 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 03:34:20,293 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:20,507 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 03:34:20,507 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:20,731 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 03:34:20,732 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:21,017 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 03:34:21,018 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:21,249 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 03:34:21,250 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:21,487 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 03:34:21,488 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:21,717 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 03:34:21,718 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 03:34:23,970 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 03:34:23,971 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:34:23,971 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:34:24,088 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d17f6d4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1019}
    * Task{7bd5bc3 #1019 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:34:24,089 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:34:24,089 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 03:34:24,089 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 03:34:24,089 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_033424_20250320_033424.png
2025-03-20 03:34:25,428 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_033424_20250320_033424.png
2025-03-20 03:34:25,428 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_033424_20250320_033424.png
2025-03-20 03:34:25,428 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:34:32,905 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 03:34:33,456 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 03:34:33,460 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 03:34:33,460 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 03:34:33,460 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:34:33,461 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:34:43,557 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 03:34:43,559 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 03:34:43,560 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 03:34:43,668 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d17f6d4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1019}
    * Task{7bd5bc3 #1019 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 03:34:43,668 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 03:34:43,669 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 03:34:43,669 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 03:34:43,669 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_033443_20250320_033443.png
2025-03-20 03:34:44,967 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_033443_20250320_033443.png
2025-03-20 03:34:44,968 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_033443_20250320_033443.png
2025-03-20 03:34:44,969 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 03:34:49,562 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 03:34:49,567 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 03:34:49,568 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 03:34:49,568 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 03:34:49,568 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:34:49,568 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:34:51,728 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 03:34:51,729 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 03:34:51,729 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 03:34:51,729 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 03:34:52,737 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 03:34:53,745 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 03:34:53,746 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 03:34:53,746 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 119.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 03:34:53,746 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 03:35:03,749 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_033351.mp4 (大小: 3.64MB)
2025-03-20 03:35:03,749 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 03:35:03,871 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.135433秒，无需修复
2025-03-20 03:35:03,871 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 03:35:03,871 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_033351.mp4
2025-03-20 03:35:03,871 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 03:35:12,042 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_279.mp4
2025-03-20 03:35:12,049 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_279.mp4
2025-03-20 03:35:12,049 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:35:12,049 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 03:35:17,277 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 03:35:17,278 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_279.mp4
2025-03-20 03:35:17,279 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 03:35:17,279 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 03:35:17,279 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 03:35:17,670 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 03:35:18,679 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 03:35:18,680 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:35:18,680 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:35:19,780 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 03:35:19,781 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 03:35:19,781 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 03:35:21,890 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 03:35:21,891 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 03:35:23,033 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 03:35:23,034 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:35:23,034 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:35:24,154 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 03:35:24,155 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 03:35:24,155 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 03:35:24,156 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 03:33:04\n- 结束时间: 2025-03-20 03:35:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_279.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 03:35:24"}]}]}}
2025-03-20 03:35:24,483 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 03:35:24,486 - QuickAppADBTester - INFO - 测试完成
2025-03-20 03:45:54,555 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 03:45:54,556 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 03:45:54,556 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 03:45:54,556 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 03:45:54,674 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 03:45:54,812 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 03:45:54,813 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 03:45:54,813 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:45:54,813 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:45:55,043 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:45:55,043 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:45:55,044 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:45:55,044 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:45:56,559 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:45:56,560 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:45:57,839 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:45:57,840 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 03:45:57,840 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 03:45:57,840 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 03:45:57,840 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 03:45:57,989 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 03:45:57,990 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 03:45:57,990 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 03:45:57,990 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 03:45:59,403 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:45:59,404 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:46:00,638 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 03:46:00,638 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 03:46:00,638 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:46:00,638 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:46:00,638 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:46:01,734 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 03:46:01,735 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 03:46:01,849 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 03:46:03,859 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 03:46:03,860 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 03:46:04,963 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 03:46:04,964 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 03:46:04,964 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:46:04,964 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 03:46:05,035 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:46:07,052 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 03:46:07,053 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 03:46:09,231 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 03:46:09,232 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 03:46:11,324 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 03:46:11,325 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 03:46:12,436 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 03:46:12,436 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 03:46:12,436 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 03:46:12,436 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 03:46:12,544 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 03:46:14,557 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 03:46:14,557 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 03:46:16,774 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 03:46:16,774 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 03:46:18,195 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 03:46:19,690 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 03:46:19,691 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 03:46:20,869 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 03:46:20,870 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 03:46:21,984 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 03:46:21,986 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 03:46:24,138 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 03:46:24,139 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 03:46:24,139 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 03:46:24,139 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 03:46:24,139 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 03:46:25,284 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 03:46:25,285 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 03:46:25,404 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 03:46:30,412 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 03:46:30,413 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 03:46:32,572 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 03:46:32,573 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 03:46:37,725 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 03:46:37,726 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 03:46:39,887 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 03:46:44,891 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 03:46:44,891 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_034644.mp4
2025-03-20 03:46:44,891 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 03:46:44,891 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:02:27,035 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:02:27,036 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 04:02:27,077 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 04:02:28,231 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_034644.mp4
2025-03-20 04:02:28,232 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_034644.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 04:02:30,252 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 04:02:33,268 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 04:02:33,268 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 04:02:36,278 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 04:02:36,279 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 04:02:36,279 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 04:02:37,465 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 04:02:37,466 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 04:02:37,466 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:02:37,466 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 04:02:37,571 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:02:39,591 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 04:02:39,591 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 04:02:39,592 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 04:02:41,858 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 04:02:41,859 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 04:02:50,004 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 04:02:50,005 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 04:02:50,005 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 04:02:50,006 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:50,286 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 04:02:50,287 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:50,566 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 04:02:50,566 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:50,826 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 04:02:50,827 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:51,063 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 04:02:51,063 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:51,289 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 04:02:51,290 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:51,537 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 04:02:51,538 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:51,804 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 04:02:51,804 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:52,134 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 04:02:52,135 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:52,390 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 04:02:52,391 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:02:54,667 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 04:02:54,667 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:02:54,667 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:02:54,789 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{852de97 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1025}
    * Task{14e386d #1025 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:02:54,790 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:02:54,790 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 04:02:54,790 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 04:02:54,790 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_040254_20250320_040254.png
2025-03-20 04:02:56,446 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_040254_20250320_040254.png
2025-03-20 04:02:56,447 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_040254_20250320_040254.png
2025-03-20 04:02:56,447 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:03:03,496 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 04:03:04,845 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_280.jpg
2025-03-20 04:03:04,850 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_280.jpg
2025-03-20 04:03:04,850 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 04:03:04,850 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:03:04,850 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:18:14,909 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 04:18:14,911 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:18:14,911 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:18:15,024 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{852de97 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1025}
    * Task{14e386d #1025 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:18:15,025 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:18:15,025 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 04:18:15,025 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 04:18:15,026 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_041815_20250320_041815.png
2025-03-20 04:18:16,702 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_041815_20250320_041815.png
2025-03-20 04:18:16,702 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_041815_20250320_041815.png
2025-03-20 04:18:16,703 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:18:33,678 - QuickAppADBTester - INFO - 录制进行中，已录制约 960 秒
2025-03-20 04:18:44,933 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 04:18:44,938 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 04:18:44,942 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-20 04:18:44,942 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 04:18:44,942 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 04:18:44,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:18:44,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:18:47,066 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 04:18:47,067 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 04:18:47,067 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 04:18:47,067 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 04:18:48,073 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 04:18:49,077 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 04:18:49,077 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 04:18:49,077 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 129.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 04:18:49,077 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 04:18:59,087 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_034644.mp4 (大小: 3.64MB)
2025-03-20 04:18:59,089 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 04:18:59,236 - QuickAppADBTester - INFO - 录制文件完整，时长: 977.876289秒，无需修复
2025-03-20 04:18:59,236 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 04:18:59,236 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_034644.mp4
2025-03-20 04:18:59,236 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 04:19:08,799 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_281.mp4
2025-03-20 04:19:08,803 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_281.mp4
2025-03-20 04:19:08,803 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:19:08,803 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:19:14,085 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:19:14,086 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_281.mp4
2025-03-20 04:19:14,086 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 04:19:14,086 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 04:19:14,086 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 04:19:14,449 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 04:19:15,453 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 04:19:15,453 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:19:15,453 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:19:16,566 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 04:19:16,567 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 04:19:16,567 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 04:19:18,667 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 04:19:18,667 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 04:19:19,843 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 04:19:19,843 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:19:19,844 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:19:20,977 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 04:19:20,978 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 04:19:20,978 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-20 04:19:20,978 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 03:45:57\n- 结束时间: 2025-03-20 04:19:20\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_280.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_281.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 04:19:20"}]}]}}
2025-03-20 04:19:21,330 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 04:19:21,332 - QuickAppADBTester - INFO - 测试完成
2025-03-20 04:24:21,398 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 04:24:21,400 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 04:24:21,400 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 04:24:21,400 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 04:24:21,536 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 04:24:21,697 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 04:24:21,697 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 04:24:21,697 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:24:21,698 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:24:21,951 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:24:21,951 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:24:21,951 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:24:21,951 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:24:23,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:24:23,421 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:24:24,663 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:24:24,663 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 04:24:24,663 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 04:24:24,663 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:24:24,663 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:24:24,825 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:24:24,826 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:24:24,826 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:24:24,826 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:24:26,234 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:24:26,235 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:24:27,479 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:24:27,479 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 04:24:27,479 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:24:27,479 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:24:27,479 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:24:28,582 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 04:24:28,583 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 04:24:28,692 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 04:24:30,696 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 04:24:30,696 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 04:24:31,784 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 04:24:31,784 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 04:24:31,784 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:24:31,784 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 04:24:31,858 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:24:33,869 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 04:24:33,869 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 04:24:36,004 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 04:24:36,006 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 04:24:38,094 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 04:24:38,094 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 04:24:39,190 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 04:24:39,190 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 04:24:39,190 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:24:39,190 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 04:24:39,254 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:24:41,272 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 04:24:41,273 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 04:24:43,460 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 04:24:43,461 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 04:24:44,879 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 04:24:46,319 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 04:24:46,320 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 04:24:47,502 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 04:24:47,503 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 04:24:48,606 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 04:24:48,606 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 04:24:50,777 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 04:24:50,778 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 04:24:50,778 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:24:50,778 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:24:50,778 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:24:51,948 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 04:24:51,948 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 04:24:52,053 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 04:24:57,060 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 04:24:57,061 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 04:24:59,222 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 04:24:59,223 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 04:25:04,369 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 04:25:04,369 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 04:25:06,510 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 04:25:11,519 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 04:25:11,520 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_042511.mp4
2025-03-20 04:25:11,520 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:25:11,520 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:25:16,799 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:25:16,799 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 04:25:16,842 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 04:25:18,062 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_042511.mp4
2025-03-20 04:25:18,062 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_042511.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 04:25:20,075 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 04:25:23,077 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 04:25:23,078 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 04:25:26,087 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 04:25:26,088 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 04:25:26,088 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 04:25:27,270 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 04:25:27,270 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 04:25:27,270 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:25:27,270 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 04:25:27,369 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:25:29,385 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 04:25:29,386 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 04:25:29,386 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 04:25:31,638 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 04:25:31,639 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 04:25:39,829 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 04:25:39,829 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 04:25:39,829 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 04:25:39,829 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:40,087 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 04:25:40,087 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:40,311 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 04:25:40,312 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:40,534 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 04:25:40,534 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:40,767 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 04:25:40,767 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:41,044 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 04:25:41,045 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:41,262 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 04:25:41,263 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:41,498 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 04:25:41,499 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:41,726 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 04:25:41,727 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:41,943 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 04:25:41,944 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:25:44,171 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 04:25:44,172 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:25:44,172 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:25:44,291 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fc185b9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1031}
    * Task{5bf395f #1031 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:25:44,291 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:25:44,291 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 04:25:44,291 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 04:25:44,291 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_042544_20250320_042544.png
2025-03-20 04:25:45,802 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_042544_20250320_042544.png
2025-03-20 04:25:45,802 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_042544_20250320_042544.png
2025-03-20 04:25:45,803 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:25:52,965 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_282.jpg
2025-03-20 04:25:52,971 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_282.jpg
2025-03-20 04:25:52,971 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 04:25:52,971 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:25:52,971 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:25:53,243 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 04:26:03,136 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 04:26:03,136 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:26:03,136 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:26:03,267 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{fc185b9 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1031}
    * Task{5bf395f #1031 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:26:03,267 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:26:03,267 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 04:26:03,267 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 04:26:03,267 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_042603_20250320_042603.png
2025-03-20 04:26:04,743 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_042603_20250320_042603.png
2025-03-20 04:26:04,743 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_042603_20250320_042603.png
2025-03-20 04:26:04,743 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:26:10,609 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_283.jpg
2025-03-20 04:26:10,613 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_283.jpg
2025-03-20 04:26:10,613 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 04:26:10,614 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 04:26:10,614 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:26:10,614 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:26:12,737 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 04:26:12,737 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 04:26:12,737 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 04:26:12,738 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 04:26:13,748 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 04:26:14,756 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 04:26:14,756 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 04:26:14,757 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 75.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 04:26:14,757 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 04:26:24,765 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_042511.mp4 (大小: 3.84MB)
2025-03-20 04:26:24,765 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 04:26:24,878 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.797444秒，无需修复
2025-03-20 04:26:24,879 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 04:26:24,879 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_042511.mp4
2025-03-20 04:26:24,879 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 04:26:32,022 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_284.mp4
2025-03-20 04:26:32,027 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_284.mp4
2025-03-20 04:26:32,027 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:26:32,027 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:26:37,249 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:26:37,250 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_284.mp4
2025-03-20 04:26:37,250 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 04:26:37,250 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 04:26:37,250 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 04:26:37,631 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 04:26:38,638 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 04:26:38,639 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:26:38,639 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:26:39,739 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 04:26:39,740 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 04:26:39,740 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 04:26:41,843 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 04:26:41,844 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 04:26:43,012 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 04:26:43,012 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:26:43,012 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:26:44,115 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 04:26:44,116 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 04:26:44,116 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 04:26:44,117 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 04:24:24\n- 结束时间: 2025-03-20 04:26:44\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_282.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_283.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_284.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 04:26:44"}]}]}}
2025-03-20 04:26:44,442 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 04:26:44,444 - QuickAppADBTester - INFO - 测试完成
2025-03-20 04:31:44,560 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 04:31:44,562 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 04:31:44,562 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 04:31:44,562 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 04:31:44,694 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 04:31:44,847 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 04:31:44,847 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 04:31:44,847 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:31:44,847 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:31:45,057 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:31:45,057 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:31:45,057 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:31:45,057 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:31:46,542 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:31:46,542 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:31:47,759 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:31:47,759 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 04:31:47,759 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 04:31:47,760 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:31:47,760 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:31:47,926 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:31:47,926 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:31:47,926 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:31:47,926 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:31:49,333 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:31:49,333 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:31:50,579 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:31:50,580 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 04:31:50,580 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:31:50,580 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:31:50,580 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:31:51,681 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 04:31:51,681 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 04:31:51,789 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 04:31:53,792 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 04:31:53,792 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 04:31:54,876 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 04:31:54,877 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 04:31:54,877 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:31:54,877 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 04:31:54,952 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:31:56,971 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 04:31:56,971 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 04:31:59,133 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 04:31:59,133 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 04:32:01,220 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 04:32:01,221 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 04:32:02,326 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 04:32:02,326 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 04:32:02,326 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:32:02,327 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 04:32:02,401 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:32:04,418 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 04:32:04,418 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 04:32:06,575 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 04:32:06,575 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 04:32:08,001 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 04:32:09,485 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 04:32:09,485 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 04:32:10,625 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 04:32:10,625 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 04:32:11,725 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 04:32:11,726 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 04:32:13,911 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 04:32:13,911 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 04:32:13,912 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:32:13,912 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:32:13,912 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:32:15,059 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 04:32:15,060 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 04:32:15,168 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 04:32:20,178 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 04:32:20,178 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 04:32:22,341 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 04:32:22,342 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 04:32:27,490 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 04:32:27,490 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 04:32:29,623 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 04:32:34,631 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 04:32:34,633 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_043234.mp4
2025-03-20 04:32:34,633 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:32:34,633 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:32:39,906 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:32:39,906 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 04:32:39,942 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 04:32:41,151 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043234.mp4
2025-03-20 04:32:41,151 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043234.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 04:32:43,160 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 04:32:46,164 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 04:32:46,164 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 04:32:49,167 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 04:32:49,167 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 04:32:49,167 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 04:32:50,325 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 04:32:50,326 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 04:32:50,326 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:32:50,326 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 04:32:50,415 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:32:52,423 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 04:32:52,423 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 04:32:52,423 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 04:32:54,677 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 04:32:54,677 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 04:33:02,856 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 04:33:02,856 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 04:33:02,857 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 04:33:02,857 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:03,088 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 04:33:03,089 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:03,322 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 04:33:03,322 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:03,569 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 04:33:03,569 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:03,807 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 04:33:03,808 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:04,044 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 04:33:04,044 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:04,260 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 04:33:04,260 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:04,507 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 04:33:04,508 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:04,723 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 04:33:04,723 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:04,946 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 04:33:04,947 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:33:07,194 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 04:33:07,195 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:33:07,195 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:33:07,302 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7488293 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1037}
    * Task{ef36dce #1037 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:33:07,303 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:33:07,303 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 04:33:07,303 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 04:33:07,303 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_043307_20250320_043307.png
2025-03-20 04:33:09,289 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_043307_20250320_043307.png
2025-03-20 04:33:09,290 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_043307_20250320_043307.png
2025-03-20 04:33:09,290 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:33:16,378 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 04:33:17,743 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_285.jpg
2025-03-20 04:33:17,747 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_285.jpg
2025-03-20 04:33:17,747 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 04:33:17,747 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:33:17,747 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:33:27,890 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 04:33:27,890 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:33:27,890 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:33:28,020 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7488293 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1037}
    * Task{ef36dce #1037 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:33:28,020 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:33:28,020 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 04:33:28,021 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 04:33:28,021 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_043328_20250320_043328.png
2025-03-20 04:33:30,021 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_043328_20250320_043328.png
2025-03-20 04:33:30,021 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_043328_20250320_043328.png
2025-03-20 04:33:30,021 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:33:34,911 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_285.jpg
2025-03-20 04:33:34,915 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_285.jpg
2025-03-20 04:33:34,915 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 04:33:34,915 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 04:33:34,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:33:34,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:33:37,165 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 04:33:37,165 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 04:33:37,165 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 04:33:37,165 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 04:33:38,170 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 04:33:39,178 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 04:33:39,179 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 04:33:39,179 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 128.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 04:33:39,179 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 04:33:49,184 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043234.mp4 (大小: 3.74MB)
2025-03-20 04:33:49,186 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 04:33:49,302 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.183300秒，无需修复
2025-03-20 04:33:49,302 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 04:33:49,302 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043234.mp4
2025-03-20 04:33:49,302 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 04:33:56,938 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_286.mp4
2025-03-20 04:33:56,944 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_286.mp4
2025-03-20 04:33:56,944 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:33:56,944 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:34:02,168 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:34:02,169 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_286.mp4
2025-03-20 04:34:02,169 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 04:34:02,169 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 04:34:02,169 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 04:34:02,482 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 04:34:03,491 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 04:34:03,491 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:34:03,492 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:34:04,596 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 04:34:04,596 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 04:34:04,596 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 04:34:06,698 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 04:34:06,699 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 04:34:07,876 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 04:34:07,877 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:34:07,877 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:34:09,011 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 04:34:09,012 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 04:34:09,012 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 04:34:09,012 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 04:31:47\n- 结束时间: 2025-03-20 04:34:09\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_285.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_285.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_286.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 04:34:09"}]}]}}
2025-03-20 04:34:09,340 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 04:34:09,342 - QuickAppADBTester - INFO - 测试完成
2025-03-20 04:39:09,395 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 04:39:09,397 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 04:39:09,397 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 04:39:09,397 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 04:39:09,525 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 04:39:09,686 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 04:39:09,686 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 04:39:09,686 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:39:09,686 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:39:09,926 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:39:09,927 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:39:09,927 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:39:09,927 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:39:11,420 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:39:11,420 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:39:12,663 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:39:12,664 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 04:39:12,664 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 04:39:12,664 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:39:12,664 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:39:12,821 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:39:12,822 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:39:12,822 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:39:12,822 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:39:14,232 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:39:14,232 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:39:15,497 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:39:15,498 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 04:39:15,498 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:39:15,498 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:39:15,498 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:39:16,596 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 04:39:16,597 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 04:39:16,714 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 04:39:18,724 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 04:39:18,724 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 04:39:19,818 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 04:39:19,819 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 04:39:19,819 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:39:19,819 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 04:39:19,897 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:39:21,905 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 04:39:21,906 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 04:39:24,093 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 04:39:24,093 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 04:39:26,180 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 04:39:26,181 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 04:39:27,278 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 04:39:27,278 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 04:39:27,279 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:39:27,279 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 04:39:27,349 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:39:29,362 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 04:39:29,362 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 04:39:31,536 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 04:39:31,537 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 04:39:32,951 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 04:39:34,431 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 04:39:34,432 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 04:39:35,607 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 04:39:35,608 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 04:39:36,705 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 04:39:36,705 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 04:39:38,904 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 04:39:38,904 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 04:39:38,905 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:39:38,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:39:38,905 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:39:40,082 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 04:39:40,083 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 04:39:40,190 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 04:39:45,196 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 04:39:45,198 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 04:39:47,368 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 04:39:47,369 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 04:39:52,514 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 04:39:52,514 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 04:39:54,670 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 04:39:59,681 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 04:39:59,681 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_043959.mp4
2025-03-20 04:39:59,682 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:39:59,682 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:40:04,956 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:40:04,957 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 04:40:04,998 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 04:40:06,158 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043959.mp4
2025-03-20 04:40:06,159 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043959.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 04:40:08,170 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 04:40:11,172 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 04:40:11,173 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 04:40:14,181 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 04:40:14,181 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 04:40:14,182 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 04:40:15,329 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 04:40:15,329 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 04:40:15,330 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:40:15,330 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 04:40:15,429 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:40:17,436 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 04:40:17,436 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 04:40:17,436 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 04:40:19,730 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 04:40:19,731 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 04:40:27,935 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 04:40:27,935 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 04:40:27,935 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 04:40:27,935 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:28,296 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 04:40:28,297 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:28,514 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 04:40:28,514 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:28,777 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 04:40:28,777 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:29,000 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 04:40:29,000 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:29,264 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 04:40:29,264 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:29,485 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 04:40:29,485 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:29,727 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 04:40:29,728 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:29,970 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 04:40:29,971 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:30,210 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 04:40:30,211 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:40:32,437 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 04:40:32,437 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:40:32,437 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:40:32,541 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eb1c95 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1043}
    * Task{aaded11 #1043 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:40:32,541 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:40:32,541 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 04:40:32,541 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 04:40:32,541 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_044032_20250320_044032.png
2025-03-20 04:40:34,337 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_044032_20250320_044032.png
2025-03-20 04:40:34,337 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_044032_20250320_044032.png
2025-03-20 04:40:34,337 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:40:41,384 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 04:40:41,851 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_287.jpg
2025-03-20 04:40:41,855 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_287.jpg
2025-03-20 04:40:41,856 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 04:40:41,856 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:40:41,856 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:40:52,025 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 04:40:52,026 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:40:52,026 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:40:52,148 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{eb1c95 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1043}
    * Task{aaded11 #1043 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:40:52,148 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:40:52,148 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 04:40:52,148 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 04:40:52,149 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_044052_20250320_044052.png
2025-03-20 04:40:53,959 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_044052_20250320_044052.png
2025-03-20 04:40:53,960 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_044052_20250320_044052.png
2025-03-20 04:40:53,960 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:40:58,687 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_287.jpg
2025-03-20 04:40:58,691 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_287.jpg
2025-03-20 04:40:58,691 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 04:40:58,691 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 04:40:58,691 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:40:58,691 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:41:00,811 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 04:41:00,811 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 04:41:00,812 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 04:41:00,812 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 04:41:01,819 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 04:41:02,828 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 04:41:02,828 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 04:41:02,828 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 130.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 04:41:02,828 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 04:41:12,835 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043959.mp4 (大小: 3.59MB)
2025-03-20 04:41:12,836 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 04:41:12,937 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.806400秒，无需修复
2025-03-20 04:41:12,937 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 04:41:12,937 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_043959.mp4
2025-03-20 04:41:12,937 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 04:41:19,909 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_288.mp4
2025-03-20 04:41:19,914 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_288.mp4
2025-03-20 04:41:19,914 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:41:19,914 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:41:25,182 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:41:25,183 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_288.mp4
2025-03-20 04:41:25,183 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 04:41:25,183 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 04:41:25,183 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 04:41:25,621 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 04:41:26,631 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 04:41:26,631 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:41:26,631 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:41:27,737 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 04:41:27,737 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 04:41:27,737 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 04:41:29,833 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 04:41:29,834 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 04:41:30,991 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 04:41:30,992 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:41:30,992 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:41:32,123 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 04:41:32,124 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 04:41:32,124 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 04:41:32,124 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 04:39:12\n- 结束时间: 2025-03-20 04:41:32\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_287.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_287.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_288.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 04:41:32"}]}]}}
2025-03-20 04:41:32,464 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 04:41:32,466 - QuickAppADBTester - INFO - 测试完成
2025-03-20 04:46:32,482 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 04:46:32,485 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 04:46:32,485 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 04:46:32,485 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 04:46:32,618 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 04:46:32,766 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 04:46:32,767 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 04:46:32,767 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:46:32,767 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:46:33,025 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:46:33,025 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:46:33,025 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:46:33,025 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:46:34,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:46:34,511 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:46:35,762 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:46:35,763 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 04:46:35,763 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 04:46:35,763 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:46:35,763 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:46:35,897 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:46:35,898 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:46:35,898 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:46:35,898 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:46:37,302 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:46:37,303 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:46:38,545 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:46:38,546 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 04:46:38,546 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:46:38,546 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:46:38,546 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:46:39,645 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 04:46:39,645 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 04:46:39,758 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 04:46:41,768 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 04:46:41,769 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 04:46:42,859 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 04:46:42,860 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 04:46:42,860 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:46:42,860 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 04:46:42,931 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:46:44,950 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 04:46:44,950 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 04:46:47,127 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 04:46:47,128 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 04:46:49,213 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 04:46:49,214 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 04:46:50,307 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 04:46:50,309 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 04:46:50,309 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:46:50,309 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 04:46:50,379 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:46:52,392 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 04:46:52,393 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 04:46:54,583 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 04:46:54,583 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 04:46:56,003 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 04:46:57,488 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 04:46:57,488 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 04:46:58,633 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 04:46:58,633 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 04:46:59,743 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 04:46:59,744 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 04:47:01,925 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 04:47:01,926 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 04:47:01,926 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:47:01,926 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:47:01,926 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:47:03,067 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 04:47:03,069 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 04:47:03,178 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 04:47:08,186 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 04:47:08,187 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 04:47:10,333 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 04:47:10,333 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 04:47:15,468 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 04:47:15,469 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 04:47:17,615 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 04:47:22,618 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 04:47:22,619 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_044722.mp4
2025-03-20 04:47:22,619 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:47:22,619 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:47:27,898 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:47:27,899 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 04:47:27,940 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 04:47:29,093 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_044722.mp4
2025-03-20 04:47:29,094 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_044722.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 04:47:31,108 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 04:47:34,118 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 04:47:34,119 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 04:47:37,121 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 04:47:37,122 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 04:47:37,122 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 04:47:38,293 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 04:47:38,293 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 04:47:38,293 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:47:38,293 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 04:47:38,391 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:47:40,404 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 04:47:40,404 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 04:47:40,405 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 04:47:42,694 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 04:47:42,694 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 04:47:50,874 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 04:47:50,875 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 04:47:50,875 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 04:47:50,875 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:51,107 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 04:47:51,108 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:51,389 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 04:47:51,389 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:51,663 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 04:47:51,664 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:51,953 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 04:47:51,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:52,172 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 04:47:52,173 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:52,389 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 04:47:52,389 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:52,637 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 04:47:52,637 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:52,872 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 04:47:52,873 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:53,091 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 04:47:53,092 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:47:55,311 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 04:47:55,311 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:47:55,311 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:47:55,457 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e465db3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1049}
    * Task{45c32e9 #1049 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:47:55,457 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:47:55,458 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 04:47:55,458 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 04:47:55,458 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_044755_20250320_044755.png
2025-03-20 04:47:57,296 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_044755_20250320_044755.png
2025-03-20 04:47:57,297 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_044755_20250320_044755.png
2025-03-20 04:47:57,298 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:48:04,328 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 04:48:05,155 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_289.jpg
2025-03-20 04:48:05,159 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_289.jpg
2025-03-20 04:48:05,159 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 04:48:05,159 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:48:05,159 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:48:15,335 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 04:48:15,337 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:48:15,337 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:48:15,424 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e465db3 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1049}
    * Task{45c32e9 #1049 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:48:15,424 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:48:15,424 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 04:48:15,424 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 04:48:15,425 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_044815_20250320_044815.png
2025-03-20 04:48:17,191 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_044815_20250320_044815.png
2025-03-20 04:48:17,191 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_044815_20250320_044815.png
2025-03-20 04:48:17,192 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:48:23,083 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_290.jpg
2025-03-20 04:48:23,087 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_290.jpg
2025-03-20 04:48:23,087 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 04:48:23,087 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 04:48:23,088 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:48:23,088 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:48:25,220 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 04:48:25,221 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 04:48:25,221 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 04:48:25,221 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 04:48:26,230 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 04:48:27,238 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 04:48:27,239 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 04:48:27,239 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 04:48:27,239 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 04:48:37,249 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_044722.mp4 (大小: 3.50MB)
2025-03-20 04:48:37,250 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 04:48:37,365 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.282078秒，无需修复
2025-03-20 04:48:37,366 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 04:48:37,366 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_044722.mp4
2025-03-20 04:48:37,366 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 04:48:44,211 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_291.mp4
2025-03-20 04:48:44,215 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_291.mp4
2025-03-20 04:48:44,215 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:48:44,215 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:48:49,438 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:48:49,438 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_291.mp4
2025-03-20 04:48:49,439 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 04:48:49,439 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 04:48:49,439 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 04:48:49,753 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 04:48:50,761 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 04:48:50,761 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:48:50,761 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:48:51,867 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 04:48:51,868 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 04:48:51,868 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 04:48:53,968 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 04:48:53,969 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 04:48:55,114 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 04:48:55,114 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:48:55,114 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:48:56,251 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 04:48:56,252 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 04:48:56,252 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 04:48:56,252 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 04:46:35\n- 结束时间: 2025-03-20 04:48:56\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_289.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_290.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_291.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 04:48:56"}]}]}}
2025-03-20 04:48:56,582 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 04:48:56,585 - QuickAppADBTester - INFO - 测试完成
2025-03-20 04:53:56,675 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 04:53:56,676 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 04:53:56,676 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 04:53:56,676 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 04:53:56,793 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 04:53:56,931 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 04:53:56,931 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 04:53:56,931 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:53:56,931 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:53:57,120 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:53:57,120 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:53:57,120 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:53:57,120 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:53:58,576 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:53:58,576 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:53:59,806 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:53:59,806 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 04:53:59,806 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 04:53:59,806 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 04:53:59,806 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 04:53:59,953 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 04:53:59,954 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 04:53:59,954 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 04:53:59,954 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 04:54:01,358 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:54:01,359 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:54:02,605 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 04:54:02,605 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 04:54:02,605 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:54:02,605 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:54:02,605 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:54:03,700 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 04:54:03,700 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 04:54:03,816 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 04:54:05,825 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 04:54:05,826 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 04:54:06,908 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 04:54:06,908 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 04:54:06,908 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:54:06,908 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 04:54:06,981 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:54:08,995 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 04:54:08,995 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 04:54:11,170 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 04:54:11,171 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 04:54:13,254 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 04:54:13,255 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 04:54:14,354 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 04:54:14,354 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 04:54:14,354 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:54:14,354 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 04:54:14,426 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:54:16,442 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 04:54:16,443 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 04:54:18,552 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 04:54:18,553 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 04:54:19,970 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 04:54:21,428 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 04:54:21,429 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 04:54:22,606 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 04:54:22,606 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 04:54:23,710 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 04:54:23,710 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 04:54:25,891 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 04:54:25,892 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 04:54:25,892 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 04:54:25,892 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:54:25,892 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:54:27,043 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 04:54:27,044 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 04:54:27,156 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 04:54:32,165 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 04:54:32,167 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 04:54:34,305 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 04:54:34,306 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 04:54:39,452 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 04:54:39,452 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 04:54:41,606 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 04:54:46,610 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 04:54:46,611 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_045446.mp4
2025-03-20 04:54:46,611 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:54:46,611 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:54:51,892 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:54:51,893 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 04:54:51,932 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 04:54:53,092 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_045446.mp4
2025-03-20 04:54:53,093 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_045446.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 04:54:55,100 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 04:54:58,108 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 04:54:58,108 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 04:55:01,117 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 04:55:01,118 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 04:55:01,118 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 04:55:02,319 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 04:55:02,320 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 04:55:02,320 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 04:55:02,320 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 04:55:02,418 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 04:55:04,435 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 04:55:04,437 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 04:55:04,437 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 04:55:06,715 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 04:55:06,715 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 04:55:14,910 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 04:55:14,911 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 04:55:14,911 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 04:55:14,911 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:15,274 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 04:55:15,275 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:15,517 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 04:55:15,518 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:15,734 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 04:55:15,735 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:15,966 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 04:55:15,967 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:16,184 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 04:55:16,184 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:16,451 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 04:55:16,452 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:16,685 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 04:55:16,686 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:16,922 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 04:55:16,923 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:17,156 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 04:55:17,156 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 04:55:19,398 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 04:55:19,398 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:55:19,398 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:55:19,513 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e5f62b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1055}
    * Task{cc13f7 #1055 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:55:19,514 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:55:19,514 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 04:55:19,514 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 04:55:19,514 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_045519_20250320_045519.png
2025-03-20 04:55:21,218 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_045519_20250320_045519.png
2025-03-20 04:55:21,218 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_045519_20250320_045519.png
2025-03-20 04:55:21,218 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:55:28,304 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 04:55:28,875 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_292.jpg
2025-03-20 04:55:28,879 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_292.jpg
2025-03-20 04:55:28,879 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 04:55:28,880 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:55:28,880 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:55:39,007 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 04:55:39,010 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 04:55:39,010 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 04:55:39,105 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e5f62b8 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1055}
    * Task{cc13f7 #1055 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 04:55:39,105 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 04:55:39,105 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 04:55:39,105 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 04:55:39,105 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_045539_20250320_045539.png
2025-03-20 04:55:40,810 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_045539_20250320_045539.png
2025-03-20 04:55:40,810 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_045539_20250320_045539.png
2025-03-20 04:55:40,811 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 04:55:45,520 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_292.jpg
2025-03-20 04:55:45,523 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_292.jpg
2025-03-20 04:55:45,523 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 04:55:45,523 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 04:55:45,523 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:55:45,523 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:55:47,638 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 04:55:47,639 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 04:55:47,639 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 04:55:47,639 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 04:55:48,644 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 04:55:49,650 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 04:55:49,650 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 04:55:49,650 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 126.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 04:55:49,650 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 04:55:59,657 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_045446.mp4 (大小: 3.36MB)
2025-03-20 04:55:59,658 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 04:55:59,771 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.681333秒，无需修复
2025-03-20 04:55:59,771 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 04:55:59,771 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_045446.mp4
2025-03-20 04:55:59,771 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 04:56:06,751 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_293.mp4
2025-03-20 04:56:06,755 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_293.mp4
2025-03-20 04:56:06,755 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 04:56:06,755 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 04:56:11,974 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 04:56:11,975 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_293.mp4
2025-03-20 04:56:11,975 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 04:56:11,975 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 04:56:11,975 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 04:56:12,353 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 04:56:13,361 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 04:56:13,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:56:13,362 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:56:14,472 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 04:56:14,472 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 04:56:14,472 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 04:56:16,570 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 04:56:16,571 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 04:56:17,720 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 04:56:17,721 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 04:56:17,721 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 04:56:18,816 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 04:56:18,816 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 04:56:18,817 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 04:56:18,817 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 04:53:59\n- 结束时间: 2025-03-20 04:56:18\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_292.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_292.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_293.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 04:56:18"}]}]}}
2025-03-20 04:56:19,117 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 04:56:19,119 - QuickAppADBTester - INFO - 测试完成
2025-03-20 05:01:19,190 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 05:01:19,192 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 05:01:19,193 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 05:01:19,193 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 05:01:19,322 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 05:01:19,481 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 05:01:19,481 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 05:01:19,482 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:01:19,482 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:01:19,752 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:01:19,752 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:01:19,752 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:01:19,752 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:01:21,255 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:01:21,256 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:01:22,533 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:01:22,533 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 05:01:22,533 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 05:01:22,533 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:01:22,533 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:01:22,681 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:01:22,682 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:01:22,682 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:01:22,682 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:01:24,085 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:01:24,086 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:01:25,289 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:01:25,289 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 05:01:25,289 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:01:25,289 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:01:25,289 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:01:26,385 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 05:01:26,386 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 05:01:26,502 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 05:01:28,510 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 05:01:28,510 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 05:01:29,597 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 05:01:29,598 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 05:01:29,598 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:01:29,598 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 05:01:29,667 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:01:31,687 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 05:01:31,687 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 05:01:33,841 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 05:01:33,842 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 05:01:35,918 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 05:01:35,918 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 05:01:37,020 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 05:01:37,021 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 05:01:37,021 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:01:37,021 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 05:01:37,091 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:01:39,109 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 05:01:39,109 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 05:01:41,287 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 05:01:41,287 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 05:01:42,686 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 05:01:44,160 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 05:01:44,160 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 05:01:45,319 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 05:01:45,319 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 05:01:46,420 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 05:01:46,420 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 05:01:48,604 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 05:01:48,604 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 05:01:48,604 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:01:48,604 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:01:48,604 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:01:49,766 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 05:01:49,767 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 05:01:49,881 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 05:01:54,889 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 05:01:54,891 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 05:01:57,027 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 05:01:57,028 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 05:02:02,177 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 05:02:02,178 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 05:02:04,334 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 05:02:09,343 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 05:02:09,345 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_050209.mp4
2025-03-20 05:02:09,345 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:02:09,345 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:02:14,622 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:02:14,623 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 05:02:14,662 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 05:02:15,876 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050209.mp4
2025-03-20 05:02:15,877 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050209.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 05:02:17,886 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 05:02:20,897 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 05:02:20,897 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 05:02:23,898 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 05:02:23,899 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 05:02:23,899 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 05:02:25,088 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 05:02:25,089 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 05:02:25,089 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:02:25,089 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 05:02:25,187 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:02:27,199 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 05:02:27,200 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 05:02:27,200 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 05:02:29,441 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 05:02:29,443 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 05:02:37,612 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 05:02:37,613 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 05:02:37,613 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 05:02:37,613 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:37,934 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 05:02:37,935 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:38,165 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 05:02:38,166 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:38,396 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 05:02:38,396 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:38,645 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 05:02:38,645 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:38,896 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 05:02:38,897 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:39,118 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 05:02:39,118 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:39,368 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 05:02:39,369 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:39,607 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 05:02:39,608 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:39,842 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 05:02:39,843 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:02:42,069 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 05:02:42,069 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:02:42,069 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:02:42,228 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b8cd6d2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1061}
    * Task{ebe86a0 #1061 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:02:42,229 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:02:42,229 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 05:02:42,229 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 05:02:42,229 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_050242_20250320_050242.png
2025-03-20 05:02:44,253 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_050242_20250320_050242.png
2025-03-20 05:02:44,254 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_050242_20250320_050242.png
2025-03-20 05:02:44,254 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:02:51,117 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 05:02:51,810 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_294.jpg
2025-03-20 05:02:51,814 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_294.jpg
2025-03-20 05:02:51,814 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 05:02:51,814 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:02:51,815 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:03:01,932 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 05:03:01,932 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:03:01,933 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:03:02,053 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b8cd6d2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1061}
    * Task{ebe86a0 #1061 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:03:02,053 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:03:02,053 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 05:03:02,053 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 05:03:02,053 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_050302_20250320_050302.png
2025-03-20 05:03:03,977 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_050302_20250320_050302.png
2025-03-20 05:03:03,979 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_050302_20250320_050302.png
2025-03-20 05:03:03,979 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:03:09,812 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_295.jpg
2025-03-20 05:03:09,816 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_295.jpg
2025-03-20 05:03:09,816 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 05:03:09,816 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 05:03:09,816 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:03:09,816 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:03:11,940 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 05:03:11,940 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 05:03:11,940 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 05:03:11,941 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 05:03:12,944 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 05:03:13,950 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 05:03:13,950 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 05:03:13,950 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 143.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 05:03:13,950 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 05:03:23,958 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050209.mp4 (大小: 3.84MB)
2025-03-20 05:03:23,959 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 05:03:24,072 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.200789秒，无需修复
2025-03-20 05:03:24,073 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 05:03:24,073 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050209.mp4
2025-03-20 05:03:24,073 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 05:03:30,790 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_296.mp4
2025-03-20 05:03:30,793 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_296.mp4
2025-03-20 05:03:30,794 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:03:30,794 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:03:36,014 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:03:36,014 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_296.mp4
2025-03-20 05:03:36,015 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 05:03:36,015 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 05:03:36,015 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 05:03:36,415 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 05:03:37,423 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 05:03:37,424 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:03:37,424 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:03:38,530 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 05:03:38,530 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 05:03:38,530 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 05:03:40,617 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 05:03:40,618 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 05:03:41,791 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 05:03:41,792 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:03:41,792 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:03:42,917 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 05:03:42,917 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 05:03:42,918 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 05:03:42,918 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 05:01:22\n- 结束时间: 2025-03-20 05:03:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_294.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_295.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_296.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 05:03:42"}]}]}}
2025-03-20 05:03:43,242 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 05:03:43,244 - QuickAppADBTester - INFO - 测试完成
2025-03-20 05:08:43,308 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 05:08:43,310 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 05:08:43,310 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 05:08:43,310 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 05:08:43,447 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 05:08:43,600 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 05:08:43,601 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 05:08:43,601 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:08:43,601 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:08:43,857 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:08:43,858 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:08:43,858 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:08:43,858 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:08:45,343 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:08:45,344 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:08:46,575 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:08:46,575 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 05:08:46,575 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 05:08:46,575 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:08:46,575 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:08:46,719 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:08:46,720 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:08:46,720 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:08:46,720 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:08:48,123 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:08:48,123 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:08:49,378 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:08:49,378 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 05:08:49,379 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:08:49,379 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:08:49,379 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:08:50,475 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 05:08:50,475 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 05:08:50,590 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 05:08:52,598 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 05:08:52,598 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 05:08:53,680 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 05:08:53,681 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 05:08:53,681 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:08:53,681 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 05:08:53,752 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:08:55,770 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 05:08:55,770 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 05:08:57,948 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 05:08:57,949 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 05:09:00,032 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 05:09:00,033 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 05:09:01,137 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 05:09:01,138 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 05:09:01,138 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:09:01,138 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 05:09:01,207 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:09:03,223 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 05:09:03,223 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 05:09:05,390 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 05:09:05,390 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 05:09:06,807 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 05:09:08,290 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 05:09:08,290 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 05:09:09,481 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 05:09:09,481 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 05:09:10,589 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 05:09:10,590 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 05:09:12,747 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 05:09:12,747 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 05:09:12,747 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:09:12,748 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:09:12,748 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:09:13,919 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 05:09:13,920 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 05:09:14,027 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 05:09:19,035 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 05:09:19,036 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 05:09:21,176 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 05:09:21,177 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 05:09:26,321 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 05:09:26,323 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 05:09:28,470 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 05:09:33,478 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 05:09:33,479 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_050933.mp4
2025-03-20 05:09:33,479 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:09:33,479 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:09:38,759 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:09:38,760 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 05:09:38,799 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 05:09:40,012 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050933.mp4
2025-03-20 05:09:40,012 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050933.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 05:09:42,026 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 05:09:45,030 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 05:09:45,030 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 05:09:48,031 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 05:09:48,033 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 05:09:48,033 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 05:09:49,217 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 05:09:49,218 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 05:09:49,218 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:09:49,218 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 05:09:49,310 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:09:51,313 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 05:09:51,314 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 05:09:51,314 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 05:09:53,596 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 05:09:53,597 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 05:10:01,762 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 05:10:01,763 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 05:10:01,763 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 05:10:01,763 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:02,146 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 05:10:02,147 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:02,380 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 05:10:02,380 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:02,623 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 05:10:02,624 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:02,837 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 05:10:02,838 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:03,060 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 05:10:03,060 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:03,280 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 05:10:03,280 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:03,505 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 05:10:03,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:03,752 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 05:10:03,752 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:03,984 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 05:10:03,985 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:10:06,211 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 05:10:06,213 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:10:06,213 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:10:06,328 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3381464 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1067}
    * Task{19412d0 #1067 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:10:06,329 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:10:06,329 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 05:10:06,329 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 05:10:06,329 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_051006_20250320_051006.png
2025-03-20 05:10:07,973 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_051006_20250320_051006.png
2025-03-20 05:10:07,973 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_051006_20250320_051006.png
2025-03-20 05:10:07,973 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:10:15,152 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_297.jpg
2025-03-20 05:10:15,156 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_297.jpg
2025-03-20 05:10:15,156 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 05:10:15,157 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:10:15,157 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:10:15,244 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 05:10:25,262 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 05:10:25,262 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:10:25,263 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:10:25,372 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3381464 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1067}
    * Task{19412d0 #1067 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:10:25,372 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:10:25,372 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 05:10:25,372 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 05:10:25,373 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_051025_20250320_051025.png
2025-03-20 05:10:27,007 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_051025_20250320_051025.png
2025-03-20 05:10:27,008 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_051025_20250320_051025.png
2025-03-20 05:10:27,008 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:10:31,806 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_297.jpg
2025-03-20 05:10:31,809 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_297.jpg
2025-03-20 05:10:31,810 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 05:10:31,810 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 05:10:31,810 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:10:31,810 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:10:33,941 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 05:10:33,941 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 05:10:33,941 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 05:10:33,942 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 05:10:34,949 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 05:10:35,959 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 05:10:35,960 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 05:10:35,960 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 05:10:35,960 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 05:10:45,967 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050933.mp4 (大小: 3.71MB)
2025-03-20 05:10:45,967 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 05:10:46,081 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.046744秒，无需修复
2025-03-20 05:10:46,082 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 05:10:46,082 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_050933.mp4
2025-03-20 05:10:46,082 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 05:10:53,224 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_298.mp4
2025-03-20 05:10:53,230 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_298.mp4
2025-03-20 05:10:53,230 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:10:53,230 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:10:58,508 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:10:58,509 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_298.mp4
2025-03-20 05:10:58,509 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 05:10:58,509 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 05:10:58,509 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 05:10:58,975 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 05:10:59,983 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 05:10:59,983 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:10:59,983 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:11:01,083 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 05:11:01,084 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 05:11:01,084 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 05:11:03,183 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 05:11:03,184 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 05:11:04,337 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 05:11:04,337 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:11:04,337 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:11:05,443 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 05:11:05,443 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 05:11:05,444 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 05:11:05,444 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 05:08:46\n- 结束时间: 2025-03-20 05:11:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_297.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_297.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_298.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 05:11:05"}]}]}}
2025-03-20 05:11:05,774 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 05:11:05,776 - QuickAppADBTester - INFO - 测试完成
2025-03-20 05:16:05,821 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 05:16:05,823 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 05:16:05,823 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 05:16:05,823 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 05:16:05,955 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 05:16:06,113 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 05:16:06,114 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 05:16:06,114 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:16:06,114 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:16:06,343 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:16:06,343 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:16:06,343 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:16:06,343 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:16:07,805 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:16:07,805 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:16:08,999 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:16:08,999 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 05:16:08,999 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 05:16:08,999 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:16:08,999 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:16:09,153 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:16:09,154 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:16:09,154 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:16:09,154 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:16:10,563 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:16:10,564 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:16:11,820 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:16:11,821 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 05:16:11,821 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:16:11,821 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:16:11,821 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:16:12,921 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 05:16:12,921 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 05:16:13,033 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 05:16:15,044 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 05:16:15,044 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 05:16:16,131 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 05:16:16,131 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 05:16:16,131 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:16:16,131 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 05:16:16,204 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:16:18,220 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 05:16:18,221 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 05:16:20,408 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 05:16:20,413 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 05:16:22,476 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 05:16:22,477 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 05:16:23,581 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 05:16:23,582 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 05:16:23,582 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:16:23,582 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 05:16:23,654 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:16:25,674 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 05:16:25,674 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 05:16:27,838 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 05:16:27,839 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 05:16:29,255 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 05:16:30,732 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 05:16:30,732 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 05:16:31,916 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 05:16:31,916 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 05:16:33,022 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 05:16:33,023 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 05:16:35,197 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 05:16:35,197 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 05:16:35,198 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:16:35,198 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:16:35,198 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:16:36,357 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 05:16:36,358 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 05:16:36,473 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 05:16:41,482 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 05:16:41,482 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 05:16:43,629 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 05:16:43,629 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 05:16:48,773 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 05:16:48,773 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 05:16:50,925 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 05:16:55,933 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 05:16:55,936 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_051655.mp4
2025-03-20 05:16:55,936 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:16:55,937 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:17:01,212 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:17:01,214 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 05:17:01,254 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 05:17:02,466 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_051655.mp4
2025-03-20 05:17:02,467 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_051655.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 05:17:04,478 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 05:17:07,485 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 05:17:07,485 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 05:17:10,485 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 05:17:10,486 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 05:17:10,486 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 05:17:11,650 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 05:17:11,651 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 05:17:11,651 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:17:11,651 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 05:17:11,747 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:17:13,756 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 05:17:13,757 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 05:17:13,757 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 05:17:16,030 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 05:17:16,030 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 05:17:24,207 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 05:17:24,208 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 05:17:24,208 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 05:17:24,208 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:24,427 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 05:17:24,428 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:24,737 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 05:17:24,738 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:24,993 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 05:17:24,994 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:25,225 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 05:17:25,226 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:25,451 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 05:17:25,452 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:25,677 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 05:17:25,678 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:25,896 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 05:17:25,896 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:26,145 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 05:17:26,146 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:26,395 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 05:17:26,395 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:17:28,636 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 05:17:28,637 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:17:28,637 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:17:28,770 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5d72514 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1073}
    * Task{2200f03 #1073 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:17:28,770 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:17:28,770 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 05:17:28,770 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 05:17:28,771 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_051728_20250320_051728.png
2025-03-20 05:17:30,846 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_051728_20250320_051728.png
2025-03-20 05:17:30,847 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_051728_20250320_051728.png
2025-03-20 05:17:30,847 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:17:37,696 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 05:17:37,903 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_299.jpg
2025-03-20 05:17:37,907 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_299.jpg
2025-03-20 05:17:37,908 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 05:17:37,908 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:17:37,908 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:17:48,028 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 05:17:48,030 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:17:48,030 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:17:48,145 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5d72514 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1073}
    * Task{2200f03 #1073 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:17:48,145 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:17:48,145 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 05:17:48,146 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 05:17:48,146 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_051748_20250320_051748.png
2025-03-20 05:17:50,107 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_051748_20250320_051748.png
2025-03-20 05:17:50,108 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_051748_20250320_051748.png
2025-03-20 05:17:50,108 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:17:56,119 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_300.jpg
2025-03-20 05:17:56,123 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_300.jpg
2025-03-20 05:17:56,123 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 05:17:56,123 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 05:17:56,123 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:17:56,123 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:17:58,322 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 05:17:58,323 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 05:17:58,325 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 05:17:58,325 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 05:17:59,328 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 05:18:00,334 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 05:18:00,334 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 05:18:00,334 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 133.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 05:18:00,334 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 05:18:10,344 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_051655.mp4 (大小: 4.09MB)
2025-03-20 05:18:10,346 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 05:18:10,504 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.966744秒，无需修复
2025-03-20 05:18:10,504 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 05:18:10,504 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_051655.mp4
2025-03-20 05:18:10,505 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 05:18:17,661 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_301.mp4
2025-03-20 05:18:17,666 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_301.mp4
2025-03-20 05:18:17,666 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:18:17,666 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:18:22,878 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:18:22,879 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_301.mp4
2025-03-20 05:18:22,879 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 05:18:22,879 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 05:18:22,879 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 05:18:23,287 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 05:18:24,293 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 05:18:24,294 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:18:24,294 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:18:25,404 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 05:18:25,404 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 05:18:25,404 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 05:18:27,496 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 05:18:27,497 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 05:18:28,664 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 05:18:28,665 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:18:28,665 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:18:29,793 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 05:18:29,795 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 05:18:29,795 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 05:18:29,795 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 05:16:08\n- 结束时间: 2025-03-20 05:18:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_299.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_300.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_301.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 05:18:29"}]}]}}
2025-03-20 05:18:30,117 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 05:18:30,120 - QuickAppADBTester - INFO - 测试完成
2025-03-20 05:35:40,176 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 05:35:40,178 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 05:35:40,178 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 05:35:40,178 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 05:35:40,326 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 05:35:40,471 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 05:35:40,471 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 05:35:40,471 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:35:40,471 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:35:40,738 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:35:40,739 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:35:40,739 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:35:40,739 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:35:42,227 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:35:42,228 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:35:43,494 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:35:43,494 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 05:35:43,494 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 05:35:43,494 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 05:35:43,494 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 05:35:43,641 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 05:35:43,642 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 05:35:43,642 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 05:35:43,642 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 05:35:45,061 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:35:45,062 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:35:46,492 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 05:35:46,493 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 05:35:46,493 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:35:46,493 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:35:46,493 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:35:47,708 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 05:35:47,709 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 05:35:47,836 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 05:35:49,847 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 05:35:49,848 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 05:35:50,970 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 05:35:50,970 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 05:35:50,970 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:35:50,971 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 05:35:51,061 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:35:53,069 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 05:35:53,069 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 05:35:55,243 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 05:35:55,244 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 05:35:57,339 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 05:35:57,340 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 05:35:58,444 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 05:35:58,445 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 05:35:58,445 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:35:58,445 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 05:35:58,523 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:36:00,543 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 05:36:00,543 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 05:36:02,708 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 05:36:02,709 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 05:36:04,127 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 05:36:05,610 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 05:36:05,611 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 05:36:06,806 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 05:36:06,807 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 05:36:07,909 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 05:36:07,910 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 05:36:10,093 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 05:36:10,094 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 05:36:10,095 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 05:36:10,095 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:36:10,095 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:36:11,297 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 05:36:11,298 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 05:36:11,418 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 05:36:16,428 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 05:36:16,429 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 05:36:18,599 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 05:36:18,599 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 05:36:23,784 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 05:36:23,785 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 05:36:25,947 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 05:36:30,957 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 05:36:30,958 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_053630.mp4
2025-03-20 05:36:30,958 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 05:36:30,958 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 05:36:36,247 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 05:36:36,248 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 05:36:36,293 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 05:36:37,455 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_053630.mp4
2025-03-20 05:36:37,456 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_053630.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 05:36:39,468 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 05:46:54,715 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 05:46:54,716 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 05:46:57,726 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 05:46:57,726 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 05:46:57,726 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 05:46:58,877 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 05:46:58,877 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 05:46:58,878 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 05:46:58,878 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 05:46:58,971 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 05:47:00,988 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 05:47:00,989 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 05:47:00,989 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 05:47:03,259 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 05:47:03,260 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 05:47:11,438 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 05:47:11,440 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 05:47:11,440 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 05:47:11,440 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:11,772 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 05:47:11,773 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:12,012 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 05:47:12,013 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:12,263 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 05:47:12,263 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:12,486 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 05:47:12,486 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:12,732 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 05:47:12,733 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:12,990 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 05:47:12,990 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:13,224 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 05:47:13,225 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:13,456 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 05:47:13,457 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:13,712 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 05:47:13,713 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 05:47:15,966 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 05:47:15,967 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:47:15,967 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:47:16,057 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8e63d7a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1079}
    * Task{b853721 #1079 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:47:16,057 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:47:16,057 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 05:47:16,057 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 05:47:16,058 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_054716_20250320_054716.png
2025-03-20 05:47:17,566 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_054716_20250320_054716.png
2025-03-20 05:47:17,567 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_054716_20250320_054716.png
2025-03-20 05:47:17,567 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 05:47:24,959 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 05:47:26,757 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_302.jpg
2025-03-20 05:47:26,763 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_302.jpg
2025-03-20 05:47:26,764 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 05:47:26,764 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 05:47:26,764 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 05:47:36,920 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 05:47:36,922 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 05:47:36,922 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 05:47:37,003 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8e63d7a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1079}
    * Task{b853721 #1079 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 05:47:37,003 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 05:47:37,003 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 05:47:37,003 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 05:47:37,003 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_054737_20250320_054737.png
2025-03-20 05:47:38,445 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_054737_20250320_054737.png
2025-03-20 05:47:38,445 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_054737_20250320_054737.png
2025-03-20 05:47:38,446 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:03:55,119 - QuickAppADBTester - INFO - 录制进行中，已录制约 1020 秒
2025-03-20 06:04:13,778 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by ProxyError('Cannot connect to proxy.', RemoteDisconnected('Remote end closed connection without response')))
2025-03-20 06:04:13,787 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 716, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 468, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 463, in _make_request
    httplib_response = conn.getresponse()
                       ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 1378, in getresponse
    response.begin()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by ProxyError('Cannot connect to proxy.', RemoteDisconnected('Remote end closed connection without response')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 559, in send
    raise ProxyError(e, request=request)
requests.exceptions.ProxyError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by ProxyError('Cannot connect to proxy.', RemoteDisconnected('Remote end closed connection without response')))

2025-03-20 06:04:13,790 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-20 06:04:13,790 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:04:13,790 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:04:13,790 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:04:13,790 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:04:15,930 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:04:15,930 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:04:15,931 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:04:15,931 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:04:16,936 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:04:17,945 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:04:17,946 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:04:17,946 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 129.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:04:17,946 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:04:27,956 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_053630.mp4 (大小: 3.48MB)
2025-03-20 06:04:27,957 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:04:28,079 - QuickAppADBTester - INFO - 录制文件完整，时长: 1657.563100秒，无需修复
2025-03-20 06:04:28,080 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:04:28,080 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_053630.mp4
2025-03-20 06:04:28,080 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:04:36,669 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_303.mp4
2025-03-20 06:04:36,676 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_303.mp4
2025-03-20 06:04:36,677 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:04:36,677 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:04:41,955 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:04:41,957 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_303.mp4
2025-03-20 06:04:41,957 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:04:41,957 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:04:41,957 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:04:42,276 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:04:43,284 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:04:43,284 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:04:43,284 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:04:44,397 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:04:44,398 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:04:44,398 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:04:46,513 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:04:46,514 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:04:47,678 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:04:47,679 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:04:47,679 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:04:48,817 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:04:48,817 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:04:48,818 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-20 06:04:48,818 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 05:35:43\n- 结束时间: 2025-03-20 06:04:48\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_302.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_303.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:04:48"}]}]}}
2025-03-20 06:04:49,171 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:04:49,174 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:09:49,382 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:09:49,384 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:09:49,384 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:09:49,384 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:09:49,504 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:09:49,659 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:09:49,659 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:09:49,660 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:09:49,660 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:09:49,897 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:09:49,897 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:09:49,898 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:09:49,898 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:09:51,405 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:09:51,406 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:09:52,690 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:09:52,690 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:09:52,690 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:09:52,690 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:09:52,691 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:09:52,846 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:09:52,847 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:09:52,847 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:09:52,847 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:09:54,255 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:09:54,256 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:09:55,527 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:09:55,527 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:09:55,527 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:09:55,527 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:09:55,527 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:09:56,616 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:09:56,617 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:09:56,749 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:09:58,757 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:09:58,757 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:09:59,887 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:09:59,888 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:09:59,888 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:09:59,888 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:09:59,979 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:10:01,997 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:10:01,998 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:10:04,178 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:10:04,179 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:10:06,270 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:10:06,271 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:10:07,373 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:10:07,375 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:10:07,375 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:10:07,375 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:10:07,451 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:10:09,469 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:10:09,469 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:10:11,678 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:10:11,678 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:10:13,107 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:10:14,595 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:10:14,596 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:10:15,769 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:10:15,770 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:10:16,873 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:10:16,874 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:10:19,064 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:10:19,066 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:10:19,066 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:10:19,066 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:10:19,066 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:10:20,272 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:10:20,273 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:10:20,382 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:10:25,393 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:10:25,393 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:10:27,578 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:10:27,578 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:10:32,770 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:10:32,771 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:10:34,936 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:10:39,947 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:10:39,948 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_061039.mp4
2025-03-20 06:10:39,948 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:10:39,948 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:10:45,232 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:10:45,233 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:10:45,282 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:10:46,437 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061039.mp4
2025-03-20 06:10:46,438 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061039.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:10:48,452 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:10:51,464 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:10:51,465 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:10:54,471 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:10:54,472 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:10:54,472 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:10:55,637 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:10:55,638 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:10:55,639 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:10:55,639 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:10:55,741 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:10:57,758 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:10:57,758 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:10:57,758 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:11:00,054 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:11:00,055 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:11:08,239 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:11:08,240 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:11:08,240 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:11:08,240 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:08,573 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:11:08,574 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:08,839 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:11:08,840 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:09,125 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:11:09,126 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:09,382 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:11:09,383 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:09,615 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:11:09,616 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:09,850 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:11:09,851 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:10,103 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:11:10,104 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:10,346 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:11:10,347 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:10,591 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:11:10,592 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:11:12,824 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:11:12,825 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:11:12,825 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:11:13,000 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7e6ab20 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1085}
    * Task{166a57f #1085 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:11:13,001 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:11:13,001 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:11:13,001 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:11:13,002 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_061113_20250320_061113.png
2025-03-20 06:11:14,840 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_061113_20250320_061113.png
2025-03-20 06:11:14,840 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_061113_20250320_061113.png
2025-03-20 06:11:14,840 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:11:21,656 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:11:21,946 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_304.jpg
2025-03-20 06:11:21,952 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_304.jpg
2025-03-20 06:11:21,952 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:11:21,952 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:11:21,952 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:11:32,066 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:11:32,067 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:11:32,067 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:11:32,177 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7e6ab20 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1085}
    * Task{166a57f #1085 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:11:32,178 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:11:32,178 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:11:32,178 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:11:32,178 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_061132_20250320_061132.png
2025-03-20 06:11:33,930 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_061132_20250320_061132.png
2025-03-20 06:11:33,930 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_061132_20250320_061132.png
2025-03-20 06:11:33,931 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:11:38,515 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_304.jpg
2025-03-20 06:11:38,519 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_304.jpg
2025-03-20 06:11:38,520 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:11:38,520 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:11:38,520 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:11:38,520 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:11:40,646 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:11:40,646 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:11:40,647 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:11:40,647 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:11:41,655 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:11:42,666 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:11:42,666 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:11:42,666 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 151.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:11:42,667 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:11:52,676 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061039.mp4 (大小: 3.72MB)
2025-03-20 06:11:52,677 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:11:52,782 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.283922秒，无需修复
2025-03-20 06:11:52,782 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:11:52,782 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061039.mp4
2025-03-20 06:11:52,782 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:11:59,591 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_305.mp4
2025-03-20 06:11:59,594 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_305.mp4
2025-03-20 06:11:59,594 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:11:59,594 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:12:04,852 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:12:04,853 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_305.mp4
2025-03-20 06:12:04,853 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:12:04,853 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:12:04,853 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:12:05,334 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:12:06,343 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:12:06,344 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:12:06,344 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:12:07,458 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:12:07,459 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:12:07,459 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:12:09,566 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:12:09,567 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:12:10,759 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:12:10,759 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:12:10,760 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:12:11,895 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:12:11,896 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:12:11,897 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:12:11,897 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:09:52\n- 结束时间: 2025-03-20 06:12:11\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_304.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_304.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_305.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:12:11"}]}]}}
2025-03-20 06:12:12,254 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:12:12,258 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:17:12,417 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:17:12,419 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:17:12,420 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:17:12,420 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:17:12,547 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:17:12,711 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:17:12,712 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:17:12,712 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:17:12,712 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:17:12,977 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:17:12,978 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:17:12,978 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:17:12,978 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:17:14,468 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:17:14,469 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:17:15,730 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:17:15,731 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:17:15,731 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:17:15,731 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:17:15,731 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:17:15,882 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:17:15,882 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:17:15,882 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:17:15,883 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:17:17,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:17:17,291 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:17:18,547 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:17:18,547 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:17:18,547 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:17:18,547 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:17:18,547 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:17:19,649 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:17:19,650 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:17:19,764 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:17:21,766 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:17:21,767 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:17:22,860 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:17:22,860 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:17:22,861 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:17:22,861 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:17:22,943 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:17:24,962 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:17:24,963 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:17:27,162 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:17:27,162 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:17:29,239 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:17:29,239 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:17:30,347 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:17:30,348 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:17:30,348 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:17:30,348 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:17:30,424 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:17:32,444 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:17:32,444 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:17:34,599 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:17:34,600 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:17:36,017 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:17:37,479 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:17:37,479 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:17:38,673 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:17:38,674 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:17:39,785 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:17:39,785 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:17:41,961 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:17:41,962 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:17:41,962 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:17:41,962 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:17:41,962 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:17:43,120 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:17:43,121 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:17:43,240 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:17:48,250 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:17:48,250 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:17:50,405 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:17:50,407 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:17:55,569 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:17:55,570 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:17:57,725 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:18:02,733 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:18:02,734 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_061802.mp4
2025-03-20 06:18:02,734 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:18:02,735 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:18:08,021 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:18:08,022 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:18:08,059 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:18:09,273 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061802.mp4
2025-03-20 06:18:09,276 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061802.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:18:11,286 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:18:14,289 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:18:14,290 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:18:17,297 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:18:17,298 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:18:17,298 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:18:18,479 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:18:18,480 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:18:18,480 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:18:18,480 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:18:18,581 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:18:20,592 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:18:20,592 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:18:20,592 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:18:22,885 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:18:22,886 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:18:31,090 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:18:31,091 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:18:31,091 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:18:31,091 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:31,410 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:18:31,411 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:31,636 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:18:31,637 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:31,885 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:18:31,886 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:32,116 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:18:32,117 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:32,385 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:18:32,386 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:32,616 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:18:32,617 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:32,856 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:18:32,857 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:33,084 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:18:33,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:33,316 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:18:33,317 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:18:35,564 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:18:35,565 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:18:35,565 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:18:35,695 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e41bc22 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1091}
    * Task{9e3786e #1091 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:18:35,695 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:18:35,696 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:18:35,696 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:18:35,696 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_061835_20250320_061835.png
2025-03-20 06:18:37,396 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_061835_20250320_061835.png
2025-03-20 06:18:37,397 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_061835_20250320_061835.png
2025-03-20 06:18:37,397 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:18:44,449 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_306.jpg
2025-03-20 06:18:44,457 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_306.jpg
2025-03-20 06:18:44,458 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:18:44,458 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:18:44,458 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:18:44,484 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:18:54,614 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:18:54,614 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:18:54,614 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:18:54,726 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{e41bc22 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1091}
    * Task{9e3786e #1091 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:18:54,727 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:18:54,727 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:18:54,727 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:18:54,727 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_061854_20250320_061854.png
2025-03-20 06:18:56,492 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_061854_20250320_061854.png
2025-03-20 06:18:56,493 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_061854_20250320_061854.png
2025-03-20 06:18:56,493 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:19:01,208 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_306.jpg
2025-03-20 06:19:01,215 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_306.jpg
2025-03-20 06:19:01,215 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:19:01,215 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:19:01,215 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:19:01,215 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:19:03,322 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:19:03,324 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:19:03,324 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:19:03,324 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:19:04,328 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:19:05,335 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:19:05,335 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:19:05,336 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 118.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:19:05,336 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:19:15,338 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061802.mp4 (大小: 3.61MB)
2025-03-20 06:19:15,339 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:19:15,455 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.287400秒，无需修复
2025-03-20 06:19:15,455 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:19:15,455 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_061802.mp4
2025-03-20 06:19:15,455 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:19:22,391 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_307.mp4
2025-03-20 06:19:22,395 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_307.mp4
2025-03-20 06:19:22,396 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:19:22,396 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:19:27,673 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:19:27,674 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_307.mp4
2025-03-20 06:19:27,674 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:19:27,675 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:19:27,675 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:19:28,013 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:19:29,021 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:19:29,022 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:19:29,022 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:19:30,123 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:19:30,124 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:19:30,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:19:32,240 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:19:32,241 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:19:33,392 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:19:33,393 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:19:33,393 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:19:34,534 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:19:34,535 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:19:34,536 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:19:34,536 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:17:15\n- 结束时间: 2025-03-20 06:19:34\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_306.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_306.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_307.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:19:34"}]}]}}
2025-03-20 06:19:34,873 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:19:34,876 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:24:35,009 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:24:35,011 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:24:35,011 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:24:35,011 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:24:35,154 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:24:35,318 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:24:35,319 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:24:35,319 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:24:35,320 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:24:35,524 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:24:35,525 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:24:35,525 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:24:35,526 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:24:37,013 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:24:37,014 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:24:38,278 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:24:38,278 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:24:38,279 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:24:38,279 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:24:38,279 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:24:38,451 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:24:38,452 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:24:38,452 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:24:38,452 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:24:39,864 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:24:39,864 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:24:41,161 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:24:41,162 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:24:41,162 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:24:41,162 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:24:41,162 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:24:42,258 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:24:42,258 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:24:42,372 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:24:44,379 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:24:44,379 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:24:45,469 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:24:45,470 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:24:45,470 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:24:45,470 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:24:45,549 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:24:47,563 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:24:47,563 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:24:49,714 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:24:49,715 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:24:51,805 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:24:51,806 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:24:52,912 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:24:52,913 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:24:52,913 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:24:52,914 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:24:52,987 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:24:55,000 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:24:55,001 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:24:57,173 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:24:57,174 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:24:58,597 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:25:00,058 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:25:00,059 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:25:01,223 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:25:01,224 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:25:02,322 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:25:02,323 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:25:04,505 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:25:04,505 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:25:04,505 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:25:04,505 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:25:04,506 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:25:05,685 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:25:05,686 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:25:05,822 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:25:10,828 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:25:10,828 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:25:12,983 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:25:12,984 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:25:18,120 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:25:18,121 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:25:20,273 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:25:25,280 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:25:25,282 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_062525.mp4
2025-03-20 06:25:25,282 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:25:25,282 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:25:30,562 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:25:30,563 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:25:30,610 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:25:31,770 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_062525.mp4
2025-03-20 06:25:31,770 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_062525.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:25:33,779 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:25:36,788 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:25:36,788 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:25:39,794 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:25:39,794 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:25:39,794 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:25:41,024 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:25:41,024 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:25:41,025 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:25:41,025 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:25:41,129 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:25:43,142 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:25:43,143 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:25:43,143 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:25:45,459 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:25:45,460 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:25:53,663 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:25:53,665 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:25:53,665 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:25:53,666 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:54,090 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:25:54,091 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:54,359 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:25:54,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:54,582 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:25:54,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:54,800 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:25:54,801 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:55,065 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:25:55,065 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:55,319 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:25:55,320 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:55,564 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:25:55,565 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:55,794 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:25:55,794 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:56,032 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:25:56,033 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:25:58,305 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:25:58,306 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:25:58,306 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:25:58,472 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3ea5b62 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1097}
    * Task{c96cbae #1097 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:25:58,473 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:25:58,473 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:25:58,473 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:25:58,473 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_062558_20250320_062558.png
2025-03-20 06:26:00,254 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_062558_20250320_062558.png
2025-03-20 06:26:00,256 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_062558_20250320_062558.png
2025-03-20 06:26:00,256 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:26:06,983 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:26:07,297 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_308.jpg
2025-03-20 06:26:07,301 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_308.jpg
2025-03-20 06:26:07,302 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:26:07,302 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:26:07,302 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:26:17,456 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:26:17,456 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:26:17,456 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:26:17,570 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3ea5b62 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1097}
    * Task{c96cbae #1097 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:26:17,570 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:26:17,571 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:26:17,571 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:26:17,571 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_062617_20250320_062617.png
2025-03-20 06:26:19,318 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_062617_20250320_062617.png
2025-03-20 06:26:19,319 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_062617_20250320_062617.png
2025-03-20 06:26:19,319 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:26:23,839 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_308.jpg
2025-03-20 06:26:23,844 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_308.jpg
2025-03-20 06:26:23,845 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:26:23,845 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:26:23,845 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:26:23,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:26:26,013 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:26:26,014 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:26:26,014 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:26:26,014 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:26:27,024 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:26:28,033 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:26:28,034 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:26:28,034 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 155.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:26:28,034 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:26:38,043 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_062525.mp4 (大小: 4.36MB)
2025-03-20 06:26:38,044 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:26:38,143 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.361289秒，无需修复
2025-03-20 06:26:38,143 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:26:38,144 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_062525.mp4
2025-03-20 06:26:38,144 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:26:45,458 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_309.mp4
2025-03-20 06:26:45,464 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_309.mp4
2025-03-20 06:26:45,464 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:26:45,465 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:26:50,688 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:26:50,690 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_309.mp4
2025-03-20 06:26:50,691 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:26:50,691 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:26:50,691 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:26:51,158 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:26:52,162 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:26:52,162 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:26:52,163 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:26:53,278 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:26:53,279 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:26:53,279 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:26:55,383 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:26:55,383 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:26:56,558 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:26:56,558 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:26:56,559 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:26:57,702 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:26:57,703 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:26:57,704 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:26:57,704 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:24:38\n- 结束时间: 2025-03-20 06:26:57\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_308.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_308.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_309.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:26:57"}]}]}}
2025-03-20 06:26:58,034 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:26:58,038 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:31:58,231 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:31:58,232 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:31:58,233 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:31:58,233 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:31:58,354 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:31:58,505 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:31:58,505 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:31:58,505 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:31:58,506 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:31:58,763 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:31:58,763 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:31:58,763 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:31:58,764 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:32:00,251 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:32:00,252 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:32:01,519 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:32:01,520 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:32:01,520 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:32:01,520 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:32:01,520 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:32:01,666 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:32:01,666 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:32:01,666 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:32:01,667 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:32:03,082 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:32:03,083 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:32:04,356 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:32:04,356 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:32:04,356 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:32:04,356 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:32:04,356 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:32:05,464 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:32:05,465 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:32:05,592 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:32:07,594 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:32:07,595 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:32:08,687 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:32:08,688 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:32:08,688 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:32:08,688 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:32:08,764 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:32:10,782 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:32:10,783 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:32:12,988 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:32:12,989 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:32:15,077 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:32:15,078 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:32:16,190 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:32:16,191 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:32:16,192 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:32:16,192 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:32:16,269 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:32:18,290 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:32:18,291 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:32:20,462 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:32:20,463 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:32:21,883 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:32:23,359 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:32:23,360 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:32:24,522 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:32:24,523 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:32:25,633 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:32:25,634 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:32:27,823 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:32:27,824 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:32:27,824 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:32:27,824 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:32:27,824 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:32:28,990 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:32:28,991 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:32:29,111 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:32:34,120 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:32:34,120 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:32:36,270 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:32:36,271 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:32:41,441 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:32:41,442 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:32:43,603 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:32:48,612 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:32:48,614 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_063248.mp4
2025-03-20 06:32:48,614 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:32:48,614 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:32:53,875 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:32:53,876 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:32:53,922 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:32:55,079 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_063248.mp4
2025-03-20 06:32:55,081 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_063248.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:32:57,095 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:33:00,101 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:33:00,101 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:33:03,111 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:33:03,112 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:33:03,112 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:33:04,290 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:33:04,291 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:33:04,291 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:33:04,291 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:33:04,392 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:33:06,406 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:33:06,406 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:33:06,406 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:33:08,689 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:33:08,690 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:33:16,903 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:33:16,904 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:33:16,904 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:33:16,905 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:17,173 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:33:17,173 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:17,418 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:33:17,418 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:17,636 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:33:17,637 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:17,868 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:33:17,869 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:18,173 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:33:18,174 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:18,405 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:33:18,405 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:18,636 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:33:18,637 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:18,889 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:33:18,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:19,132 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:33:19,133 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:33:21,386 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:33:21,387 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:33:21,387 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:33:21,520 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{83150db u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1103}
    * Task{43226b6 #1103 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:33:21,521 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:33:21,521 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:33:21,521 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:33:21,522 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_063321_20250320_063321.png
2025-03-20 06:33:23,107 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_063321_20250320_063321.png
2025-03-20 06:33:23,108 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_063321_20250320_063321.png
2025-03-20 06:33:23,108 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:33:30,108 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_310.jpg
2025-03-20 06:33:30,115 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_310.jpg
2025-03-20 06:33:30,116 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:33:30,116 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:33:30,116 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:33:30,292 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:33:40,261 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:33:40,261 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:33:40,262 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:33:40,392 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{83150db u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1103}
    * Task{43226b6 #1103 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:33:40,393 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:33:40,393 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:33:40,393 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:33:40,393 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_063340_20250320_063340.png
2025-03-20 06:33:42,003 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_063340_20250320_063340.png
2025-03-20 06:33:42,003 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_063340_20250320_063340.png
2025-03-20 06:33:42,004 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:33:47,937 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_311.jpg
2025-03-20 06:33:47,942 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_311.jpg
2025-03-20 06:33:47,943 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:33:47,943 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:33:47,943 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:33:47,943 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:33:50,083 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:33:50,084 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:33:50,084 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:33:50,084 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:33:51,091 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:33:52,099 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:33:52,099 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:33:52,099 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 137.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:33:52,100 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:34:02,105 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_063248.mp4 (大小: 3.98MB)
2025-03-20 06:34:02,107 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:34:02,221 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.071956秒，无需修复
2025-03-20 06:34:02,222 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:34:02,222 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_063248.mp4
2025-03-20 06:34:02,222 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:34:09,169 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_312.mp4
2025-03-20 06:34:09,175 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_312.mp4
2025-03-20 06:34:09,175 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:34:09,175 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:34:14,444 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:34:14,446 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_312.mp4
2025-03-20 06:34:14,446 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:34:14,446 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:34:14,446 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:34:14,909 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:34:15,918 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:34:15,919 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:34:15,919 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:34:17,025 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:34:17,026 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:34:17,026 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:34:19,138 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:34:19,139 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:34:20,291 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:34:20,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:34:20,292 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:34:21,417 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:34:21,418 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:34:21,418 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:34:21,419 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:32:01\n- 结束时间: 2025-03-20 06:34:21\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_310.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_311.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_312.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:34:21"}]}]}}
2025-03-20 06:34:21,754 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:34:21,758 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:39:21,887 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:39:21,888 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:39:21,888 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:39:21,889 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:39:22,004 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:39:22,159 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:39:22,160 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:39:22,160 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:39:22,160 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:39:22,391 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:39:22,392 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:39:22,392 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:39:22,392 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:39:23,872 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:39:23,873 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:39:25,133 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:39:25,134 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:39:25,134 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:39:25,134 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:39:25,134 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:39:25,287 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:39:25,287 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:39:25,287 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:39:25,288 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:39:26,705 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:39:26,706 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:39:27,972 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:39:27,972 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:39:27,972 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:39:27,972 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:39:27,972 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:39:29,062 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:39:29,063 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:39:29,189 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:39:31,194 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:39:31,195 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:39:32,291 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:39:32,291 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:39:32,292 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:39:32,292 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:39:32,366 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:39:34,383 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:39:34,383 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:39:36,581 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:39:36,582 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:39:38,671 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:39:38,672 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:39:39,771 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:39:39,771 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:39:39,772 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:39:39,772 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:39:39,849 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:39:41,866 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:39:41,866 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:39:44,025 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:39:44,026 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:39:45,455 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:39:46,936 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:39:46,938 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:39:48,126 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:39:48,127 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:39:49,238 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:39:49,240 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:39:51,437 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:39:51,438 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:39:51,438 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:39:51,438 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:39:51,438 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:39:52,599 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:39:52,601 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:39:52,731 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:39:57,741 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:39:57,742 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:39:59,893 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:39:59,894 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:40:05,075 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:40:05,076 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:40:07,248 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:40:12,259 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:40:12,260 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_064012.mp4
2025-03-20 06:40:12,260 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:40:12,260 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:40:17,540 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:40:17,541 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:40:17,583 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:40:18,801 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064012.mp4
2025-03-20 06:40:18,802 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064012.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:40:20,816 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:40:23,826 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:40:23,827 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:40:26,836 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:40:26,836 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:40:26,836 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:40:28,024 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:40:28,025 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:40:28,025 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:40:28,025 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:40:28,130 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:40:30,147 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:40:30,148 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:40:30,148 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:40:32,441 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:40:32,442 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:40:40,634 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:40:40,635 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:40:40,635 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:40:40,635 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:40,990 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:40:40,991 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:41,215 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:40:41,216 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:41,454 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:40:41,455 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:41,690 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:40:41,691 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:41,939 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:40:41,940 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:42,187 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:40:42,188 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:42,434 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:40:42,435 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:42,687 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:40:42,688 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:42,922 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:40:42,923 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:40:45,162 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:40:45,163 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:40:45,164 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:40:45,292 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{74a1fe u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1109}
    * Task{be153ac #1109 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:40:45,293 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:40:45,293 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:40:45,293 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:40:45,293 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_064045_20250320_064045.png
2025-03-20 06:40:46,580 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_064045_20250320_064045.png
2025-03-20 06:40:46,581 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_064045_20250320_064045.png
2025-03-20 06:40:46,581 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:40:53,537 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_313.jpg
2025-03-20 06:40:53,544 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_313.jpg
2025-03-20 06:40:53,544 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:40:53,544 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:40:53,544 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:40:54,039 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:41:03,670 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:41:03,671 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:41:03,671 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:41:03,816 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{74a1fe u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1109}
    * Task{be153ac #1109 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:41:03,816 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:41:03,817 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:41:03,817 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:41:03,817 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_064103_20250320_064103.png
2025-03-20 06:41:05,098 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_064103_20250320_064103.png
2025-03-20 06:41:05,099 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_064103_20250320_064103.png
2025-03-20 06:41:05,099 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:41:09,537 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_313.jpg
2025-03-20 06:41:09,543 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_313.jpg
2025-03-20 06:41:09,543 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:41:09,543 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:41:09,543 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:41:09,543 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:41:11,686 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:41:11,687 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:41:11,687 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:41:11,687 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:41:12,694 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:41:13,699 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:41:13,700 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:41:13,700 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 116.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:41:13,700 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:41:23,705 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064012.mp4 (大小: 3.42MB)
2025-03-20 06:41:23,705 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:41:23,820 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.099378秒，无需修复
2025-03-20 06:41:23,820 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:41:23,820 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064012.mp4
2025-03-20 06:41:23,820 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:41:30,508 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_314.mp4
2025-03-20 06:41:30,513 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_314.mp4
2025-03-20 06:41:30,513 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:41:30,513 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:41:35,731 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:41:35,732 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_314.mp4
2025-03-20 06:41:35,732 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:41:35,733 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:41:35,733 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:41:36,099 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:41:37,109 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:41:37,109 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:41:37,109 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:41:38,215 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:41:38,216 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:41:38,216 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:41:40,315 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:41:40,316 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:41:41,462 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:41:41,463 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:41:41,463 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:41:42,586 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:41:42,587 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:41:42,588 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:41:42,588 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:39:25\n- 结束时间: 2025-03-20 06:41:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_313.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_313.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_314.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:41:42"}]}]}}
2025-03-20 06:41:42,908 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:41:42,911 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:46:43,089 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:46:43,091 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:46:43,091 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:46:43,091 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:46:43,230 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:46:43,389 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:46:43,390 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:46:43,390 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:46:43,390 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:46:43,592 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:46:43,592 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:46:43,592 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:46:43,593 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:46:45,073 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:46:45,074 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:46:46,351 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:46:46,352 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:46:46,352 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:46:46,352 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:46:46,352 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:46:46,499 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:46:46,500 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:46:46,500 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:46:46,500 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:46:47,905 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:46:47,906 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:46:49,147 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:46:49,147 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:46:49,147 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:46:49,147 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:46:49,147 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:46:50,238 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:46:50,238 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:46:50,364 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:46:52,370 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:46:52,371 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:46:53,462 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:46:53,463 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:46:53,463 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:46:53,463 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:46:53,539 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:46:55,558 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:46:55,559 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:46:57,740 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:46:57,741 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:46:59,831 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:46:59,832 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:47:00,942 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:47:00,943 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:47:00,943 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:47:00,943 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:47:01,017 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:47:03,031 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:47:03,032 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:47:05,201 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:47:05,202 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:47:06,629 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:47:08,125 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:47:08,126 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:47:09,305 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:47:09,306 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:47:10,415 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:47:10,416 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:47:12,596 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:47:12,597 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:47:12,597 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:47:12,597 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:47:12,597 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:47:13,770 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:47:13,771 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:47:13,882 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:47:18,892 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:47:18,893 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:47:21,058 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:47:21,059 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:47:26,199 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:47:26,200 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:47:28,369 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:47:33,377 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:47:33,378 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_064733.mp4
2025-03-20 06:47:33,378 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:47:33,378 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:47:38,656 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:47:38,659 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:47:38,703 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:47:39,862 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064733.mp4
2025-03-20 06:47:39,863 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064733.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:47:41,879 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:47:44,887 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:47:44,888 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:47:47,897 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:47:47,898 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:47:47,898 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:47:49,081 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:47:49,082 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:47:49,082 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:47:49,082 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:47:49,186 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:47:51,202 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:47:51,203 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:47:51,203 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:47:53,494 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:47:53,494 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:48:01,703 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:48:01,705 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:48:01,705 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:48:01,705 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:02,077 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:48:02,078 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:02,311 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:48:02,311 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:02,547 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:48:02,548 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:02,780 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:48:02,781 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:03,028 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:48:03,029 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:03,276 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:48:03,277 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:03,570 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:48:03,571 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:03,794 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:48:03,795 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:04,012 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:48:04,013 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:48:06,278 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:48:06,279 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:48:06,279 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:48:06,441 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d24567d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1115}
    * Task{c421a40 #1115 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:48:06,442 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:48:06,442 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:48:06,442 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:48:06,442 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_064806_20250320_064806.png
2025-03-20 06:48:07,907 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_064806_20250320_064806.png
2025-03-20 06:48:07,908 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_064806_20250320_064806.png
2025-03-20 06:48:07,908 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:48:14,624 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_315.jpg
2025-03-20 06:48:14,630 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_315.jpg
2025-03-20 06:48:14,630 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:48:14,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:48:14,631 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:48:15,080 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:48:24,810 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:48:24,811 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:48:24,812 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:48:24,915 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d24567d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1115}
    * Task{c421a40 #1115 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:48:24,916 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:48:24,916 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:48:24,916 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:48:24,916 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_064824_20250320_064824.png
2025-03-20 06:48:26,422 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_064824_20250320_064824.png
2025-03-20 06:48:26,423 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_064824_20250320_064824.png
2025-03-20 06:48:26,423 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:48:32,039 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_316.jpg
2025-03-20 06:48:32,045 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_316.jpg
2025-03-20 06:48:32,045 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:48:32,045 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:48:32,045 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:48:32,046 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:48:34,225 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:48:34,225 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:48:34,226 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:48:34,226 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:48:35,228 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:48:36,239 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:48:36,240 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:48:36,240 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 147.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:48:36,240 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:48:46,250 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064733.mp4 (大小: 3.22MB)
2025-03-20 06:48:46,251 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:48:46,365 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.474156秒，无需修复
2025-03-20 06:48:46,365 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:48:46,365 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_064733.mp4
2025-03-20 06:48:46,365 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:48:53,282 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_317.mp4
2025-03-20 06:48:53,287 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_317.mp4
2025-03-20 06:48:53,288 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:48:53,288 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:48:58,506 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:48:58,507 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_317.mp4
2025-03-20 06:48:58,507 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:48:58,507 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:48:58,507 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:48:58,922 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:48:59,932 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:48:59,932 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:48:59,933 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:49:01,037 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:49:01,038 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:49:01,038 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:49:03,146 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:49:03,147 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:49:04,310 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:49:04,311 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:49:04,311 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:49:05,459 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:49:05,460 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:49:05,460 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:49:05,460 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:46:46\n- 结束时间: 2025-03-20 06:49:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_315.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_316.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_317.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:49:05"}]}]}}
2025-03-20 06:49:05,793 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:49:05,796 - QuickAppADBTester - INFO - 测试完成
2025-03-20 06:54:05,979 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 06:54:05,981 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 06:54:05,981 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 06:54:05,981 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 06:54:06,119 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 06:54:06,284 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 06:54:06,285 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 06:54:06,285 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:54:06,285 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:54:06,523 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:54:06,524 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:54:06,524 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:54:06,524 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:54:08,002 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:54:08,003 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:54:09,252 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:54:09,252 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 06:54:09,252 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 06:54:09,252 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 06:54:09,252 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 06:54:09,393 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 06:54:09,394 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 06:54:09,394 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 06:54:09,394 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 06:54:10,794 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:54:10,794 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:54:12,070 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 06:54:12,070 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 06:54:12,070 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:54:12,070 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:54:12,070 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:54:13,174 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 06:54:13,175 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 06:54:13,285 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 06:54:15,294 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 06:54:15,294 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 06:54:16,387 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 06:54:16,388 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 06:54:16,389 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:54:16,389 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 06:54:16,471 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:54:18,491 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 06:54:18,492 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 06:54:20,704 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 06:54:20,704 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 06:54:22,794 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 06:54:22,795 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 06:54:23,899 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 06:54:23,900 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 06:54:23,901 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:54:23,901 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 06:54:23,975 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:54:25,995 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 06:54:25,996 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 06:54:28,211 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 06:54:28,212 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 06:54:29,639 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 06:54:31,094 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 06:54:31,095 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 06:54:32,282 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 06:54:32,283 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 06:54:33,392 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 06:54:33,393 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 06:54:35,582 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 06:54:35,583 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 06:54:35,583 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 06:54:35,583 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:54:35,583 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:54:36,749 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 06:54:36,750 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 06:54:36,861 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 06:54:41,866 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 06:54:41,867 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 06:54:43,998 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 06:54:43,999 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 06:54:49,183 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 06:54:49,184 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 06:54:51,349 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 06:54:56,357 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 06:54:56,358 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_065456.mp4
2025-03-20 06:54:56,358 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:54:56,358 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:55:01,581 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:55:01,583 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 06:55:01,629 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 06:55:02,782 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_065456.mp4
2025-03-20 06:55:02,783 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_065456.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 06:55:04,798 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 06:55:07,810 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 06:55:07,810 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 06:55:10,816 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 06:55:10,817 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 06:55:10,817 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 06:55:12,005 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 06:55:12,006 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 06:55:12,006 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 06:55:12,006 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 06:55:12,104 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 06:55:14,124 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 06:55:14,125 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 06:55:14,125 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 06:55:16,433 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 06:55:16,434 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 06:55:24,630 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 06:55:24,631 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 06:55:24,631 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 06:55:24,632 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:24,980 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 06:55:24,981 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:25,213 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 06:55:25,214 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:25,443 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 06:55:25,444 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:25,705 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 06:55:25,706 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:25,938 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 06:55:25,938 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:26,198 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 06:55:26,199 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:26,430 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 06:55:26,431 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:26,672 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 06:55:26,673 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:26,933 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 06:55:26,934 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 06:55:29,180 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 06:55:29,181 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:55:29,182 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:55:29,340 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f35285a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1121}
    * Task{7e3c768 #1121 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:55:29,341 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:55:29,341 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 06:55:29,341 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 06:55:29,341 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_065529_20250320_065529.png
2025-03-20 06:55:30,730 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_065529_20250320_065529.png
2025-03-20 06:55:30,730 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_065529_20250320_065529.png
2025-03-20 06:55:30,731 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:55:37,318 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_318.jpg
2025-03-20 06:55:37,325 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_318.jpg
2025-03-20 06:55:37,326 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 06:55:37,326 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:55:37,326 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:55:38,024 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 06:55:47,453 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 06:55:47,453 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 06:55:47,454 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 06:55:47,565 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f35285a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1121}
    * Task{7e3c768 #1121 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 06:55:47,565 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 06:55:47,565 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 06:55:47,565 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 06:55:47,565 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_065547_20250320_065547.png
2025-03-20 06:55:48,945 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_065547_20250320_065547.png
2025-03-20 06:55:48,946 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_065547_20250320_065547.png
2025-03-20 06:55:48,946 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 06:55:53,416 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_318.jpg
2025-03-20 06:55:53,423 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_318.jpg
2025-03-20 06:55:53,423 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 06:55:53,423 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 06:55:53,423 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:55:53,423 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:55:55,598 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 06:55:55,599 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 06:55:55,599 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 06:55:55,599 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 06:55:56,608 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 06:55:57,613 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 06:55:57,614 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 06:55:57,614 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 149.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 06:55:57,614 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 06:56:07,623 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_065456.mp4 (大小: 3.11MB)
2025-03-20 06:56:07,624 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 06:56:07,740 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.942000秒，无需修复
2025-03-20 06:56:07,740 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 06:56:07,740 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_065456.mp4
2025-03-20 06:56:07,740 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 06:56:14,751 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_319.mp4
2025-03-20 06:56:14,758 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_319.mp4
2025-03-20 06:56:14,758 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 06:56:14,758 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 06:56:19,971 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 06:56:19,973 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_319.mp4
2025-03-20 06:56:19,973 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 06:56:19,973 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 06:56:19,973 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 06:56:20,462 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 06:56:21,470 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 06:56:21,471 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:56:21,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:56:22,574 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 06:56:22,575 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 06:56:22,575 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 06:56:24,689 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 06:56:24,690 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 06:56:25,835 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 06:56:25,836 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 06:56:25,836 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 06:56:26,970 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 06:56:26,971 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 06:56:26,971 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 06:56:26,972 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 06:54:09\n- 结束时间: 2025-03-20 06:56:26\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_318.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_318.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_319.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 06:56:26"}]}]}}
2025-03-20 06:56:27,305 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 06:56:27,308 - QuickAppADBTester - INFO - 测试完成
2025-03-20 07:01:27,458 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 07:01:27,460 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 07:01:27,460 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 07:01:27,460 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 07:01:27,590 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 07:01:27,713 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 07:01:27,714 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 07:01:27,714 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 07:01:27,715 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 07:01:27,914 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 07:01:27,915 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 07:01:27,915 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 07:01:27,915 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 07:01:29,407 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:01:29,408 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:01:30,684 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 07:01:30,685 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 07:01:30,685 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 07:01:30,685 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 07:01:30,685 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 07:01:30,829 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 07:01:30,829 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 07:01:30,829 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 07:01:30,830 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 07:01:32,229 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:01:32,230 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:01:33,488 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 07:01:33,488 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 07:01:33,488 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 07:01:33,489 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:01:33,489 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:01:34,585 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 07:01:34,586 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 07:01:34,705 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 07:01:36,716 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 07:01:36,716 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 07:01:37,808 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 07:01:37,809 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 07:01:37,809 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 07:01:37,809 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 07:01:37,888 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 07:01:39,908 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 07:01:39,909 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 07:01:42,118 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 07:01:42,119 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 07:01:44,209 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 07:01:44,210 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 07:01:45,312 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 07:01:45,313 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 07:01:45,313 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 07:01:45,313 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 07:01:45,388 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 07:01:47,407 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 07:01:47,407 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 07:01:49,549 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 07:01:49,550 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 07:01:50,974 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 07:01:52,449 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 07:01:52,450 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 07:01:53,634 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 07:01:53,635 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 07:01:54,744 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 07:01:54,745 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 07:01:56,949 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 07:01:56,950 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 07:01:56,950 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 07:01:56,950 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:01:56,950 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:01:58,119 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 07:01:58,119 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 07:01:58,236 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 07:02:03,247 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 07:02:03,247 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 07:02:05,402 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 07:02:05,403 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 07:02:10,538 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 07:02:10,540 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 07:02:12,693 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 07:02:17,701 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 07:02:17,702 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_070217.mp4
2025-03-20 07:02:17,702 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 07:02:17,702 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 07:02:22,965 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 07:02:22,966 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 07:02:23,010 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 07:02:24,171 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_070217.mp4
2025-03-20 07:02:24,172 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_070217.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 07:02:26,191 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 07:02:29,202 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 07:02:29,202 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 07:02:32,211 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 07:02:32,211 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 07:02:32,212 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 07:02:33,393 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 07:02:33,394 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 07:02:33,394 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 07:02:33,395 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 07:02:33,496 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 07:02:35,509 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 07:02:35,509 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 07:02:35,510 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 07:02:37,787 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 07:02:37,788 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 07:02:45,978 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 07:02:45,979 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 07:02:45,979 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 07:02:45,980 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:46,241 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 07:02:46,242 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:46,537 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 07:02:46,538 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:46,784 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 07:02:46,785 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:47,013 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 07:02:47,014 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:47,243 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 07:02:47,244 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:47,482 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 07:02:47,482 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:47,720 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 07:02:47,720 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:47,934 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 07:02:47,934 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:48,194 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 07:02:48,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:02:50,416 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 07:02:50,417 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 07:02:50,417 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 07:02:50,526 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9733610 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1127}
    * Task{6fd212f #1127 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 07:02:50,527 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 07:02:50,527 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 07:02:50,527 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 07:02:50,527 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_070250_20250320_070250.png
2025-03-20 07:02:51,978 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_070250_20250320_070250.png
2025-03-20 07:02:51,979 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_070250_20250320_070250.png
2025-03-20 07:02:51,979 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 07:02:58,454 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_320.jpg
2025-03-20 07:02:58,458 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_320.jpg
2025-03-20 07:02:58,458 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 07:02:58,459 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:02:58,459 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:02:59,443 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 07:03:08,601 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 07:03:08,602 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 07:03:08,603 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 07:03:08,693 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9733610 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1127}
    * Task{6fd212f #1127 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 07:03:08,693 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 07:03:08,693 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 07:03:08,693 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 07:03:08,694 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_070308_20250320_070308.png
2025-03-20 07:03:10,101 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_070308_20250320_070308.png
2025-03-20 07:03:10,101 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_070308_20250320_070308.png
2025-03-20 07:03:10,102 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 07:03:14,606 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_320.jpg
2025-03-20 07:03:14,612 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_320.jpg
2025-03-20 07:03:14,612 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 07:03:14,612 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 07:03:14,613 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:03:14,613 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:03:16,759 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 07:03:16,760 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 07:03:16,760 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 07:03:16,760 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 07:03:17,769 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 07:03:18,779 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 07:03:18,780 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 07:03:18,780 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 118.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 07:03:18,780 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 07:03:28,786 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_070217.mp4 (大小: 2.89MB)
2025-03-20 07:03:28,787 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 07:03:28,899 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.692611秒，无需修复
2025-03-20 07:03:28,900 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 07:03:28,900 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_070217.mp4
2025-03-20 07:03:28,900 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 07:03:36,043 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_321.mp4
2025-03-20 07:03:36,048 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_321.mp4
2025-03-20 07:03:36,048 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 07:03:36,048 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 07:03:41,264 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 07:03:41,265 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_321.mp4
2025-03-20 07:03:41,265 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 07:03:41,265 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 07:03:41,265 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 07:03:41,579 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 07:03:42,590 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 07:03:42,590 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:03:42,590 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:03:43,708 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 07:03:43,709 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 07:03:43,709 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 07:03:45,813 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 07:03:45,814 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 07:03:46,996 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 07:03:46,997 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:03:46,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:03:48,137 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 07:03:48,137 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 07:03:48,138 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 07:03:48,138 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 07:01:30\n- 结束时间: 2025-03-20 07:03:48\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_320.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_320.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_321.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 07:03:48"}]}]}}
2025-03-20 07:03:48,454 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 07:03:48,457 - QuickAppADBTester - INFO - 测试完成
2025-03-20 07:19:38,093 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 07:19:38,094 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 07:19:38,094 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 07:19:38,094 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 07:19:38,233 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 07:19:38,403 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 07:19:38,403 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 07:19:38,403 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 07:19:38,403 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 07:19:38,651 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 07:19:38,652 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 07:19:38,652 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 07:19:38,652 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 07:19:40,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:19:40,149 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:19:41,424 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 07:19:41,425 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 07:19:41,425 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 07:19:41,425 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 07:19:41,425 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 07:19:41,595 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 07:19:41,595 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 07:19:41,595 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 07:19:41,596 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 07:19:43,013 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:19:43,013 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:19:44,245 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 07:19:44,246 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 07:19:44,246 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 07:19:44,246 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:19:44,246 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:19:45,347 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 07:19:45,348 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 07:19:45,483 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 07:19:47,491 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 07:19:47,491 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 07:19:48,577 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 07:19:48,578 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 07:19:48,579 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 07:19:48,579 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 07:19:48,661 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 07:19:50,680 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 07:19:50,681 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 07:19:52,873 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 07:19:52,874 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 07:19:54,951 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 07:19:54,952 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 07:19:56,063 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 07:19:56,064 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 07:19:56,065 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 07:19:56,065 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 07:19:56,141 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 07:19:58,157 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 07:19:58,158 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 07:20:00,306 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 07:20:00,307 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 07:20:01,736 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 07:20:03,225 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 07:20:03,225 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 07:20:04,428 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 07:20:04,429 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 07:20:05,539 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 07:20:05,540 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 07:20:07,725 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 07:20:07,726 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 07:20:07,726 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 07:20:07,726 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:20:07,726 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:20:08,913 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 07:20:08,914 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 07:20:09,030 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 07:20:14,039 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 07:20:14,040 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 07:20:16,162 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 07:20:16,163 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 07:20:21,322 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 07:20:21,322 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 07:20:23,485 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 07:35:46,492 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 07:35:46,492 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_073546.mp4
2025-03-20 07:35:46,493 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 07:35:46,493 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 07:35:51,745 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 07:35:51,746 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 07:35:51,791 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 07:35:53,004 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_073546.mp4
2025-03-20 07:35:53,005 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_073546.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 07:35:55,020 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 07:35:58,030 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 07:35:58,032 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 07:36:01,035 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 07:36:01,036 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 07:36:01,036 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 07:36:02,223 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 07:36:02,224 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 07:36:02,224 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 07:36:02,224 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 07:36:02,324 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 07:36:04,334 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 07:36:04,335 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 07:36:04,335 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 07:36:06,660 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 07:36:06,661 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 07:36:14,858 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 07:36:14,859 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 07:36:14,860 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 07:36:14,860 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:15,186 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 07:36:15,187 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:15,400 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 07:36:15,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:15,643 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 07:36:15,644 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:15,878 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 07:36:15,879 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:16,132 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 07:36:16,133 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:16,352 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 07:36:16,353 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:16,575 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 07:36:16,575 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:16,811 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 07:36:16,812 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:17,065 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 07:36:17,066 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 07:36:19,342 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 07:36:19,343 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 07:36:19,343 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 07:36:19,510 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8171b9f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1133}
    * Task{e5bd2bb #1133 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 07:36:19,511 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 07:36:19,511 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 07:36:19,511 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 07:36:19,511 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_073619_20250320_073619.png
2025-03-20 07:36:21,248 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_073619_20250320_073619.png
2025-03-20 07:36:21,249 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_073619_20250320_073619.png
2025-03-20 07:36:21,250 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 07:36:28,213 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 07:36:28,627 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_322.jpg
2025-03-20 07:36:28,630 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_322.jpg
2025-03-20 07:36:28,630 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 07:36:28,631 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:36:28,631 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:36:38,763 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 07:36:38,764 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 07:36:38,764 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 07:36:38,862 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{8171b9f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1133}
    * Task{e5bd2bb #1133 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 07:36:38,863 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 07:36:38,863 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 07:36:38,863 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 07:36:38,863 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_073638_20250320_073638.png
2025-03-20 07:36:40,587 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_073638_20250320_073638.png
2025-03-20 07:36:40,588 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_073638_20250320_073638.png
2025-03-20 07:36:40,588 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 07:36:45,135 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_322.jpg
2025-03-20 07:36:45,141 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_322.jpg
2025-03-20 07:36:45,142 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 07:36:45,142 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 07:36:45,142 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:36:45,142 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:47:55,043 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 07:47:55,047 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 07:47:55,048 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 07:47:55,048 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 07:47:56,054 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 07:47:57,064 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 07:47:57,064 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 07:47:57,065 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 110.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 07:47:57,065 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 07:48:07,074 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_073546.mp4 (大小: 4.25MB)
2025-03-20 07:48:07,075 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 07:48:07,237 - QuickAppADBTester - INFO - 录制文件完整，时长: 666.082422秒，无需修复
2025-03-20 07:48:07,238 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 07:48:07,238 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_073546.mp4
2025-03-20 07:48:07,238 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 07:48:33,080 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 07:48:33,087 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 07:48:33,091 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-20 07:48:33,091 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 07:48:33,091 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 07:48:38,374 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 07:48:38,376 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 07:48:38,376 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 07:48:38,376 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 07:48:38,376 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 07:48:38,708 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 07:48:39,719 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 07:48:39,719 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 07:48:39,719 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 07:48:40,832 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 07:48:40,833 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 07:48:40,833 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 08:04:43,897 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 08:04:43,898 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 08:04:45,061 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 08:04:45,061 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:04:45,061 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:04:46,198 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 08:04:46,198 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 08:04:46,198 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-20 08:04:46,199 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 07:19:41\n- 结束时间: 2025-03-20 08:04:46\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_322.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_322.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 08:04:46"}]}]}}
2025-03-20 08:04:46,582 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 08:04:46,584 - QuickAppADBTester - INFO - 测试完成
2025-03-20 08:21:02,449 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 08:21:02,511 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 08:21:02,511 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 08:21:02,511 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 08:21:02,626 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 08:21:02,751 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 08:21:02,751 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 08:21:02,751 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 08:21:02,751 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 08:21:02,983 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 08:21:02,983 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 08:21:02,983 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 08:21:02,983 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 08:21:04,486 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:21:04,487 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:21:05,748 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 08:21:05,748 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 08:21:05,748 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 08:21:05,748 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 08:21:05,748 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 08:21:05,884 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 08:21:05,885 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 08:21:05,885 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 08:21:05,885 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 08:21:07,288 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:21:07,289 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:21:08,549 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 08:21:08,550 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 08:21:08,550 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 08:21:08,550 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:21:08,550 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:21:09,647 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 08:21:09,647 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 08:21:09,766 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 08:21:11,772 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 08:21:11,773 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 08:21:12,877 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 08:21:12,878 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 08:21:12,878 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 08:21:12,878 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 08:21:12,987 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 08:21:14,999 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 08:21:15,001 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 08:21:17,205 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 08:21:17,205 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 08:21:19,292 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 08:21:19,293 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 08:21:20,394 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 08:21:20,395 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 08:21:20,395 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 08:21:20,395 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 08:21:20,473 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 08:21:22,491 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 08:21:22,492 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 08:21:24,669 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 08:21:24,670 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 08:21:26,102 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 08:21:27,599 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 08:21:27,600 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 08:21:28,717 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 08:21:28,718 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 08:21:29,829 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 08:21:29,830 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 08:21:32,009 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 08:21:32,010 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 08:21:32,010 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 08:21:32,010 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:21:32,010 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:21:33,173 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 08:21:33,174 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 08:21:33,294 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 08:21:38,299 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 08:21:38,301 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 08:21:40,632 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 08:21:40,633 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 08:21:45,775 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 08:21:45,776 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 08:21:47,952 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 08:37:32,886 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 08:37:32,888 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_083732.mp4
2025-03-20 08:37:32,888 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 08:37:32,889 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 08:37:38,171 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 08:37:38,172 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 08:37:38,213 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 08:37:39,372 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_083732.mp4
2025-03-20 08:37:39,373 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_083732.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 08:37:41,390 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 08:37:44,392 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 08:37:44,393 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 08:37:47,400 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 08:37:47,401 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 08:37:47,401 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 08:37:48,549 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 08:37:48,550 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 08:37:48,550 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 08:37:48,551 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 08:37:48,652 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 08:37:50,670 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 08:37:50,671 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 08:37:50,671 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 08:37:52,940 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 08:37:52,941 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 08:38:01,132 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 08:38:01,133 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 08:38:01,133 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 08:38:01,133 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:01,413 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 08:38:01,414 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:01,648 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 08:38:01,649 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:01,894 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 08:38:01,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:02,127 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 08:38:02,128 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:02,372 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 08:38:02,374 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:02,622 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 08:38:02,623 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:02,861 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 08:38:02,862 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:03,094 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 08:38:03,095 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:03,354 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 08:38:03,355 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 08:38:05,680 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 08:38:05,681 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 08:38:05,681 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 08:38:05,826 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{497fd7a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1139}
    * Task{fe27188 #1139 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 08:38:05,826 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 08:38:05,826 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 08:38:05,826 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 08:38:05,827 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_083805_20250320_083805.png
2025-03-20 08:38:07,357 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_083805_20250320_083805.png
2025-03-20 08:38:07,358 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_083805_20250320_083805.png
2025-03-20 08:38:07,358 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 08:38:14,613 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 08:38:14,801 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_323.jpg
2025-03-20 08:38:14,807 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_323.jpg
2025-03-20 08:38:14,808 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 08:38:14,808 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:38:14,808 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:38:24,952 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 08:38:24,953 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 08:38:24,953 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 08:38:25,073 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{497fd7a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1139}
    * Task{fe27188 #1139 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 08:38:25,073 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 08:38:25,073 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 08:38:25,074 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 08:38:25,074 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_083825_20250320_083825.png
2025-03-20 08:38:26,544 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_083825_20250320_083825.png
2025-03-20 08:38:26,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_083825_20250320_083825.png
2025-03-20 08:38:26,548 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 08:38:31,008 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_323.jpg
2025-03-20 08:38:31,014 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_323.jpg
2025-03-20 08:38:31,014 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 08:38:31,014 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 08:38:31,014 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:38:31,014 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:48:55,092 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 08:48:55,093 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 08:48:55,093 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 08:48:55,093 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 08:48:56,101 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 08:48:57,107 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 08:48:57,108 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 08:48:57,108 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 158.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 08:48:57,108 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 08:49:07,113 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_083732.mp4 (大小: 3.40MB)
2025-03-20 08:49:07,114 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 08:49:07,273 - QuickAppADBTester - INFO - 录制文件完整，时长: 619.799989秒，无需修复
2025-03-20 08:49:07,273 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 08:49:07,273 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_083732.mp4
2025-03-20 08:49:07,273 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 08:49:23,980 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 08:49:23,986 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 08:49:23,990 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-20 08:49:23,990 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 08:49:23,990 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 08:49:29,271 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 08:49:29,272 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 08:49:29,272 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 08:49:29,272 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 08:49:29,273 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 08:49:29,578 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 08:49:30,586 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 08:49:30,587 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:49:30,587 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:49:31,698 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 08:49:31,699 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 08:49:31,700 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 08:49:33,813 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 08:49:33,813 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 08:49:35,007 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 08:49:35,008 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:49:35,008 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:49:36,133 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 08:49:36,134 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 08:49:36,134 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-20 08:49:36,135 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 08:21:05\n- 结束时间: 2025-03-20 08:49:36\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_323.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_323.jpg"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 08:49:36"}]}]}}
2025-03-20 08:49:36,548 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 08:49:36,551 - QuickAppADBTester - INFO - 测试完成
2025-03-20 08:56:58,623 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 08:56:58,623 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 08:56:58,623 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 08:56:58,623 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 08:56:58,748 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 08:56:58,923 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 08:56:58,924 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 08:56:58,924 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 08:56:58,924 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 08:56:59,190 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 08:56:59,191 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 08:56:59,191 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 08:56:59,191 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 08:57:00,676 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:57:00,677 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:57:01,949 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 08:57:01,949 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 08:57:01,949 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 08:57:01,949 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 08:57:01,949 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 08:57:02,104 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 08:57:02,105 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 08:57:02,105 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 08:57:02,105 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 08:57:03,514 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:57:03,517 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:57:04,773 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 08:57:04,774 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 08:57:04,774 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 08:57:04,774 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:57:04,774 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:57:05,876 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 08:57:05,877 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 08:57:06,009 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 08:57:08,010 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 08:57:08,011 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 08:57:09,110 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 08:57:09,111 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 08:57:09,111 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 08:57:09,111 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 08:57:09,199 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 08:57:11,219 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 08:57:11,219 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 08:57:13,403 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 08:57:13,404 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 08:57:15,496 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 08:57:15,497 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 08:57:16,612 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 08:57:16,613 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 08:57:16,613 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 08:57:16,613 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 08:57:16,691 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 08:57:18,710 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 08:57:18,710 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 08:57:20,886 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 08:57:20,887 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 08:57:22,307 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 08:57:23,805 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 08:57:23,805 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 08:57:24,959 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 08:57:24,960 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 08:57:26,069 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 08:57:26,071 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 08:57:28,276 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 08:57:28,277 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 08:57:28,277 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 08:57:28,277 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 08:57:28,277 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 08:57:29,468 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 08:57:29,469 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 08:57:29,585 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 08:57:34,592 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 08:57:34,593 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 08:57:36,761 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 08:57:36,762 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 08:57:41,940 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 08:57:41,941 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 08:57:44,100 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 09:09:06,637 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 09:09:06,640 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_090906.mp4
2025-03-20 09:09:06,640 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 09:09:06,641 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 09:09:11,853 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 09:09:11,854 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 09:09:11,891 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 09:09:13,015 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_090906.mp4
2025-03-20 09:09:13,016 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_090906.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 09:09:15,024 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 09:09:18,030 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 09:09:18,032 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 09:09:21,037 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 09:09:21,037 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 09:09:21,037 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 09:09:22,212 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 09:09:22,212 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 09:09:22,213 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 09:09:22,213 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 09:09:22,324 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 09:09:24,329 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 09:09:24,329 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 09:09:24,330 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 09:09:26,451 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 09:09:26,451 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 09:09:27,426 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 09:09:27,427 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-20 09:09:27,427 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 09:09:27,427 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 09:09:27,427 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 09:09:27,427 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 09:09:28,433 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时2秒
2025-03-20 09:09:28,433 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 09:09:28,434 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 94.4 MB/s (90640 bytes in 0.001s)

2025-03-20 09:09:28,435 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 09:09:38,441 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_090906.mp4 (大小: 1.04MB)
2025-03-20 09:09:38,442 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 09:09:38,551 - QuickAppADBTester - INFO - 录制文件完整，时长: 13.609000秒，无需修复
2025-03-20 09:09:38,551 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 09:09:38,551 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_090906.mp4
2025-03-20 09:09:38,551 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 09:09:45,997 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_324.mp4
2025-03-20 09:09:46,002 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_324.mp4
2025-03-20 09:09:46,003 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 09:09:46,003 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 09:09:51,266 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 09:09:51,266 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_324.mp4
2025-03-20 09:09:51,266 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-20 09:09:51,266 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 09:09:51,266 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_324.mp4
2025-03-20 09:09:51,267 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含1张图片链接
2025-03-20 09:09:51,267 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-20 08:57:01\n- 中断时间: 2025-03-20 09:09:51\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_324.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 09:09:51"}]}]}}
2025-03-20 09:09:51,820 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 09:09:51,824 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-20 09:53:05,070 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 09:53:05,070 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 09:53:05,070 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 09:53:05,070 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 09:53:05,070 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 09:53:05,301 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 09:53:05,361 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 09:53:05,361 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 09:53:05,361 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 09:53:05,361 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 09:53:05,484 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 09:53:05,484 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 09:53:05,484 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 09:53:05,484 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 09:53:06,879 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:53:06,880 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:53:08,057 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 09:53:08,057 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 09:53:08,058 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 09:53:08,058 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 09:53:08,058 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 09:53:08,198 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 09:53:08,199 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 09:53:08,199 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 09:53:08,199 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 09:53:09,571 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:53:09,572 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:53:10,739 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 09:53:10,739 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 09:53:10,740 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 09:53:10,740 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:53:10,740 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:53:11,801 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 09:53:11,802 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 09:53:11,886 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 09:53:13,892 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 09:53:13,893 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 09:53:14,999 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 09:53:15,000 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 09:53:15,000 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 09:53:15,000 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 09:53:15,070 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 09:53:17,076 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 09:53:17,077 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 09:53:19,179 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 09:53:19,180 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 09:53:21,270 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 09:53:21,271 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 09:53:22,379 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 09:53:22,380 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 09:53:22,381 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 09:53:22,381 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 09:53:22,457 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 09:53:24,464 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 09:53:24,465 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 09:53:26,574 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 09:53:26,576 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 09:53:27,967 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 09:53:29,381 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 09:53:29,382 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 09:53:30,487 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 09:53:30,488 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 09:53:31,590 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 09:53:31,591 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 09:53:33,711 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 09:53:33,712 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 09:53:33,712 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 09:53:33,712 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:53:33,712 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:53:34,797 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 09:53:34,798 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 09:53:34,894 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 09:53:39,905 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 09:53:39,916 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 09:53:42,039 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 09:53:42,040 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 09:53:47,135 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 09:53:47,137 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 09:53:49,267 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 09:53:54,275 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 09:53:54,278 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_095354.mp4
2025-03-20 09:53:54,278 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 09:53:54,279 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 09:53:59,515 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 09:53:59,515 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 09:53:59,566 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 09:54:00,695 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_095354.mp4
2025-03-20 09:54:00,695 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_095354.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 09:54:02,702 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 09:54:05,708 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 09:54:05,709 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 09:54:08,711 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 09:54:08,713 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 09:54:08,713 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 09:54:09,811 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 09:54:09,813 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 09:54:09,813 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 09:54:09,813 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 09:54:09,877 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 09:54:11,886 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 09:54:11,887 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 09:54:11,887 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 09:54:14,082 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 09:54:14,083 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 09:54:22,195 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 09:54:22,196 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 09:54:22,196 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 09:54:22,196 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:22,491 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 09:54:22,491 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:22,718 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 09:54:22,720 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:22,946 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 09:54:22,947 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:23,153 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 09:54:23,154 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:23,373 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 09:54:23,373 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:23,566 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 09:54:23,567 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:23,766 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 09:54:23,767 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:23,969 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 09:54:23,970 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:24,189 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 09:54:24,189 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 09:54:26,386 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 09:54:26,387 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 09:54:26,388 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 09:54:26,471 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a0bf188 u0 com.huawei.fastapp/.app.processManager.PageLoaderActivityEntryPort0 t1160}
    mLastPausedActivity: ActivityRecord{181aa20 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t-1 f}}

2025-03-20 09:54:26,472 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 09:54:26,472 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 09:54:26,472 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 09:54:26,472 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_095426_20250320_095426.png
2025-03-20 09:54:27,463 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_095426_20250320_095426.png
2025-03-20 09:54:27,463 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_095426_20250320_095426.png
2025-03-20 09:54:27,464 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 09:54:34,046 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_325.jpg
2025-03-20 09:54:34,054 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_325.jpg
2025-03-20 09:54:34,055 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 09:54:34,055 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:54:34,055 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:54:35,803 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 09:54:44,162 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 09:54:44,162 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 09:54:44,162 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 09:54:44,254 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{f776e58 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{180a1ed #7 type=home A=10093:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 09:54:44,255 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 09:54:44,255 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 09:54:44,255 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 09:54:44,255 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_095444_20250320_095444.png
2025-03-20 09:54:45,489 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_095444_20250320_095444.png
2025-03-20 09:54:45,490 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_095444_20250320_095444.png
2025-03-20 09:54:45,490 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 09:54:51,288 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_326.jpg
2025-03-20 09:54:51,293 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_326.jpg
2025-03-20 09:54:51,293 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 09:54:51,294 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 09:54:51,294 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:54:51,294 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:54:53,424 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 09:54:53,425 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 09:54:53,425 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 09:54:53,426 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 09:54:54,431 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 09:54:55,435 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 09:54:55,435 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 09:54:55,436 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 44.9 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-20 09:54:55,436 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 09:55:05,442 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_095354.mp4 (大小: 2.74MB)
2025-03-20 09:55:05,443 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 09:55:05,602 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.818533秒，无需修复
2025-03-20 09:55:05,602 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 09:55:05,602 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_095354.mp4
2025-03-20 09:55:05,602 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 09:55:12,406 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_327.mp4
2025-03-20 09:55:12,412 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_327.mp4
2025-03-20 09:55:12,412 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 09:55:12,412 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 09:55:17,701 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 09:55:17,703 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_327.mp4
2025-03-20 09:55:17,703 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 09:55:17,704 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 09:55:17,704 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 09:55:17,974 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 09:55:18,976 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 09:55:18,976 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:55:18,976 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:55:20,088 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 09:55:20,090 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 09:55:20,092 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 09:55:22,187 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 09:55:22,188 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 09:55:23,311 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 09:55:23,312 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:55:23,313 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:55:24,406 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 09:55:24,409 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 09:55:24,409 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 09:55:24,411 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 09:53:08\n- 结束时间: 2025-03-20 09:55:24\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ✅ 成功\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_325.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_326.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_327.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 09:55:24"}]}]}}
2025-03-20 09:55:24,854 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 09:55:24,858 - QuickAppADBTester - INFO - 测试完成
2025-03-20 09:55:24,858 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-20 09:56:30,251 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 09:56:30,252 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 09:56:30,252 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-20 09:58:48,428 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 09:58:48,429 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 09:58:48,429 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 09:58:48,429 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 09:58:48,429 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 09:58:48,496 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 09:58:48,553 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 09:58:48,553 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 09:58:48,553 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 09:58:48,553 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 09:58:48,676 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 09:58:48,677 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 09:58:48,677 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 09:58:48,677 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 09:58:50,065 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:58:50,066 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:58:51,239 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 09:58:51,239 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 09:58:51,239 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 09:58:51,239 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 09:58:51,239 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 09:58:51,398 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 09:58:51,398 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 09:58:51,398 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 09:58:51,398 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 09:58:52,768 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:58:52,768 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:58:53,945 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 09:58:53,946 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 09:58:53,946 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 09:58:53,946 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:58:53,946 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:58:55,013 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 09:58:55,014 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 09:58:55,114 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 09:58:57,115 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 09:58:57,116 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 09:58:58,207 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 09:58:58,208 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 09:58:58,209 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 09:58:58,214 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 09:58:58,296 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 09:59:00,304 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 09:59:00,306 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 09:59:02,418 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 09:59:02,419 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 09:59:04,505 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 09:59:04,506 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 09:59:05,606 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 09:59:05,607 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 09:59:05,607 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 09:59:05,607 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 09:59:05,682 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 09:59:07,691 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 09:59:07,692 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 09:59:09,800 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 09:59:09,801 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 09:59:11,195 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 09:59:12,603 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 09:59:12,604 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 09:59:13,720 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 09:59:13,721 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 09:59:14,794 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 09:59:14,795 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 09:59:16,924 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 09:59:16,924 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 09:59:16,924 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 09:59:16,924 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 09:59:16,924 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 09:59:18,012 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 09:59:18,013 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 09:59:18,124 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 09:59:23,125 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 09:59:23,126 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 09:59:25,232 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 09:59:25,233 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 09:59:26,651 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 09:59:26,652 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 09:59:26,652 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 09:59:26,652 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-20 09:58:51\n- 中断时间: 2025-03-20 09:59:26\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 09:59:26"}]}]}}
2025-03-20 09:59:27,151 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 10:12:45,891 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 10:12:45,891 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:12:45,891 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:12:45,891 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:12:45,891 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:12:46,143 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:12:46,208 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:12:46,208 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:12:46,208 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:12:46,208 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:12:46,335 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:12:46,335 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:12:46,336 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:12:46,336 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:12:47,724 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:12:47,725 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:12:48,876 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:12:48,877 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:12:48,877 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:12:48,877 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:12:48,877 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:12:49,022 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:12:49,022 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:12:49,022 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:12:49,022 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:12:50,385 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:12:50,386 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:12:51,560 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:12:51,561 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:12:51,561 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:12:51,561 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:12:51,561 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:12:52,624 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:12:52,625 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:12:52,724 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:12:54,729 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:12:54,731 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:12:55,810 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:12:55,811 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:12:55,812 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:12:55,812 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:12:55,899 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:12:57,910 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:12:57,911 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:12:59,997 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:12:59,998 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:13:02,092 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:13:02,093 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:13:03,195 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:13:03,197 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:13:03,197 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:13:03,197 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:13:03,267 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:13:05,278 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:13:05,278 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:13:07,378 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:13:07,378 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:13:08,758 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:13:10,158 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:13:10,161 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:13:11,271 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:13:11,272 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:13:12,352 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:13:12,353 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:13:14,460 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:13:14,461 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:13:14,461 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:13:14,462 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:13:14,462 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:13:15,567 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:13:15,568 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:13:15,669 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:13:20,675 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:13:20,675 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:13:22,771 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:13:22,772 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:13:27,871 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:13:27,873 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:13:29,976 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:13:34,981 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:13:34,983 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_101334.mp4
2025-03-20 10:13:34,983 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:13:34,983 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:13:40,192 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:13:40,193 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:13:40,238 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:13:41,373 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_101334.mp4
2025-03-20 10:13:41,374 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_101334.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:13:43,387 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:13:46,392 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:13:46,392 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:13:49,394 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:13:49,395 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:13:49,395 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:13:50,499 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:13:50,499 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:13:50,500 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:13:50,500 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:13:50,573 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:13:52,583 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:13:52,583 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:13:52,584 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:13:54,784 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:13:54,784 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:14:02,891 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:14:02,893 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:14:02,893 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:14:02,893 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:03,179 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:14:03,180 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:03,388 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:14:03,389 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:03,632 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:14:03,632 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:03,890 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:14:03,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:04,194 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:14:04,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:04,468 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:14:04,470 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:04,652 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:14:04,653 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:04,872 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:14:04,872 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:05,074 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:14:05,074 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:14:07,298 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:14:07,299 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:14:07,299 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:14:07,385 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4efd0e6 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1168}
    * Task{b6f20d4 #1168 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:14:07,386 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:14:07,386 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:14:07,386 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:14:07,386 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_101407_20250320_101407.png
2025-03-20 10:14:09,011 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_101407_20250320_101407.png
2025-03-20 10:14:09,012 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_101407_20250320_101407.png
2025-03-20 10:14:09,012 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:14:16,016 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_328.jpg
2025-03-20 10:14:16,025 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_328.jpg
2025-03-20 10:14:16,025 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:14:16,025 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:14:16,025 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:14:16,511 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 10:14:26,120 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 10:14:26,123 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:14:26,123 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:14:26,206 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4efd0e6 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1168}
    * Task{b6f20d4 #1168 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:14:26,206 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:14:26,206 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 10:14:26,206 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 10:14:26,206 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_101426_20250320_101426.png
2025-03-20 10:14:27,720 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_101426_20250320_101426.png
2025-03-20 10:14:27,720 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_101426_20250320_101426.png
2025-03-20 10:14:27,720 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:14:32,532 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_328.jpg
2025-03-20 10:14:32,536 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_328.jpg
2025-03-20 10:14:32,536 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 10:14:32,536 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 10:14:32,536 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:14:32,537 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:14:34,643 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 10:14:34,644 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 10:14:34,644 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 10:14:34,644 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 10:14:35,647 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 10:14:36,651 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 10:14:36,651 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 10:14:36,652 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 48.2 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-20 10:14:36,652 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 10:14:46,655 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_101334.mp4 (大小: 4.08MB)
2025-03-20 10:14:46,656 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 10:14:46,833 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.569300秒，无需修复
2025-03-20 10:14:46,833 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 10:14:46,833 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_101334.mp4
2025-03-20 10:14:46,833 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 10:14:54,547 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_329.mp4
2025-03-20 10:14:54,554 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_329.mp4
2025-03-20 10:14:54,554 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:14:54,554 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:14:59,762 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:14:59,764 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_329.mp4
2025-03-20 10:14:59,764 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 10:14:59,764 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 10:14:59,764 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 10:15:00,120 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 10:15:01,123 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 10:15:01,123 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:15:01,123 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:15:02,208 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 10:15:02,208 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 10:15:02,209 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 10:15:04,281 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 10:15:04,281 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 10:15:05,366 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 10:15:05,367 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:15:05,367 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:15:06,461 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 10:15:06,463 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 10:15:06,464 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 10:15:06,464 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:12:48\n- 结束时间: 2025-03-20 10:15:06\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_328.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_328.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_329.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 10:15:06"}]}]}}
2025-03-20 10:15:06,971 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 10:15:06,975 - QuickAppADBTester - INFO - 测试完成
2025-03-20 10:15:06,976 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-20 10:20:07,969 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:20:07,972 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:20:07,973 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:20:07,973 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:20:08,096 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:20:08,169 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:20:08,170 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:20:08,170 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:20:08,170 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:20:08,327 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:20:08,327 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:20:08,327 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:20:08,327 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:20:09,723 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:20:09,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:20:10,906 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:20:10,906 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:20:10,907 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:20:10,907 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:20:10,907 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:20:11,056 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:20:11,057 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:20:11,057 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:20:11,057 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:20:12,439 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:20:12,440 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:20:13,616 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:20:13,617 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:20:13,617 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:20:13,617 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:20:13,617 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:20:14,686 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:20:14,686 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:20:14,783 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:20:16,789 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:20:16,789 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:20:17,864 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:20:17,865 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:20:17,865 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:20:17,866 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:20:17,947 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:20:19,957 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:20:19,958 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:20:22,062 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:20:22,062 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:20:24,140 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:20:24,141 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:20:25,243 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:20:25,244 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:20:25,244 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:20:25,244 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:20:25,321 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:20:27,331 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:20:27,332 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:20:29,419 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:20:29,420 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:20:30,814 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:20:32,215 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:20:32,215 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:20:33,332 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:20:33,333 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:20:34,421 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:20:34,423 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:20:36,538 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:20:36,539 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:20:36,539 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:20:36,539 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:20:36,539 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:20:37,658 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:20:37,659 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:20:37,748 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:20:42,750 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:20:42,751 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:20:44,862 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:20:44,863 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:20:49,957 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:20:49,959 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:20:52,109 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:20:57,115 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:20:57,121 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_102057.mp4
2025-03-20 10:20:57,121 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:20:57,121 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:21:02,389 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:21:02,391 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:21:02,445 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:21:03,530 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102057.mp4
2025-03-20 10:21:03,530 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102057.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:21:05,544 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:21:08,551 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:21:08,551 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:21:11,554 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:21:11,555 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:21:11,555 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:21:12,667 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:21:12,668 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:21:12,668 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:21:12,668 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:21:12,733 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:21:14,740 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:21:14,741 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:21:14,741 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:21:16,926 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:21:16,927 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:21:25,039 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:21:25,041 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:21:25,041 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:21:25,041 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:25,327 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:21:25,328 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:25,554 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:21:25,555 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:25,754 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:21:25,755 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:25,965 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:21:25,967 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:26,154 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:21:26,155 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:26,382 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:21:26,383 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:26,625 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:21:26,626 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:26,858 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:21:26,859 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:27,095 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:21:27,096 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:21:29,328 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:21:29,329 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:21:29,329 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:21:29,415 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4f83790 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1174}
    * Task{4a130af #1174 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:21:29,415 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:21:29,415 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:21:29,415 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:21:29,416 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_102129_20250320_102129.png
2025-03-20 10:21:30,841 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_102129_20250320_102129.png
2025-03-20 10:21:30,842 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_102129_20250320_102129.png
2025-03-20 10:21:30,842 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:21:37,663 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_330.jpg
2025-03-20 10:21:37,678 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_330.jpg
2025-03-20 10:21:37,678 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:21:37,678 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:21:37,678 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:21:38,666 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 10:21:47,762 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 10:21:47,763 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:21:47,763 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:21:47,851 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4f83790 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1174}
    * Task{4a130af #1174 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:21:47,851 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:21:47,851 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 10:21:47,851 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 10:21:47,851 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_102147_20250320_102147.png
2025-03-20 10:21:49,239 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_102147_20250320_102147.png
2025-03-20 10:21:49,239 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_102147_20250320_102147.png
2025-03-20 10:21:49,240 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:21:53,786 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_330.jpg
2025-03-20 10:21:53,793 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_330.jpg
2025-03-20 10:21:53,794 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 10:21:53,794 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 10:21:53,794 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:21:53,794 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:21:55,889 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 10:21:55,890 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 10:21:55,890 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 10:21:55,890 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 10:21:56,891 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 10:21:57,896 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 10:21:57,896 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 10:21:57,897 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 54.4 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-20 10:21:57,897 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 10:22:07,898 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102057.mp4 (大小: 4.25MB)
2025-03-20 10:22:07,899 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 10:22:08,055 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.550544秒，无需修复
2025-03-20 10:22:08,055 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 10:22:08,055 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102057.mp4
2025-03-20 10:22:08,055 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 10:22:15,636 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_331.mp4
2025-03-20 10:22:15,644 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_331.mp4
2025-03-20 10:22:15,644 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:22:15,644 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:22:20,859 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:22:20,861 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_331.mp4
2025-03-20 10:22:20,861 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 10:22:20,861 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 10:22:20,861 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 10:22:21,165 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 10:22:22,169 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 10:22:22,171 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:22:22,171 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:22:23,259 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 10:22:23,259 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 10:22:23,260 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 10:22:25,337 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 10:22:25,337 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 10:22:26,453 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 10:22:26,454 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:22:26,454 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:22:27,543 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 10:22:27,545 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 10:22:27,546 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 10:22:27,547 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:20:10\n- 结束时间: 2025-03-20 10:22:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_330.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_330.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_331.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 10:22:27"}]}]}}
2025-03-20 10:22:27,995 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 10:22:27,998 - QuickAppADBTester - INFO - 测试完成
2025-03-20 10:27:28,994 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:27:28,998 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:27:28,998 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:27:28,998 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:27:29,094 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:27:29,174 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:27:29,174 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:27:29,174 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:27:29,174 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:27:29,337 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:27:29,338 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:27:29,338 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:27:29,338 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:27:30,750 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:27:30,751 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:27:31,930 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:27:31,930 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:27:31,930 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:27:31,930 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:27:31,930 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:27:32,049 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:27:32,050 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:27:32,050 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:27:32,050 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:27:33,425 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:27:33,425 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:27:34,617 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:27:34,618 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:27:34,618 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:27:34,618 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:27:34,618 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:27:35,687 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:27:35,688 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:27:35,795 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:27:37,800 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:27:37,801 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:27:38,879 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:27:38,880 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:27:38,880 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:27:38,880 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:27:38,951 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:27:40,956 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:27:40,956 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:27:43,058 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:27:43,059 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:27:45,146 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:27:45,147 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:27:46,251 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:27:46,252 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:27:46,252 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:27:46,252 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:27:46,328 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:27:48,337 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:27:48,338 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:27:50,451 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:27:50,453 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:27:51,874 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:27:53,275 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:27:53,276 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:27:54,383 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:27:54,383 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:27:55,468 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:27:55,469 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:27:57,584 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:27:57,585 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:27:57,586 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:27:57,586 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:27:57,586 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:27:58,735 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:27:58,736 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:27:58,831 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:28:03,837 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:28:03,837 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:28:05,951 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:28:05,952 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:28:11,052 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:28:11,053 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:28:13,173 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:28:18,183 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:28:18,186 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_102818.mp4
2025-03-20 10:28:18,187 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:28:18,188 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:28:23,422 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:28:23,423 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:28:23,456 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:28:24,594 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102818.mp4
2025-03-20 10:28:24,595 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102818.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:28:26,606 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:28:29,612 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:28:29,613 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:28:32,614 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:28:32,615 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:28:32,615 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:28:33,721 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:28:33,722 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:28:33,722 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:28:33,722 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:28:33,782 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:28:35,788 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:28:35,789 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:28:35,789 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:28:37,988 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:28:37,989 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:28:46,105 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:28:46,107 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:28:46,107 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:28:46,107 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:46,422 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:28:46,423 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:46,749 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:28:46,750 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:46,963 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:28:46,964 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:47,215 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:28:47,216 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:47,448 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:28:47,449 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:47,681 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:28:47,682 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:47,914 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:28:47,916 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:48,148 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:28:48,149 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:48,388 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:28:48,389 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:28:50,618 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:28:50,619 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:28:50,619 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:28:50,709 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2d39149 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1180}
    * Task{13af905 #1180 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:28:50,709 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:28:50,709 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:28:50,709 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:28:50,709 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_102850_20250320_102850.png
2025-03-20 10:28:52,027 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_102850_20250320_102850.png
2025-03-20 10:28:52,028 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_102850_20250320_102850.png
2025-03-20 10:28:52,028 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:28:58,879 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_332.jpg
2025-03-20 10:28:58,886 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_332.jpg
2025-03-20 10:28:58,887 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:28:58,887 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:28:58,887 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:28:59,719 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 10:29:08,990 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 10:29:08,991 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:29:08,991 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:29:09,079 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2d39149 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1180}
    * Task{13af905 #1180 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:29:09,079 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:29:09,080 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 10:29:09,080 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 10:29:09,080 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_102909_20250320_102909.png
2025-03-20 10:29:10,337 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_102909_20250320_102909.png
2025-03-20 10:29:10,337 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_102909_20250320_102909.png
2025-03-20 10:29:10,337 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:29:14,891 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_332.jpg
2025-03-20 10:29:14,896 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_332.jpg
2025-03-20 10:29:14,897 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 10:29:14,897 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 10:29:14,897 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:29:14,897 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:29:17,012 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 10:29:17,013 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 10:29:17,013 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 10:29:17,013 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 10:29:18,019 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 10:29:19,025 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 10:29:19,025 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 10:29:19,025 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 10:29:19,025 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 10:29:29,026 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102818.mp4 (大小: 3.94MB)
2025-03-20 10:29:29,028 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 10:29:29,183 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.656133秒，无需修复
2025-03-20 10:29:29,183 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 10:29:29,183 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_102818.mp4
2025-03-20 10:29:29,183 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 10:29:36,527 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_333.mp4
2025-03-20 10:29:36,534 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_333.mp4
2025-03-20 10:29:36,535 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:29:36,535 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:29:41,738 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:29:41,740 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_333.mp4
2025-03-20 10:29:41,740 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 10:29:41,740 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 10:29:41,741 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 10:29:42,072 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 10:29:43,076 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 10:29:43,077 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:29:43,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:29:44,162 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 10:29:44,163 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 10:29:44,164 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 10:29:46,248 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 10:29:46,249 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 10:29:47,369 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 10:29:47,370 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:29:47,370 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:29:48,460 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 10:29:48,461 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 10:29:48,461 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 10:29:48,461 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:27:31\n- 结束时间: 2025-03-20 10:29:48\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_332.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_332.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_333.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 10:29:48"}]}]}}
2025-03-20 10:29:48,885 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 10:29:48,888 - QuickAppADBTester - INFO - 测试完成
2025-03-20 10:34:49,796 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:34:49,800 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:34:49,801 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:34:49,801 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:34:49,896 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:34:49,976 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:34:49,977 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:34:49,977 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:34:49,977 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:34:50,116 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:34:50,116 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:34:50,116 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:34:50,117 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:34:51,513 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:34:51,513 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:34:52,696 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:34:52,697 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:34:52,697 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:34:52,697 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:34:52,697 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:34:52,814 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:34:52,814 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:34:52,814 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:34:52,814 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:34:54,188 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:34:54,189 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:34:55,370 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:34:55,371 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:34:55,371 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:34:55,371 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:34:55,371 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:34:56,438 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:34:56,439 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:34:56,541 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:34:58,553 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:34:58,553 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:34:59,634 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:34:59,635 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:34:59,635 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:34:59,635 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:34:59,715 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:35:01,725 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:35:01,726 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:35:03,836 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:35:03,837 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:35:05,914 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:35:05,917 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:35:07,016 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:35:07,016 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:35:07,017 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:35:07,017 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:35:07,090 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:35:09,096 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:35:09,097 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:35:11,210 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:35:11,212 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:35:12,604 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:35:14,018 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:35:14,019 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:35:15,137 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:35:15,138 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:35:16,225 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:35:16,226 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:35:18,343 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:35:18,344 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:35:18,344 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:35:18,345 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:35:18,345 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:35:19,465 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:35:19,466 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:35:19,561 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:35:24,562 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:35:24,566 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:35:26,668 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:35:26,669 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:35:31,765 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:35:31,767 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:35:33,901 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:35:38,903 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:35:38,904 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_103538.mp4
2025-03-20 10:35:38,904 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:35:38,905 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:35:44,173 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:35:44,175 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:35:44,220 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:35:45,359 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_103538.mp4
2025-03-20 10:35:45,360 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_103538.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:35:47,372 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:35:50,376 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:35:50,377 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:35:53,381 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:35:53,382 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:35:53,382 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:35:54,494 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:35:54,495 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:35:54,496 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:35:54,496 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:35:54,577 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:35:56,584 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:35:56,584 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:35:56,584 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:35:58,775 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:35:58,777 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:36:06,889 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:36:06,891 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:36:06,891 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:36:06,891 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:07,125 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:36:07,126 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:07,343 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:36:07,344 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:07,559 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:36:07,564 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:07,755 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:36:07,756 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:07,981 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:36:07,981 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:08,190 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:36:08,191 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:08,425 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:36:08,426 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:08,678 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:36:08,679 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:08,907 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:36:08,908 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:36:11,132 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:36:11,132 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:36:11,132 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:36:11,235 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b05adb6 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1186}
    * Task{f77a18d #1186 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:36:11,235 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:36:11,236 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:36:11,236 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:36:11,236 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_103611_20250320_103611.png
2025-03-20 10:36:12,840 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_103611_20250320_103611.png
2025-03-20 10:36:12,840 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_103611_20250320_103611.png
2025-03-20 10:36:12,840 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:36:20,507 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 10:36:50,606 - QuickAppADBTester - INFO - 录制进行中，已录制约 60 秒
2025-03-20 10:37:02,447 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 10:37:02,469 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 10:37:02,471 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-20 10:37:02,471 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:37:02,471 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:37:02,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:37:12,556 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 10:37:12,558 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:37:12,559 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:37:12,644 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b05adb6 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1186}
    * Task{f77a18d #1186 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:37:12,645 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:37:12,645 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 10:37:12,645 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 10:37:12,645 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_103712_20250320_103712.png
2025-03-20 10:37:14,224 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_103712_20250320_103712.png
2025-03-20 10:37:14,224 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_103712_20250320_103712.png
2025-03-20 10:37:14,225 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:37:20,711 - QuickAppADBTester - INFO - 录制进行中，已录制约 90 秒
2025-03-20 10:37:23,452 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 10:37:23,458 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendPhoto (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 10:37:23,467 - QuickAppADBTester - INFO - 截图上传成功: None
2025-03-20 10:37:23,467 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 10:37:23,467 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 10:37:23,467 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:37:23,468 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:37:25,557 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 10:37:25,558 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 10:37:25,558 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 10:37:25,558 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 10:37:26,561 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 10:37:27,565 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 10:37:27,566 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 10:37:27,566 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 128.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 10:37:27,566 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 10:37:37,571 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_103538.mp4 (大小: 3.27MB)
2025-03-20 10:37:37,572 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 10:37:37,687 - QuickAppADBTester - INFO - 录制文件完整，时长: 99.502889秒，无需修复
2025-03-20 10:37:37,688 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 10:37:37,688 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_103538.mp4
2025-03-20 10:37:37,688 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 10:38:30,437 - QuickAppADBTester - ERROR - 上传文件到Telegram时出错: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))
2025-03-20 10:38:30,450 - QuickAppADBTester - ERROR - 详细错误: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 713, in urlopen
    self._prepare_proxy(conn)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 1015, in _prepare_proxy
    conn.connect()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
                ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 458, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/ssl_.py", line 502, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1075, in _create
    self.do_handshake()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/ssl.py", line 1346, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLEOFError: EOF occurred in violation of protocol (_ssl.c:1002)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/connectionpool.py", line 802, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/urllib3/util/retry.py", line 594, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/ct/Desktop/huawei_auto/huawei_quick_app_adb.py", line 208, in upload_to_telegram
    response = requests.post(url, files=files, data=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/requests/adapters.py", line 563, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/sendVideo (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1002)')))

2025-03-20 10:38:30,454 - QuickAppADBTester - WARNING - 视频上传失败
2025-03-20 10:38:30,454 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:38:30,454 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:38:35,636 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:38:35,637 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 10:38:35,638 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 10:38:35,638 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 10:38:35,638 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 10:38:36,051 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 10:38:37,052 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 10:38:37,052 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:38:37,053 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:38:38,145 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 10:38:38,147 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 10:38:38,147 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 10:38:40,235 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 10:38:40,237 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 10:38:41,357 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 10:38:41,358 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:38:41,358 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:38:42,461 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 10:38:42,461 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 10:38:42,462 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 10:38:42,462 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:34:52\n- 结束时间: 2025-03-20 10:38:42\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 10:38:42"}]}]}}
2025-03-20 10:38:42,928 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 10:38:42,931 - QuickAppADBTester - INFO - 测试完成
2025-03-20 10:43:42,975 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:43:42,979 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:43:42,979 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:43:42,979 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:43:43,083 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:43:43,168 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:43:43,169 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:43:43,169 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:43:43,169 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:43:43,307 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:43:43,308 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:43:43,308 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:43:43,308 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:43:44,717 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:43:44,718 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:43:45,900 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:43:45,900 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:43:45,900 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:43:45,900 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:43:45,901 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:43:46,035 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:43:46,035 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:43:46,035 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:43:46,035 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:43:47,417 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:43:47,418 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:43:48,598 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:43:48,598 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:43:48,598 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:43:48,598 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:43:48,598 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:43:49,664 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:43:49,666 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:43:49,755 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:43:51,759 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:43:51,759 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:43:52,848 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:43:52,849 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:43:52,850 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:43:52,850 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:43:52,933 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:43:54,941 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:43:54,941 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:43:57,014 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:43:57,015 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:43:59,101 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:43:59,102 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:44:00,203 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:44:00,204 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:44:00,204 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:44:00,204 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:44:00,279 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:44:02,285 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:44:02,286 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:44:04,392 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:44:04,394 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:44:05,779 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:44:07,189 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:44:07,190 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:44:08,303 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:44:08,304 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:44:09,390 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:44:09,391 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:44:11,508 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:44:11,509 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:44:11,510 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:44:11,510 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:44:11,510 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:44:12,620 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:44:12,621 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:44:12,716 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:44:17,718 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:44:17,718 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:44:19,818 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:44:19,820 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:44:25,018 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:44:25,019 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:44:27,144 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:44:32,149 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:44:32,151 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_104432.mp4
2025-03-20 10:44:32,151 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:44:32,151 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:44:37,410 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:44:37,412 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:44:37,471 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:44:38,606 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_104432.mp4
2025-03-20 10:44:38,608 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_104432.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:44:40,623 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:44:43,624 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:44:43,625 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:44:46,630 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:44:46,631 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:44:46,631 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:44:47,739 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:44:47,741 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:44:47,741 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:44:47,741 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:44:47,819 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:44:49,829 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:44:49,830 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:44:49,830 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:44:52,031 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:44:52,031 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:45:00,132 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:45:00,133 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:45:00,133 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:45:00,133 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:00,405 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:45:00,409 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:00,654 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:45:00,655 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:00,861 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:45:00,862 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:01,123 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:45:01,123 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:01,328 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:45:01,329 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:01,554 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:45:01,555 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:01,799 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:45:01,800 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:02,017 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:45:02,017 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:02,217 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:45:02,218 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:45:04,465 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:45:04,465 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:45:04,466 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:45:04,548 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{41a7336 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1192}
    * Task{bb1450d #1192 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:45:04,548 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:45:04,548 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:45:04,548 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:45:04,548 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_104504_20250320_104504.png
2025-03-20 10:45:06,094 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_104504_20250320_104504.png
2025-03-20 10:45:06,095 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_104504_20250320_104504.png
2025-03-20 10:45:06,095 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:45:13,283 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_334.jpg
2025-03-20 10:45:13,290 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_334.jpg
2025-03-20 10:45:13,291 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:45:13,291 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:45:13,291 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:45:13,721 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 10:45:23,404 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 10:45:23,405 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:45:23,405 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:45:23,494 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{41a7336 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1192}
    * Task{bb1450d #1192 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:45:23,494 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:45:23,494 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 10:45:23,495 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 10:45:23,495 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_104523_20250320_104523.png
2025-03-20 10:45:25,055 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_104523_20250320_104523.png
2025-03-20 10:45:25,056 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_104523_20250320_104523.png
2025-03-20 10:45:25,056 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:45:29,735 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_334.jpg
2025-03-20 10:45:29,742 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_334.jpg
2025-03-20 10:45:29,743 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 10:45:29,743 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 10:45:29,743 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:45:29,743 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:45:31,876 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 10:45:31,877 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 10:45:31,877 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 10:45:31,877 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 10:45:32,886 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 10:45:33,890 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 10:45:33,891 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 10:45:33,891 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 125.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 10:45:33,891 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 10:45:43,893 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_104432.mp4 (大小: 3.52MB)
2025-03-20 10:45:43,894 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 10:45:44,044 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.575589秒，无需修复
2025-03-20 10:45:44,045 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 10:45:44,045 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_104432.mp4
2025-03-20 10:45:44,045 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 10:45:51,038 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_335.mp4
2025-03-20 10:45:51,046 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_335.mp4
2025-03-20 10:45:51,046 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:45:51,046 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:45:56,247 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:45:56,248 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_335.mp4
2025-03-20 10:45:56,248 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 10:45:56,248 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 10:45:56,248 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 10:45:56,596 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 10:45:57,597 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 10:45:57,598 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:45:57,598 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:45:58,685 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 10:45:58,685 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 10:45:58,685 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 10:46:00,770 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 10:46:00,771 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 10:46:01,872 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 10:46:01,872 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:46:01,872 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:46:02,948 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 10:46:02,948 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 10:46:02,949 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 10:46:02,949 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:43:45\n- 结束时间: 2025-03-20 10:46:02\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_334.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_334.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_335.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 10:46:02"}]}]}}
2025-03-20 10:46:03,624 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 10:46:03,625 - QuickAppADBTester - INFO - 测试完成
2025-03-20 10:51:03,643 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:51:03,645 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:51:03,645 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:51:03,645 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:51:03,717 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:51:03,769 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:51:03,769 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:51:03,770 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:51:03,770 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:51:03,897 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:51:03,897 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:51:03,898 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:51:03,898 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:51:05,297 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:51:05,298 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:51:06,487 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:51:06,487 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:51:06,487 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:51:06,487 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:51:06,487 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:51:06,599 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:51:06,599 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:51:06,599 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:51:06,599 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:51:07,972 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:51:07,973 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:51:09,161 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:51:09,161 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:51:09,161 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:51:09,161 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:51:09,161 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:51:10,229 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:51:10,229 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:51:10,325 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:51:12,327 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:51:12,328 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:51:13,422 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:51:13,424 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:51:13,425 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:51:13,425 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:51:13,519 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:51:15,528 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:51:15,529 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:51:17,643 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:51:17,644 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:51:19,731 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:51:19,732 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:51:20,827 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:51:20,827 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:51:20,827 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:51:20,827 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:51:20,891 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:51:22,901 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:51:22,901 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:51:25,028 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:51:25,029 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:51:26,422 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:51:27,833 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:51:27,834 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:51:28,944 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:51:28,945 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:51:30,031 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:51:30,032 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:51:32,146 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:51:32,147 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:51:32,147 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:51:32,148 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:51:32,148 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:51:33,267 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:51:33,268 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:51:33,366 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:51:38,371 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:51:38,374 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:51:40,482 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:51:40,483 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:51:45,584 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:51:45,585 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:51:47,697 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:51:52,701 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:51:52,705 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_105152.mp4
2025-03-20 10:51:52,706 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:51:52,706 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:51:57,961 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:51:57,962 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:51:58,010 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:51:59,149 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105152.mp4
2025-03-20 10:51:59,150 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105152.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:52:01,160 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:52:04,168 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:52:04,169 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:52:07,174 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:52:07,175 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:52:07,175 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:52:08,290 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:52:08,290 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:52:08,290 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:52:08,290 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:52:08,389 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:52:10,399 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:52:10,401 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:52:10,401 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:52:12,603 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:52:12,604 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:52:20,718 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:52:20,719 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:52:20,719 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:52:20,720 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:21,033 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:52:21,034 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:21,246 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:52:21,247 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:21,444 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:52:21,445 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:21,666 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:52:21,667 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:21,884 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:52:21,885 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:22,103 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:52:22,103 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:22,338 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:52:22,339 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:22,583 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:52:22,583 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:22,783 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:52:22,784 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:52:25,015 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:52:25,015 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:52:25,016 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:52:25,107 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{87dd338 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1198}
    * Task{5d8eae4 #1198 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:52:25,107 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:52:25,107 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:52:25,107 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:52:25,107 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_105225_20250320_105225.png
2025-03-20 10:52:26,725 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_105225_20250320_105225.png
2025-03-20 10:52:26,726 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_105225_20250320_105225.png
2025-03-20 10:52:26,726 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:52:34,059 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_336.jpg
2025-03-20 10:52:34,068 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_336.jpg
2025-03-20 10:52:34,069 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:52:34,069 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:52:34,069 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:52:34,264 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 10:52:44,174 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 10:52:44,174 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:52:44,175 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:52:44,268 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{87dd338 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1198}
    * Task{5d8eae4 #1198 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:52:44,269 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:52:44,269 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 10:52:44,269 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 10:52:44,269 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_105244_20250320_105244.png
2025-03-20 10:52:45,937 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_105244_20250320_105244.png
2025-03-20 10:52:45,937 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_105244_20250320_105244.png
2025-03-20 10:52:45,937 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:52:51,949 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_337.jpg
2025-03-20 10:52:51,957 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_337.jpg
2025-03-20 10:52:51,957 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 10:52:51,957 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 10:52:51,957 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:52:51,958 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:52:54,076 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 10:52:54,077 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 10:52:54,078 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 10:52:54,078 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 10:52:55,083 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 10:52:56,090 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 10:52:56,091 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 10:52:56,091 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 163.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 10:52:56,091 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 10:53:06,097 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105152.mp4 (大小: 3.59MB)
2025-03-20 10:53:06,098 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 10:53:06,217 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.189156秒，无需修复
2025-03-20 10:53:06,217 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 10:53:06,217 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105152.mp4
2025-03-20 10:53:06,217 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 10:53:12,989 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_338.mp4
2025-03-20 10:53:12,996 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_338.mp4
2025-03-20 10:53:12,996 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:53:12,997 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:53:18,185 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:53:18,186 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_338.mp4
2025-03-20 10:53:18,186 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 10:53:18,187 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 10:53:18,187 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 10:53:18,628 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 10:53:19,632 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 10:53:19,632 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:53:19,632 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:53:20,719 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 10:53:20,720 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 10:53:20,720 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 10:53:22,804 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 10:53:22,805 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 10:53:23,917 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 10:53:23,918 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:53:23,918 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:53:25,012 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 10:53:25,013 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 10:53:25,014 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 10:53:25,014 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:51:06\n- 结束时间: 2025-03-20 10:53:25\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_336.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_337.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_338.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 10:53:25"}]}]}}
2025-03-20 10:53:25,469 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 10:53:25,472 - QuickAppADBTester - INFO - 测试完成
2025-03-20 10:58:25,515 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 10:58:25,517 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 10:58:25,518 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 10:58:25,518 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 10:58:25,608 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 10:58:25,685 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 10:58:25,686 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 10:58:25,686 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:58:25,686 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:58:25,834 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:58:25,835 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:58:25,835 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:58:25,835 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:58:27,225 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:58:27,225 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:58:28,390 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:58:28,390 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 10:58:28,390 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 10:58:28,390 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 10:58:28,390 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 10:58:28,503 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 10:58:28,503 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 10:58:28,503 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 10:58:28,503 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 10:58:29,867 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:58:29,868 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:58:31,033 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 10:58:31,034 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 10:58:31,034 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:58:31,034 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:58:31,034 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:58:32,097 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 10:58:32,098 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 10:58:32,184 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 10:58:34,189 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 10:58:34,190 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 10:58:35,273 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 10:58:35,274 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 10:58:35,274 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:58:35,274 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 10:58:35,344 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:58:37,351 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 10:58:37,352 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 10:58:39,461 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 10:58:39,463 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 10:58:41,558 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 10:58:41,558 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 10:58:42,640 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 10:58:42,641 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 10:58:42,641 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:58:42,641 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 10:58:42,716 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:58:44,724 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 10:58:44,724 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 10:58:46,824 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 10:58:46,825 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 10:58:48,212 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 10:58:49,609 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 10:58:49,609 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 10:58:50,722 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 10:58:50,722 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 10:58:51,811 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 10:58:51,812 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 10:58:53,924 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 10:58:53,925 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 10:58:53,925 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 10:58:53,925 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:58:53,925 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:58:55,031 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 10:58:55,032 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 10:58:55,114 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 10:59:00,120 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 10:59:00,121 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 10:59:02,224 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 10:59:02,225 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 10:59:07,334 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 10:59:07,335 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 10:59:09,462 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 10:59:14,466 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 10:59:14,468 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_105914.mp4
2025-03-20 10:59:14,468 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 10:59:14,468 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 10:59:19,719 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 10:59:19,720 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 10:59:19,765 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 10:59:20,900 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105914.mp4
2025-03-20 10:59:20,901 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105914.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 10:59:22,911 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 10:59:25,914 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 10:59:25,915 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 10:59:28,917 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 10:59:28,918 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 10:59:28,918 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 10:59:30,013 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 10:59:30,014 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 10:59:30,014 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 10:59:30,015 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 10:59:30,090 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 10:59:32,100 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 10:59:32,101 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 10:59:32,101 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 10:59:34,298 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 10:59:34,299 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 10:59:42,393 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 10:59:42,394 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 10:59:42,394 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 10:59:42,394 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:42,640 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 10:59:42,641 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:42,866 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 10:59:42,866 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:43,088 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 10:59:43,088 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:43,288 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 10:59:43,289 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:43,523 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 10:59:43,524 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:43,734 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 10:59:43,735 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:43,946 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 10:59:43,946 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:44,171 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 10:59:44,172 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:44,425 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 10:59:44,426 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 10:59:46,661 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 10:59:46,661 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 10:59:46,661 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 10:59:46,739 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b1c6db2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1204}
    * Task{b262880 #1204 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 10:59:46,739 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 10:59:46,739 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 10:59:46,739 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 10:59:46,740 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_105946_20250320_105946.png
2025-03-20 10:59:47,941 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_105946_20250320_105946.png
2025-03-20 10:59:47,941 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_105946_20250320_105946.png
2025-03-20 10:59:47,942 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 10:59:54,734 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_339.jpg
2025-03-20 10:59:54,741 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_339.jpg
2025-03-20 10:59:54,741 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 10:59:54,741 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 10:59:54,741 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 10:59:56,004 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:00:04,855 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:00:04,855 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:00:04,855 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:00:04,939 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b1c6db2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1204}
    * Task{b262880 #1204 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:00:04,939 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:00:04,939 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:00:04,939 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:00:04,940 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_110004_20250320_110004.png
2025-03-20 11:00:06,127 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_110004_20250320_110004.png
2025-03-20 11:00:06,127 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_110004_20250320_110004.png
2025-03-20 11:00:06,127 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:00:10,616 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_339.jpg
2025-03-20 11:00:10,621 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_339.jpg
2025-03-20 11:00:10,622 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:00:10,622 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:00:10,622 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:00:10,622 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:00:12,719 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:00:12,720 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:00:12,720 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:00:12,720 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:00:13,721 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:00:14,723 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:00:14,724 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:00:14,724 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 129.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:00:14,724 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:00:24,729 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105914.mp4 (大小: 3.25MB)
2025-03-20 11:00:24,730 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:00:24,853 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.055800秒，无需修复
2025-03-20 11:00:24,853 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:00:24,853 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_105914.mp4
2025-03-20 11:00:24,853 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:00:32,291 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_340.mp4
2025-03-20 11:00:32,297 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_340.mp4
2025-03-20 11:00:32,298 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:00:32,298 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:00:37,487 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:00:37,488 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_340.mp4
2025-03-20 11:00:37,488 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:00:37,488 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:00:37,488 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:00:37,882 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:00:38,888 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:00:38,888 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:00:38,888 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:00:39,976 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:00:39,977 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:00:39,978 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:00:42,060 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:00:42,061 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:00:43,158 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:00:43,160 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:00:43,160 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:00:44,254 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:00:44,255 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:00:44,255 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:00:44,256 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 10:58:28\n- 结束时间: 2025-03-20 11:00:44\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_339.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_339.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_340.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:00:44"}]}]}}
2025-03-20 11:00:44,759 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:00:44,762 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:05:44,893 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:05:44,896 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:05:44,897 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:05:44,897 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:05:44,990 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:05:45,066 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:05:45,066 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:05:45,066 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:05:45,066 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:05:45,190 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:05:45,190 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:05:45,190 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:05:45,191 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:05:46,594 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:05:46,594 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:05:47,772 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:05:47,772 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:05:47,772 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:05:47,772 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:05:47,772 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:05:47,888 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:05:47,889 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:05:47,889 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:05:47,889 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:05:49,258 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:05:49,259 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:05:50,436 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:05:50,437 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:05:50,437 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:05:50,437 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:05:50,437 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:05:51,502 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:05:51,503 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:05:51,602 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:05:53,606 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:05:53,608 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:05:54,702 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:05:54,703 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:05:54,703 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:05:54,704 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:05:54,782 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:05:56,788 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:05:56,789 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:05:58,897 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:05:58,898 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:06:00,985 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:06:00,986 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:06:02,081 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:06:02,082 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:06:02,082 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:06:02,082 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:06:02,151 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:06:04,161 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:06:04,161 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:06:06,262 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:06:06,263 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:06:07,656 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:06:09,064 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:06:09,065 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:06:10,177 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:06:10,178 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:06:11,264 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:06:11,265 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:06:13,381 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:06:13,382 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:06:13,383 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:06:13,383 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:06:13,383 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:06:14,499 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:06:14,500 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:06:14,587 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:06:19,590 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:06:19,591 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:06:21,689 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:06:21,690 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:06:26,795 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:06:26,797 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:06:28,921 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:06:33,923 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:06:33,924 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_110633.mp4
2025-03-20 11:06:33,925 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:06:33,925 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:06:39,189 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:06:39,191 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:06:39,239 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:06:40,323 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_110633.mp4
2025-03-20 11:06:40,324 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_110633.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:06:42,333 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:06:45,339 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:06:45,340 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:06:48,345 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:06:48,346 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:06:48,346 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:06:49,452 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:06:49,453 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:06:49,453 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:06:49,453 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:06:49,534 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:06:51,539 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:06:51,540 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:06:51,541 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:06:53,735 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:06:53,735 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:07:01,843 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:07:01,844 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:07:01,844 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:07:01,844 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:02,069 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:07:02,070 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:02,268 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:07:02,268 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:02,478 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:07:02,479 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:02,677 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:07:02,678 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:02,879 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:07:02,880 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:03,109 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:07:03,110 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:03,310 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:07:03,311 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:03,538 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:07:03,538 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:03,764 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:07:03,765 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:07:05,948 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:07:05,949 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:07:05,949 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:07:06,054 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{88e4fe4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1210}
    * Task{8920302 #1210 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:07:06,054 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:07:06,054 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:07:06,054 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:07:06,055 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_110706_20250320_110706.png
2025-03-20 11:07:07,826 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_110706_20250320_110706.png
2025-03-20 11:07:07,827 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_110706_20250320_110706.png
2025-03-20 11:07:07,827 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:07:15,024 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_341.jpg
2025-03-20 11:07:15,033 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_341.jpg
2025-03-20 11:07:15,033 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:07:15,033 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:07:15,033 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:07:15,439 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:07:25,147 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:07:25,149 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:07:25,149 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:07:25,245 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{88e4fe4 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1210}
    * Task{8920302 #1210 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:07:25,246 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:07:25,246 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:07:25,246 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:07:25,246 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_110725_20250320_110725.png
2025-03-20 11:07:27,047 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_110725_20250320_110725.png
2025-03-20 11:07:27,047 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_110725_20250320_110725.png
2025-03-20 11:07:27,047 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:07:31,822 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_341.jpg
2025-03-20 11:07:31,828 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_341.jpg
2025-03-20 11:07:31,829 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:07:31,829 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:07:31,829 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:07:31,829 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:07:33,937 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:07:33,938 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:07:33,938 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:07:33,938 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:07:34,943 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:07:35,948 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:07:35,948 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:07:35,949 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 176.0 MB/s (90640 bytes in 0.000s)
WARN: Killing the server...

2025-03-20 11:07:35,949 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:07:45,953 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_110633.mp4 (大小: 4.25MB)
2025-03-20 11:07:45,955 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:07:46,067 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.889167秒，无需修复
2025-03-20 11:07:46,067 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:07:46,067 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_110633.mp4
2025-03-20 11:07:46,067 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:07:53,120 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_342.mp4
2025-03-20 11:07:53,125 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_342.mp4
2025-03-20 11:07:53,125 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:07:53,126 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:07:58,320 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:07:58,321 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_342.mp4
2025-03-20 11:07:58,321 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:07:58,322 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:07:58,322 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:07:58,709 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:07:59,715 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:07:59,715 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:07:59,716 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:08:00,796 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:08:00,797 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:08:00,797 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:08:02,891 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:08:02,892 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:08:04,008 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:08:04,009 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:08:04,009 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:08:05,100 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:08:05,101 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:08:05,102 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:08:05,103 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:05:47\n- 结束时间: 2025-03-20 11:08:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_341.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_341.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_342.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:08:05"}]}]}}
2025-03-20 11:08:05,620 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:08:05,624 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:13:06,627 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:13:06,629 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:13:06,630 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:13:06,630 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:13:06,727 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:13:06,808 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:13:06,808 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:13:06,809 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:13:06,809 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:13:06,943 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:13:06,944 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:13:06,944 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:13:06,944 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:13:08,348 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:13:08,349 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:13:09,545 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:13:09,546 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:13:09,546 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:13:09,546 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:13:09,546 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:13:09,661 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:13:09,661 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:13:09,661 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:13:09,662 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:13:11,037 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:13:11,038 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:13:12,227 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:13:12,228 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:13:12,228 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:13:12,228 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:13:12,228 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:13:13,301 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:13:13,301 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:13:13,395 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:13:15,406 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:13:15,408 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:13:16,504 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:13:16,505 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:13:16,505 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:13:16,505 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:13:16,585 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:13:18,598 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:13:18,599 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:13:20,711 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:13:20,712 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:13:22,806 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:13:22,807 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:13:23,909 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:13:23,910 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:13:23,910 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:13:23,910 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:13:23,985 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:13:26,001 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:13:26,002 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:13:28,116 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:13:28,117 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:13:29,509 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:13:30,920 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:13:30,921 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:13:32,052 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:13:32,053 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:13:33,145 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:13:33,146 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:13:35,258 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:13:35,259 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:13:35,259 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:13:35,259 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:13:35,259 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:13:36,383 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:13:36,384 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:13:36,494 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:13:41,504 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:13:41,504 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:13:43,615 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:13:43,616 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:13:48,721 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:13:48,721 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:13:50,852 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:13:55,858 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:13:55,859 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_111355.mp4
2025-03-20 11:13:55,859 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:13:55,859 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:14:01,128 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:14:01,130 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:14:01,174 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:14:02,275 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_111355.mp4
2025-03-20 11:14:02,276 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_111355.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:14:04,294 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:14:07,302 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:14:07,303 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:14:10,312 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:14:10,313 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:14:10,313 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:14:11,423 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:14:11,424 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:14:11,424 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:14:11,424 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:14:11,497 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:14:13,512 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:14:13,513 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:14:13,513 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:14:15,707 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:14:15,707 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:14:23,821 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:14:23,823 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:14:23,823 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:14:23,824 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:24,056 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:14:24,057 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:24,274 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:14:24,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:24,506 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:14:24,507 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:24,726 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:14:24,727 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:24,979 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:14:24,980 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:25,195 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:14:25,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:25,409 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:14:25,410 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:25,607 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:14:25,608 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:25,852 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:14:25,853 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:14:28,070 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:14:28,071 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:14:28,071 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:14:28,169 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{6485486 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1216}
    * Task{2453312 #1216 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:14:28,170 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:14:28,170 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:14:28,170 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:14:28,170 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_111428_20250320_111428.png
2025-03-20 11:14:30,277 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_111428_20250320_111428.png
2025-03-20 11:14:30,278 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_111428_20250320_111428.png
2025-03-20 11:14:30,278 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:14:37,438 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_343.jpg
2025-03-20 11:14:37,446 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_343.jpg
2025-03-20 11:14:37,447 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:14:37,447 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:14:37,447 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:14:37,524 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:14:47,565 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:14:47,565 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:14:47,565 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:14:47,668 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{6485486 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1216}
    * Task{2453312 #1216 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:14:47,669 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:14:47,669 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:14:47,669 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:14:47,669 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_111447_20250320_111447.png
2025-03-20 11:14:49,780 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_111447_20250320_111447.png
2025-03-20 11:14:49,780 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_111447_20250320_111447.png
2025-03-20 11:14:49,780 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:14:54,639 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_343.jpg
2025-03-20 11:14:54,647 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_343.jpg
2025-03-20 11:14:54,648 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:14:54,648 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:14:54,648 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:14:54,648 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:14:56,765 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:14:56,766 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:14:56,767 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:14:56,767 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:14:57,775 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:14:58,779 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:14:58,780 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:14:58,780 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 167.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:14:58,780 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:15:08,789 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_111355.mp4 (大小: 3.81MB)
2025-03-20 11:15:08,789 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:15:08,898 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.696100秒，无需修复
2025-03-20 11:15:08,898 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:15:08,898 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_111355.mp4
2025-03-20 11:15:08,899 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:15:16,067 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_344.mp4
2025-03-20 11:15:16,075 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_344.mp4
2025-03-20 11:15:16,075 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:15:16,075 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:15:21,293 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:15:21,294 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_344.mp4
2025-03-20 11:15:21,294 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:15:21,294 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:15:21,294 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:15:21,560 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:15:22,565 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:15:22,565 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:15:22,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:15:23,649 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:15:23,651 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:15:23,651 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:15:25,745 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:15:25,746 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:15:26,862 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:15:26,863 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:15:26,863 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:15:27,959 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:15:27,960 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:15:27,960 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:15:27,961 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:13:09\n- 结束时间: 2025-03-20 11:15:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_343.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_343.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_344.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:15:27"}]}]}}
2025-03-20 11:15:28,436 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:15:28,440 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:20:28,852 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:20:28,855 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:20:28,855 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:20:28,856 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:20:29,105 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:20:29,162 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:20:29,162 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:20:29,162 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:20:29,162 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:20:29,275 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:20:29,276 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:20:29,276 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:20:29,276 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:20:30,671 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:20:30,671 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:20:31,845 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:20:31,846 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:20:31,846 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:20:31,846 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:20:31,846 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:20:31,983 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:20:31,984 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:20:31,984 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:20:31,984 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:20:33,362 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:20:33,363 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:20:34,522 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:20:34,522 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:20:34,522 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:20:34,522 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:20:34,522 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:20:35,581 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:20:35,582 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:20:35,688 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:20:37,693 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:20:37,693 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:20:38,778 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:20:38,779 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:20:38,779 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:20:38,779 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:20:38,922 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:20:40,930 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:20:40,931 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:20:43,038 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:20:43,039 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:20:45,128 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:20:45,130 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:20:46,226 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:20:46,227 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:20:46,227 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:20:46,227 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:20:46,301 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:20:48,311 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:20:48,312 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:20:50,428 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:20:50,429 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:20:51,826 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:20:53,244 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:20:53,246 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:20:54,366 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:20:54,368 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:20:55,457 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:20:55,458 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:20:57,572 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:20:57,572 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:20:57,572 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:20:57,573 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:20:57,573 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:20:58,670 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:20:58,670 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:20:58,772 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:21:03,776 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:21:03,778 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:21:05,880 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:21:05,880 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:21:10,961 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:21:10,962 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:21:13,093 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:21:18,099 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:21:18,100 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_112118.mp4
2025-03-20 11:21:18,101 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:21:18,101 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:21:23,494 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:21:23,497 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:21:23,542 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:21:24,677 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112118.mp4
2025-03-20 11:21:24,678 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112118.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:21:26,691 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:21:29,696 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:21:29,696 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:21:32,699 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:21:32,700 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:21:32,700 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:21:33,806 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:21:33,807 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:21:33,807 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:21:33,807 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:21:33,871 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:21:35,878 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:21:35,878 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:21:35,879 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:21:38,069 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:21:38,070 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:21:46,196 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:21:46,198 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:21:46,198 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:21:46,198 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:46,492 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:21:46,493 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:46,706 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:21:46,706 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:46,893 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:21:46,894 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:47,128 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:21:47,128 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:47,357 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:21:47,358 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:47,557 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:21:47,558 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:47,759 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:21:47,759 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:47,954 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:21:47,955 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:48,165 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:21:48,166 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:21:50,416 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:21:50,417 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:21:50,417 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:21:50,504 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{101dc2a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1222}
    * Task{2a4a7b8 #1222 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:21:50,505 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:21:50,505 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:21:50,505 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:21:50,505 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_112150_20250320_112150.png
2025-03-20 11:21:51,771 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_112150_20250320_112150.png
2025-03-20 11:21:51,771 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_112150_20250320_112150.png
2025-03-20 11:21:51,771 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:21:58,990 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_345.jpg
2025-03-20 11:21:58,998 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_345.jpg
2025-03-20 11:21:58,998 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:21:58,998 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:21:58,998 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:21:59,800 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:22:09,116 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:22:09,117 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:22:09,117 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:22:09,209 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{101dc2a u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1222}
    * Task{2a4a7b8 #1222 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:22:09,210 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:22:09,210 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:22:09,210 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:22:09,210 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_112209_20250320_112209.png
2025-03-20 11:22:10,497 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_112209_20250320_112209.png
2025-03-20 11:22:10,498 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_112209_20250320_112209.png
2025-03-20 11:22:10,498 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:22:15,043 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_345.jpg
2025-03-20 11:22:15,050 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_345.jpg
2025-03-20 11:22:15,050 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:22:15,050 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:22:15,051 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:22:15,051 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:22:17,147 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:22:17,148 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:22:17,149 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:22:17,149 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:22:18,153 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:22:19,159 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:22:19,159 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:22:19,160 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 72.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:22:19,160 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:22:29,165 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112118.mp4 (大小: 3.36MB)
2025-03-20 11:22:29,166 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:22:29,285 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.681778秒，无需修复
2025-03-20 11:22:29,285 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:22:29,285 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112118.mp4
2025-03-20 11:22:29,285 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:22:36,527 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_346.mp4
2025-03-20 11:22:36,535 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_346.mp4
2025-03-20 11:22:36,535 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:22:36,535 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:22:41,736 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:22:41,738 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_346.mp4
2025-03-20 11:22:41,739 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:22:41,740 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:22:41,740 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:22:42,024 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:22:43,030 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:22:43,030 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:22:43,031 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:22:44,116 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:22:44,118 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:22:44,118 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:22:46,207 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:22:46,208 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:22:47,315 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:22:47,316 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:22:47,316 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:22:48,409 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:22:48,412 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:22:48,413 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:22:48,413 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:20:31\n- 结束时间: 2025-03-20 11:22:48\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_345.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_345.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_346.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:22:48"}]}]}}
2025-03-20 11:22:48,823 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:22:48,827 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:27:48,861 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:27:48,864 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:27:48,864 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:27:48,865 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:27:48,954 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:27:49,024 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:27:49,024 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:27:49,024 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:27:49,024 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:27:49,149 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:27:49,149 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:27:49,150 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:27:49,150 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:27:50,550 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:27:50,550 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:27:51,720 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:27:51,720 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:27:51,722 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:27:51,722 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:27:51,722 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:27:51,842 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:27:51,843 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:27:51,843 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:27:51,843 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:27:53,211 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:27:53,212 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:27:54,395 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:27:54,400 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:27:54,400 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:27:54,400 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:27:54,400 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:27:55,470 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:27:55,471 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:27:55,573 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:27:57,578 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:27:57,578 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:27:58,637 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:27:58,637 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:27:58,638 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:27:58,638 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:27:58,723 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:28:00,732 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:28:00,733 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:28:02,839 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:28:02,839 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:28:04,919 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:28:04,919 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:28:06,015 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:28:06,017 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:28:06,017 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:28:06,017 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:28:06,093 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:28:08,103 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:28:08,104 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:28:10,216 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:28:10,217 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:28:11,590 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:28:12,987 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:28:12,987 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:28:14,098 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:28:14,099 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:28:15,181 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:28:15,182 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:28:17,305 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:28:17,311 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:28:17,311 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:28:17,311 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:28:17,311 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:28:18,411 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:28:18,411 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:28:18,510 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:28:23,513 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:28:23,514 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:28:25,615 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:28:25,616 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:28:30,714 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:28:30,714 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:28:32,822 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:28:37,828 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:28:37,829 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_112837.mp4
2025-03-20 11:28:37,829 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:28:37,829 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:28:43,076 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:28:43,080 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:28:43,127 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:28:44,211 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112837.mp4
2025-03-20 11:28:44,211 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112837.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:28:46,222 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:28:49,230 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:28:49,230 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:28:52,235 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:28:52,235 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:28:52,236 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:28:53,338 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:28:53,338 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:28:53,338 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:28:53,339 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:28:53,418 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:28:55,426 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:28:55,426 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:28:55,426 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:28:57,617 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:28:57,617 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:29:05,708 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:29:05,711 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:29:05,711 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:29:05,712 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:05,953 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:29:05,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:06,169 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:29:06,170 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:06,421 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:29:06,422 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:06,656 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:29:06,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:06,867 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:29:06,869 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:07,087 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:29:07,088 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:07,306 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:29:07,306 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:07,517 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:29:07,518 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:07,735 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:29:07,736 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:29:09,953 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:29:09,953 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:29:09,954 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:29:10,053 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b5182d1 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1228}
    * Task{3c421a4 #1228 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:29:10,054 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:29:10,054 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:29:10,054 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:29:10,054 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_112910_20250320_112910.png
2025-03-20 11:29:11,720 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_112910_20250320_112910.png
2025-03-20 11:29:11,720 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_112910_20250320_112910.png
2025-03-20 11:29:11,721 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:29:18,932 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_347.jpg
2025-03-20 11:29:18,939 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_347.jpg
2025-03-20 11:29:18,939 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:29:18,939 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:29:18,939 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:29:19,336 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:29:29,037 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:29:29,038 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:29:29,039 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:29:29,125 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b5182d1 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1228}
    * Task{3c421a4 #1228 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:29:29,125 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:29:29,126 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:29:29,126 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:29:29,126 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_112929_20250320_112929.png
2025-03-20 11:29:30,850 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_112929_20250320_112929.png
2025-03-20 11:29:30,850 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_112929_20250320_112929.png
2025-03-20 11:29:30,850 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:29:35,509 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_347.jpg
2025-03-20 11:29:35,517 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_347.jpg
2025-03-20 11:29:35,517 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:29:35,518 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:29:35,518 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:29:35,518 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:29:37,626 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:29:37,628 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:29:37,628 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:29:37,628 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:29:38,629 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:29:39,635 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:29:39,636 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:29:39,636 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 46.4 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-20 11:29:39,636 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:29:49,644 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112837.mp4 (大小: 4.12MB)
2025-03-20 11:29:49,645 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:29:49,760 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.721789秒，无需修复
2025-03-20 11:29:49,760 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:29:49,760 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_112837.mp4
2025-03-20 11:29:49,760 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:29:56,824 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_348.mp4
2025-03-20 11:29:56,830 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_348.mp4
2025-03-20 11:29:56,831 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:29:56,831 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:30:02,122 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:30:02,124 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_348.mp4
2025-03-20 11:30:02,124 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:30:02,124 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:30:02,124 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:30:02,510 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:30:03,515 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:30:03,515 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:30:03,515 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:30:04,585 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:30:04,585 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:30:04,586 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:30:06,656 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:30:06,657 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:30:07,771 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:30:07,772 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:30:07,772 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:30:08,861 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:30:08,863 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:30:08,863 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:30:08,865 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:27:51\n- 结束时间: 2025-03-20 11:30:08\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_347.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_347.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_348.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:30:08"}]}]}}
2025-03-20 11:30:09,340 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:30:09,346 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:35:10,336 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:35:10,338 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:35:10,338 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:35:10,338 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:35:10,427 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:35:10,503 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:35:10,503 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:35:10,503 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:35:10,503 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:35:10,645 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:35:10,645 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:35:10,646 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:35:10,646 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:35:12,061 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:35:12,061 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:35:13,250 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:35:13,250 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:35:13,250 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:35:13,250 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:35:13,250 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:35:13,391 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:35:13,392 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:35:13,392 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:35:13,392 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:35:14,767 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:35:14,768 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:35:15,959 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:35:15,959 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:35:15,959 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:35:15,959 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:35:15,959 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:35:17,027 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:35:17,027 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:35:17,118 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:35:19,124 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:35:19,124 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:35:20,233 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:35:20,235 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:35:20,235 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:35:20,235 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:35:20,327 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:35:22,334 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:35:22,335 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:35:24,453 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:35:24,454 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:35:26,539 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:35:26,540 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:35:27,641 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:35:27,642 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:35:27,642 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:35:27,642 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:35:27,697 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:35:29,706 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:35:29,707 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:35:31,827 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:35:31,828 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:35:33,219 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:35:34,630 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:35:34,631 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:35:35,739 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:35:35,740 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:35:36,809 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:35:36,810 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:35:38,928 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:35:38,929 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:35:38,929 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:35:38,929 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:35:38,929 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:35:40,046 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:35:40,047 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:35:40,145 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:35:45,139 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:35:45,140 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:35:47,234 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:35:47,235 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:35:52,329 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:35:52,330 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:35:54,450 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:35:59,448 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:35:59,450 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_113559.mp4
2025-03-20 11:35:59,450 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:35:59,450 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:36:04,699 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:36:04,702 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:36:04,743 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:36:05,875 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_113559.mp4
2025-03-20 11:36:05,875 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_113559.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:36:07,883 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:36:10,889 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:36:10,889 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:36:13,892 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:36:13,893 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:36:13,893 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:36:15,008 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:36:15,009 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:36:15,009 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:36:15,009 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:36:15,081 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:36:17,086 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:36:17,086 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:36:17,087 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:36:19,271 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:36:19,271 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:36:27,388 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:36:27,389 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:36:27,389 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:36:27,389 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:27,601 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:36:27,601 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:27,803 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:36:27,804 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:28,014 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:36:28,015 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:28,244 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:36:28,245 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:28,491 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:36:28,491 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:28,695 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:36:28,696 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:28,921 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:36:28,922 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:29,128 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:36:29,129 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:29,349 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:36:29,350 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:36:31,564 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:36:31,568 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:36:31,568 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:36:31,652 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9d88391 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1234}
    * Task{9146f7 #1234 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:36:31,652 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:36:31,652 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:36:31,652 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:36:31,652 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_113631_20250320_113631.png
2025-03-20 11:36:32,871 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_113631_20250320_113631.png
2025-03-20 11:36:32,872 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_113631_20250320_113631.png
2025-03-20 11:36:32,872 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:36:39,511 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_349.jpg
2025-03-20 11:36:39,517 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_349.jpg
2025-03-20 11:36:39,518 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:36:39,518 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:36:39,519 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:36:40,980 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:36:49,636 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:36:49,637 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:36:49,637 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:36:49,736 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9d88391 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1234}
    * Task{9146f7 #1234 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:36:49,736 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:36:49,736 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:36:49,736 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:36:49,737 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_113649_20250320_113649.png
2025-03-20 11:36:50,966 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_113649_20250320_113649.png
2025-03-20 11:36:50,967 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_113649_20250320_113649.png
2025-03-20 11:36:50,967 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:36:55,703 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_349.jpg
2025-03-20 11:36:55,714 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_349.jpg
2025-03-20 11:36:55,714 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:36:55,714 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:36:55,714 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:36:55,715 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:36:57,824 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:36:57,826 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:36:57,826 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:36:57,826 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:36:58,827 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:36:59,831 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:36:59,831 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:36:59,832 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 124.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:36:59,832 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:37:09,836 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_113559.mp4 (大小: 3.65MB)
2025-03-20 11:37:09,837 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:37:09,980 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.180133秒，无需修复
2025-03-20 11:37:09,980 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:37:09,980 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_113559.mp4
2025-03-20 11:37:09,980 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:37:17,461 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_350.mp4
2025-03-20 11:37:17,472 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_350.mp4
2025-03-20 11:37:17,473 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:37:17,473 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:37:22,682 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:37:22,683 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_350.mp4
2025-03-20 11:37:22,684 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:37:22,684 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:37:22,684 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:37:23,068 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:37:24,072 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:37:24,073 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:37:24,073 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:37:25,152 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:37:25,153 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:37:25,153 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:37:27,235 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:37:27,236 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:37:28,345 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:37:28,345 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:37:28,345 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:37:29,443 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:37:29,444 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:37:29,444 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:37:29,445 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:35:13\n- 结束时间: 2025-03-20 11:37:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_349.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_349.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_350.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:37:29"}]}]}}
2025-03-20 11:37:30,069 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:37:30,072 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:42:30,080 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:42:30,082 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:42:30,082 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:42:30,083 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:42:30,182 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:42:30,267 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:42:30,267 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:42:30,268 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:42:30,268 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:42:30,407 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:42:30,407 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:42:30,408 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:42:30,409 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:42:31,822 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:42:31,823 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:42:33,006 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:42:33,007 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:42:33,007 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:42:33,007 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:42:33,007 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:42:33,130 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:42:33,130 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:42:33,130 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:42:33,130 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:42:34,499 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:42:34,500 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:42:35,663 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:42:35,663 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:42:35,663 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:42:35,664 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:42:35,664 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:42:36,749 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:42:36,753 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:42:36,860 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:42:38,863 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:42:38,864 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:42:39,956 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:42:39,957 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:42:39,957 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:42:39,957 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:42:40,019 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:42:42,030 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:42:42,031 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:42:44,135 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:42:44,136 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:42:46,215 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:42:46,216 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:42:47,314 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:42:47,314 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:42:47,314 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:42:47,314 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:42:47,391 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:42:49,396 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:42:49,397 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:42:51,498 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:42:51,499 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:42:52,892 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:42:54,306 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:42:54,307 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:42:55,420 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:42:55,421 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:42:56,507 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:42:56,508 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:42:58,619 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:42:58,621 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:42:58,621 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:42:58,621 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:42:58,622 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:42:59,730 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:42:59,730 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:42:59,827 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:43:04,832 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:43:04,832 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:43:06,925 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:43:06,927 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:43:12,023 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:43:12,023 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:43:14,151 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:43:19,155 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:43:19,156 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_114319.mp4
2025-03-20 11:43:19,156 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:43:19,156 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:43:24,422 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:43:24,423 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:43:24,463 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:43:25,544 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_114319.mp4
2025-03-20 11:43:25,544 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_114319.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:43:27,549 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:43:30,555 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:43:30,555 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:43:33,558 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:43:33,560 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:43:33,560 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:43:34,670 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:43:34,671 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:43:34,671 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:43:34,671 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:43:34,750 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:43:36,758 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:43:36,758 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:43:36,759 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:43:38,940 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:43:38,940 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:43:47,055 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:43:47,056 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:43:47,056 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:43:47,056 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:47,306 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:43:47,307 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:47,515 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:43:47,516 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:47,743 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:43:47,743 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:47,954 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:43:47,955 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:48,175 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:43:48,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:48,379 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:43:48,380 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:48,614 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:43:48,615 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:48,852 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:43:48,853 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:49,070 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:43:49,071 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:43:51,284 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:43:51,285 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:43:51,285 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:43:51,379 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ee4b55c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1240}
    * Task{fbd13a #1240 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:43:51,379 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:43:51,380 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:43:51,380 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:43:51,380 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_114351_20250320_114351.png
2025-03-20 11:43:52,585 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_114351_20250320_114351.png
2025-03-20 11:43:52,586 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_114351_20250320_114351.png
2025-03-20 11:43:52,586 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:43:57,634 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 11:43:57,635 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 11:43:57,635 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:43:57,635 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:43:57,635 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:44:00,659 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:44:07,725 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:44:07,727 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:44:07,727 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:44:07,815 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ee4b55c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1240}
    * Task{fbd13a #1240 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:44:07,816 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:44:07,816 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:44:07,816 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:44:07,816 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_114407_20250320_114407.png
2025-03-20 11:44:09,022 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_114407_20250320_114407.png
2025-03-20 11:44:09,022 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_114407_20250320_114407.png
2025-03-20 11:44:09,022 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:44:13,920 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 11:44:13,926 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg
2025-03-20 11:44:13,926 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:44:13,927 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:44:13,927 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:44:13,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:44:16,051 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:44:16,052 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:44:16,052 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:44:16,052 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:44:17,057 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:44:18,061 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:44:18,062 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:44:18,062 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 133.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:44:18,062 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:44:28,068 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_114319.mp4 (大小: 3.38MB)
2025-03-20 11:44:28,071 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:44:28,232 - QuickAppADBTester - INFO - 录制文件完整，时长: 49.770144秒，无需修复
2025-03-20 11:44:28,232 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:44:28,232 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_114319.mp4
2025-03-20 11:44:28,232 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:44:36,475 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_351.mp4
2025-03-20 11:44:36,484 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_351.mp4
2025-03-20 11:44:36,484 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:44:36,484 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:44:41,731 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:44:41,732 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_351.mp4
2025-03-20 11:44:41,732 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:44:41,732 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:44:41,732 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:44:42,092 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:44:43,095 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:44:43,096 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:44:43,096 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:44:44,184 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:44:44,184 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:44:44,184 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:44:46,273 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:44:46,273 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:44:47,389 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:44:47,390 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:44:47,390 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:44:48,481 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:44:48,483 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:44:48,483 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:44:48,484 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:42:33\n- 结束时间: 2025-03-20 11:44:48\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_278.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_351.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:44:48"}]}]}}
2025-03-20 11:44:48,961 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:44:48,963 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:49:49,115 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:49:49,117 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:49:49,117 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:49:49,118 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:49:49,381 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:49:49,445 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:49:49,446 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:49:49,446 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:49:49,446 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:49:49,562 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:49:49,562 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:49:49,562 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:49:49,562 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:49:50,956 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:49:50,957 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:49:52,144 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:49:52,144 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:49:52,144 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:49:52,144 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:49:52,144 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:49:52,300 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:49:52,300 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:49:52,300 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:49:52,300 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:49:53,667 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:49:53,668 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:49:54,846 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:49:54,846 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:49:54,846 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:49:54,846 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:49:54,846 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:49:55,915 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:49:55,916 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:49:56,021 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:49:58,024 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:49:58,025 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:49:59,105 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:49:59,106 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:49:59,106 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:49:59,106 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:49:59,176 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:50:01,183 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:50:01,183 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:50:03,294 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:50:03,296 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:50:05,380 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:50:05,380 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:50:06,482 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:50:06,483 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:50:06,484 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:50:06,484 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:50:06,559 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:50:08,568 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:50:08,568 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:50:10,678 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:50:10,679 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:50:12,064 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:50:13,471 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:50:13,474 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:50:14,591 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:50:14,592 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:50:15,680 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:50:15,680 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:50:17,782 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:50:17,783 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:50:17,783 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:50:17,784 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:50:17,784 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:50:18,903 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:50:18,904 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:50:18,997 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:50:24,001 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:50:24,001 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:50:26,162 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:50:26,163 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:50:31,259 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:50:31,260 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:50:33,384 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:50:38,387 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:50:38,389 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_115038.mp4
2025-03-20 11:50:38,389 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:50:38,389 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:50:43,725 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:50:43,726 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:50:43,833 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:50:44,972 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115038.mp4
2025-03-20 11:50:44,972 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115038.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:50:46,979 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:50:49,985 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:50:49,985 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:50:52,986 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:50:52,987 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:50:52,987 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:50:54,101 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:50:54,102 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:50:54,102 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:50:54,103 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:50:54,173 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:50:56,178 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:50:56,178 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:50:56,178 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:50:58,362 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:50:58,363 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:51:06,467 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:51:06,469 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:51:06,469 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:51:06,469 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:06,793 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:51:06,794 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:07,027 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:51:07,028 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:07,258 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:51:07,259 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:07,478 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:51:07,479 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:07,701 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:51:07,702 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:07,929 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:51:07,930 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:08,174 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:51:08,175 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:08,379 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:51:08,380 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:08,604 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:51:08,605 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:51:10,824 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:51:10,825 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:51:10,826 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:51:10,921 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{35850fc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1246}
    * Task{b44e5da #1246 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:51:10,921 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:51:10,922 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:51:10,922 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:51:10,922 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_115110_20250320_115110.png
2025-03-20 11:51:12,690 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_115110_20250320_115110.png
2025-03-20 11:51:12,691 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_115110_20250320_115110.png
2025-03-20 11:51:12,691 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:51:19,277 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_352.jpg
2025-03-20 11:51:19,283 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_352.jpg
2025-03-20 11:51:19,283 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:51:19,283 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:51:19,283 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:51:20,077 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:51:29,385 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:51:29,385 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:51:29,386 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:51:29,465 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{35850fc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1246}
    * Task{b44e5da #1246 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:51:29,466 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:51:29,466 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:51:29,466 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:51:29,466 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_115129_20250320_115129.png
2025-03-20 11:51:31,247 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_115129_20250320_115129.png
2025-03-20 11:51:31,248 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_115129_20250320_115129.png
2025-03-20 11:51:31,248 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:51:35,387 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_352.jpg
2025-03-20 11:51:35,393 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_352.jpg
2025-03-20 11:51:35,394 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:51:35,394 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:51:35,394 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:51:35,394 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:51:37,506 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:51:37,507 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:51:37,507 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:51:37,507 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:51:38,513 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:51:39,518 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:51:39,518 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:51:39,519 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 110.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:51:39,519 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:51:49,525 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115038.mp4 (大小: 4.25MB)
2025-03-20 11:51:49,527 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:51:49,679 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.708611秒，无需修复
2025-03-20 11:51:49,679 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:51:49,679 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115038.mp4
2025-03-20 11:51:49,679 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:51:56,637 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_353.mp4
2025-03-20 11:51:56,653 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_353.mp4
2025-03-20 11:51:56,654 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:51:56,654 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:52:01,846 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:52:01,847 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_353.mp4
2025-03-20 11:52:01,848 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:52:01,848 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:52:01,848 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:52:02,253 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:52:03,259 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:52:03,260 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:52:03,260 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:52:04,346 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:52:04,347 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:52:04,347 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:52:06,427 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:52:06,428 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:52:07,540 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:52:07,540 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:52:07,541 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:52:08,622 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:52:08,623 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:52:08,623 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:52:08,624 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:49:52\n- 结束时间: 2025-03-20 11:52:08\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_352.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_352.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_353.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:52:08"}]}]}}
2025-03-20 11:52:09,204 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:52:09,207 - QuickAppADBTester - INFO - 测试完成
2025-03-20 11:57:10,174 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 11:57:10,177 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 11:57:10,178 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 11:57:10,178 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 11:57:10,273 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 11:57:10,332 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 11:57:10,332 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 11:57:10,332 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:57:10,333 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:57:10,472 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:57:10,473 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:57:10,473 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:57:10,473 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:57:11,872 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:57:11,873 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:57:13,067 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:57:13,067 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 11:57:13,067 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 11:57:13,067 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 11:57:13,067 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 11:57:13,183 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 11:57:13,183 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 11:57:13,184 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 11:57:13,184 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 11:57:14,556 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:57:14,557 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:57:15,743 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 11:57:15,743 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 11:57:15,743 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:57:15,743 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:57:15,743 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:57:16,807 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 11:57:16,807 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 11:57:16,883 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 11:57:18,888 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 11:57:18,889 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 11:57:19,984 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 11:57:19,985 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 11:57:19,985 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:57:19,985 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 11:57:20,063 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:57:22,073 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 11:57:22,074 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 11:57:24,177 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 11:57:24,178 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 11:57:26,265 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 11:57:26,265 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 11:57:27,367 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 11:57:27,367 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 11:57:27,368 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:57:27,368 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 11:57:27,441 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:57:29,452 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 11:57:29,453 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 11:57:31,570 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 11:57:31,571 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 11:57:32,961 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 11:57:34,377 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 11:57:34,378 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 11:57:35,498 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 11:57:35,498 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 11:57:36,583 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 11:57:36,584 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 11:57:38,696 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 11:57:38,697 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 11:57:38,697 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 11:57:38,697 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:57:38,697 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:57:39,805 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 11:57:39,805 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 11:57:39,900 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 11:57:44,901 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 11:57:44,901 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 11:57:47,004 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 11:57:47,005 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 11:57:52,105 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 11:57:52,106 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 11:57:54,227 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 11:57:59,231 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 11:57:59,231 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_115759.mp4
2025-03-20 11:57:59,231 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:57:59,231 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:58:04,474 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:58:04,475 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 11:58:04,520 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 11:58:05,659 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115759.mp4
2025-03-20 11:58:05,660 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115759.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 11:58:07,669 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 11:58:10,674 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 11:58:10,675 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 11:58:13,676 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 11:58:13,676 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 11:58:13,676 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 11:58:14,792 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 11:58:14,793 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 11:58:14,793 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 11:58:14,794 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 11:58:14,872 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 11:58:16,882 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 11:58:16,883 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 11:58:16,883 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 11:58:19,069 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 11:58:19,070 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 11:58:27,182 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 11:58:27,183 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 11:58:27,183 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 11:58:27,183 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:27,404 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 11:58:27,405 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:27,615 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 11:58:27,616 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:27,821 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 11:58:27,822 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:28,022 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 11:58:28,023 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:28,228 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 11:58:28,229 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:28,465 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 11:58:28,466 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:28,692 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 11:58:28,693 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:28,891 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 11:58:28,892 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:29,089 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 11:58:29,090 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 11:58:31,292 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 11:58:31,293 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:58:31,293 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:58:31,392 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4a0e947 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1252}
    * Task{31e7a9d #1252 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:58:31,392 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:58:31,392 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 11:58:31,392 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 11:58:31,393 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_115831_20250320_115831.png
2025-03-20 11:58:33,371 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_115831_20250320_115831.png
2025-03-20 11:58:33,372 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_115831_20250320_115831.png
2025-03-20 11:58:33,372 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:58:39,744 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_354.jpg
2025-03-20 11:58:39,751 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_354.jpg
2025-03-20 11:58:39,752 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 11:58:39,752 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:58:39,752 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:58:40,774 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 11:58:49,846 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 11:58:49,848 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 11:58:49,848 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 11:58:49,931 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4a0e947 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1252}
    * Task{31e7a9d #1252 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 11:58:49,931 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 11:58:49,931 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 11:58:49,931 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 11:58:49,931 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_115849_20250320_115849.png
2025-03-20 11:58:51,615 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_115849_20250320_115849.png
2025-03-20 11:58:51,615 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_115849_20250320_115849.png
2025-03-20 11:58:51,616 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 11:58:56,879 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_355.jpg
2025-03-20 11:58:56,886 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_355.jpg
2025-03-20 11:58:56,886 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 11:58:56,886 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 11:58:56,887 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:58:56,887 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:58:58,992 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 11:58:58,993 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 11:58:58,993 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 11:58:58,993 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 11:58:59,996 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 11:59:00,998 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 11:59:00,999 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 11:59:00,999 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 11:59:00,999 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 11:59:11,002 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115759.mp4 (大小: 3.48MB)
2025-03-20 11:59:11,004 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 11:59:11,130 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.564589秒，无需修复
2025-03-20 11:59:11,130 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 11:59:11,130 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_115759.mp4
2025-03-20 11:59:11,130 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 11:59:17,088 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_356.mp4
2025-03-20 11:59:17,094 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_356.mp4
2025-03-20 11:59:17,095 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 11:59:17,095 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 11:59:22,345 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 11:59:22,346 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_356.mp4
2025-03-20 11:59:22,347 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 11:59:22,347 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 11:59:22,347 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 11:59:22,684 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 11:59:23,690 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 11:59:23,691 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:59:23,691 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:59:24,775 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 11:59:24,776 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 11:59:24,777 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 11:59:26,859 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 11:59:26,860 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 11:59:27,962 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 11:59:27,963 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 11:59:27,963 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 11:59:29,046 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 11:59:29,047 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 11:59:29,047 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 11:59:29,048 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 11:57:13\n- 结束时间: 2025-03-20 11:59:29\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_354.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_355.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_356.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 11:59:29"}]}]}}
2025-03-20 11:59:29,454 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 11:59:29,458 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:04:29,511 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:04:29,515 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:04:29,515 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:04:29,517 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:04:29,611 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 12:04:29,695 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 12:04:29,695 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 12:04:29,695 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:04:29,696 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:04:29,825 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:04:29,826 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:04:29,826 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:04:29,826 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:04:31,228 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:04:31,229 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:04:32,409 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:04:32,409 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:04:32,410 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:04:32,410 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:04:32,410 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:04:32,528 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:04:32,528 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:04:32,528 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:04:32,528 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:04:33,896 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:04:33,897 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:04:35,071 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:04:35,071 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:04:35,071 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:04:35,071 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:04:35,071 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:04:36,139 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:04:36,140 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:04:36,235 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 12:04:38,241 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:04:38,241 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:04:39,330 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:04:39,331 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:04:39,331 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:04:39,331 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:04:39,410 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:04:41,421 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:04:41,421 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:04:43,528 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:04:43,529 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:04:45,612 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:04:45,613 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:04:46,713 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:04:46,714 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:04:46,714 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:04:46,714 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:04:46,786 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:04:48,796 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:04:48,797 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:04:50,905 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:04:50,906 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:04:52,298 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:04:53,706 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:04:53,707 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:04:54,805 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:04:54,805 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:04:55,891 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:04:55,892 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:04:58,010 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:04:58,011 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:04:58,011 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:04:58,011 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:04:58,011 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:04:59,123 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:04:59,124 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:04:59,215 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 12:05:04,221 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:05:04,221 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:05:06,332 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:05:06,333 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:05:11,424 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:05:11,425 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:05:13,550 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:05:18,552 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:05:18,553 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_120518.mp4
2025-03-20 12:05:18,553 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:05:18,553 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:05:23,808 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:05:23,809 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:05:23,857 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 12:05:24,997 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_120518.mp4
2025-03-20 12:05:24,998 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_120518.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 12:05:27,009 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 12:05:30,012 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 12:05:30,013 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 12:05:33,014 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:05:33,015 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:05:33,015 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:05:34,122 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:05:34,123 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:05:34,123 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:05:34,123 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:05:34,190 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:05:36,200 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:05:36,200 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:05:36,200 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:05:38,388 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:05:38,389 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:05:46,501 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:05:46,502 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:05:46,502 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:05:46,502 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:46,727 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:05:46,728 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:46,948 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:05:46,949 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:47,179 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:05:47,180 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:47,396 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:05:47,397 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:47,635 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:05:47,636 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:47,908 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:05:47,909 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:48,148 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:05:48,149 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:48,359 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:05:48,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:48,564 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:05:48,565 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:05:50,823 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:05:50,823 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:05:50,824 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:05:50,916 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{46ef86 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1258}
    * Task{57fe99d #1258 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:05:50,916 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:05:50,916 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 12:05:50,916 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:05:50,916 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_120550_20250320_120550.png
2025-03-20 12:05:52,145 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_120550_20250320_120550.png
2025-03-20 12:05:52,145 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_120550_20250320_120550.png
2025-03-20 12:05:52,145 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:05:59,141 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_357.jpg
2025-03-20 12:05:59,149 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_357.jpg
2025-03-20 12:05:59,149 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:05:59,149 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:05:59,150 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:06:00,119 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 12:06:09,270 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:06:09,272 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:06:09,272 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:06:09,371 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{46ef86 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1258}
    * Task{57fe99d #1258 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:06:09,372 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:06:09,372 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 12:06:09,372 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:06:09,372 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_120609_20250320_120609.png
2025-03-20 12:06:10,654 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_120609_20250320_120609.png
2025-03-20 12:06:10,654 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_120609_20250320_120609.png
2025-03-20 12:06:10,654 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:06:15,286 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_357.jpg
2025-03-20 12:06:15,294 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_357.jpg
2025-03-20 12:06:15,294 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:06:15,295 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:06:15,295 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:06:15,295 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:06:17,388 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 12:06:17,389 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 12:06:17,389 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 12:06:17,389 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 12:06:18,392 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 12:06:19,395 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 12:06:19,395 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 12:06:19,396 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 129.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 12:06:19,396 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 12:06:29,403 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_120518.mp4 (大小: 4.39MB)
2025-03-20 12:06:29,404 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 12:06:29,548 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.642744秒，无需修复
2025-03-20 12:06:29,549 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 12:06:29,549 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_120518.mp4
2025-03-20 12:06:29,549 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 12:06:37,093 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_358.mp4
2025-03-20 12:06:37,101 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_358.mp4
2025-03-20 12:06:37,101 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:06:37,101 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:06:42,298 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:06:42,300 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_358.mp4
2025-03-20 12:06:42,300 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:06:42,300 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:06:42,301 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:06:42,684 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:06:43,688 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:06:43,689 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:06:43,689 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:06:44,778 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:06:44,779 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:06:44,780 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:06:46,864 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:06:46,864 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:06:47,957 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:06:47,957 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:06:47,958 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:06:49,039 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:06:49,040 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 12:06:49,040 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 12:06:49,041 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 12:04:32\n- 结束时间: 2025-03-20 12:06:49\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_357.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_357.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_358.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:06:49"}]}]}}
2025-03-20 12:06:49,706 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 12:06:49,708 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:11:49,741 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:11:49,744 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:11:49,744 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:11:49,744 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:11:49,838 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 12:11:49,914 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 12:11:49,915 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 12:11:49,915 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:11:49,915 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:11:50,081 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:11:50,082 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:11:50,082 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:11:50,082 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:11:51,488 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:11:51,488 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:11:52,660 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:11:52,661 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:11:52,661 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:11:52,661 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:11:52,661 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:11:52,769 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:11:52,769 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:11:52,769 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:11:52,769 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:11:54,136 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:11:54,136 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:11:55,321 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:11:55,322 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:11:55,322 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:11:55,322 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:11:55,322 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:11:56,386 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:11:56,387 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:11:56,483 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 12:11:58,488 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:11:58,489 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:11:59,577 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:11:59,578 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:11:59,578 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:11:59,578 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:11:59,659 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:12:01,668 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:12:01,669 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:12:03,768 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:12:03,769 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:12:05,852 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:12:05,853 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:12:06,951 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:12:06,952 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:12:06,952 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:12:06,952 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:12:07,024 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:12:09,034 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:12:09,034 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:12:11,140 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:12:11,141 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:12:12,528 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:12:13,933 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:12:13,934 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:12:15,035 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:12:15,035 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:12:16,120 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:12:16,121 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:12:18,239 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:12:18,240 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:12:18,240 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:12:18,240 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:12:18,240 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:12:19,356 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:12:19,356 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:12:19,446 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 12:12:24,451 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:12:24,451 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:12:26,547 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:12:26,548 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:12:31,661 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:12:31,661 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:12:33,782 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:12:38,789 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:12:38,789 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_121238.mp4
2025-03-20 12:12:38,790 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:12:38,790 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:12:44,046 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:12:44,047 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:12:44,089 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 12:12:45,227 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121238.mp4
2025-03-20 12:12:45,228 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121238.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 12:12:47,233 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 12:12:50,238 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 12:12:50,239 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 12:12:53,244 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:12:53,246 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:12:53,247 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:12:54,355 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:12:54,356 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:12:54,356 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:12:54,356 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:12:54,435 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:12:56,445 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:12:56,445 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:12:56,445 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:12:58,656 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:12:58,657 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:13:06,762 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:13:06,763 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:13:06,764 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:13:06,764 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:06,987 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:13:06,987 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:07,215 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:13:07,216 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:07,436 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:13:07,437 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:07,665 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:13:07,665 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:07,953 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:13:07,953 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:08,155 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:13:08,156 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:08,379 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:13:08,379 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:08,570 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:13:08,570 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:08,797 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:13:08,798 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:13:11,007 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:13:11,008 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:13:11,008 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:13:11,108 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{48565ba u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1264}
    * Task{bdbac61 #1264 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:13:11,109 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:13:11,109 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 12:13:11,109 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:13:11,109 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_121311_20250320_121311.png
2025-03-20 12:13:12,583 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_121311_20250320_121311.png
2025-03-20 12:13:12,583 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_121311_20250320_121311.png
2025-03-20 12:13:12,583 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:13:19,515 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_359.jpg
2025-03-20 12:13:19,521 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_359.jpg
2025-03-20 12:13:19,521 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:13:19,521 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:13:19,522 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:13:20,331 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 12:13:29,611 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:13:29,611 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:13:29,612 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:13:29,716 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{48565ba u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1264}
    * Task{bdbac61 #1264 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:13:29,716 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:13:29,716 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 12:13:29,716 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:13:29,716 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_121329_20250320_121329.png
2025-03-20 12:13:31,202 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_121329_20250320_121329.png
2025-03-20 12:13:31,202 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_121329_20250320_121329.png
2025-03-20 12:13:31,202 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:13:35,842 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_359.jpg
2025-03-20 12:13:35,845 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_359.jpg
2025-03-20 12:13:35,845 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:13:35,845 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:13:35,845 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:13:35,845 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:13:37,950 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 12:13:37,951 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 12:13:37,951 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 12:13:37,951 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 12:13:38,955 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 12:13:39,959 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 12:13:39,959 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 12:13:39,959 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 12:13:39,959 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 12:13:49,961 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121238.mp4 (大小: 3.27MB)
2025-03-20 12:13:49,961 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 12:13:50,072 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.971422秒，无需修复
2025-03-20 12:13:50,072 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 12:13:50,072 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121238.mp4
2025-03-20 12:13:50,072 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 12:13:57,216 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_360.mp4
2025-03-20 12:13:57,222 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_360.mp4
2025-03-20 12:13:57,223 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:13:57,224 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:14:02,430 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:14:02,431 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_360.mp4
2025-03-20 12:14:02,431 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:14:02,431 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:14:02,432 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:14:02,713 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:14:03,718 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:14:03,719 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:14:03,719 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:14:04,806 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:14:04,807 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:14:04,807 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:14:06,891 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:14:06,892 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:14:08,002 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:14:08,002 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:14:08,002 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:14:09,082 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:14:09,083 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 12:14:09,083 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 12:14:09,084 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 12:11:52\n- 结束时间: 2025-03-20 12:14:09\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_359.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_359.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_360.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:14:09"}]}]}}
2025-03-20 12:14:09,519 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 12:14:09,523 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:19:10,516 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:19:10,520 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:19:10,520 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:19:10,520 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:19:10,617 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 12:19:10,700 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 12:19:10,701 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 12:19:10,701 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:19:10,701 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:19:10,837 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:19:10,838 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:19:10,838 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:19:10,838 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:19:12,245 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:19:12,246 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:19:13,426 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:19:13,426 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:19:13,426 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:19:13,426 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:19:13,426 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:19:13,540 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:19:13,541 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:19:13,541 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:19:13,541 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:19:14,907 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:19:14,908 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:19:16,083 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:19:16,084 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:19:16,084 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:19:16,084 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:19:16,084 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:19:17,152 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:19:17,153 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:19:17,245 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 12:19:19,249 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:19:19,249 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:19:20,338 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:19:20,339 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:19:20,339 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:19:20,339 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:19:20,415 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:19:22,426 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:19:22,426 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:19:24,537 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:19:24,538 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:19:26,623 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:19:26,623 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:19:27,716 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:19:27,717 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:19:27,717 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:19:27,717 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:19:27,770 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:19:29,775 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:19:29,776 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:19:31,888 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:19:31,889 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:19:33,278 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:19:34,693 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:19:34,693 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:19:35,803 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:19:35,803 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:19:36,888 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:19:36,889 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:19:39,003 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:19:39,003 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:19:39,004 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:19:39,004 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:19:39,004 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:19:40,119 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:19:40,120 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:19:40,214 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 12:19:45,218 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:19:45,219 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:19:47,320 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:19:47,321 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:19:52,421 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:19:52,422 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:19:54,544 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:19:59,550 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:19:59,550 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_121959.mp4
2025-03-20 12:19:59,551 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:19:59,551 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:20:04,803 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:20:04,804 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:20:04,849 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 12:20:05,989 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121959.mp4
2025-03-20 12:20:05,989 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121959.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 12:20:08,001 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 12:20:11,005 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 12:20:11,005 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 12:20:14,010 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:20:14,011 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:20:14,011 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:20:15,117 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:20:15,118 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:20:15,118 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:20:15,118 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:20:15,195 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:20:17,203 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:20:17,203 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:20:17,203 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:20:19,406 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:20:19,408 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:20:27,518 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:20:27,518 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:20:27,518 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:20:27,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:27,739 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:20:27,739 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:27,957 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:20:27,958 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:28,195 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:20:28,195 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:28,400 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:20:28,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:28,649 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:20:28,650 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:28,869 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:20:28,869 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:29,109 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:20:29,110 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:29,318 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:20:29,319 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:29,517 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:20:29,518 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:20:31,761 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:20:31,762 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:20:31,763 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:20:31,849 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4fb717c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1270}
    * Task{9ba3a5a #1270 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:20:31,849 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:20:31,850 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 12:20:31,850 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:20:31,850 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_122031_20250320_122031.png
2025-03-20 12:20:33,719 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_122031_20250320_122031.png
2025-03-20 12:20:33,719 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_122031_20250320_122031.png
2025-03-20 12:20:33,719 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:20:40,930 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_361.jpg
2025-03-20 12:20:40,934 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_361.jpg
2025-03-20 12:20:40,934 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:20:40,934 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:20:40,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:20:41,104 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 12:20:51,052 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:20:51,053 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:20:51,054 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:20:51,156 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{4fb717c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1270}
    * Task{9ba3a5a #1270 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:20:51,156 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:20:51,156 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 12:20:51,156 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:20:51,156 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_122051_20250320_122051.png
2025-03-20 12:20:53,052 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_122051_20250320_122051.png
2025-03-20 12:20:53,052 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_122051_20250320_122051.png
2025-03-20 12:20:53,052 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:20:57,766 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_361.jpg
2025-03-20 12:20:57,771 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_361.jpg
2025-03-20 12:20:57,771 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:20:57,771 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:20:57,771 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:20:57,771 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:20:59,873 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 12:20:59,873 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 12:20:59,874 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 12:20:59,874 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 12:21:00,875 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 12:21:01,880 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 12:21:01,881 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 12:21:01,881 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 124.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 12:21:01,883 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 12:21:11,888 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121959.mp4 (大小: 3.44MB)
2025-03-20 12:21:11,889 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 12:21:12,002 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.108222秒，无需修复
2025-03-20 12:21:12,002 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 12:21:12,002 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_121959.mp4
2025-03-20 12:21:12,002 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 12:21:19,124 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_362.mp4
2025-03-20 12:21:19,131 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_362.mp4
2025-03-20 12:21:19,132 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:21:19,132 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:21:24,328 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:21:24,330 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_362.mp4
2025-03-20 12:21:24,330 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:21:24,330 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:21:24,330 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:21:24,644 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:21:25,649 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:21:25,650 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:21:25,650 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:21:26,735 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:21:26,736 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:21:26,736 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:21:28,821 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:21:28,823 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:21:29,937 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:21:29,937 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:21:29,938 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:21:31,035 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:21:31,036 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 12:21:31,036 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 12:21:31,037 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 12:19:13\n- 结束时间: 2025-03-20 12:21:31\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_361.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_361.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_362.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:21:31"}]}]}}
2025-03-20 12:21:31,521 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 12:21:31,526 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:26:31,586 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:26:31,588 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:26:31,588 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:26:31,588 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:26:31,682 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 12:26:31,760 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 12:26:31,760 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 12:26:31,760 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:26:31,760 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:26:31,897 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:26:31,898 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:26:31,898 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:26:31,898 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:26:33,308 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:26:33,309 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:26:34,490 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:26:34,490 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:26:34,491 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:26:34,491 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:26:34,491 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:26:34,603 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 12:26:34,603 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 12:26:34,603 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 12:26:34,603 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 12:26:35,974 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:26:35,975 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:26:37,153 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 12:26:37,153 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:26:37,153 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:26:37,153 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:26:37,153 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:26:38,224 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:26:38,225 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:26:38,325 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 12:26:40,330 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:26:40,330 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:26:41,419 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:26:41,420 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:26:41,420 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:26:41,420 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:26:41,496 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:26:43,505 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:26:43,506 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:26:45,606 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:26:45,607 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:26:47,683 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:26:47,683 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:26:48,779 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:26:48,781 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:26:48,781 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:26:48,781 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:26:48,857 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:26:50,867 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:26:50,868 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:26:52,970 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:26:52,971 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:26:54,355 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:26:55,759 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:26:55,760 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:26:56,879 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:26:56,879 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:26:57,950 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:26:57,951 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:27:00,063 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:27:00,065 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:27:00,065 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:27:00,065 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:27:00,065 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:27:01,177 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:27:01,177 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:27:01,270 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 12:27:06,275 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:27:06,276 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:27:08,385 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:27:08,386 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:27:13,491 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:27:13,492 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:27:15,619 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:27:20,625 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:27:20,626 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_122720.mp4
2025-03-20 12:27:20,626 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:27:20,626 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:27:25,883 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:27:25,885 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:27:25,931 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 12:27:27,069 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_122720.mp4
2025-03-20 12:27:27,070 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_122720.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 12:27:29,078 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 12:27:32,084 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 12:27:32,084 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 12:27:35,089 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:27:35,090 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:27:35,090 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:27:36,202 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:27:36,202 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:27:36,203 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:27:36,203 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:27:36,272 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 12:27:38,282 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:27:38,284 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:27:38,284 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:27:40,511 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:27:40,511 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:27:48,624 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:27:48,625 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:27:48,625 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:27:48,625 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:48,905 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:27:48,905 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:49,136 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:27:49,137 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:49,406 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:27:49,407 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:49,635 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:27:49,636 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:49,833 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:27:49,834 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:50,067 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:27:50,067 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:50,305 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:27:50,305 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:50,542 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:27:50,543 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:50,774 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:27:50,775 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:27:53,003 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:27:53,004 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:27:53,004 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:27:53,098 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2e8e11d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1276}
    * Task{b25dd63 #1276 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:27:53,098 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:27:53,098 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 12:27:53,098 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:27:53,098 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_122753_20250320_122753.png
2025-03-20 12:27:54,558 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_122753_20250320_122753.png
2025-03-20 12:27:54,558 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_122753_20250320_122753.png
2025-03-20 12:27:54,558 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:28:01,596 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_363.jpg
2025-03-20 12:28:01,601 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_363.jpg
2025-03-20 12:28:01,601 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:28:01,602 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:28:01,602 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:28:02,174 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 12:28:11,718 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:28:11,719 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:28:11,719 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:28:11,829 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{2e8e11d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1276}
    * Task{b25dd63 #1276 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 12:28:11,830 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 12:28:11,831 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 12:28:11,831 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:28:11,831 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_122811_20250320_122811.png
2025-03-20 12:28:13,283 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_122811_20250320_122811.png
2025-03-20 12:28:13,284 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_122811_20250320_122811.png
2025-03-20 12:28:13,284 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 12:28:17,775 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_363.jpg
2025-03-20 12:28:17,780 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_363.jpg
2025-03-20 12:28:17,780 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:28:17,781 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:28:17,781 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:28:17,781 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:28:19,880 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 12:28:19,881 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 12:28:19,881 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 12:28:19,882 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 12:28:20,883 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 12:28:21,888 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 12:28:21,888 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 12:28:21,888 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 12:28:21,889 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 12:28:31,891 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_122720.mp4 (大小: 3.62MB)
2025-03-20 12:28:31,892 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 12:28:32,044 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.977578秒，无需修复
2025-03-20 12:28:32,044 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 12:28:32,044 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_122720.mp4
2025-03-20 12:28:32,044 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 12:28:39,209 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_364.mp4
2025-03-20 12:28:39,218 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_364.mp4
2025-03-20 12:28:39,218 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:28:39,218 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:28:44,416 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:28:44,418 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_364.mp4
2025-03-20 12:28:44,418 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:28:44,418 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:28:44,418 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:28:44,807 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:28:45,811 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:28:45,812 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:28:45,812 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:28:46,895 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:28:46,896 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:28:46,896 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:28:48,956 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:28:48,957 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:28:50,068 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:28:50,069 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:28:50,069 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:28:51,164 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:28:51,165 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 12:28:51,165 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 12:28:51,166 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 12:26:34\n- 结束时间: 2025-03-20 12:28:51\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_363.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_363.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_364.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:28:51"}]}]}}
2025-03-20 12:28:51,695 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 12:28:51,698 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:33:51,778 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:33:51,782 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:33:51,782 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:33:51,782 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:33:51,879 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 12:33:51,879 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 12:33:51,879 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 12:33:51,879 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:33:51,879 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:33:51,894 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:33:51,909 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:33:51,909 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:33:51,909 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:33:51,909 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:33:51,909 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:33:53,928 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:33:53,972 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:33:53,997 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:33:53,997 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:33:53,997 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:33:53,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:33:56,019 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:33:56,065 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:33:56,092 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:33:56,092 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:33:56,092 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:33:56,092 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:33:56,092 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:33:56,092 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:33:56,092 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:33:56,092 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:33:56,111 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:33:56,127 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:33:56,127 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:33:56,127 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:33:56,127 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:33:56,127 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:33:58,147 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:33:58,194 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:33:58,219 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:33:58,220 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:33:58,220 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:33:58,220 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:34:00,243 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:34:00,289 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:34:00,315 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:34:00,315 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:34:00,315 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:34:00,315 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:34:00,315 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:34:00,315 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:34:00,315 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:34:00,315 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:34:01,337 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:34:01,338 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:34:01,380 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:34:03,385 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:34:03,386 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:34:04,436 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:34:04,436 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:34:04,437 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:34:04,437 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:34:04,483 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:34:04,483 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 12:34:06,517 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:34:06,518 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:34:08,570 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:34:08,571 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:34:10,619 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:34:10,620 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:34:11,670 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:34:11,670 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:34:11,670 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:34:11,670 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:34:11,719 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:34:11,719 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 12:34:13,756 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:34:13,757 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:34:15,806 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:34:15,807 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:34:16,859 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:34:17,902 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:34:17,902 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:34:18,953 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:34:18,954 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:34:20,002 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:34:20,003 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:34:22,053 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:34:22,054 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:34:22,054 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:34:22,054 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:34:22,054 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:34:23,112 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:34:23,113 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:34:23,156 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:34:28,161 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:34:28,162 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:34:30,208 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:34:30,209 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:34:35,259 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:34:35,260 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:34:37,311 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:34:42,317 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:34:42,317 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_123442.mp4
2025-03-20 12:34:42,317 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:34:42,318 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:34:47,459 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:34:47,461 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:34:47,504 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 12:34:47,504 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 12:34:47,504 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:34:47,504 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:34:47,504 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:34:48,534 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:34:48,535 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:34:48,536 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:34:48,536 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:34:48,579 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:34:48,580 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 12:34:50,608 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:34:50,609 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:34:50,609 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:34:52,656 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:34:52,657 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:35:00,708 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:35:00,709 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:35:00,709 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:35:00,709 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:00,860 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:35:00,861 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,011 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:35:01,012 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,160 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:35:01,160 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,310 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:35:01,311 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,460 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:35:01,461 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,611 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:35:01,612 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,761 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:35:01,762 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:01,910 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:35:01,912 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:02,059 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:35:02,060 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:35:04,213 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:35:04,213 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:35:04,213 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:35:04,253 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:35:04,253 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:35:04,254 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 12:35:04,254 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:35:04,254 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_123504_20250320_123504.png
2025-03-20 12:35:04,278 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_123504_20250320_123504.png' returned non-zero exit status 1.
2025-03-20 12:35:04,278 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:35:04,278 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:35:04,278 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:35:14,301 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:35:14,302 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:35:14,302 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:35:14,346 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:35:14,347 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:35:14,347 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 12:35:14,347 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:35:14,347 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_123514_20250320_123514.png
2025-03-20 12:35:14,372 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_123514_20250320_123514.png' returned non-zero exit status 1.
2025-03-20 12:35:14,372 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:35:14,372 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:35:14,372 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:35:14,372 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:35:16,400 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 12:35:16,401 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 12:35:16,401 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:35:16,401 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:35:16,401 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:35:16,448 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:35:17,459 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:35:17,459 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:35:17,459 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:35:18,515 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:35:18,516 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:35:18,516 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:35:20,569 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:35:20,570 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:35:21,624 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:35:21,625 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:35:21,625 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:35:22,674 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:35:22,675 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 12:35:22,675 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 12:35:22,676 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 12:33:56\n- 结束时间: 2025-03-20 12:35:22\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:35:22"}]}]}}
2025-03-20 12:35:23,072 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 12:35:23,074 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:40:23,244 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:40:23,246 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:40:23,247 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:40:23,247 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:40:23,350 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 12:40:23,351 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 12:40:23,351 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 12:40:23,351 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:40:23,351 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:40:23,366 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:40:23,380 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:40:23,381 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:40:23,381 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:40:23,381 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:40:23,381 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:40:25,405 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:40:25,453 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:40:25,478 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:40:25,478 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:40:25,478 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:40:25,478 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:40:27,506 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:40:27,553 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:40:27,579 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:40:27,579 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:40:27,579 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:40:27,579 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:40:27,579 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:40:27,579 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:40:27,579 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:40:27,579 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:40:27,598 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:40:27,614 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:40:27,614 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:40:27,614 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:40:27,614 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:40:27,614 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:40:29,636 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:40:29,683 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:40:29,709 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:40:29,709 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:40:29,709 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:40:29,709 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:40:31,738 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:40:31,786 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:40:31,812 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:40:31,812 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:40:31,812 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:40:31,812 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:40:31,812 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:40:31,812 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:40:31,812 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:40:31,812 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:40:32,840 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:40:32,840 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:40:32,884 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:40:34,895 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:40:34,896 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:40:35,950 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:40:35,951 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:40:35,952 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:40:35,952 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:40:35,997 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:40:35,998 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 12:40:38,043 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:40:38,044 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:40:40,100 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:40:40,100 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:40:42,156 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:40:42,157 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:40:43,212 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:40:43,213 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:40:43,213 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:40:43,213 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:40:43,260 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:40:43,260 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 12:40:45,305 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:40:45,306 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:40:47,362 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:40:47,363 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:40:48,418 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:40:49,474 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:40:49,474 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:40:50,530 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:40:50,530 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:40:51,585 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:40:51,586 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:40:53,639 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:40:53,640 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:40:53,640 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:40:53,641 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:40:53,641 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:40:54,688 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:40:54,689 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:40:54,735 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:40:59,745 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:40:59,746 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:41:01,804 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:41:01,805 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:41:06,858 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:41:06,859 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:41:08,914 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:41:13,924 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:41:13,925 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_124113.mp4
2025-03-20 12:41:13,925 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:41:13,925 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:41:19,079 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:41:19,080 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:41:19,125 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 12:41:19,125 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 12:41:19,125 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:41:19,125 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:41:19,125 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:41:20,160 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:41:20,161 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:41:20,161 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:41:20,161 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:41:20,205 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:41:20,206 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 12:41:22,251 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:41:22,252 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:41:22,252 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:41:24,306 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:41:24,307 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:41:32,361 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:41:32,362 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:41:32,363 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:41:32,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:32,518 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:41:32,519 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:32,672 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:41:32,673 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:32,827 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:41:32,828 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:32,982 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:41:32,983 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:33,138 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:41:33,138 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:33,294 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:41:33,295 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:33,449 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:41:33,450 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:33,603 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:41:33,603 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:33,757 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:41:33,758 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:41:35,920 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:41:35,921 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:41:35,921 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:41:35,966 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:41:35,966 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:41:35,966 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 12:41:35,966 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:41:35,966 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_124135_20250320_124135.png
2025-03-20 12:41:35,992 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_124135_20250320_124135.png' returned non-zero exit status 1.
2025-03-20 12:41:35,992 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:41:35,992 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:41:35,992 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:41:46,020 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:41:46,021 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:41:46,021 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:41:46,066 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:41:46,066 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:41:46,066 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 12:41:46,066 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:41:46,066 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_124146_20250320_124146.png
2025-03-20 12:41:46,092 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_124146_20250320_124146.png' returned non-zero exit status 1.
2025-03-20 12:41:46,092 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:41:46,092 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:41:46,092 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:41:46,092 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:41:48,120 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 12:41:48,121 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 12:41:48,121 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:41:48,121 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:41:48,121 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:41:48,169 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:41:49,179 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:41:49,180 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:41:49,180 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:41:50,232 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:41:50,233 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:41:50,234 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:41:52,287 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:41:52,288 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:41:53,342 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:41:53,342 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:41:53,343 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:41:54,401 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:41:54,402 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 12:41:54,402 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 12:41:54,402 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 12:40:27\n- 结束时间: 2025-03-20 12:41:54\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:41:54"}]}]}}
2025-03-20 12:41:54,809 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 12:41:54,812 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:46:55,058 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:46:55,060 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:46:55,061 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:46:55,061 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:46:55,163 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 12:46:55,163 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 12:46:55,163 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 12:46:55,163 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:46:55,163 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:46:55,178 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:46:55,193 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:46:55,193 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:46:55,193 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:46:55,193 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:46:55,193 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:46:57,218 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:46:57,266 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:46:57,293 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:46:57,293 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:46:57,293 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:46:57,293 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:46:59,322 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:46:59,366 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:46:59,392 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:46:59,392 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:46:59,392 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:46:59,392 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:46:59,392 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:46:59,392 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:46:59,392 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:46:59,392 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:46:59,410 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:46:59,424 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:46:59,424 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:46:59,424 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:46:59,425 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:46:59,425 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:47:01,449 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:47:01,495 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:47:01,519 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:47:01,519 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:47:01,519 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:47:01,519 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:47:03,547 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:47:03,594 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:47:03,619 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:47:03,619 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:47:03,619 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:47:03,620 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:47:03,620 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:47:03,620 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:47:03,620 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:47:03,620 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:47:04,643 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:47:04,643 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:47:04,678 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:47:06,689 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:47:06,689 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:47:07,748 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:47:07,749 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:47:07,749 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:47:07,749 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:47:07,795 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:47:07,796 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 12:47:09,841 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:47:09,842 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:47:11,899 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:47:11,900 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:47:13,947 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:47:13,948 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:47:15,004 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:47:15,005 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:47:15,005 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:47:15,005 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:47:15,050 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:47:15,050 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 12:47:17,095 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:47:17,096 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:47:19,152 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:47:19,153 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:47:20,207 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:47:21,263 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:47:21,264 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:47:22,319 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:47:22,320 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:47:23,373 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:47:23,374 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:47:25,431 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:47:25,432 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:47:25,432 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:47:25,432 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:47:25,432 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:47:26,487 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:47:26,487 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:47:26,530 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:47:31,540 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:47:31,541 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:47:33,598 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:47:33,599 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:47:38,654 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:47:38,655 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:47:40,711 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:47:45,720 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:47:45,721 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_124745.mp4
2025-03-20 12:47:45,721 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:47:45,721 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:47:50,873 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:47:50,874 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:47:50,920 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 12:47:50,920 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 12:47:50,920 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:47:50,920 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:47:50,920 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:47:51,947 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:47:51,947 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:47:51,948 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:47:51,948 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:47:51,992 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:47:51,992 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 12:47:54,035 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:47:54,035 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:47:54,036 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:47:56,086 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:47:56,087 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:48:04,141 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:48:04,142 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:48:04,142 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:48:04,142 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:04,273 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:48:04,274 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:04,408 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:48:04,408 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:04,559 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:48:04,560 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:04,714 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:48:04,714 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:04,848 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:48:04,848 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:04,992 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:48:04,992 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:05,148 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:48:05,149 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:05,302 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:48:05,303 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:05,459 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:48:05,460 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:48:07,622 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:48:07,623 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:48:07,623 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:48:07,668 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:48:07,669 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:48:07,669 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 12:48:07,669 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:48:07,669 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_124807_20250320_124807.png
2025-03-20 12:48:07,694 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_124807_20250320_124807.png' returned non-zero exit status 1.
2025-03-20 12:48:07,694 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:48:07,694 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:48:07,694 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:48:17,722 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:48:17,723 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:48:17,723 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:48:17,768 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:48:17,768 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:48:17,768 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 12:48:17,768 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:48:17,768 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_124817_20250320_124817.png
2025-03-20 12:48:17,793 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_124817_20250320_124817.png' returned non-zero exit status 1.
2025-03-20 12:48:17,793 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:48:17,793 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:48:17,793 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:48:17,793 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:48:19,820 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 12:48:19,821 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 12:48:19,821 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:48:19,821 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:48:19,821 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:48:19,866 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:48:20,877 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:48:20,877 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:48:20,877 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:48:21,933 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:48:21,934 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:48:21,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:48:23,990 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:48:23,991 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:48:25,049 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:48:25,050 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:48:25,050 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:48:26,105 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:48:26,106 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 12:48:26,106 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 12:48:26,107 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 12:46:59\n- 结束时间: 2025-03-20 12:48:26\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:48:26"}]}]}}
2025-03-20 12:48:26,501 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 12:48:26,505 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:53:26,679 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:53:26,679 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:53:26,679 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:53:26,679 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:53:26,774 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 12:53:26,774 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 12:53:26,775 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 12:53:26,775 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:53:26,775 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:53:26,790 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:53:26,805 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:53:26,805 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:53:26,805 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:53:26,805 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:53:26,805 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:53:28,829 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:53:28,877 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:53:28,904 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:53:28,904 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:53:28,904 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:53:28,904 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:53:30,930 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:53:30,975 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:53:31,002 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:53:31,002 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:53:31,003 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:53:31,003 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:53:31,003 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 12:53:31,003 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 12:53:31,003 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:53:31,003 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:53:31,024 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:53:31,040 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:53:31,040 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:53:31,040 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:53:31,040 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:53:31,040 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 12:53:33,063 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:53:33,109 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:53:33,134 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:53:33,135 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 12:53:33,135 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 12:53:33,135 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 12:53:35,163 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:53:35,208 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:53:35,233 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:53:35,233 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 12:53:35,233 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 12:53:35,233 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 12:53:35,233 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 12:53:35,233 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:53:35,233 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:53:35,233 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:53:36,260 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 12:53:36,261 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 12:53:36,308 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:53:38,318 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 12:53:38,319 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 12:53:39,374 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 12:53:39,375 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 12:53:39,375 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:53:39,375 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 12:53:39,419 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:53:39,419 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 12:53:41,454 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 12:53:41,455 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 12:53:43,511 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 12:53:43,512 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 12:53:45,568 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 12:53:45,569 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 12:53:46,624 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 12:53:46,625 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 12:53:46,625 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:53:46,625 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 12:53:46,668 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:53:46,668 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 12:53:48,712 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 12:53:48,713 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 12:53:50,761 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 12:53:50,761 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 12:53:51,817 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 12:53:52,871 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 12:53:52,872 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 12:53:53,915 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 12:53:53,915 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 12:53:54,971 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 12:53:54,972 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 12:53:57,025 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 12:53:57,026 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 12:53:57,026 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 12:53:57,026 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:53:57,026 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:53:58,080 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 12:53:58,081 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 12:53:58,124 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:54:03,134 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 12:54:03,135 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 12:54:05,188 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 12:54:05,189 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 12:54:10,245 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 12:54:10,246 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 12:54:12,302 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 12:54:17,311 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 12:54:17,312 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_125417.mp4
2025-03-20 12:54:17,312 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 12:54:17,312 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 12:54:22,471 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 12:54:22,472 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 12:54:22,514 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 12:54:22,514 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 12:54:22,514 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 12:54:22,515 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 12:54:22,515 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 12:54:23,550 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 12:54:23,551 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 12:54:23,552 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 12:54:23,552 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 12:54:23,597 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 12:54:23,597 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 12:54:25,640 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 12:54:25,641 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 12:54:25,642 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 12:54:27,694 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 12:54:27,695 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 12:54:35,752 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 12:54:35,753 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 12:54:35,753 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 12:54:35,753 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:35,908 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 12:54:35,908 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,064 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 12:54:36,064 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,217 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 12:54:36,218 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,374 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 12:54:36,374 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,530 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 12:54:36,531 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,687 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 12:54:36,688 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,843 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 12:54:36,844 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:36,995 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 12:54:36,995 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:37,151 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 12:54:37,152 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 12:54:39,315 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 12:54:39,316 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:54:39,316 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:54:39,362 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:54:39,362 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:54:39,362 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 12:54:39,362 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 12:54:39,362 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_125439_20250320_125439.png
2025-03-20 12:54:39,387 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_125439_20250320_125439.png' returned non-zero exit status 1.
2025-03-20 12:54:39,387 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 12:54:39,387 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:54:39,387 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:54:49,415 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 12:54:49,416 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 12:54:49,416 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 12:54:49,462 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:54:49,462 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 12:54:49,462 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 12:54:49,462 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 12:54:49,463 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_125449_20250320_125449.png
2025-03-20 12:54:49,487 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_125449_20250320_125449.png' returned non-zero exit status 1.
2025-03-20 12:54:49,488 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 12:54:49,488 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 12:54:49,488 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:54:49,488 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:54:51,516 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 12:54:51,517 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 12:54:51,517 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 12:54:51,517 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 12:54:51,517 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 12:54:51,562 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 12:54:52,572 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 12:54:52,573 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:54:52,573 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:54:53,626 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 12:54:53,627 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 12:54:53,627 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 12:54:55,682 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 12:54:55,683 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 12:54:56,738 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 12:54:56,739 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 12:54:56,739 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 12:54:57,792 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 12:54:57,792 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 12:54:57,792 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 12:54:57,793 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 12:53:31\n- 结束时间: 2025-03-20 12:54:57\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 12:54:57"}]}]}}
2025-03-20 12:54:58,176 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 12:54:58,179 - QuickAppADBTester - INFO - 测试完成
2025-03-20 12:59:58,371 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 12:59:58,371 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 12:59:58,371 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 12:59:58,372 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 12:59:58,474 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 12:59:58,474 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 12:59:58,474 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 12:59:58,474 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 12:59:58,474 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 12:59:58,489 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 12:59:58,504 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 12:59:58,504 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 12:59:58,504 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 12:59:58,504 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 12:59:58,504 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:00:00,529 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:00:00,575 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:00:00,601 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:00:00,601 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:00:00,601 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:00:00,601 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:00:02,629 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:00:02,676 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:00:02,702 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:00:02,702 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:00:02,702 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:00:02,702 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:00:02,702 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:00:02,702 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:00:02,702 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:00:02,702 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:00:02,721 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:00:02,738 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:00:02,738 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:00:02,738 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:00:02,738 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:00:02,738 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:00:04,762 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:00:04,786 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:00:04,804 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:00:04,804 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:00:04,804 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:00:04,804 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:00:06,830 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:00:06,876 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:00:06,903 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:00:06,903 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:00:06,903 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:00:06,903 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:00:06,903 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:00:06,903 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:00:06,903 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:00:06,903 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:00:07,931 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:00:07,931 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:00:07,976 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:00:09,982 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:00:09,982 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:00:11,037 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:00:11,038 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:00:11,038 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:00:11,039 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:00:11,084 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:00:11,084 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 13:00:13,130 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:00:13,131 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:00:15,185 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:00:15,186 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:00:17,241 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:00:17,242 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:00:18,295 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:00:18,296 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:00:18,296 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:00:18,296 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:00:18,340 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:00:18,340 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 13:00:20,386 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:00:20,387 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:00:22,444 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:00:22,445 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:00:23,497 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:00:24,554 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:00:24,555 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:00:25,608 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:00:25,609 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:00:26,664 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:00:26,665 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:00:28,719 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:00:28,720 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:00:28,720 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:00:28,720 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:00:28,720 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:00:29,777 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:00:29,778 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:00:29,821 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:00:34,832 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:00:34,832 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:00:36,874 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:00:36,875 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:00:41,929 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:00:41,930 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:00:43,982 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:00:48,988 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:00:48,988 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_130048.mp4
2025-03-20 13:00:48,988 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:00:48,989 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:00:54,143 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:00:54,144 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:00:54,188 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 13:00:54,188 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 13:00:54,188 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:00:54,188 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:00:54,188 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:00:55,223 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:00:55,224 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:00:55,224 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:00:55,224 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:00:55,268 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:00:55,269 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 13:00:57,312 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:00:57,313 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:00:57,313 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:00:59,368 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:00:59,368 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:01:07,424 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:01:07,425 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:01:07,426 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:01:07,426 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:07,579 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:01:07,580 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:07,735 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:01:07,736 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:07,885 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:01:07,885 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:08,039 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:01:08,039 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:08,193 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:01:08,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:08,349 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:01:08,350 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:08,499 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:01:08,500 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:08,656 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:01:08,657 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:08,812 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:01:08,813 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:01:10,975 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:01:10,976 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:01:10,976 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:01:11,018 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:01:11,019 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:01:11,019 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 13:01:11,019 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:01:11,019 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_130111_20250320_130111.png
2025-03-20 13:01:11,045 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_130111_20250320_130111.png' returned non-zero exit status 1.
2025-03-20 13:01:11,045 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:01:11,045 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:01:11,045 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:01:21,074 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:01:21,075 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:01:21,075 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:01:21,112 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:01:21,112 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:01:21,112 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 13:01:21,112 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:01:21,112 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_130121_20250320_130121.png
2025-03-20 13:01:21,128 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_130121_20250320_130121.png' returned non-zero exit status 1.
2025-03-20 13:01:21,129 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:01:21,129 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:01:21,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:01:21,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:01:23,151 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 13:01:23,151 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 13:01:23,152 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:01:23,152 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:01:23,152 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:01:23,195 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:01:24,206 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:01:24,206 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:01:24,207 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:01:25,262 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:01:25,263 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:01:25,263 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:01:27,318 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:01:27,318 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:01:28,375 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:01:28,376 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:01:28,376 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:01:29,432 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:01:29,433 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 13:01:29,433 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 13:01:29,433 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 13:00:02\n- 结束时间: 2025-03-20 13:01:29\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:01:29"}]}]}}
2025-03-20 13:01:29,866 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 13:01:29,869 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:06:30,111 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:06:30,112 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:06:30,112 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:06:30,112 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:06:30,215 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 13:06:30,215 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 13:06:30,215 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 13:06:30,215 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:06:30,215 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:06:30,230 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:06:30,245 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:06:30,245 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:06:30,245 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:06:30,245 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:06:30,245 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:06:32,268 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:06:32,304 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:06:32,329 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:06:32,330 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:06:32,330 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:06:32,330 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:06:34,358 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:06:34,407 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:06:34,432 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:06:34,432 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:06:34,432 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:06:34,432 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:06:34,432 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:06:34,432 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:06:34,432 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:06:34,432 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:06:34,450 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:06:34,465 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:06:34,465 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:06:34,465 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:06:34,465 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:06:34,465 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:06:36,490 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:06:36,538 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:06:36,564 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:06:36,564 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:06:36,564 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:06:36,564 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:06:38,592 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:06:38,637 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:06:38,661 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:06:38,662 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:06:38,662 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:06:38,662 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:06:38,662 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:06:38,662 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:06:38,662 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:06:38,662 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:06:39,689 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:06:39,690 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:06:39,735 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:06:41,745 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:06:41,746 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:06:42,799 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:06:42,800 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:06:42,800 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:06:42,800 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:06:42,848 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:06:42,848 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 13:06:44,892 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:06:44,893 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:06:46,949 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:06:46,950 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:06:49,002 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:06:49,003 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:06:50,060 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:06:50,061 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:06:50,061 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:06:50,062 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:06:50,106 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:06:50,106 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 13:06:52,149 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:06:52,149 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:06:54,203 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:06:54,203 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:06:55,261 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:06:56,315 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:06:56,316 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:06:57,370 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:06:57,370 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:06:58,426 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:06:58,426 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:07:00,481 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:07:00,482 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:07:00,482 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:07:00,482 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:07:00,482 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:07:01,539 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:07:01,539 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:07:01,582 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:07:06,593 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:07:06,594 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:07:08,649 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:07:08,650 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:07:13,707 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:07:13,707 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:07:15,765 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:07:20,774 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:07:20,775 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_130720.mp4
2025-03-20 13:07:20,775 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:07:20,775 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:07:25,934 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:07:25,935 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:07:25,979 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 13:07:25,979 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 13:07:25,979 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:07:25,979 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:07:25,979 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:07:27,015 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:07:27,016 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:07:27,016 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:07:27,016 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:07:27,058 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:07:27,058 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 13:07:29,102 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:07:29,103 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:07:29,103 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:07:31,159 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:07:31,160 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:07:39,215 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:07:39,215 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:07:39,216 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:07:39,216 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:39,369 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:07:39,370 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:39,527 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:07:39,528 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:39,683 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:07:39,684 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:39,834 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:07:39,835 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:39,988 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:07:39,989 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:40,143 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:07:40,144 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:40,298 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:07:40,299 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:40,454 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:07:40,454 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:40,609 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:07:40,610 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:07:42,777 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:07:42,778 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:07:42,778 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:07:42,823 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:07:42,823 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:07:42,823 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 13:07:42,823 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:07:42,823 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_130742_20250320_130742.png
2025-03-20 13:07:42,847 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_130742_20250320_130742.png' returned non-zero exit status 1.
2025-03-20 13:07:42,847 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:07:42,847 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:07:42,847 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:07:52,875 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:07:52,876 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:07:52,876 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:07:52,901 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:07:52,901 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:07:52,901 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 13:07:52,901 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:07:52,901 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_130752_20250320_130752.png
2025-03-20 13:07:52,918 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_130752_20250320_130752.png' returned non-zero exit status 1.
2025-03-20 13:07:52,918 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:07:52,918 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:07:52,918 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:07:52,918 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:07:54,943 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 13:07:54,944 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 13:07:54,944 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:07:54,944 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:07:54,944 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:07:54,989 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:07:56,000 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:07:56,000 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:07:56,000 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:07:57,054 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:07:57,055 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:07:57,055 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:07:59,109 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:07:59,110 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:08:00,163 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:08:00,164 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:08:00,164 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:08:01,219 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:08:01,220 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 13:08:01,220 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 13:08:01,221 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 13:06:34\n- 结束时间: 2025-03-20 13:08:01\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:08:01"}]}]}}
2025-03-20 13:08:01,628 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 13:08:01,632 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:13:01,843 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:13:01,844 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:13:01,844 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:13:01,844 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:13:01,949 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 13:13:01,950 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 13:13:01,950 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 13:13:01,950 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:13:01,950 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:13:01,964 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:13:01,979 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:13:01,979 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:13:01,979 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:13:01,979 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:13:01,979 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:13:04,004 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:13:04,052 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:13:04,078 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:13:04,078 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:13:04,078 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:13:04,078 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:13:06,106 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:13:06,153 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:13:06,179 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:13:06,180 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:13:06,180 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:13:06,180 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:13:06,180 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:13:06,180 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:13:06,180 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:13:06,180 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:13:06,198 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:13:06,214 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:13:06,214 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:13:06,214 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:13:06,214 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:13:06,214 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:13:08,239 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:13:08,283 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:13:08,308 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:13:08,309 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:13:08,309 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:13:08,309 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:13:10,336 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:13:10,382 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:13:10,408 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:13:10,408 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:13:10,408 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:13:10,408 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:13:10,408 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:13:10,408 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:13:10,408 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:13:10,408 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:13:11,437 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:13:11,438 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:13:11,478 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:13:13,489 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:13:13,489 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:13:14,545 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:13:14,546 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:13:14,546 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:13:14,546 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:13:14,591 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:13:14,591 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 13:13:16,628 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:13:16,628 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:13:18,682 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:13:18,683 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:13:20,737 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:13:20,738 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:13:21,792 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:13:21,793 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:13:21,793 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:13:21,793 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:13:21,838 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:13:21,838 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 13:13:23,884 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:13:23,885 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:13:25,941 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:13:25,942 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:13:26,997 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:13:28,052 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:13:28,053 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:13:29,107 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:13:29,108 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:13:30,163 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:13:30,164 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:13:32,218 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:13:32,219 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:13:32,219 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:13:32,219 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:13:32,219 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:13:33,273 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:13:33,274 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:13:33,318 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:13:38,328 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:13:38,329 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:13:40,385 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:13:40,386 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:13:45,439 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:13:45,440 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:13:47,496 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:13:52,498 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:13:52,499 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_131352.mp4
2025-03-20 13:13:52,499 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:13:52,499 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:13:57,653 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:13:57,654 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:13:57,697 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 13:13:57,697 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 13:13:57,697 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:13:57,697 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:13:57,697 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:13:58,732 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:13:58,733 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:13:58,733 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:13:58,734 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:13:58,776 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:13:58,776 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 13:14:00,820 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:14:00,820 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:14:00,821 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:14:02,872 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:14:02,873 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:14:10,929 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:14:10,930 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:14:10,931 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:14:10,931 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:11,084 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:14:11,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:11,239 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:14:11,240 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:11,396 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:14:11,396 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:11,549 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:14:11,550 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:11,707 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:14:11,707 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:11,864 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:14:11,865 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:12,029 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:14:12,030 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:12,173 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:14:12,174 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:12,330 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:14:12,331 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:14:14,489 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:14:14,489 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:14:14,490 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:14:14,513 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:14:14,513 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:14:14,513 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 13:14:14,513 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:14:14,513 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_131414_20250320_131414.png
2025-03-20 13:14:14,537 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_131414_20250320_131414.png' returned non-zero exit status 1.
2025-03-20 13:14:14,537 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:14:14,537 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:14:14,537 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:14:24,570 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:14:24,571 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:14:24,571 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:14:24,602 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:14:24,602 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:14:24,602 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 13:14:24,602 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:14:24,603 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_131424_20250320_131424.png
2025-03-20 13:14:24,618 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_131424_20250320_131424.png' returned non-zero exit status 1.
2025-03-20 13:14:24,618 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:14:24,618 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:14:24,618 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:14:24,618 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:14:26,644 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 13:14:26,644 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 13:14:26,644 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:14:26,644 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:14:26,644 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:14:26,685 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:14:27,696 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:14:27,696 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:14:27,696 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:14:28,752 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:14:28,753 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:14:28,753 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:14:30,809 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:14:30,809 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:14:31,866 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:14:31,867 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:14:31,867 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:14:32,921 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:14:32,922 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 13:14:32,923 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 13:14:32,923 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 13:13:06\n- 结束时间: 2025-03-20 13:14:32\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:14:32"}]}]}}
2025-03-20 13:14:33,340 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 13:14:33,342 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:19:33,618 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:19:33,618 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:19:33,618 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:19:33,619 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:19:33,718 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 13:19:33,718 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 13:19:33,718 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 13:19:33,718 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:19:33,718 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:19:33,732 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:19:33,747 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:19:33,747 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:19:33,747 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:19:33,747 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:19:33,747 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:19:35,772 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:19:35,818 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:19:35,843 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:19:35,843 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:19:35,843 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:19:35,843 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:19:37,871 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:19:37,919 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:19:37,945 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:19:37,945 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:19:37,945 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:19:37,945 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:19:37,945 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:19:37,945 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:19:37,945 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:19:37,945 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:19:37,964 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:19:37,980 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:19:37,980 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:19:37,980 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:19:37,980 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:19:37,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:19:40,004 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:19:40,051 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:19:40,077 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:19:40,077 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:19:40,077 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:19:40,077 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:19:42,105 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:19:42,152 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:19:42,178 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:19:42,178 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:19:42,178 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:19:42,178 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:19:42,178 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:19:42,178 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:19:42,178 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:19:42,178 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:19:43,207 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:19:43,207 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:19:43,252 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:19:45,262 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:19:45,263 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:19:46,318 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:19:46,319 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:19:46,319 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:19:46,319 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:19:46,365 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:19:46,365 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 13:19:48,408 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:19:48,409 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:19:50,464 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:19:50,465 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:19:52,521 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:19:52,522 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:19:53,574 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:19:53,575 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:19:53,575 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:19:53,575 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:19:53,619 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:19:53,620 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 13:19:55,660 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:19:55,660 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:19:57,715 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:19:57,716 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:19:58,772 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:19:59,829 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:19:59,829 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:20:00,884 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:20:00,885 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:20:01,941 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:20:01,942 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:20:03,996 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:20:03,997 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:20:03,997 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:20:03,997 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:20:03,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:20:05,053 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:20:05,054 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:20:05,099 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:20:10,109 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:20:10,110 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:20:12,167 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:20:12,168 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:20:17,225 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:20:17,226 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:20:19,281 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:20:24,290 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:20:24,291 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_132024.mp4
2025-03-20 13:20:24,291 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:20:24,291 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:20:29,447 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:20:29,447 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:20:29,492 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 13:20:29,493 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 13:20:29,493 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:20:29,493 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:20:29,493 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:20:30,528 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:20:30,529 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:20:30,529 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:20:30,529 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:20:30,575 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:20:30,575 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 13:20:32,615 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:20:32,616 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:20:32,616 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:20:34,670 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:20:34,671 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:20:42,728 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:20:42,728 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:20:42,728 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:20:42,729 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:42,885 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:20:42,886 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,038 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:20:43,039 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,193 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:20:43,194 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,350 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:20:43,351 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,507 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:20:43,508 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,663 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:20:43,664 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,818 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:20:43,819 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:43,974 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:20:43,974 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:44,131 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:20:44,132 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:20:46,292 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:20:46,293 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:20:46,293 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:20:46,337 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:20:46,337 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:20:46,337 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 13:20:46,337 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:20:46,337 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_132046_20250320_132046.png
2025-03-20 13:20:46,363 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_132046_20250320_132046.png' returned non-zero exit status 1.
2025-03-20 13:20:46,364 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:20:46,364 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:20:46,364 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:20:56,393 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:20:56,393 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:20:56,394 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:20:56,441 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:20:56,441 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:20:56,441 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 13:20:56,441 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:20:56,441 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_132056_20250320_132056.png
2025-03-20 13:20:56,466 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_132056_20250320_132056.png' returned non-zero exit status 1.
2025-03-20 13:20:56,466 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:20:56,466 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:20:56,466 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:20:56,466 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:20:58,495 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 13:20:58,495 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 13:20:58,495 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:20:58,495 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:20:58,495 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:20:58,542 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:20:59,552 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:20:59,553 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:20:59,553 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:21:00,609 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:21:00,610 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:21:00,610 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:21:02,663 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:21:02,664 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:21:03,720 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:21:03,721 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:21:03,722 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:21:04,777 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:21:04,778 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 13:21:04,779 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 13:21:04,779 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 13:19:37\n- 结束时间: 2025-03-20 13:21:04\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:21:04"}]}]}}
2025-03-20 13:21:05,180 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 13:21:05,182 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:26:05,348 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:26:05,350 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:26:05,350 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:26:05,350 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:26:05,441 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 13:26:05,441 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 13:26:05,441 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 13:26:05,441 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:26:05,441 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:26:05,457 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:26:05,471 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:26:05,471 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:26:05,471 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:26:05,471 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:26:05,471 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:26:07,490 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:26:07,533 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:26:07,558 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:26:07,558 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:26:07,558 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:26:07,558 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:26:09,582 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:26:09,628 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:26:09,654 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:26:09,654 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:26:09,654 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:26:09,654 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:26:09,654 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:26:09,654 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:26:09,654 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:26:09,654 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:26:09,673 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:26:09,689 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:26:09,689 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 13:26:09,689 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 13:26:09,689 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 13:26:09,689 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 13:26:11,708 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:26:11,755 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:26:11,780 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:26:11,780 - QuickAppADBTester - WARNING - 电源键唤醒失败，尝试备用方法
2025-03-20 13:26:11,780 - QuickAppADBTester - INFO - 使用WAKEUP键码唤醒
2025-03-20 13:26:11,780 - QuickAppADBTester - INFO - 按下按键: KEYCODE_WAKEUP
2025-03-20 13:26:13,803 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:26:13,849 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 13:26:13,875 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 13:26:13,876 - QuickAppADBTester - WARNING - 所有唤醒方法均失败
2025-03-20 13:26:13,876 - QuickAppADBTester - ERROR - 无法唤醒屏幕
2025-03-20 13:26:13,876 - QuickAppADBTester - WARNING - 无法确保屏幕处于亮屏状态，测试可能失败
2025-03-20 13:26:13,876 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:26:13,876 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:26:13,876 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:26:13,876 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:26:14,899 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:26:14,900 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:26:14,944 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:26:16,949 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:26:16,950 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:26:18,001 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:26:18,002 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:26:18,002 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:26:18,002 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:26:18,045 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:26:18,045 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '应用和服务'
2025-03-20 13:26:20,080 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:26:20,081 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:26:22,130 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:26:22,131 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:26:24,181 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:26:24,182 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:26:25,233 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:26:25,234 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:26:25,235 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:26:25,235 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:26:25,279 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:26:25,279 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '快应用中心'
2025-03-20 13:26:27,314 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:26:27,315 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:26:29,364 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:26:29,365 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:26:30,415 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:26:31,471 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:26:31,472 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:26:32,527 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:26:32,528 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:26:33,577 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:26:33,578 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:26:35,630 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:26:35,631 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:26:35,632 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:26:35,632 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:26:35,632 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:26:36,686 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:26:36,688 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:26:36,732 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:26:41,743 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:26:41,743 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:26:43,800 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:26:43,802 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:26:48,858 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:26:48,859 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:26:50,915 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:26:55,920 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:26:55,921 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_132655.mp4
2025-03-20 13:26:55,921 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:26:55,921 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:27:01,081 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:27:01,083 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:27:01,127 - QuickAppADBTester - ERROR - 未检测到已连接的设备，无法开始录制
2025-03-20 13:27:01,128 - QuickAppADBTester - WARNING - 无法启动scrcpy录制，将继续测试但没有录制
2025-03-20 13:27:01,128 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:27:01,128 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:27:01,128 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:27:02,164 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:27:02,164 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:27:02,164 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:27:02,164 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:27:02,208 - QuickAppADBTester - WARNING - 文本输入广播命令可能未成功发送，尝试备用方法
2025-03-20 13:27:02,209 - QuickAppADBTester - INFO - 执行备用命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg '优购'
2025-03-20 13:27:04,249 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:27:04,249 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:27:04,249 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:27:06,285 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:27:06,286 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:27:14,336 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:27:14,337 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:27:14,338 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:27:14,338 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:14,490 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:27:14,490 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:14,646 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:27:14,647 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:14,803 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:27:14,805 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:14,959 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:27:14,960 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:15,117 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:27:15,118 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:15,272 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:27:15,273 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:15,427 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:27:15,428 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:15,583 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:27:15,584 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:15,738 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:27:15,738 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:27:17,902 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:27:17,903 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:27:17,904 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:27:17,947 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:27:17,947 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:27:17,947 - QuickAppADBTester - WARNING - 侧滑拦截失败：快应用已不在前台运行
2025-03-20 13:27:17,948 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:27:17,948 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_132717_20250320_132717.png
2025-03-20 13:27:17,973 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_swipe_20250320_132717_20250320_132717.png' returned non-zero exit status 1.
2025-03-20 13:27:17,973 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:27:17,973 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:27:17,973 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:27:28,002 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:27:28,002 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:27:28,002 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:27:28,026 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:27:28,026 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 13:27:28,026 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 13:27:28,026 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:27:28,026 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_132728_20250320_132728.png
2025-03-20 13:27:28,042 - QuickAppADBTester - ERROR - 截图失败: Command 'adb shell screencap -p /sdcard/after_home_20250320_132728_20250320_132728.png' returned non-zero exit status 1.
2025-03-20 13:27:28,042 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:27:28,042 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:27:28,042 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:27:28,043 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:27:30,067 - QuickAppADBTester - WARNING - 没有正在进行的录制进程，无法停止
2025-03-20 13:27:30,068 - QuickAppADBTester - WARNING - 无法获取流程3视频URL，可能是录制或上传失败
2025-03-20 13:27:30,069 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:27:30,069 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:27:30,069 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:27:30,114 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:27:31,125 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:27:31,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:27:31,125 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:27:32,183 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:27:32,184 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:27:32,184 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:27:34,236 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:27:34,237 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:27:35,277 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:27:35,278 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:27:35,278 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:27:36,334 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:27:36,336 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': False, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': False, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 13:27:36,336 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 13:27:36,336 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：屏幕唤醒失败、快应用防侧滑测试失败、快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 13:26:09\n- 结束时间: 2025-03-20 13:27:36\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ❌ 失败\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ❌ 失败\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:27:36"}]}]}}
2025-03-20 13:27:36,812 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 13:27:36,815 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:32:37,194 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:32:37,196 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:32:37,197 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:32:37,197 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:32:37,308 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 13:32:37,388 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 13:32:37,388 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 13:32:37,388 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:32:37,388 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:32:37,534 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:32:37,535 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:32:37,535 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:32:37,535 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:32:38,938 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:32:38,939 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:32:40,129 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:32:40,130 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:32:40,130 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:32:40,130 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:32:40,130 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:32:40,254 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:32:40,255 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:32:40,255 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:32:40,255 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:32:41,630 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:32:41,631 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:32:42,782 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:32:42,782 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:32:42,782 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:32:42,782 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:32:42,782 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:32:43,842 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:32:43,843 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:32:43,936 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 13:32:45,942 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:32:45,943 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:32:47,038 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:32:47,039 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:32:47,039 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:32:47,039 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:32:47,118 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:32:49,127 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:32:49,127 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:32:51,239 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:32:51,239 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:32:53,330 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:32:53,331 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:32:54,439 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:32:54,440 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:32:54,441 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:32:54,441 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:32:54,517 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:32:56,525 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:32:56,528 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:32:58,622 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:32:58,623 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:33:00,022 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:33:01,430 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:33:01,431 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:33:02,538 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:33:02,539 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:33:03,625 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:33:03,626 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:33:05,739 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:33:05,740 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:33:05,740 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:33:05,740 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:33:05,740 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:33:06,853 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:33:06,854 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:33:06,958 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 13:33:11,961 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:33:11,962 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:33:14,062 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:33:14,063 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:33:19,158 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:33:19,159 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:33:21,270 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:33:26,273 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:33:26,274 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_133326.mp4
2025-03-20 13:33:26,274 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:33:26,274 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:33:31,536 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:33:31,537 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:33:31,584 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 13:33:32,720 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_133326.mp4
2025-03-20 13:33:32,721 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_133326.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 13:33:34,741 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 13:33:37,745 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 13:33:37,745 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 13:33:40,750 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:33:40,750 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:33:40,751 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:33:41,870 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:33:41,871 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:33:41,871 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:33:41,871 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:33:41,943 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:33:43,953 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:33:43,954 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:33:43,954 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:33:46,159 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:33:46,159 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:33:54,263 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:33:54,265 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:33:54,265 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:33:54,265 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:54,535 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:33:54,536 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:54,762 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:33:54,763 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:55,000 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:33:55,000 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:55,221 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:33:55,222 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:55,433 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:33:55,434 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:55,633 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:33:55,635 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:55,836 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:33:55,837 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:56,054 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:33:56,054 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:56,271 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:33:56,272 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:33:58,495 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:33:58,496 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:33:58,496 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:33:58,579 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{163e4dc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1282}
    * Task{8b94cba #1282 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:33:58,580 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:33:58,580 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 13:33:58,580 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:33:58,580 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_133358_20250320_133358.png
2025-03-20 13:34:00,076 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_133358_20250320_133358.png
2025-03-20 13:34:00,076 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_133358_20250320_133358.png
2025-03-20 13:34:00,076 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:34:07,356 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_365.jpg
2025-03-20 13:34:07,361 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_365.jpg
2025-03-20 13:34:07,362 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:34:07,362 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:34:07,362 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:34:07,844 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 13:34:17,456 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:34:17,456 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:34:17,457 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:34:17,546 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{163e4dc u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1282}
    * Task{8b94cba #1282 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:34:17,547 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:34:17,547 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 13:34:17,547 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:34:17,547 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_133417_20250320_133417.png
2025-03-20 13:34:19,059 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_133417_20250320_133417.png
2025-03-20 13:34:19,059 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_133417_20250320_133417.png
2025-03-20 13:34:19,059 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:34:23,856 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_365.jpg
2025-03-20 13:34:23,861 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_365.jpg
2025-03-20 13:34:23,861 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:34:23,861 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:34:23,861 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:34:23,861 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:34:25,949 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 13:34:25,950 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 13:34:25,950 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 13:34:25,951 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 13:34:26,952 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 13:34:27,953 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 13:34:27,953 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 13:34:27,953 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 153.1 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 13:34:27,953 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 13:34:37,958 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_133326.mp4 (大小: 3.61MB)
2025-03-20 13:34:37,959 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 13:34:38,096 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.370167秒，无需修复
2025-03-20 13:34:38,096 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 13:34:38,096 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_133326.mp4
2025-03-20 13:34:38,096 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 13:34:45,329 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_366.mp4
2025-03-20 13:34:45,335 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_366.mp4
2025-03-20 13:34:45,335 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:34:45,335 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:34:50,529 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:34:50,530 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_366.mp4
2025-03-20 13:34:50,530 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:34:50,531 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:34:50,531 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:34:50,929 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:34:51,933 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:34:51,933 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:34:51,934 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:34:53,017 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:34:53,017 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:34:53,017 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:34:55,083 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:34:55,084 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:34:56,192 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:34:56,193 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:34:56,194 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:34:57,290 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:34:57,291 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 13:34:57,292 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 13:34:57,293 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 13:32:40\n- 结束时间: 2025-03-20 13:34:57\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_365.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_365.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_366.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:34:57"}]}]}}
2025-03-20 13:34:57,751 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 13:34:57,754 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:39:57,834 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:39:57,836 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:39:57,837 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:39:57,837 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:39:57,931 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 13:39:58,007 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 13:39:58,008 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 13:39:58,008 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:39:58,008 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:39:58,132 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:39:58,132 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:39:58,132 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:39:58,132 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:39:59,521 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:39:59,522 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:40:00,683 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:40:00,683 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:40:00,683 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:40:00,683 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:40:00,683 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:40:00,809 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:40:00,809 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:40:00,809 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:40:00,809 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:40:02,186 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:40:02,187 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:40:03,367 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:40:03,368 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:40:03,368 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:40:03,368 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:40:03,368 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:40:04,437 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:40:04,437 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:40:04,516 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 13:40:06,521 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:40:06,522 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:40:07,635 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:40:07,636 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:40:07,636 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:40:07,636 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:40:07,716 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:40:09,727 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:40:09,728 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:40:11,828 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:40:11,828 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:40:13,914 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:40:13,916 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:40:15,029 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:40:15,030 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:40:15,030 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:40:15,030 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:40:15,097 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:40:17,104 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:40:17,104 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:40:19,207 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:40:19,208 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:40:20,591 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:40:21,995 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:40:21,995 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:40:23,106 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:40:23,106 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:40:24,185 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:40:24,185 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:40:26,301 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:40:26,302 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:40:26,302 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:40:26,302 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:40:26,302 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:40:27,414 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:40:27,414 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:40:27,506 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 13:40:32,510 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:40:32,511 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:40:34,608 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:40:34,609 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:40:39,714 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:40:39,716 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:40:41,834 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:40:46,836 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:40:46,837 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_134046.mp4
2025-03-20 13:40:46,837 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:40:46,837 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:40:52,097 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:40:52,098 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:40:52,129 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 13:40:53,264 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134046.mp4
2025-03-20 13:40:53,265 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134046.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 13:40:55,273 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 13:40:58,278 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 13:40:58,278 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 13:41:01,282 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:41:01,282 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:41:01,282 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:41:02,393 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:41:02,394 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:41:02,394 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:41:02,394 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:41:02,474 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:41:04,484 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:41:04,484 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:41:04,484 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:41:06,659 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:41:06,661 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:41:14,768 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:41:14,769 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:41:14,769 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:41:14,769 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:15,072 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:41:15,073 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:15,300 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:41:15,301 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:15,531 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:41:15,532 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:15,744 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:41:15,745 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:15,964 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:41:15,965 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:16,180 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:41:16,181 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:16,399 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:41:16,400 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:16,633 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:41:16,634 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:16,873 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:41:16,873 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:41:19,093 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:41:19,094 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:41:19,094 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:41:19,171 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ed51339 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1288}
    * Task{2e342df #1288 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:41:19,171 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:41:19,171 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 13:41:19,171 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:41:19,171 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_134119_20250320_134119.png
2025-03-20 13:41:20,923 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_134119_20250320_134119.png
2025-03-20 13:41:20,923 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_134119_20250320_134119.png
2025-03-20 13:41:20,923 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:41:28,369 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 13:41:28,826 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_367.jpg
2025-03-20 13:41:28,833 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_367.jpg
2025-03-20 13:41:28,833 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:41:28,833 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:41:28,833 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:41:38,949 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:41:38,951 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:41:38,951 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:41:39,039 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ed51339 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1288}
    * Task{2e342df #1288 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:41:39,040 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:41:39,040 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 13:41:39,040 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:41:39,040 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_134139_20250320_134139.png
2025-03-20 13:41:40,785 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_134139_20250320_134139.png
2025-03-20 13:41:40,786 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_134139_20250320_134139.png
2025-03-20 13:41:40,786 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:41:45,429 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_367.jpg
2025-03-20 13:41:45,436 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_367.jpg
2025-03-20 13:41:45,436 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:41:45,437 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:41:45,437 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:41:45,437 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:41:47,537 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 13:41:47,538 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 13:41:47,538 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 13:41:47,539 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 13:41:48,544 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 13:41:49,548 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 13:41:49,548 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 13:41:49,549 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 125.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 13:41:49,549 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 13:41:59,553 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134046.mp4 (大小: 3.64MB)
2025-03-20 13:41:59,555 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 13:41:59,665 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.565267秒，无需修复
2025-03-20 13:41:59,665 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 13:41:59,665 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134046.mp4
2025-03-20 13:41:59,665 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 13:42:07,281 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_368.mp4
2025-03-20 13:42:07,286 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_368.mp4
2025-03-20 13:42:07,287 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:42:07,287 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:42:12,478 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:42:12,479 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_368.mp4
2025-03-20 13:42:12,480 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:42:12,480 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:42:12,480 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:42:12,895 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:42:13,900 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:42:13,900 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:42:13,900 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:42:14,986 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:42:14,987 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:42:14,987 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:42:17,074 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:42:17,075 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:42:18,191 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:42:18,192 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:42:18,193 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:42:19,290 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:42:19,290 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 13:42:19,291 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 13:42:19,291 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 13:40:00\n- 结束时间: 2025-03-20 13:42:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_367.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_367.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_368.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:42:19"}]}]}}
2025-03-20 13:42:19,787 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 13:42:19,790 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:47:19,838 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:47:19,841 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:47:19,841 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:47:19,841 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:47:19,942 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 13:47:20,011 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 13:47:20,011 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 13:47:20,011 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:47:20,011 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:47:20,183 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:47:20,184 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:47:20,184 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:47:20,184 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:47:21,599 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:47:21,600 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:47:22,792 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:47:22,793 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:47:22,793 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:47:22,793 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:47:22,793 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:47:22,913 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:47:22,914 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:47:22,914 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:47:22,914 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:47:24,284 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:47:24,285 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:47:25,474 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:47:25,474 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:47:25,474 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:47:25,474 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:47:25,474 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:47:26,543 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:47:26,544 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:47:26,641 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 13:47:28,646 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:47:28,647 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:47:29,737 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:47:29,738 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:47:29,738 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:47:29,738 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:47:29,823 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:47:31,831 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:47:31,832 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:47:33,938 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:47:33,938 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:47:36,017 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:47:36,018 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:47:37,119 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:47:37,120 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:47:37,120 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:47:37,120 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:47:37,198 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:47:39,208 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:47:39,209 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:47:41,321 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:47:41,322 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:47:42,713 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:47:44,113 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:47:44,113 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:47:45,225 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:47:45,226 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:47:46,315 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:47:46,316 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:47:48,435 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:47:48,436 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:47:48,437 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:47:48,437 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:47:48,437 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:47:49,545 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:47:49,545 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:47:49,633 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 13:47:54,638 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:47:54,638 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:47:56,748 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:47:56,749 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:48:01,854 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:48:01,855 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:48:03,980 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:48:08,985 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:48:08,986 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_134808.mp4
2025-03-20 13:48:08,986 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:48:08,986 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:48:14,238 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:48:14,240 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:48:14,284 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 13:48:15,422 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134808.mp4
2025-03-20 13:48:15,423 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134808.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 13:48:17,433 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 13:48:20,438 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 13:48:20,438 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 13:48:23,440 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:48:23,440 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:48:23,441 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:48:24,554 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:48:24,555 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:48:24,555 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:48:24,555 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:48:24,631 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:48:26,639 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:48:26,639 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:48:26,639 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:48:28,829 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:48:28,830 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:48:36,939 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:48:36,940 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:48:36,940 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:48:36,940 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:37,268 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:48:37,269 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:37,504 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:48:37,505 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:37,730 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:48:37,731 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:37,947 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:48:37,948 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:38,176 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:48:38,177 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:38,383 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:48:38,383 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:38,584 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:48:38,585 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:38,786 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:48:38,786 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:39,039 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:48:39,040 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:48:41,272 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:48:41,272 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:48:41,273 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:48:41,367 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{133c04f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1294}
    * Task{3c37ce5 #1294 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:48:41,367 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:48:41,367 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 13:48:41,367 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:48:41,368 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_134841_20250320_134841.png
2025-03-20 13:48:42,968 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_134841_20250320_134841.png
2025-03-20 13:48:42,968 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_134841_20250320_134841.png
2025-03-20 13:48:42,968 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:48:50,058 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_369.jpg
2025-03-20 13:48:50,062 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_369.jpg
2025-03-20 13:48:50,062 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:48:50,062 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:48:50,063 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:48:50,533 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 13:49:00,163 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:49:00,164 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:49:00,164 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:49:00,246 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{133c04f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1294}
    * Task{3c37ce5 #1294 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:49:00,246 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:49:00,246 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 13:49:00,246 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:49:00,246 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_134900_20250320_134900.png
2025-03-20 13:49:01,827 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_134900_20250320_134900.png
2025-03-20 13:49:01,827 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_134900_20250320_134900.png
2025-03-20 13:49:01,827 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:49:07,991 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_370.jpg
2025-03-20 13:49:07,996 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_370.jpg
2025-03-20 13:49:07,997 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:49:07,997 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:49:07,997 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:49:07,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:49:10,095 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 13:49:10,095 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 13:49:10,096 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 13:49:10,096 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 13:49:11,098 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 13:49:12,102 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 13:49:12,103 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 13:49:12,103 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 136.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 13:49:12,103 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 13:49:22,104 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134808.mp4 (大小: 3.55MB)
2025-03-20 13:49:22,104 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 13:49:22,219 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.912700秒，无需修复
2025-03-20 13:49:22,219 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 13:49:22,219 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_134808.mp4
2025-03-20 13:49:22,220 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 13:49:28,989 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_371.mp4
2025-03-20 13:49:28,994 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_371.mp4
2025-03-20 13:49:28,995 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:49:28,995 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:49:34,189 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:49:34,190 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_371.mp4
2025-03-20 13:49:34,190 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:49:34,190 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:49:34,190 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:49:34,579 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:49:35,585 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:49:35,585 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:49:35,585 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:49:36,669 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:49:36,670 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:49:36,670 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:49:38,751 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:49:38,752 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:49:39,855 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:49:39,857 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:49:39,857 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:49:40,946 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:49:40,947 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 13:49:40,947 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 13:49:40,947 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 13:47:22\n- 结束时间: 2025-03-20 13:49:40\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_369.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_370.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_371.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:49:40"}]}]}}
2025-03-20 13:49:41,413 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 13:49:41,415 - QuickAppADBTester - INFO - 测试完成
2025-03-20 13:54:41,428 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 13:54:41,430 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 13:54:41,431 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 13:54:41,431 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 13:54:41,529 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 13:54:41,610 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 13:54:41,610 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 13:54:41,611 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:54:41,611 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:54:41,756 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:54:41,756 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:54:41,757 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:54:41,757 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:54:43,162 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:54:43,162 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:54:44,344 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:54:44,345 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 13:54:44,345 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 13:54:44,345 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 13:54:44,345 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 13:54:44,490 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 13:54:44,490 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 13:54:44,491 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 13:54:44,491 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 13:54:45,872 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:54:45,872 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:54:47,049 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 13:54:47,050 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 13:54:47,050 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:54:47,050 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:54:47,050 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:54:48,118 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 13:54:48,119 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 13:54:48,213 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 13:54:50,214 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 13:54:50,214 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 13:54:51,298 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 13:54:51,298 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 13:54:51,298 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:54:51,298 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 13:54:51,371 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:54:53,379 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 13:54:53,380 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 13:54:55,489 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 13:54:55,490 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 13:54:57,574 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 13:54:57,575 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 13:54:58,676 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 13:54:58,677 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 13:54:58,677 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:54:58,677 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 13:54:58,752 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:55:00,762 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 13:55:00,762 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 13:55:02,880 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 13:55:02,880 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 13:55:04,276 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 13:55:05,688 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 13:55:05,689 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 13:55:06,796 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 13:55:06,797 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 13:55:07,882 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 13:55:07,883 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 13:55:09,996 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 13:55:09,996 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 13:55:09,996 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 13:55:09,997 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:55:09,997 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:55:11,109 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 13:55:11,110 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 13:55:11,211 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 13:55:16,212 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 13:55:16,213 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 13:55:18,313 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 13:55:18,313 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 13:55:23,411 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 13:55:23,411 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 13:55:25,529 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 13:55:30,533 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 13:55:30,534 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_135530.mp4
2025-03-20 13:55:30,535 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:55:30,535 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:55:35,785 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:55:35,786 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 13:55:35,829 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 13:55:36,913 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_135530.mp4
2025-03-20 13:55:36,914 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_135530.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 13:55:38,924 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 13:55:41,929 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 13:55:41,930 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 13:55:44,930 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 13:55:44,930 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 13:55:44,931 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 13:55:46,042 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 13:55:46,043 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 13:55:46,043 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 13:55:46,043 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 13:55:46,121 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 13:55:48,128 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 13:55:48,128 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 13:55:48,128 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 13:55:50,327 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 13:55:50,328 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 13:55:58,437 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 13:55:58,439 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 13:55:58,439 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 13:55:58,440 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:55:58,726 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 13:55:58,727 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:55:58,980 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 13:55:58,981 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:55:59,236 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 13:55:59,237 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:55:59,466 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 13:55:59,466 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:55:59,664 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 13:55:59,665 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:55:59,861 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 13:55:59,862 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:56:00,060 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 13:56:00,061 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:56:00,271 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 13:56:00,271 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:56:00,499 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 13:56:00,500 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 13:56:02,703 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 13:56:02,704 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:56:02,705 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:56:02,784 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3e2f2ca u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1300}
    * Task{9d32f58 #1300 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:56:02,785 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:56:02,785 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 13:56:02,785 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 13:56:02,785 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_135602_20250320_135602.png
2025-03-20 13:56:04,340 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_135602_20250320_135602.png
2025-03-20 13:56:04,340 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_135602_20250320_135602.png
2025-03-20 13:56:04,340 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:56:11,506 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_372.jpg
2025-03-20 13:56:11,512 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_372.jpg
2025-03-20 13:56:11,512 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 13:56:11,512 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:56:11,512 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:56:12,045 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 13:56:21,609 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 13:56:21,610 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 13:56:21,610 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 13:56:21,708 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{3e2f2ca u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1300}
    * Task{9d32f58 #1300 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 13:56:21,709 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 13:56:21,709 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 13:56:21,709 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 13:56:21,709 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_135621_20250320_135621.png
2025-03-20 13:56:23,201 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_135621_20250320_135621.png
2025-03-20 13:56:23,202 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_135621_20250320_135621.png
2025-03-20 13:56:23,202 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 13:56:27,888 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_372.jpg
2025-03-20 13:56:27,893 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_372.jpg
2025-03-20 13:56:27,894 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 13:56:27,894 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 13:56:27,894 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:56:27,894 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:56:30,008 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 13:56:30,008 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 13:56:30,009 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 13:56:30,009 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 13:56:31,011 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 13:56:32,016 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 13:56:32,017 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 13:56:32,017 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 122.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 13:56:32,017 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 13:56:42,019 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_135530.mp4 (大小: 3.87MB)
2025-03-20 13:56:42,020 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 13:56:42,181 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.371011秒，无需修复
2025-03-20 13:56:42,181 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 13:56:42,181 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_135530.mp4
2025-03-20 13:56:42,181 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 13:56:49,601 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_373.mp4
2025-03-20 13:56:49,607 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_373.mp4
2025-03-20 13:56:49,607 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 13:56:49,608 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 13:56:54,871 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 13:56:54,873 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_373.mp4
2025-03-20 13:56:54,874 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 13:56:54,874 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 13:56:54,874 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 13:56:55,200 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 13:56:56,201 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 13:56:56,202 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:56:56,202 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:56:57,277 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 13:56:57,278 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 13:56:57,278 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 13:56:59,367 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 13:56:59,368 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 13:57:00,485 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 13:57:00,486 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 13:57:00,486 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 13:57:01,576 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 13:57:01,577 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 13:57:01,578 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 13:57:01,579 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 13:54:44\n- 结束时间: 2025-03-20 13:57:01\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_372.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_372.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_373.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 13:57:01"}]}]}}
2025-03-20 13:57:02,061 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 13:57:02,067 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:02:02,153 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:02:02,155 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:02:02,155 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:02:02,155 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:02:02,243 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:02:02,339 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:02:02,339 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:02:02,340 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:02:02,340 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:02:02,482 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:02:02,483 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:02:02,483 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:02:02,483 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:02:03,889 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:02:03,890 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:02:05,059 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:02:05,059 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:02:05,059 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:02:05,059 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:02:05,059 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:02:05,185 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:02:05,185 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:02:05,185 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:02:05,185 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:02:06,555 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:02:06,555 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:02:07,723 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:02:07,723 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:02:07,723 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:02:07,723 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:02:07,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:02:08,790 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:02:08,791 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:02:08,899 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:02:10,900 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:02:10,900 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:02:11,986 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:02:11,987 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:02:11,987 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:02:11,987 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:02:12,062 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:02:14,071 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:02:14,072 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:02:16,177 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:02:16,178 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:02:18,264 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:02:18,265 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:02:19,366 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:02:19,366 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:02:19,367 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:02:19,367 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:02:19,441 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:02:21,451 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:02:21,451 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:02:23,561 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:02:23,561 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:02:24,955 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:02:26,366 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:02:26,367 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:02:27,481 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:02:27,483 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:02:28,568 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:02:28,569 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:02:30,680 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:02:30,681 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:02:30,682 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:02:30,682 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:02:30,682 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:02:31,798 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:02:31,799 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:02:31,896 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:02:36,901 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:02:36,901 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:02:38,999 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:02:39,000 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:02:44,106 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:02:44,107 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:02:46,238 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:02:51,240 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:02:51,241 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_140251.mp4
2025-03-20 14:02:51,241 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:02:51,241 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:02:56,493 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:02:56,495 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:02:56,540 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:02:57,626 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_140251.mp4
2025-03-20 14:02:57,626 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_140251.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:02:59,637 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:03:02,641 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:03:02,641 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:03:05,644 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:03:05,645 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:03:05,645 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:03:06,748 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:03:06,748 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:03:06,749 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:03:06,749 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:03:06,825 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:03:08,836 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:03:08,836 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:03:08,836 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:03:11,024 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:03:11,024 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:03:19,135 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:03:19,136 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:03:19,136 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:03:19,136 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:19,381 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:03:19,382 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:19,584 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:03:19,585 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:19,812 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:03:19,813 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:20,018 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:03:20,019 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:20,250 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:03:20,250 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:20,483 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:03:20,484 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:20,687 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:03:20,688 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:20,895 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:03:20,896 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:21,101 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:03:21,102 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:03:23,354 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:03:23,355 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:03:23,355 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:03:23,460 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{234a5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1306}
    * Task{2d8f02b #1306 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:03:23,461 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:03:23,461 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:03:23,462 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:03:23,462 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_140323_20250320_140323.png
2025-03-20 14:03:25,465 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_140323_20250320_140323.png
2025-03-20 14:03:25,465 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_140323_20250320_140323.png
2025-03-20 14:03:25,465 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:03:32,726 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:03:32,996 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_374.jpg
2025-03-20 14:03:33,001 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_374.jpg
2025-03-20 14:03:33,002 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:03:33,002 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:03:33,002 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:03:43,112 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:03:43,113 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:03:43,113 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:03:43,200 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{234a5 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1306}
    * Task{2d8f02b #1306 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:03:43,200 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:03:43,201 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:03:43,201 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:03:43,201 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_140343_20250320_140343.png
2025-03-20 14:03:45,261 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_140343_20250320_140343.png
2025-03-20 14:03:45,262 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_140343_20250320_140343.png
2025-03-20 14:03:45,262 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:03:50,280 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_374.jpg
2025-03-20 14:03:50,285 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_374.jpg
2025-03-20 14:03:50,286 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:03:50,286 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:03:50,286 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:03:50,286 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:03:52,405 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:03:52,407 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:03:52,407 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:03:52,407 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:03:53,412 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:03:54,417 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:03:54,419 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:03:54,419 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 124.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:03:54,419 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:04:04,424 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_140251.mp4 (大小: 4.37MB)
2025-03-20 14:04:04,424 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:04:04,541 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.977344秒，无需修复
2025-03-20 14:04:04,542 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:04:04,542 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_140251.mp4
2025-03-20 14:04:04,542 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:04:12,139 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_375.mp4
2025-03-20 14:04:12,146 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_375.mp4
2025-03-20 14:04:12,146 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:04:12,146 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:04:17,402 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:04:17,403 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_375.mp4
2025-03-20 14:04:17,403 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:04:17,403 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:04:17,403 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:04:17,754 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:04:18,758 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:04:18,758 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:04:18,758 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:04:19,842 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:04:19,843 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:04:19,843 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:04:21,924 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:04:21,925 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:04:23,034 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:04:23,034 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:04:23,035 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:04:24,123 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:04:24,124 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:04:24,125 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:04:24,125 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:02:05\n- 结束时间: 2025-03-20 14:04:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_374.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_374.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_375.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:04:24"}]}]}}
2025-03-20 14:04:24,596 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:04:24,599 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:09:24,616 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:09:24,620 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:09:24,620 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:09:24,620 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:09:24,714 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:09:24,787 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:09:24,788 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:09:24,788 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:09:24,788 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:09:24,933 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:09:24,934 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:09:24,934 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:09:24,934 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:09:26,335 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:09:26,335 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:09:27,514 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:09:27,514 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:09:27,515 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:09:27,515 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:09:27,515 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:09:27,639 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:09:27,640 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:09:27,640 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:09:27,640 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:09:29,006 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:09:29,007 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:09:30,182 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:09:30,182 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:09:30,182 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:09:30,182 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:09:30,182 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:09:31,246 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:09:31,248 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:09:31,348 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:09:33,354 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:09:33,354 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:09:34,442 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:09:34,442 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:09:34,442 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:09:34,442 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:09:34,491 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:09:36,501 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:09:36,502 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:09:38,607 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:09:38,609 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:09:40,690 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:09:40,691 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:09:41,791 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:09:41,792 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:09:41,792 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:09:41,792 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:09:41,851 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:09:43,854 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:09:43,854 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:09:45,969 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:09:45,970 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:09:47,361 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:09:48,772 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:09:48,773 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:09:49,880 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:09:49,881 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:09:50,964 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:09:50,965 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:09:53,080 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:09:53,081 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:09:53,081 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:09:53,081 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:09:53,081 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:09:54,174 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:09:54,174 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:09:54,273 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:09:59,279 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:09:59,281 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:10:01,385 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:10:01,386 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:10:06,484 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:10:06,485 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:10:08,597 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:10:13,601 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:10:13,602 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_141013.mp4
2025-03-20 14:10:13,602 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:10:13,602 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:10:18,845 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:10:18,846 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:10:18,889 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:10:19,967 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141013.mp4
2025-03-20 14:10:19,967 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141013.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:10:21,977 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:10:24,981 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:10:24,982 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:10:27,987 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:10:27,988 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:10:27,988 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:10:29,097 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:10:29,098 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:10:29,098 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:10:29,098 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:10:29,175 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:10:31,184 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:10:31,184 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:10:31,184 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:10:33,386 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:10:33,387 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:10:41,494 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:10:41,496 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:10:41,496 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:10:41,496 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:41,710 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:10:41,711 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:41,913 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:10:41,914 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:42,119 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:10:42,120 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:42,327 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:10:42,328 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:42,562 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:10:42,563 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:42,799 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:10:42,800 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:43,034 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:10:43,034 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:43,229 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:10:43,229 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:43,451 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:10:43,452 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:10:45,674 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:10:45,675 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:10:45,675 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:10:45,760 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{12a5b1d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1312}
    * Task{b64e763 #1312 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:10:45,760 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:10:45,760 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:10:45,761 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:10:45,761 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_141045_20250320_141045.png
2025-03-20 14:10:47,625 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_141045_20250320_141045.png
2025-03-20 14:10:47,625 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_141045_20250320_141045.png
2025-03-20 14:10:47,625 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:10:54,982 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_376.jpg
2025-03-20 14:10:54,988 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_376.jpg
2025-03-20 14:10:54,988 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:10:54,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:10:54,989 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:10:55,073 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:11:05,088 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:11:05,089 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:11:05,089 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:11:05,160 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{12a5b1d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1312}
    * Task{b64e763 #1312 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:11:05,160 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:11:05,160 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:11:05,160 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:11:05,161 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_141105_20250320_141105.png
2025-03-20 14:11:06,989 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_141105_20250320_141105.png
2025-03-20 14:11:06,990 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_141105_20250320_141105.png
2025-03-20 14:11:06,990 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:11:12,980 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_377.jpg
2025-03-20 14:11:12,985 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_377.jpg
2025-03-20 14:11:12,985 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:11:12,985 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:11:12,985 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:11:12,985 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:11:15,073 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:11:15,074 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:11:15,074 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:11:15,075 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:11:16,077 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:11:17,082 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:11:17,082 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:11:17,083 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 116.3 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:11:17,083 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:11:27,085 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141013.mp4 (大小: 3.72MB)
2025-03-20 14:11:27,087 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:11:27,193 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.370078秒，无需修复
2025-03-20 14:11:27,193 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:11:27,193 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141013.mp4
2025-03-20 14:11:27,193 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:11:34,192 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_378.mp4
2025-03-20 14:11:34,199 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_378.mp4
2025-03-20 14:11:34,200 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:11:34,200 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:11:39,450 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:11:39,461 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_378.mp4
2025-03-20 14:11:39,478 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:11:39,478 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:11:39,478 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:11:39,794 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:11:40,800 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:11:40,800 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:11:40,800 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:11:42,110 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:11:42,110 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:11:42,110 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:11:44,231 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:11:44,233 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:11:45,353 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:11:45,354 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:11:45,395 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:11:46,576 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:11:46,577 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:11:46,577 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:11:46,577 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:09:27\n- 结束时间: 2025-03-20 14:11:46\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_376.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_377.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_378.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:11:46"}]}]}}
2025-03-20 14:11:47,107 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:11:47,108 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:16:47,127 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:16:47,130 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:16:47,130 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:16:47,131 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:16:47,239 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:16:47,287 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:16:47,287 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:16:47,287 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:16:47,287 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:16:47,396 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:16:47,396 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:16:47,397 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:16:47,397 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:16:48,774 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:16:48,775 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:16:49,955 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:16:49,956 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:16:49,956 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:16:49,956 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:16:49,956 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:16:50,074 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:16:50,074 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:16:50,074 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:16:50,074 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:16:51,450 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:16:51,451 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:16:52,631 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:16:52,631 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:16:52,631 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:16:52,631 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:16:52,631 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:16:53,697 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:16:53,698 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:16:53,799 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:16:55,805 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:16:55,805 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:16:56,906 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:16:56,907 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:16:56,908 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:16:56,908 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:16:56,985 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:16:58,995 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:16:58,996 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:17:01,101 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:17:01,102 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:17:03,184 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:17:03,185 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:17:04,290 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:17:04,292 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:17:04,292 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:17:04,292 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:17:04,366 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:17:06,376 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:17:06,377 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:17:08,489 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:17:08,491 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:17:09,878 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:17:11,292 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:17:11,293 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:17:12,407 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:17:12,408 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:17:13,500 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:17:13,501 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:17:15,615 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:17:15,616 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:17:15,617 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:17:15,617 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:17:15,617 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:17:16,727 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:17:16,728 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:17:16,830 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:17:21,831 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:17:21,832 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:17:23,935 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:17:23,936 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:17:29,044 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:17:29,045 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:17:31,161 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:17:36,167 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:17:36,169 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_141736.mp4
2025-03-20 14:17:36,169 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:17:36,169 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:17:41,415 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:17:41,416 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:17:41,455 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:17:42,537 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141736.mp4
2025-03-20 14:17:42,538 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141736.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:17:44,547 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:17:47,554 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:17:47,555 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:17:50,560 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:17:50,560 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:17:50,560 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:17:51,678 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:17:51,679 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:17:51,679 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:17:51,680 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:17:51,755 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:17:53,765 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:17:53,765 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:17:53,765 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:17:55,964 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:17:55,966 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:18:04,075 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:18:04,076 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:18:04,076 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:18:04,076 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:04,358 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:18:04,359 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:04,561 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:18:04,562 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:04,778 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:18:04,780 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:04,975 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:18:04,976 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:05,177 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:18:05,178 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:05,415 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:18:05,415 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:05,681 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:18:05,682 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:05,894 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:18:05,894 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:06,121 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:18:06,122 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:18:08,331 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:18:08,333 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:18:08,333 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:18:08,420 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a3f5d02 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1320}
    * Task{8186249 #1320 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:18:08,421 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:18:08,421 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:18:08,421 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:18:08,421 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_141808_20250320_141808.png
2025-03-20 14:18:09,773 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_141808_20250320_141808.png
2025-03-20 14:18:09,773 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_141808_20250320_141808.png
2025-03-20 14:18:09,773 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:18:16,794 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_379.jpg
2025-03-20 14:18:16,802 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_379.jpg
2025-03-20 14:18:16,802 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:18:16,802 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:18:16,803 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:18:17,659 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:18:26,906 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:18:26,907 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:18:26,907 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:18:27,006 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a3f5d02 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1320}
    * Task{8186249 #1320 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:18:27,006 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:18:27,006 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:18:27,006 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:18:27,007 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_141827_20250320_141827.png
2025-03-20 14:18:28,400 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_141827_20250320_141827.png
2025-03-20 14:18:28,401 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_141827_20250320_141827.png
2025-03-20 14:18:28,401 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:18:32,977 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_379.jpg
2025-03-20 14:18:32,982 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_379.jpg
2025-03-20 14:18:32,983 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:18:32,983 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:18:32,983 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:18:32,983 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:18:35,084 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:18:35,086 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:18:35,088 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:18:35,088 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:18:36,092 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:18:37,097 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:18:37,099 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:18:37,103 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 131.7 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:18:37,104 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:18:47,110 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141736.mp4 (大小: 3.47MB)
2025-03-20 14:18:47,112 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:18:47,406 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.775833秒，无需修复
2025-03-20 14:18:47,406 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:18:47,406 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_141736.mp4
2025-03-20 14:18:47,406 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:18:55,048 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_380.mp4
2025-03-20 14:18:55,053 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_380.mp4
2025-03-20 14:18:55,053 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:18:55,053 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:19:00,195 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:19:00,196 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_380.mp4
2025-03-20 14:19:00,197 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:19:00,197 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:19:00,197 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:19:00,475 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:19:01,479 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:19:01,479 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:19:01,479 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:19:02,551 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:19:02,552 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:19:02,552 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:19:04,621 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:19:04,640 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:19:05,752 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:19:05,753 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:19:05,753 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:19:06,835 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:19:06,836 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:19:06,837 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:19:06,837 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:16:49\n- 结束时间: 2025-03-20 14:19:06\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_379.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_379.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_380.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:19:06"}]}]}}
2025-03-20 14:19:07,254 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:19:07,257 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:24:07,397 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:24:07,398 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:24:07,398 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:24:07,399 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:24:07,506 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:24:07,567 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:24:07,567 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:24:07,567 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:24:07,567 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:24:07,720 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:24:07,720 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:24:07,720 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:24:07,720 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:24:09,125 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:24:09,126 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:24:10,303 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:24:10,303 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:24:10,304 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:24:10,304 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:24:10,304 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:24:10,413 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:24:10,414 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:24:10,414 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:24:10,414 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:24:11,788 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:24:11,790 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:24:12,969 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:24:12,969 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:24:12,969 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:24:12,969 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:24:12,969 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:24:14,035 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:24:14,036 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:24:14,119 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:24:16,125 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:24:16,125 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:24:17,219 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:24:17,219 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:24:17,220 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:24:17,220 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:24:17,295 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:24:19,305 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:24:19,305 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:24:21,417 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:24:21,418 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:24:23,505 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:24:23,505 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:24:24,604 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:24:24,605 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:24:24,605 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:24:24,606 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:24:24,679 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:24:26,688 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:24:26,689 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:24:28,788 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:24:28,789 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:24:30,180 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:24:31,585 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:24:31,586 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:24:32,692 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:24:32,693 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:24:33,777 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:24:33,778 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:24:35,892 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:24:35,893 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:24:35,893 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:24:35,893 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:24:35,894 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:24:37,016 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:24:37,017 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:24:37,114 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:24:42,119 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:24:42,119 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:24:44,205 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:24:44,206 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:24:49,384 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:24:49,385 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:24:51,498 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:24:56,500 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:24:56,501 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_142456.mp4
2025-03-20 14:24:56,501 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:24:56,501 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:25:01,753 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:25:01,756 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:25:01,800 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:25:02,934 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_142456.mp4
2025-03-20 14:25:02,935 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_142456.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:25:04,946 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:25:07,953 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:25:07,953 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:25:10,958 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:25:10,959 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:25:10,959 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:25:12,064 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:25:12,065 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:25:12,065 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:25:12,065 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:25:12,167 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:25:14,188 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:25:14,189 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:25:14,189 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:25:16,405 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:25:16,406 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:25:24,520 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:25:24,521 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:25:24,521 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:25:24,521 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:24,769 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:25:24,770 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:24,992 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:25:24,993 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:25,198 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:25:25,199 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:25,401 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:25:25,402 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:25,638 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:25:25,639 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:25,870 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:25:25,871 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:26,083 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:25:26,084 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:26,324 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:25:26,324 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:26,537 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:25:26,537 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:25:28,759 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:25:28,759 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:25:28,759 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:25:28,854 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9f1105d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1326}
    * Task{6dbea3 #1326 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:25:28,855 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:25:28,855 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:25:28,855 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:25:28,855 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_142528_20250320_142528.png
2025-03-20 14:25:30,395 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_142528_20250320_142528.png
2025-03-20 14:25:30,395 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_142528_20250320_142528.png
2025-03-20 14:25:30,396 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:25:37,659 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_381.jpg
2025-03-20 14:25:37,669 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_381.jpg
2025-03-20 14:25:37,669 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:25:37,670 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:25:37,670 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:25:38,054 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:25:47,779 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:25:47,780 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:25:47,780 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:25:47,875 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9f1105d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1326}
    * Task{6dbea3 #1326 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:25:47,876 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:25:47,876 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:25:47,876 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:25:47,876 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_142547_20250320_142547.png
2025-03-20 14:25:49,401 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_142547_20250320_142547.png
2025-03-20 14:25:49,401 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_142547_20250320_142547.png
2025-03-20 14:25:49,402 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:25:53,983 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_381.jpg
2025-03-20 14:25:53,988 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_381.jpg
2025-03-20 14:25:53,988 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:25:53,988 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:25:53,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:25:53,988 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:25:56,105 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:25:56,107 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:25:56,108 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:25:56,108 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:25:57,113 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:25:58,118 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:25:58,118 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:25:58,118 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 44.0 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-20 14:25:58,118 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:26:08,125 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_142456.mp4 (大小: 3.64MB)
2025-03-20 14:26:08,126 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:26:08,269 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.373144秒，无需修复
2025-03-20 14:26:08,269 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:26:08,269 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_142456.mp4
2025-03-20 14:26:08,269 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:26:15,351 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_382.mp4
2025-03-20 14:26:15,355 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_382.mp4
2025-03-20 14:26:15,358 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:26:15,358 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:26:20,555 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:26:20,555 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_382.mp4
2025-03-20 14:26:20,555 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:26:20,556 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:26:20,556 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:26:20,894 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:26:21,898 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:26:21,899 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:26:21,899 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:26:22,984 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:26:22,985 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:26:22,985 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:26:25,069 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:26:25,070 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:26:26,173 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:26:26,174 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:26:26,174 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:26:27,271 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:26:27,272 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:26:27,272 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:26:27,273 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:24:10\n- 结束时间: 2025-03-20 14:26:27\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_381.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_381.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_382.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:26:27"}]}]}}
2025-03-20 14:26:27,713 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:26:27,715 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:31:27,801 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:31:27,803 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:31:27,803 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:31:27,803 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:31:27,895 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:31:27,974 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:31:27,974 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:31:27,974 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:31:27,974 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:31:28,107 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:31:28,108 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:31:28,108 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:31:28,108 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:31:29,491 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:31:29,492 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:31:30,664 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:31:30,665 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:31:30,665 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:31:30,665 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:31:30,665 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:31:30,801 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:31:30,801 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:31:30,801 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:31:30,802 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:31:32,180 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:31:32,181 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:31:33,353 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:31:33,354 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:31:33,354 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:31:33,354 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:31:33,354 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:31:34,421 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:31:34,421 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:31:34,518 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:31:36,524 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:31:36,524 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:31:37,611 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:31:37,612 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:31:37,612 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:31:37,612 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:31:37,701 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:31:39,705 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:31:39,705 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:31:41,817 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:31:41,818 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:31:43,902 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:31:43,903 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:31:45,004 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:31:45,004 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:31:45,004 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:31:45,004 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:31:45,073 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:31:47,083 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:31:47,084 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:31:49,195 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:31:49,195 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:31:50,586 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:31:51,984 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:31:51,985 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:31:53,105 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:31:53,105 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:31:54,181 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:31:54,181 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:31:56,302 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:31:56,302 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:31:56,303 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:31:56,303 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:31:56,307 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:31:57,410 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:31:57,411 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:31:57,505 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:32:02,509 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:32:02,510 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:32:04,631 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:32:04,631 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:32:09,720 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:32:09,721 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:32:11,843 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:32:16,846 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:32:16,848 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_143216.mp4
2025-03-20 14:32:16,849 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:32:16,849 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:32:22,113 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:32:22,114 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:32:22,155 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:32:23,289 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143216.mp4
2025-03-20 14:32:23,290 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143216.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:32:25,303 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:32:28,306 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:32:28,307 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:32:31,310 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:32:31,310 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:32:31,310 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:32:32,420 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:32:32,421 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:32:32,421 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:32:32,421 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:32:32,499 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:32:34,505 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:32:34,505 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:32:34,505 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:32:36,684 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:32:36,685 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:32:44,795 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:32:44,796 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:32:44,796 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:32:44,796 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:45,004 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:32:45,005 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:45,237 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:32:45,239 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:45,437 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:32:45,438 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:45,642 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:32:45,642 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:45,873 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:32:45,874 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:46,071 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:32:46,072 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:46,277 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:32:46,277 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:46,493 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:32:46,493 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:46,690 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:32:46,690 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:32:48,933 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:32:48,934 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:32:48,934 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:32:49,013 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7baefce u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1332}
    * Task{de0fc85 #1332 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:32:49,014 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:32:49,014 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:32:49,014 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:32:49,014 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_143249_20250320_143249.png
2025-03-20 14:32:50,112 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_143249_20250320_143249.png
2025-03-20 14:32:50,112 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_143249_20250320_143249.png
2025-03-20 14:32:50,112 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:32:56,649 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_383.jpg
2025-03-20 14:32:56,652 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_383.jpg
2025-03-20 14:32:56,652 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:32:56,652 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:32:56,652 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:32:58,466 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:33:06,789 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:33:06,790 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:33:06,790 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:33:06,873 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7baefce u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1332}
    * Task{de0fc85 #1332 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:33:06,873 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:33:06,873 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:33:06,873 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:33:06,873 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_143306_20250320_143306.png
2025-03-20 14:33:07,968 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_143306_20250320_143306.png
2025-03-20 14:33:07,969 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_143306_20250320_143306.png
2025-03-20 14:33:07,969 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:33:14,327 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_384.jpg
2025-03-20 14:33:14,333 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_384.jpg
2025-03-20 14:33:14,334 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:33:14,334 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:33:14,334 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:33:14,334 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:33:16,429 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:33:16,430 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:33:16,431 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:33:16,431 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:33:17,436 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:33:18,438 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:33:18,439 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:33:18,439 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:33:18,440 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:33:28,445 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143216.mp4 (大小: 3.16MB)
2025-03-20 14:33:28,447 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:33:28,562 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.311900秒，无需修复
2025-03-20 14:33:28,562 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:33:28,563 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143216.mp4
2025-03-20 14:33:28,563 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:33:36,042 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_385.mp4
2025-03-20 14:33:36,046 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_385.mp4
2025-03-20 14:33:36,047 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:33:36,047 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:33:41,254 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:33:41,256 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_385.mp4
2025-03-20 14:33:41,256 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:33:41,256 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:33:41,256 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:33:41,575 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:33:42,581 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:33:42,581 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:33:42,582 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:33:43,666 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:33:43,667 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:33:43,667 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:33:45,750 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:33:45,750 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:33:46,869 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:33:46,870 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:33:46,870 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:33:47,965 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:33:47,966 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:33:47,966 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:33:47,967 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:31:30\n- 结束时间: 2025-03-20 14:33:47\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_383.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_384.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_385.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:33:47"}]}]}}
2025-03-20 14:33:48,440 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:33:48,443 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:38:49,285 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:38:49,287 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:38:49,287 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:38:49,287 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:38:49,383 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:38:49,464 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:38:49,465 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:38:49,465 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:38:49,465 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:38:49,602 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:38:49,602 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:38:49,602 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:38:49,602 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:38:51,007 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:38:51,008 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:38:52,188 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:38:52,188 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:38:52,188 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:38:52,188 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:38:52,188 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:38:52,304 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:38:52,305 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:38:52,305 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:38:52,305 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:38:53,681 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:38:53,683 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:38:54,852 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:38:54,853 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:38:54,853 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:38:54,853 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:38:54,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:38:55,912 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:38:55,913 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:38:56,013 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:38:58,018 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:38:58,019 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:38:59,105 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:38:59,106 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:38:59,106 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:38:59,106 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:38:59,187 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:39:01,194 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:39:01,195 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:39:03,297 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:39:03,297 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:39:05,381 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:39:05,381 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:39:06,474 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:39:06,475 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:39:06,475 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:39:06,475 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:39:06,544 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:39:08,554 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:39:08,554 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:39:10,666 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:39:10,666 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:39:12,052 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:39:13,464 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:39:13,464 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:39:14,568 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:39:14,569 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:39:15,650 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:39:15,651 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:39:17,753 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:39:17,754 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:39:17,754 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:39:17,755 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:39:17,755 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:39:18,867 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:39:18,868 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:39:18,972 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:39:23,976 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:39:23,976 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:39:26,078 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:39:26,079 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:39:31,175 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:39:31,176 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:39:33,285 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:39:38,289 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:39:38,290 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_143938.mp4
2025-03-20 14:39:38,290 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:39:38,291 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:39:43,534 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:39:43,535 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:39:43,578 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:39:44,712 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143938.mp4
2025-03-20 14:39:44,713 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143938.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:39:46,720 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:39:49,726 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:39:49,727 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:39:52,732 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:39:52,733 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:39:52,733 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:39:53,843 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:39:53,844 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:39:53,844 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:39:53,844 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:39:53,919 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:39:55,929 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:39:55,929 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:39:55,929 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:39:58,126 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:39:58,127 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:40:06,228 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:40:06,229 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:40:06,230 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:40:06,230 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:06,501 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:40:06,502 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:06,802 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:40:06,802 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:07,032 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:40:07,033 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:07,241 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:40:07,242 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:07,442 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:40:07,442 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:07,676 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:40:07,677 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:07,954 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:40:07,954 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:08,156 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:40:08,157 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:08,359 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:40:08,360 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:40:10,561 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:40:10,561 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:40:10,561 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:40:10,639 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7658c15 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1338}
    * Task{af09eb8 #1338 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:40:10,639 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:40:10,639 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:40:10,639 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:40:10,639 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_144010_20250320_144010.png
2025-03-20 14:40:12,607 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_144010_20250320_144010.png
2025-03-20 14:40:12,608 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_144010_20250320_144010.png
2025-03-20 14:40:12,608 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:40:19,784 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_386.jpg
2025-03-20 14:40:19,791 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_386.jpg
2025-03-20 14:40:19,791 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:40:19,791 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:40:19,792 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:40:19,826 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:40:29,895 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:40:29,897 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:40:29,897 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:40:29,998 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{7658c15 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1338}
    * Task{af09eb8 #1338 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:40:29,998 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:40:29,999 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:40:29,999 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:40:29,999 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_144029_20250320_144029.png
2025-03-20 14:40:32,030 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_144029_20250320_144029.png
2025-03-20 14:40:32,030 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_144029_20250320_144029.png
2025-03-20 14:40:32,030 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:40:38,703 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_387.jpg
2025-03-20 14:40:38,709 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_387.jpg
2025-03-20 14:40:38,709 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:40:38,709 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:40:38,709 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:40:38,709 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:40:40,827 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:40:40,828 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:40:40,828 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:40:40,828 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:40:41,831 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:40:42,835 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:40:42,835 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:40:42,835 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 164.2 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:40:42,835 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:40:52,841 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143938.mp4 (大小: 3.84MB)
2025-03-20 14:40:52,842 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:40:52,995 - QuickAppADBTester - INFO - 录制文件完整，时长: 55.375033秒，无需修复
2025-03-20 14:40:52,995 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:40:52,996 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_143938.mp4
2025-03-20 14:40:52,996 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:40:59,863 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_388.mp4
2025-03-20 14:40:59,869 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_388.mp4
2025-03-20 14:40:59,869 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:40:59,869 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:41:05,046 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:41:05,047 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_388.mp4
2025-03-20 14:41:05,048 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:41:05,048 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:41:05,048 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:41:05,396 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:41:06,401 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:41:06,402 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:41:06,402 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:41:07,483 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:41:07,485 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:41:07,485 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:41:09,566 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:41:09,566 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:41:10,667 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:41:10,668 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:41:10,668 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:41:11,762 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:41:11,763 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:41:11,765 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:41:11,766 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:38:52\n- 结束时间: 2025-03-20 14:41:11\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_386.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_387.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_388.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:41:11"}]}]}}
2025-03-20 14:41:12,356 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:41:12,359 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:46:12,438 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:46:12,441 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:46:12,441 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:46:12,441 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:46:12,547 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:46:12,617 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:46:12,618 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:46:12,618 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:46:12,618 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:46:12,754 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:46:12,755 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:46:12,755 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:46:12,755 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:46:14,155 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:46:14,155 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:46:15,340 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:46:15,341 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:46:15,341 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:46:15,341 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:46:15,341 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:46:15,476 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:46:15,476 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:46:15,476 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:46:15,477 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:46:16,852 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:46:16,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:46:18,042 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:46:18,043 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:46:18,043 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:46:18,043 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:46:18,043 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:46:19,112 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:46:19,112 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:46:19,201 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:46:21,205 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:46:21,205 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:46:22,285 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:46:22,286 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:46:22,286 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:46:22,286 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:46:22,366 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:46:24,373 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:46:24,374 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:46:26,482 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:46:26,483 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:46:28,566 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:46:28,568 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:46:29,670 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:46:29,671 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:46:29,671 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:46:29,671 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:46:29,745 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:46:31,755 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:46:31,755 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:46:33,874 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:46:33,875 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:46:35,268 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:46:36,670 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:46:36,671 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:46:37,783 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:46:37,784 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:46:38,873 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:46:38,874 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:46:40,995 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:46:40,995 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:46:40,995 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:46:40,996 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:46:40,996 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:46:42,105 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:46:42,106 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:46:42,198 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:46:47,204 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:46:47,205 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:46:49,310 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:46:49,312 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:46:54,403 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:46:54,404 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:46:56,525 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:47:01,531 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:47:01,531 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_144701.mp4
2025-03-20 14:47:01,532 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:47:01,532 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:47:06,688 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:47:06,689 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:47:06,739 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:47:07,878 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_144701.mp4
2025-03-20 14:47:07,879 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_144701.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:47:09,891 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:47:12,896 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:47:12,897 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:47:15,901 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:47:15,902 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:47:15,902 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:47:17,010 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:47:17,010 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:47:17,011 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:47:17,011 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:47:17,089 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:47:19,099 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:47:19,101 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:47:19,101 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:47:21,290 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:47:21,291 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:47:29,399 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:47:29,401 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:47:29,401 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:47:29,401 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:29,637 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:47:29,638 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:29,868 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:47:29,869 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:30,097 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:47:30,098 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:30,299 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:47:30,300 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:30,528 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:47:30,529 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:30,732 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:47:30,733 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:30,930 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:47:30,931 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:31,154 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:47:31,154 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:31,362 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:47:31,363 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:47:33,585 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:47:33,586 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:47:33,586 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:47:33,678 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c4a12f7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1344}
    * Task{bf473cd #1344 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:47:33,679 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:47:33,679 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:47:33,679 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:47:33,679 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_144733_20250320_144733.png
2025-03-20 14:47:34,997 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_144733_20250320_144733.png
2025-03-20 14:47:34,997 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_144733_20250320_144733.png
2025-03-20 14:47:34,998 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:47:41,742 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_389.jpg
2025-03-20 14:47:41,747 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_389.jpg
2025-03-20 14:47:41,748 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:47:41,748 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:47:41,748 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:47:43,005 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:47:51,836 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:47:51,837 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:47:51,838 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:47:51,933 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c4a12f7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1344}
    * Task{bf473cd #1344 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:47:51,933 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:47:51,933 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:47:51,933 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:47:51,933 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_144751_20250320_144751.png
2025-03-20 14:47:53,314 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_144751_20250320_144751.png
2025-03-20 14:47:53,314 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_144751_20250320_144751.png
2025-03-20 14:47:53,314 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:47:57,742 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_389.jpg
2025-03-20 14:47:57,750 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_389.jpg
2025-03-20 14:47:57,751 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:47:57,751 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:47:57,751 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:47:57,751 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:47:59,853 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:47:59,853 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:47:59,854 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:47:59,854 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:48:00,856 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:48:01,861 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:48:01,861 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:48:01,861 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:48:01,861 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:48:11,864 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_144701.mp4 (大小: 4.03MB)
2025-03-20 14:48:11,865 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:48:12,018 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.175878秒，无需修复
2025-03-20 14:48:12,019 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:48:12,019 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_144701.mp4
2025-03-20 14:48:12,019 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:48:19,073 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_390.mp4
2025-03-20 14:48:19,076 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_390.mp4
2025-03-20 14:48:19,076 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:48:19,076 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:48:24,262 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:48:24,264 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_390.mp4
2025-03-20 14:48:24,265 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:48:24,265 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:48:24,265 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:48:24,627 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:48:25,632 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:48:25,633 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:48:25,633 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:48:26,716 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:48:26,717 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:48:26,718 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:48:28,805 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:48:28,807 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:48:29,923 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:48:29,924 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:48:29,924 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:48:31,017 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:48:31,018 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:48:31,020 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:48:31,021 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:46:15\n- 结束时间: 2025-03-20 14:48:31\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_389.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_389.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_390.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:48:31"}]}]}}
2025-03-20 14:48:31,456 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:48:31,458 - QuickAppADBTester - INFO - 测试完成
2025-03-20 14:53:31,554 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 14:53:31,557 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 14:53:31,558 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 14:53:31,558 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 14:53:31,657 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 14:53:31,733 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 14:53:31,734 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 14:53:31,734 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:53:31,734 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:53:31,868 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:53:31,868 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:53:31,869 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:53:31,869 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:53:33,266 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:53:33,267 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:53:34,442 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:53:34,443 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 14:53:34,443 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 14:53:34,443 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 14:53:34,443 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 14:53:34,574 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 14:53:34,574 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 14:53:34,574 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 14:53:34,574 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 14:53:35,929 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:53:35,930 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:53:37,113 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 14:53:37,113 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 14:53:37,113 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:53:37,113 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:53:37,113 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:53:38,178 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 14:53:38,178 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 14:53:38,268 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 14:53:40,273 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 14:53:40,273 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 14:53:41,363 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 14:53:41,364 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 14:53:41,364 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:53:41,364 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 14:53:41,429 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:53:43,437 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 14:53:43,437 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 14:53:45,550 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 14:53:45,550 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 14:53:47,625 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 14:53:47,625 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 14:53:48,724 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 14:53:48,724 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 14:53:48,725 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:53:48,725 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 14:53:48,799 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:53:50,806 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 14:53:50,807 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 14:53:52,917 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 14:53:52,918 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 14:53:54,305 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 14:53:55,716 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 14:53:55,716 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 14:53:56,822 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 14:53:56,823 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 14:53:57,900 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 14:53:57,900 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 14:54:00,009 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 14:54:00,009 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 14:54:00,009 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 14:54:00,009 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:54:00,009 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:54:01,108 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 14:54:01,109 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 14:54:01,201 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 14:54:06,202 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 14:54:06,202 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 14:54:08,304 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 14:54:08,305 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 14:54:13,399 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 14:54:13,400 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 14:54:15,524 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 14:54:20,530 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 14:54:20,531 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_145420.mp4
2025-03-20 14:54:20,531 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:54:20,531 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:54:25,731 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:54:25,733 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 14:54:25,787 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 14:54:26,932 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_145420.mp4
2025-03-20 14:54:26,933 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_145420.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 14:54:28,943 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 14:54:31,947 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 14:54:31,948 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 14:54:34,953 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 14:54:34,954 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 14:54:34,954 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 14:54:36,057 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 14:54:36,058 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 14:54:36,058 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 14:54:36,058 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 14:54:36,137 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 14:54:38,146 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 14:54:38,147 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 14:54:38,147 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 14:54:40,351 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 14:54:40,352 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 14:54:48,481 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 14:54:48,482 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 14:54:48,482 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 14:54:48,483 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:48,772 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 14:54:48,772 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:48,980 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 14:54:48,980 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:49,217 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 14:54:49,218 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:49,472 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 14:54:49,473 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:49,691 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 14:54:49,692 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:49,904 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 14:54:49,904 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:50,112 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 14:54:50,113 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:50,336 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 14:54:50,336 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:50,548 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 14:54:50,548 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 14:54:52,779 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 14:54:52,779 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:54:52,779 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:54:52,855 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d1621fe u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1350}
    * Task{11ed3ac #1350 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:54:52,856 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:54:52,856 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 14:54:52,856 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 14:54:52,856 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_145452_20250320_145452.png
2025-03-20 14:54:54,488 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_145452_20250320_145452.png
2025-03-20 14:54:54,488 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_145452_20250320_145452.png
2025-03-20 14:54:54,488 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:55:01,750 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_391.jpg
2025-03-20 14:55:01,761 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_391.jpg
2025-03-20 14:55:01,761 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 14:55:01,761 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:55:01,762 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:55:02,042 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 14:55:11,850 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 14:55:11,850 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 14:55:11,850 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 14:55:11,997 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d1621fe u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1350}
    * Task{11ed3ac #1350 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 14:55:11,997 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 14:55:11,997 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 14:55:11,998 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 14:55:11,998 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_145511_20250320_145511.png
2025-03-20 14:55:13,628 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_145511_20250320_145511.png
2025-03-20 14:55:13,628 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_145511_20250320_145511.png
2025-03-20 14:55:13,628 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 14:55:18,513 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_391.jpg
2025-03-20 14:55:18,519 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_391.jpg
2025-03-20 14:55:18,520 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 14:55:18,520 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 14:55:18,520 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:55:18,520 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:55:20,614 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 14:55:20,614 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 14:55:20,614 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 14:55:20,615 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 14:55:21,618 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 14:55:22,618 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 14:55:22,618 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 14:55:22,619 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 122.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 14:55:22,619 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 14:55:32,624 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_145420.mp4 (大小: 4.93MB)
2025-03-20 14:55:32,625 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 14:55:32,791 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.909800秒，无需修复
2025-03-20 14:55:32,791 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 14:55:32,792 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_145420.mp4
2025-03-20 14:55:32,792 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 14:55:40,167 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_392.mp4
2025-03-20 14:55:40,171 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_392.mp4
2025-03-20 14:55:40,172 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 14:55:40,172 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 14:55:45,407 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 14:55:45,410 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_392.mp4
2025-03-20 14:55:45,410 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 14:55:45,411 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 14:55:45,411 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 14:55:45,753 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 14:55:46,756 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 14:55:46,756 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:55:46,756 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:55:47,843 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 14:55:47,844 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 14:55:47,844 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 14:55:49,936 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 14:55:49,939 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 14:55:51,040 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 14:55:51,041 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 14:55:51,041 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 14:55:52,139 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 14:55:52,141 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 14:55:52,142 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 14:55:52,143 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 14:53:34\n- 结束时间: 2025-03-20 14:55:52\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_391.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_391.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_392.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 14:55:52"}]}]}}
2025-03-20 14:55:52,639 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 14:55:52,641 - QuickAppADBTester - INFO - 测试完成
2025-03-20 15:00:52,987 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:00:52,989 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:00:52,989 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:00:52,989 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:00:53,183 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:00:53,270 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:00:53,271 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:00:53,271 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:00:53,271 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:00:53,409 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:00:53,409 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:00:53,409 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:00:53,409 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:00:54,804 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:00:54,804 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:00:55,989 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:00:55,990 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:00:55,990 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:00:55,990 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:00:55,990 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:00:56,102 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:00:56,102 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:00:56,102 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:00:56,102 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:00:57,476 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:00:57,476 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:00:58,663 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:00:58,663 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:00:58,663 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:00:58,663 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:00:58,663 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:00:59,726 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:00:59,726 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:00:59,817 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:01:01,820 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:01:01,821 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:01:02,909 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:01:02,910 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:01:02,910 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:01:02,910 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:01:02,990 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:01:05,001 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:01:05,001 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:01:07,113 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:01:07,114 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:01:09,200 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:01:09,202 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:01:10,305 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:01:10,306 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:01:10,306 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:01:10,306 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:01:10,379 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:01:12,390 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:01:12,390 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:01:14,503 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:01:14,504 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:01:15,894 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:01:17,303 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:01:17,303 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:01:18,419 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:01:18,419 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:01:19,514 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:01:19,515 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:01:21,633 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:01:21,634 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:01:21,634 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:01:21,634 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:01:21,634 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:01:22,746 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:01:22,747 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:01:22,845 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:01:27,850 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:01:27,852 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:01:29,963 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:01:29,964 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:01:35,070 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:01:35,073 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:01:37,192 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:01:42,198 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:01:42,199 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_150142.mp4
2025-03-20 15:01:42,200 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:01:42,200 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:01:47,423 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:01:47,425 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:01:47,482 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:01:48,620 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150142.mp4
2025-03-20 15:01:48,621 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150142.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:01:50,639 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:01:53,646 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:01:53,646 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:01:56,651 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:01:56,652 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:01:56,652 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:01:57,773 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:01:57,775 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:01:57,775 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:01:57,775 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:01:57,857 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:01:59,866 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:01:59,867 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:01:59,868 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:02:02,077 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:02:02,078 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:02:10,178 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:02:10,179 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:02:10,179 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:02:10,179 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:10,440 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:02:10,441 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:10,679 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:02:10,680 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:10,915 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:02:10,916 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:11,119 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:02:11,120 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:11,317 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:02:11,318 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:11,542 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:02:11,543 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:11,749 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:02:11,750 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:11,977 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:02:11,978 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:12,241 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:02:12,242 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:02:14,441 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:02:14,441 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:02:14,442 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:02:14,535 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{890b02c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1356}
    * Task{506d08a #1356 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:02:14,535 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:02:14,535 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:02:14,535 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:02:14,535 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_150214_20250320_150214.png
2025-03-20 15:02:16,280 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_150214_20250320_150214.png
2025-03-20 15:02:16,281 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_150214_20250320_150214.png
2025-03-20 15:02:16,281 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:02:23,770 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:02:29,408 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_393.jpg
2025-03-20 15:02:29,417 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_393.jpg
2025-03-20 15:02:29,417 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:02:29,418 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:02:29,418 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:02:39,523 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:02:39,524 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:02:39,525 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:02:39,625 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{890b02c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1356}
    * Task{506d08a #1356 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:02:39,625 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:02:39,627 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:02:39,627 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:02:39,632 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_150239_20250320_150239.png
2025-03-20 15:02:41,445 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_150239_20250320_150239.png
2025-03-20 15:02:41,445 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_150239_20250320_150239.png
2025-03-20 15:02:41,445 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:02:46,210 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_393.jpg
2025-03-20 15:02:46,218 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_393.jpg
2025-03-20 15:02:46,220 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:02:46,222 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:02:46,222 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:02:46,222 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:02:48,333 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:02:48,334 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:02:48,337 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:02:48,337 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:02:49,339 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:02:50,344 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:02:50,344 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:02:50,345 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 40.5 MB/s (90640 bytes in 0.002s)
WARN: Killing the server...

2025-03-20 15:02:50,345 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:03:00,351 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150142.mp4 (大小: 4.75MB)
2025-03-20 15:03:00,352 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:03:00,508 - QuickAppADBTester - INFO - 录制文件完整，时长: 58.972522秒，无需修复
2025-03-20 15:03:00,508 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:03:00,508 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150142.mp4
2025-03-20 15:03:00,508 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:03:07,692 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_394.mp4
2025-03-20 15:03:07,699 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_394.mp4
2025-03-20 15:03:07,700 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:03:07,700 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:03:12,902 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:03:12,904 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_394.mp4
2025-03-20 15:03:12,904 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:03:12,904 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:03:12,904 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:03:13,250 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:03:14,255 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 15:03:14,256 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:03:14,256 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:03:15,341 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 15:03:15,342 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 15:03:15,342 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 15:03:17,426 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 15:03:17,427 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 15:03:18,532 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 15:03:18,533 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:03:18,533 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:03:19,624 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 15:03:19,625 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 15:03:19,626 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:03:19,626 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 15:00:55\n- 结束时间: 2025-03-20 15:03:19\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_393.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_393.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_394.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:03:19"}]}]}}
2025-03-20 15:03:20,078 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 15:03:20,081 - QuickAppADBTester - INFO - 测试完成
2025-03-20 15:08:20,162 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:08:20,165 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:08:20,165 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:08:20,166 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:08:20,247 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:08:20,320 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:08:20,320 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:08:20,320 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:08:20,320 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:08:20,455 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:08:20,456 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:08:20,456 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:08:20,456 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:08:21,857 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:08:21,858 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:08:23,050 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:08:23,050 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:08:23,051 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:08:23,051 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:08:23,051 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:08:23,187 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:08:23,187 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:08:23,187 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:08:23,187 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:08:24,565 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:08:24,565 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:08:25,749 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:08:25,749 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:08:25,749 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:08:25,749 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:08:25,749 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:08:26,816 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:08:26,817 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:08:26,911 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:08:28,917 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:08:28,917 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:08:30,018 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:08:30,019 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:08:30,019 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:08:30,019 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:08:30,097 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:08:32,106 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:08:32,106 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:08:34,212 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:08:34,213 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:08:36,298 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:08:36,299 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:08:37,402 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:08:37,403 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:08:37,403 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:08:37,403 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:08:37,479 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:08:39,488 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:08:39,490 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:08:41,607 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:08:41,608 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:08:42,999 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:08:44,403 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:08:44,404 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:08:45,519 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:08:45,520 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:08:46,605 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:08:46,606 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:08:48,699 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:08:48,700 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:08:48,700 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:08:48,700 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:08:48,700 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:08:49,812 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:08:49,814 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:08:49,909 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:08:54,911 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:08:54,913 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:08:57,016 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:08:57,017 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:09:02,121 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:09:02,122 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:09:04,246 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:09:09,250 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:09:09,250 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_150909.mp4
2025-03-20 15:09:09,251 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:09:09,251 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:09:14,509 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:09:14,510 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:09:14,556 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:09:15,690 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150909.mp4
2025-03-20 15:09:15,691 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150909.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:09:17,699 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:09:20,705 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:09:20,705 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:09:23,706 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:09:23,708 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:09:23,708 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:09:24,815 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:09:24,817 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:09:24,817 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:09:24,817 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:09:24,894 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:09:26,904 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:09:26,904 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:09:26,904 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:09:29,094 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:09:29,095 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:09:37,204 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:09:37,205 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:09:37,205 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:09:37,206 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:37,497 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:09:37,497 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:37,765 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:09:37,766 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:38,022 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:09:38,022 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:38,249 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:09:38,249 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:38,475 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:09:38,476 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:38,683 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:09:38,683 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:38,886 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:09:38,886 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:39,103 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:09:39,104 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:39,320 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:09:39,321 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:09:41,526 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:09:41,527 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:09:41,528 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:09:41,612 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9d4fb46 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1362}
    * Task{44f385d #1362 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:09:41,612 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:09:41,612 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:09:41,612 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:09:41,612 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_150941_20250320_150941.png
2025-03-20 15:09:43,633 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_150941_20250320_150941.png
2025-03-20 15:09:43,634 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_150941_20250320_150941.png
2025-03-20 15:09:43,634 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:09:50,809 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:09:51,062 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_395.jpg
2025-03-20 15:09:51,069 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_395.jpg
2025-03-20 15:09:51,069 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:09:51,069 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:09:51,069 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:10:01,176 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:10:01,178 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:10:01,178 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:10:01,305 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9d4fb46 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1362}
    * Task{44f385d #1362 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:10:01,305 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:10:01,305 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:10:01,305 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:10:01,305 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_151001_20250320_151001.png
2025-03-20 15:10:02,906 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_151001_20250320_151001.png
2025-03-20 15:10:02,907 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_151001_20250320_151001.png
2025-03-20 15:10:02,907 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:10:08,834 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_396.jpg
2025-03-20 15:10:08,840 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_396.jpg
2025-03-20 15:10:08,840 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:10:08,840 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:10:08,840 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:10:08,840 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:10:10,944 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:10:10,945 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:10:10,945 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:10:10,945 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:10:11,948 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:10:12,953 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:10:12,953 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:10:12,954 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 15:10:12,954 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:10:22,958 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150909.mp4 (大小: 4.68MB)
2025-03-20 15:10:22,959 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:10:23,112 - QuickAppADBTester - INFO - 录制文件完整，时长: 54.433667秒，无需修复
2025-03-20 15:10:23,112 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:10:23,112 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_150909.mp4
2025-03-20 15:10:23,112 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:10:30,429 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_397.mp4
2025-03-20 15:10:30,437 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_397.mp4
2025-03-20 15:10:30,438 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:10:30,438 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:10:35,640 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:10:35,641 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_397.mp4
2025-03-20 15:10:35,641 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:10:35,641 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:10:35,641 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:10:36,034 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:10:36,965 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 15:10:36,965 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 15:10:36,965 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:10:36,966 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-20 15:08:23\n- 中断时间: 2025-03-20 15:10:36\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_395.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_396.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_397.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:10:36"}]}]}}
2025-03-20 15:10:37,441 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 15:10:37,444 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-20 15:14:55,467 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 15:14:55,467 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:14:55,467 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:14:55,467 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:14:55,467 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:14:55,526 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:14:55,576 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:14:55,576 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:14:55,576 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:14:55,576 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:14:55,691 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:14:55,691 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:14:55,691 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:14:55,691 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:14:57,071 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:14:57,072 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:14:58,253 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:14:58,253 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:14:58,253 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:14:58,253 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:14:58,253 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:14:58,381 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:14:58,382 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:14:58,382 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:14:58,382 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:14:59,738 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:14:59,739 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:15:00,915 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:15:00,915 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:15:00,915 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:15:00,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:15:00,915 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:15:01,988 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:15:01,988 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:15:02,071 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:15:04,076 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:15:04,077 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:15:05,192 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:15:05,193 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:15:05,193 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:15:05,193 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:15:05,272 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:15:07,279 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:15:07,280 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:15:09,386 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:15:09,386 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:15:11,459 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:15:11,460 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:15:12,567 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:15:12,568 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:15:12,568 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:15:12,568 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:15:12,645 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:15:14,653 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:15:14,654 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:15:16,788 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:15:16,789 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:15:18,185 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:15:19,593 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:15:19,594 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:15:20,704 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:15:20,704 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:15:21,793 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:15:21,794 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:15:23,910 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:15:23,911 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:15:23,911 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:15:23,912 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:15:23,912 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:15:25,020 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:15:25,021 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:15:25,112 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:15:30,118 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:15:30,119 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:15:32,221 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:15:32,222 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:15:37,318 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:15:37,320 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:15:39,442 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:15:44,445 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:15:44,445 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_151544.mp4
2025-03-20 15:15:44,445 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:15:44,446 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:15:49,677 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:15:49,679 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:15:49,723 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:15:50,807 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_151544.mp4
2025-03-20 15:15:50,808 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_151544.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:15:52,818 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:15:55,824 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:15:55,825 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:15:58,829 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:15:58,829 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:15:58,830 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:15:59,940 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:15:59,941 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:15:59,941 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:15:59,942 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:16:00,021 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:16:02,030 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:16:02,031 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:16:02,031 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:16:04,227 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:16:04,228 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:16:12,341 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:16:12,342 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:16:12,342 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:16:12,342 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:12,626 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:16:12,627 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:12,862 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:16:12,863 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:13,090 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:16:13,091 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:13,298 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:16:13,299 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:13,548 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:16:13,548 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:13,764 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:16:13,765 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:13,965 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:16:13,966 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:14,197 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:16:14,197 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:14,428 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:16:14,429 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:16:16,634 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:16:16,635 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:16:16,635 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:16:16,723 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b5543a0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1369}
    * Task{fc3131e #1369 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:16:16,724 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:16:16,724 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:16:16,724 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:16:16,724 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_151616_20250320_151616.png
2025-03-20 15:16:17,878 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_151616_20250320_151616.png
2025-03-20 15:16:17,878 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_151616_20250320_151616.png
2025-03-20 15:16:17,878 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:16:24,504 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_398.jpg
2025-03-20 15:16:24,512 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_398.jpg
2025-03-20 15:16:24,512 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:16:24,513 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:16:24,513 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:16:25,932 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:16:34,623 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:16:34,623 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:16:34,623 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:16:34,692 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{b5543a0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1369}
    * Task{fc3131e #1369 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:16:34,692 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:16:34,693 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:16:34,693 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:16:34,693 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_151634_20250320_151634.png
2025-03-20 15:16:35,823 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_151634_20250320_151634.png
2025-03-20 15:16:35,823 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_151634_20250320_151634.png
2025-03-20 15:16:35,823 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:16:38,429 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 15:16:38,429 - QuickAppADBTester - INFO - 终止录制进程...
2025-03-20 15:16:38,430 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:16:38,430 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:16:38,430 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:16:38,430 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:16:39,433 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时2秒
2025-03-20 15:16:39,434 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:16:39,435 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 114.7 MB/s (90640 bytes in 0.001s)

2025-03-20 15:16:39,435 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:16:49,437 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_151544.mp4 (大小: 2.34MB)
2025-03-20 15:16:49,438 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:16:49,548 - QuickAppADBTester - INFO - 录制文件完整，时长: 36.313344秒，无需修复
2025-03-20 15:16:49,548 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:16:49,548 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_151544.mp4
2025-03-20 15:16:49,548 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:16:56,817 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_399.mp4
2025-03-20 15:16:56,823 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_399.mp4
2025-03-20 15:16:56,823 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:16:56,823 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:17:02,051 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:17:02,052 - QuickAppADBTester - INFO - 上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_399.mp4
2025-03-20 15:17:02,052 - QuickAppADBTester - INFO - 视频已上传，将在测试结果通知中包含
2025-03-20 15:17:02,052 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 15:17:02,053 - QuickAppADBTester - INFO - 使用中断时上传的视频URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_399.mp4
2025-03-20 15:17:02,054 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含2张图片链接
2025-03-20 15:17:02,054 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-20 15:14:58\n- 中断时间: 2025-03-20 15:17:02\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_398.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_399.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:17:02"}]}]}}
2025-03-20 15:17:02,573 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 15:23:46,609 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 15:23:46,609 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:23:46,609 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:23:46,609 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:23:46,609 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:23:46,696 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:23:46,746 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:23:46,746 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:23:46,746 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:23:46,746 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:23:46,868 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:23:46,868 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:23:46,868 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:23:46,869 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:23:48,260 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:23:48,261 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:23:49,430 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:23:49,431 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:23:49,431 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:23:49,431 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:23:49,431 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:23:49,552 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:23:49,552 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:23:49,552 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:23:49,552 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:23:50,916 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:23:50,917 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:23:52,071 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:23:52,072 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:23:52,072 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:23:52,072 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:23:52,072 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:23:53,137 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:23:53,138 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:23:53,223 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:23:55,228 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:23:55,229 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:23:56,347 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:23:56,348 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:23:56,348 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:23:56,348 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:23:56,426 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:23:58,435 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:23:58,435 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:24:00,535 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:24:00,536 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:24:02,621 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:24:02,623 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:24:03,729 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:24:03,729 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:24:03,730 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:24:03,730 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:24:03,806 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:24:05,817 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:24:05,817 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:24:07,938 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:24:07,939 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:24:09,338 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:24:10,738 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:24:10,739 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:24:11,855 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:24:11,856 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:24:12,943 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:24:12,945 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:24:15,052 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:24:15,053 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:24:15,053 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:24:15,053 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:24:15,053 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:24:16,155 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:24:16,156 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:24:16,260 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:24:21,261 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:24:21,261 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:24:23,377 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:24:23,377 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:24:28,481 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:24:28,481 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:24:30,602 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:24:35,608 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:24:35,609 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_152435.mp4
2025-03-20 15:24:35,610 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:24:35,610 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:24:40,857 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:24:40,859 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:24:40,898 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:24:42,035 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_152435.mp4
2025-03-20 15:24:42,036 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_152435.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:24:44,046 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:24:47,052 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:24:47,053 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:24:50,057 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:24:50,059 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:24:50,059 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:24:51,164 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:24:51,165 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:24:51,165 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:24:51,165 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:24:51,238 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:24:53,243 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:24:53,244 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:24:53,244 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:24:55,437 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:24:55,437 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:25:03,546 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:25:03,547 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:25:03,547 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:25:03,547 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:03,769 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:25:03,770 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:03,985 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:25:03,986 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:04,219 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:25:04,220 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:04,451 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:25:04,452 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:04,684 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:25:04,685 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:04,866 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:25:04,867 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:05,069 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:25:05,070 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:05,266 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:25:05,266 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:05,474 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:25:05,475 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:25:07,692 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:25:07,693 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:25:07,693 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:25:07,791 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{66fe04d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1379}
    * Task{f676813 #1379 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:25:07,791 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:25:07,791 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:25:07,791 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:25:07,792 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_152507_20250320_152507.png
2025-03-20 15:25:09,031 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_152507_20250320_152507.png
2025-03-20 15:25:09,032 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_152507_20250320_152507.png
2025-03-20 15:25:09,032 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:25:15,671 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_400.jpg
2025-03-20 15:25:15,679 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_400.jpg
2025-03-20 15:25:15,680 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:25:15,680 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:25:15,680 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:25:17,151 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:25:25,793 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:25:25,793 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:25:25,793 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:25:25,897 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{66fe04d u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1379}
    * Task{f676813 #1379 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:25:25,897 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:25:25,897 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:25:25,897 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:25:25,897 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_152525_20250320_152525.png
2025-03-20 15:25:27,162 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_152525_20250320_152525.png
2025-03-20 15:25:27,162 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_152525_20250320_152525.png
2025-03-20 15:25:27,162 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:25:31,616 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_400.jpg
2025-03-20 15:25:31,623 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_400.jpg
2025-03-20 15:25:31,623 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:25:31,623 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:25:31,624 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:25:31,624 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:25:33,735 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:25:33,735 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:25:33,735 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:25:33,736 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:25:34,741 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:25:35,744 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:25:35,745 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:25:35,745 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 115.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 15:25:35,745 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:25:45,750 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_152435.mp4 (大小: 3.12MB)
2025-03-20 15:25:45,751 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:25:45,915 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.901233秒，无需修复
2025-03-20 15:25:45,915 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:25:45,915 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_152435.mp4
2025-03-20 15:25:45,915 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:25:53,019 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_401.mp4
2025-03-20 15:25:53,026 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_401.mp4
2025-03-20 15:25:53,026 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:25:53,027 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:25:58,252 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:25:58,254 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_401.mp4
2025-03-20 15:25:58,254 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:25:58,254 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:25:58,255 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:25:58,674 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:25:59,678 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 15:25:59,678 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:25:59,678 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:26:00,759 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 15:26:00,760 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 15:26:00,760 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 15:26:02,841 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 15:26:02,842 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 15:26:03,945 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 15:26:03,946 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:26:03,946 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:26:05,036 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 15:26:05,037 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 15:26:05,038 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:26:05,038 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 15:23:49\n- 结束时间: 2025-03-20 15:26:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_400.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_400.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_401.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:26:05"}]}]}}
2025-03-20 15:26:05,457 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 15:26:05,461 - QuickAppADBTester - INFO - 测试完成
2025-03-20 15:26:05,461 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-20 15:31:05,492 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:31:05,495 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:31:05,495 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:31:05,495 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:31:05,589 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:31:05,665 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:31:05,665 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:31:05,665 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:31:05,665 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:31:05,827 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:31:05,828 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:31:05,828 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:31:05,828 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:31:07,241 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:31:07,241 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:31:08,423 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:31:08,423 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:31:08,423 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:31:08,423 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:31:08,423 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:31:08,546 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:31:08,546 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:31:08,546 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:31:08,546 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:31:09,915 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:31:09,917 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:31:11,094 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:31:11,094 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:31:11,094 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:31:11,094 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:31:11,095 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:31:12,163 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:31:12,164 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:31:12,260 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:31:14,264 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:31:14,264 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:31:15,351 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:31:15,352 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:31:15,353 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:31:15,353 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:31:15,431 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:31:17,439 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:31:17,439 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:31:19,540 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:31:19,541 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:31:21,615 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:31:21,616 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:31:22,715 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:31:22,716 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:31:22,716 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:31:22,716 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:31:22,792 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:31:24,802 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:31:24,803 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:31:26,919 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:31:26,920 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:31:28,313 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:31:29,723 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:31:29,724 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:31:30,845 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:31:30,846 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:31:31,911 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:31:31,911 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:31:34,020 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:31:34,021 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:31:34,021 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:31:34,021 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:31:34,021 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:31:35,143 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:31:35,144 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:31:35,246 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:31:40,249 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:31:40,250 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:31:42,340 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:31:42,342 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:31:47,438 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:31:47,438 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:31:49,556 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:31:54,562 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:31:54,564 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_153154.mp4
2025-03-20 15:31:54,564 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:31:54,564 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:31:59,823 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:31:59,826 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:31:59,871 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:32:01,009 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153154.mp4
2025-03-20 15:32:01,010 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153154.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:32:03,020 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:32:06,026 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:32:06,026 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:32:09,031 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:32:09,033 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:32:09,033 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:32:10,145 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:32:10,146 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:32:10,146 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:32:10,146 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:32:10,226 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:32:12,238 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:32:12,238 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:32:12,238 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:32:14,431 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:32:14,432 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:32:22,530 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:32:22,531 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:32:22,531 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:32:22,531 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:22,767 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:32:22,767 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:22,966 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:32:22,966 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:23,165 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:32:23,166 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:23,389 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:32:23,390 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:23,604 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:32:23,604 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:23,845 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:32:23,845 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:24,051 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:32:24,051 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:24,253 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:32:24,253 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:24,496 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:32:24,497 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:32:26,707 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:32:26,708 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:32:26,709 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:32:26,816 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{424a6ac u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1385}
    * Task{3ffeb0a #1385 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:32:26,816 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:32:26,816 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:32:26,816 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:32:26,816 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_153226_20250320_153226.png
2025-03-20 15:32:27,954 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_153226_20250320_153226.png
2025-03-20 15:32:27,955 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_153226_20250320_153226.png
2025-03-20 15:32:27,955 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:32:34,807 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_402.jpg
2025-03-20 15:32:34,809 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_402.jpg
2025-03-20 15:32:34,809 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:32:34,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:32:34,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:32:36,121 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:32:44,903 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:32:44,904 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:32:44,905 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:32:45,007 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{424a6ac u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1385}
    * Task{3ffeb0a #1385 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:32:45,008 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:32:45,008 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:32:45,008 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:32:45,008 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_153245_20250320_153245.png
2025-03-20 15:32:46,176 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_153245_20250320_153245.png
2025-03-20 15:32:46,176 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_153245_20250320_153245.png
2025-03-20 15:32:46,176 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:32:50,666 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_402.jpg
2025-03-20 15:32:50,671 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_402.jpg
2025-03-20 15:32:50,671 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:32:50,672 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:32:50,672 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:32:50,672 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:32:52,785 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:32:52,787 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:32:52,787 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:32:52,787 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:32:53,793 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:32:54,795 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:32:54,796 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:32:54,796 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 132.4 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 15:32:54,796 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:33:04,800 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153154.mp4 (大小: 3.27MB)
2025-03-20 15:33:04,800 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:33:04,911 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.965622秒，无需修复
2025-03-20 15:33:04,911 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:33:04,911 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153154.mp4
2025-03-20 15:33:04,911 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:33:12,419 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_403.mp4
2025-03-20 15:33:12,425 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_403.mp4
2025-03-20 15:33:12,425 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:33:12,425 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:33:17,633 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:33:17,635 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_403.mp4
2025-03-20 15:33:17,635 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:33:17,635 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:33:17,635 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:33:17,866 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:33:18,871 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 15:33:18,871 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:33:18,872 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:33:19,963 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 15:33:19,964 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 15:33:19,964 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 15:33:22,048 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 15:33:22,049 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 15:33:23,154 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 15:33:23,155 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:33:23,156 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:33:24,251 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 15:33:24,252 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 15:33:24,252 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:33:24,253 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 15:31:08\n- 结束时间: 2025-03-20 15:33:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_402.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_402.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_403.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:33:24"}]}]}}
2025-03-20 15:33:24,692 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 15:33:24,695 - QuickAppADBTester - INFO - 测试完成
2025-03-20 15:38:24,776 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:38:24,778 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:38:24,778 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:38:24,778 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:38:24,875 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:38:24,955 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:38:24,955 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:38:24,956 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:38:24,956 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:38:25,099 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:38:25,100 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:38:25,100 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:38:25,100 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:38:26,508 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:38:26,509 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:38:27,691 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:38:27,691 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:38:27,691 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:38:27,691 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:38:27,691 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:38:27,811 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:38:27,811 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:38:27,811 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:38:27,811 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:38:29,182 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:38:29,183 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:38:30,361 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:38:30,361 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:38:30,361 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:38:30,361 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:38:30,361 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:38:31,430 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:38:31,431 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:38:31,536 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:38:33,542 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:38:33,542 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:38:34,631 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:38:34,632 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:38:34,633 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:38:34,633 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:38:34,710 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:38:36,719 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:38:36,720 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:38:38,825 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:38:38,825 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:38:40,901 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:38:40,901 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:38:42,001 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:38:42,002 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:38:42,002 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:38:42,002 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:38:42,076 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:38:44,084 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:38:44,085 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:38:46,184 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:38:46,184 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:38:47,568 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:38:48,981 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:38:48,981 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:38:50,086 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:38:50,087 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:38:51,170 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:38:51,171 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:38:53,283 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:38:53,285 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:38:53,285 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:38:53,285 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:38:53,285 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:38:54,406 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:38:54,407 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:38:54,500 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:38:59,506 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:38:59,506 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:39:01,602 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:39:01,603 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:39:06,701 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:39:06,702 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:39:08,823 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:39:13,825 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:39:13,826 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_153913.mp4
2025-03-20 15:39:13,826 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:39:13,826 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:39:19,081 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:39:19,082 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:39:19,123 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:39:20,260 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153913.mp4
2025-03-20 15:39:20,261 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153913.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:39:22,271 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:39:25,276 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:39:25,276 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:39:28,281 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:39:28,281 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:39:28,281 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:39:29,388 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:39:29,389 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:39:29,389 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:39:29,389 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:39:29,465 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:39:31,474 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:39:31,475 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:39:31,475 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:39:33,678 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:39:33,679 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:39:41,789 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:39:41,789 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:39:41,790 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:39:41,790 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:42,088 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:39:42,089 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:42,323 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:39:42,324 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:42,560 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:39:42,560 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:42,795 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:39:42,796 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:42,990 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:39:42,991 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:43,214 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:39:43,215 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:43,421 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:39:43,422 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:43,655 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:39:43,656 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:43,841 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:39:43,841 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:39:46,044 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:39:46,045 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:39:46,045 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:39:46,146 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c416e42 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1391}
    * Task{4799489 #1391 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:39:46,147 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:39:46,147 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:39:46,147 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:39:46,147 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_153946_20250320_153946.png
2025-03-20 15:39:47,263 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_153946_20250320_153946.png
2025-03-20 15:39:47,264 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_153946_20250320_153946.png
2025-03-20 15:39:47,264 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:39:53,923 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_404.jpg
2025-03-20 15:39:53,929 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_404.jpg
2025-03-20 15:39:53,929 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:39:53,929 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:39:53,929 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:39:55,384 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:40:04,034 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:40:04,035 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:40:04,036 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:40:04,127 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c416e42 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1391}
    * Task{4799489 #1391 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:40:04,128 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:40:04,128 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:40:04,128 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:40:04,128 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_154004_20250320_154004.png
2025-03-20 15:40:05,260 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_154004_20250320_154004.png
2025-03-20 15:40:05,260 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_154004_20250320_154004.png
2025-03-20 15:40:05,260 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:40:09,845 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_404.jpg
2025-03-20 15:40:09,849 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_404.jpg
2025-03-20 15:40:09,849 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:40:09,849 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:40:09,849 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:40:09,849 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:40:11,946 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:40:11,947 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:40:11,947 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:40:11,947 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:40:12,952 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:40:13,955 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:40:13,956 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:40:13,956 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 113.0 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 15:40:13,956 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:40:23,961 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153913.mp4 (大小: 3.06MB)
2025-03-20 15:40:23,963 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:40:24,111 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.967800秒，无需修复
2025-03-20 15:40:24,111 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:40:24,111 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_153913.mp4
2025-03-20 15:40:24,111 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:40:31,507 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_405.mp4
2025-03-20 15:40:31,516 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_405.mp4
2025-03-20 15:40:31,517 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:40:31,517 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:40:36,760 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:40:36,761 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_405.mp4
2025-03-20 15:40:36,761 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:40:36,761 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:40:36,761 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:40:37,134 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:40:38,140 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 15:40:38,140 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:40:38,140 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:40:39,206 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 15:40:39,207 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 15:40:39,207 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 15:40:41,332 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 15:40:41,332 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 15:40:42,441 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 15:40:42,441 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:40:42,441 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:40:43,527 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 15:40:43,528 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 15:40:43,528 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:40:43,529 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 15:38:27\n- 结束时间: 2025-03-20 15:40:43\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_404.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_404.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_405.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:40:43"}]}]}}
2025-03-20 15:40:43,942 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 15:40:43,947 - QuickAppADBTester - INFO - 测试完成
2025-03-20 15:45:44,018 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:45:44,021 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:45:44,021 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:45:44,021 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:45:44,128 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:45:44,211 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:45:44,211 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:45:44,211 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:45:44,211 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:45:44,370 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:45:44,371 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:45:44,371 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:45:44,371 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:45:45,782 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:45:45,783 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:45:46,959 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:45:46,959 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:45:46,959 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:45:46,959 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:45:46,959 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:45:47,077 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:45:47,077 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:45:47,077 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:45:47,077 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:45:48,439 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:45:48,440 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:45:49,625 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:45:49,625 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:45:49,625 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:45:49,625 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:45:49,625 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:45:50,692 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:45:50,693 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:45:50,787 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:45:52,792 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:45:52,792 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:45:53,881 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:45:53,882 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:45:53,882 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:45:53,882 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:45:53,957 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:45:55,967 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:45:55,968 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:45:58,070 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:45:58,070 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:46:00,153 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:46:00,154 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:46:01,254 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:46:01,255 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:46:01,255 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:46:01,255 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:46:01,329 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:46:03,337 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:46:03,338 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:46:05,444 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:46:05,445 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:46:06,826 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:46:08,237 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:46:08,238 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:46:09,351 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:46:09,351 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:46:10,417 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:46:10,417 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:46:12,536 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:46:12,537 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:46:12,537 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:46:12,537 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:46:12,537 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:46:13,634 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:46:13,636 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:46:13,731 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:46:18,737 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:46:18,738 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:46:20,843 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:46:20,845 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:46:25,945 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:46:25,946 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:46:28,078 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:46:33,085 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:46:33,086 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_154633.mp4
2025-03-20 15:46:33,086 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:46:33,086 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:46:38,365 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:46:38,366 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:46:38,405 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:46:39,533 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_154633.mp4
2025-03-20 15:46:39,533 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_154633.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:46:41,541 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:46:44,545 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:46:44,546 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:46:47,549 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:46:47,549 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:46:47,549 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:46:48,658 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:46:48,659 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:46:48,659 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:46:48,659 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:46:48,734 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:46:50,744 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:46:50,744 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:46:50,745 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:46:52,933 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:46:52,934 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:47:01,025 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:47:01,026 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:47:01,026 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:47:01,027 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:01,261 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:47:01,262 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:01,479 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:47:01,480 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:01,680 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:47:01,680 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:01,895 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:47:01,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:02,130 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:47:02,131 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:02,368 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:47:02,369 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:02,578 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:47:02,579 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:02,890 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:47:02,890 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:03,186 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:47:03,186 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:47:05,385 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:47:05,385 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:47:05,385 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:47:05,445 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5868dc7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1397}
    * Task{96f8992 #1397 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:47:05,445 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:47:05,445 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:47:05,445 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:47:05,446 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_154705_20250320_154705.png
2025-03-20 15:47:06,515 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_154705_20250320_154705.png
2025-03-20 15:47:06,515 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_154705_20250320_154705.png
2025-03-20 15:47:06,515 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:47:12,868 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_406.jpg
2025-03-20 15:47:12,873 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_406.jpg
2025-03-20 15:47:12,874 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:47:12,874 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:47:12,874 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:47:14,636 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:47:22,963 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:47:22,964 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:47:22,964 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:47:23,058 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{5868dc7 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1397}
    * Task{96f8992 #1397 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:47:23,059 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:47:23,060 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:47:23,060 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:47:23,060 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_154723_20250320_154723.png
2025-03-20 15:47:24,197 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_154723_20250320_154723.png
2025-03-20 15:47:24,198 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_154723_20250320_154723.png
2025-03-20 15:47:24,198 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:47:28,523 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_406.jpg
2025-03-20 15:47:28,529 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_406.jpg
2025-03-20 15:47:28,530 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:47:28,530 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:47:28,530 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:47:28,530 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:47:30,649 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:47:30,650 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:47:30,650 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:47:30,650 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:47:31,655 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:47:32,659 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:47:32,660 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:47:32,660 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 133.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 15:47:32,660 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:47:42,662 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_154633.mp4 (大小: 3.13MB)
2025-03-20 15:47:42,663 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:47:42,774 - QuickAppADBTester - INFO - 录制文件完整，时长: 50.372533秒，无需修复
2025-03-20 15:47:42,774 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:47:42,774 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_154633.mp4
2025-03-20 15:47:42,774 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:47:49,991 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_407.mp4
2025-03-20 15:47:49,998 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_407.mp4
2025-03-20 15:47:49,999 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:47:49,999 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:47:55,194 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:47:55,196 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_407.mp4
2025-03-20 15:47:55,196 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:47:55,196 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:47:55,196 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:47:55,570 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:47:56,572 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 15:47:56,573 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:47:56,573 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:47:57,646 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 15:47:57,646 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 15:47:57,646 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 15:47:59,717 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 15:47:59,718 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 15:48:00,829 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 15:48:00,830 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:48:00,830 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:48:01,919 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 15:48:01,920 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 15:48:01,921 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:48:01,921 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 15:45:46\n- 结束时间: 2025-03-20 15:48:01\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_406.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_406.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_407.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:48:01"}]}]}}
2025-03-20 15:48:02,417 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 15:48:02,420 - QuickAppADBTester - INFO - 测试完成
2025-03-20 15:53:02,454 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 15:53:02,455 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 15:53:02,456 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 15:53:02,456 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 15:53:02,552 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 15:53:02,635 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 15:53:02,635 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 15:53:02,635 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:53:02,635 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:53:02,761 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:53:02,761 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:53:02,761 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:53:02,761 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:53:04,162 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:53:04,163 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:53:05,355 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:53:05,356 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 15:53:05,356 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 15:53:05,356 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 15:53:05,356 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 15:53:05,488 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 15:53:05,488 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 15:53:05,488 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 15:53:05,488 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 15:53:06,852 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:53:06,853 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:53:08,034 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 15:53:08,034 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 15:53:08,034 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:53:08,034 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:53:08,034 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:53:09,099 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 15:53:09,100 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 15:53:09,202 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 15:53:11,204 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 15:53:11,205 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 15:53:12,293 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 15:53:12,294 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 15:53:12,294 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:53:12,294 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 15:53:12,376 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:53:14,385 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 15:53:14,386 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 15:53:16,488 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 15:53:16,489 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 15:53:18,576 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 15:53:18,577 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 15:53:19,680 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 15:53:19,681 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 15:53:19,681 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:53:19,681 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 15:53:19,757 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:53:21,767 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 15:53:21,768 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 15:53:23,866 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 15:53:23,867 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 15:53:25,264 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 15:53:26,691 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 15:53:26,691 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 15:53:27,813 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 15:53:27,814 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 15:53:28,907 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 15:53:28,908 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 15:53:31,031 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 15:53:31,032 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 15:53:31,032 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 15:53:31,033 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:53:31,033 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:53:32,148 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 15:53:32,149 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 15:53:32,244 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 15:53:37,254 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 15:53:37,255 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 15:53:39,362 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 15:53:39,362 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 15:53:44,449 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 15:53:44,450 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 15:53:46,572 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 15:53:51,582 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 15:53:51,582 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_155351.mp4
2025-03-20 15:53:51,583 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:53:51,583 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:53:56,807 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:53:56,808 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 15:53:56,847 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 15:53:57,936 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_155351.mp4
2025-03-20 15:53:57,937 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_155351.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 15:53:59,951 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 15:54:02,962 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 15:54:02,962 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 15:54:05,972 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 15:54:05,973 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 15:54:05,973 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 15:54:07,088 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 15:54:07,088 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 15:54:07,088 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 15:54:07,088 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 15:54:07,160 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 15:54:09,178 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 15:54:09,178 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 15:54:09,178 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 15:54:11,379 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 15:54:11,380 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 15:54:19,492 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 15:54:19,494 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 15:54:19,495 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 15:54:19,495 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:19,728 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 15:54:19,729 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:19,945 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 15:54:19,945 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:20,186 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 15:54:20,187 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:20,399 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 15:54:20,400 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:20,616 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 15:54:20,617 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:20,833 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 15:54:20,834 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:21,078 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 15:54:21,079 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:21,306 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 15:54:21,307 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:21,520 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 15:54:21,521 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 15:54:23,747 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 15:54:23,748 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:54:23,748 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:54:23,847 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{879b09c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1403}
    * Task{eec962b #1403 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:54:23,848 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:54:23,848 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 15:54:23,848 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 15:54:23,848 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_155423_20250320_155423.png
2025-03-20 15:54:25,100 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_155423_20250320_155423.png
2025-03-20 15:54:25,100 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_155423_20250320_155423.png
2025-03-20 15:54:25,101 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:54:32,346 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_408.jpg
2025-03-20 15:54:32,353 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_408.jpg
2025-03-20 15:54:32,353 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 15:54:32,353 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:54:32,353 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:54:33,206 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 15:54:42,455 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 15:54:42,456 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 15:54:42,457 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 15:54:42,549 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{879b09c u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1403}
    * Task{eec962b #1403 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 15:54:42,550 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 15:54:42,550 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 15:54:42,550 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 15:54:42,550 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_155442_20250320_155442.png
2025-03-20 15:54:43,784 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_155442_20250320_155442.png
2025-03-20 15:54:43,784 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_155442_20250320_155442.png
2025-03-20 15:54:43,784 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 15:54:49,434 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_409.jpg
2025-03-20 15:54:49,440 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_409.jpg
2025-03-20 15:54:49,440 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 15:54:49,441 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 15:54:49,441 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:54:49,441 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:54:51,543 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 15:54:51,544 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 15:54:51,544 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 15:54:51,544 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 15:54:52,553 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 15:54:53,564 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 15:54:53,564 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 15:54:53,564 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 140.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 15:54:53,565 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 15:55:03,574 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_155351.mp4 (大小: 3.66MB)
2025-03-20 15:55:03,576 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 15:55:03,684 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.906911秒，无需修复
2025-03-20 15:55:03,684 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 15:55:03,684 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_155351.mp4
2025-03-20 15:55:03,684 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 15:55:11,655 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_410.mp4
2025-03-20 15:55:11,663 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_410.mp4
2025-03-20 15:55:11,663 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 15:55:11,663 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 15:55:16,878 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 15:55:16,879 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_410.mp4
2025-03-20 15:55:16,880 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 15:55:16,880 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 15:55:16,880 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 15:55:17,223 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 15:55:18,233 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 15:55:18,234 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:55:18,234 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:55:19,327 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 15:55:19,328 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 15:55:19,329 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 15:55:21,421 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 15:55:21,422 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 15:55:22,532 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 15:55:22,533 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 15:55:22,533 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 15:55:23,636 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 15:55:23,637 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 15:55:23,637 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 15:55:23,638 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 15:53:05\n- 结束时间: 2025-03-20 15:55:23\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_408.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_409.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_410.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 15:55:23"}]}]}}
2025-03-20 15:55:24,353 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 15:55:24,357 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:00:24,402 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:00:24,405 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:00:24,405 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:00:24,406 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:00:24,502 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 16:00:24,575 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 16:00:24,575 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 16:00:24,575 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:00:24,575 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:00:24,707 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:00:24,707 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:00:24,707 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:00:24,708 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:00:26,104 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:00:26,105 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:00:27,272 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:00:27,273 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:00:27,273 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:00:27,273 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:00:27,273 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:00:27,384 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:00:27,385 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:00:27,385 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:00:27,385 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:00:28,751 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:00:28,752 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:00:29,927 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:00:29,927 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:00:29,927 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:00:29,927 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:00:29,927 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:00:30,991 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:00:30,992 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:00:31,090 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:00:33,093 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:00:33,094 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 16:00:34,182 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:00:34,183 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:00:34,183 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:00:34,183 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:00:34,260 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:00:36,265 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:00:36,266 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 16:00:38,408 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:00:38,408 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 16:00:40,474 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:00:40,474 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 16:00:41,572 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 16:00:41,573 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 16:00:41,573 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:00:41,573 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 16:00:41,646 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:00:43,654 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 16:00:43,655 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 16:00:45,767 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 16:00:45,768 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 16:00:47,160 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 16:00:48,558 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 16:00:48,558 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 16:00:49,660 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 16:00:49,660 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 16:00:50,750 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 16:00:50,751 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 16:00:52,846 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 16:00:52,847 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 16:00:52,847 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:00:52,847 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:00:52,847 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:00:53,950 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 16:00:53,950 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 16:00:54,050 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 16:00:59,052 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 16:00:59,053 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 16:01:01,147 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 16:01:01,148 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 16:01:06,248 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 16:01:06,249 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 16:01:08,368 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 16:01:13,370 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 16:01:13,370 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_160113.mp4
2025-03-20 16:01:13,371 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:01:13,371 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:01:18,625 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:01:18,627 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 16:01:18,673 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 16:01:19,807 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160113.mp4
2025-03-20 16:01:19,808 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160113.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 16:01:21,821 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 16:01:24,827 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 16:01:24,828 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 16:01:27,832 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 16:01:27,833 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 16:01:27,833 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 16:01:28,946 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 16:01:28,947 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 16:01:28,947 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:01:28,947 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 16:01:29,022 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:01:31,031 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 16:01:31,032 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 16:01:31,032 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 16:01:33,228 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 16:01:33,228 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 16:01:41,340 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 16:01:41,342 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 16:01:41,342 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 16:01:41,342 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:41,566 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 16:01:41,567 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:41,789 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 16:01:41,790 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:42,002 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 16:01:42,003 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:42,221 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 16:01:42,222 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:42,438 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 16:01:42,439 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:42,680 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 16:01:42,680 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:42,895 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 16:01:42,895 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:43,101 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 16:01:43,102 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:43,329 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 16:01:43,331 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:01:45,540 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 16:01:45,541 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:01:45,541 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:01:45,628 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a61ea2f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1409}
    * Task{ca369c5 #1409 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:01:45,629 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:01:45,629 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 16:01:45,629 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 16:01:45,629 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_160145_20250320_160145.png
2025-03-20 16:01:47,122 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_160145_20250320_160145.png
2025-03-20 16:01:47,122 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_160145_20250320_160145.png
2025-03-20 16:01:47,123 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:01:53,936 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_411.jpg
2025-03-20 16:01:53,944 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_411.jpg
2025-03-20 16:01:53,945 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 16:01:53,945 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:01:53,945 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:01:54,924 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 16:02:04,040 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 16:02:04,040 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:02:04,041 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:02:04,146 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{a61ea2f u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1409}
    * Task{ca369c5 #1409 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:02:04,146 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:02:04,147 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 16:02:04,147 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 16:02:04,147 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_160204_20250320_160204.png
2025-03-20 16:02:05,592 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_160204_20250320_160204.png
2025-03-20 16:02:05,592 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_160204_20250320_160204.png
2025-03-20 16:02:05,592 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:02:10,164 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_411.jpg
2025-03-20 16:02:10,171 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_411.jpg
2025-03-20 16:02:10,172 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 16:02:10,172 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 16:02:10,172 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:02:10,172 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:02:12,272 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 16:02:12,272 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 16:02:12,273 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 16:02:12,273 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 16:02:13,277 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 16:02:14,279 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 16:02:14,280 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 16:02:14,280 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 123.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 16:02:14,280 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 16:02:24,286 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160113.mp4 (大小: 3.68MB)
2025-03-20 16:02:24,286 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 16:02:24,399 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.767778秒，无需修复
2025-03-20 16:02:24,399 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 16:02:24,399 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160113.mp4
2025-03-20 16:02:24,399 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 16:02:31,526 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_412.mp4
2025-03-20 16:02:31,532 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_412.mp4
2025-03-20 16:02:31,532 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:02:31,532 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:02:36,733 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:02:36,734 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_412.mp4
2025-03-20 16:02:36,734 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 16:02:36,734 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 16:02:36,735 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 16:02:37,124 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 16:02:38,128 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 16:02:38,129 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:02:38,129 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:02:39,208 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 16:02:39,209 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 16:02:39,209 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 16:02:41,292 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 16:02:41,292 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 16:02:42,407 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 16:02:42,408 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:02:42,408 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:02:43,497 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 16:02:43,499 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 16:02:43,499 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 16:02:43,500 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 16:00:27\n- 结束时间: 2025-03-20 16:02:43\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_411.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_411.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_412.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:02:43"}]}]}}
2025-03-20 16:02:43,917 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 16:02:43,924 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:07:44,349 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:07:44,351 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:07:44,351 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:07:44,351 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:07:44,445 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 16:07:44,525 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 16:07:44,526 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 16:07:44,526 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:07:44,526 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:07:44,661 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:07:44,662 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:07:44,662 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:07:44,662 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:07:46,070 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:07:46,071 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:07:47,257 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:07:47,258 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:07:47,258 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:07:47,258 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:07:47,258 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:07:47,384 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:07:47,384 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:07:47,385 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:07:47,385 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:07:48,752 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:07:48,753 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:07:49,938 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:07:49,939 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:07:49,939 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:07:49,939 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:07:49,939 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:07:51,015 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:07:51,015 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:07:51,108 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:07:53,118 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:07:53,119 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 16:07:54,212 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:07:54,213 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:07:54,213 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:07:54,214 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:07:54,291 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:07:56,309 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:07:56,309 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 16:07:58,421 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:07:58,422 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 16:08:00,513 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:08:00,514 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 16:08:01,617 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 16:08:01,618 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 16:08:01,618 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:08:01,618 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 16:08:01,696 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:08:03,715 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 16:08:03,716 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 16:08:05,826 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 16:08:05,827 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 16:08:07,237 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 16:08:08,652 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 16:08:08,653 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 16:08:09,771 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 16:08:09,772 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 16:08:10,863 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 16:08:10,864 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 16:08:12,978 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 16:08:12,979 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 16:08:12,979 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:08:12,979 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:08:12,980 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:08:14,097 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 16:08:14,097 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 16:08:14,257 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 16:08:19,266 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 16:08:19,267 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 16:08:21,368 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 16:08:21,371 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 16:08:26,479 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 16:08:26,480 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 16:08:28,608 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 16:08:33,616 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 16:08:33,617 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_160833.mp4
2025-03-20 16:08:33,617 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:08:33,617 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:08:38,845 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:08:38,846 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 16:08:38,891 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 16:08:39,994 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160833.mp4
2025-03-20 16:08:39,995 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160833.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 16:08:42,011 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 16:08:45,020 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 16:08:45,020 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 16:08:48,028 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 16:08:48,029 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 16:08:48,029 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 16:08:49,145 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 16:08:49,146 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 16:08:49,146 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:08:49,146 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 16:08:49,225 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:08:51,245 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 16:08:51,246 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 16:08:51,247 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 16:08:53,443 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 16:08:53,444 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 16:09:01,549 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 16:09:01,550 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 16:09:01,551 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 16:09:01,551 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:01,850 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 16:09:01,851 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:02,055 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 16:09:02,056 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:02,281 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 16:09:02,281 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:02,490 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 16:09:02,491 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:02,733 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 16:09:02,734 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:02,939 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 16:09:02,939 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:03,130 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 16:09:03,130 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:03,365 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 16:09:03,366 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:03,576 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 16:09:03,577 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:09:05,808 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 16:09:05,809 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:09:05,809 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:09:05,903 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c392ea0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1415}
    * Task{dcf9eff #1415 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:09:05,903 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:09:05,903 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 16:09:05,903 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 16:09:05,903 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_160905_20250320_160905.png
2025-03-20 16:09:07,122 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_160905_20250320_160905.png
2025-03-20 16:09:07,123 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_160905_20250320_160905.png
2025-03-20 16:09:07,123 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:09:13,612 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_413.jpg
2025-03-20 16:09:13,616 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_413.jpg
2025-03-20 16:09:13,617 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 16:09:13,617 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:09:13,617 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:09:15,217 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 16:09:23,714 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 16:09:23,715 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:09:23,715 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:09:23,831 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{c392ea0 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1415}
    * Task{dcf9eff #1415 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:09:23,832 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:09:23,832 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 16:09:23,832 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 16:09:23,832 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_160923_20250320_160923.png
2025-03-20 16:09:25,125 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_160923_20250320_160923.png
2025-03-20 16:09:25,125 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_160923_20250320_160923.png
2025-03-20 16:09:25,125 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:09:30,867 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_414.jpg
2025-03-20 16:09:30,874 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_414.jpg
2025-03-20 16:09:30,874 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 16:09:30,875 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 16:09:30,875 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:09:30,875 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:09:32,982 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 16:09:32,982 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 16:09:32,983 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 16:09:32,983 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 16:09:33,993 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 16:09:35,000 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 16:09:35,000 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 16:09:35,000 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 127.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 16:09:35,000 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 16:09:45,010 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160833.mp4 (大小: 3.44MB)
2025-03-20 16:09:45,011 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 16:09:45,127 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.242978秒，无需修复
2025-03-20 16:09:45,127 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 16:09:45,127 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_160833.mp4
2025-03-20 16:09:45,127 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 16:09:52,369 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_415.mp4
2025-03-20 16:09:52,377 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_415.mp4
2025-03-20 16:09:52,377 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:09:52,377 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:09:57,595 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:09:57,596 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_415.mp4
2025-03-20 16:09:57,596 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 16:09:57,596 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 16:09:57,597 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 16:09:57,986 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 16:09:58,997 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 16:09:58,997 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:09:58,998 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:10:00,093 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 16:10:00,094 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 16:10:00,094 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 16:10:02,182 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 16:10:02,183 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 16:10:03,307 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 16:10:03,308 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:10:03,308 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:10:04,406 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 16:10:04,407 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 16:10:04,408 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 16:10:04,408 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 16:07:47\n- 结束时间: 2025-03-20 16:10:04\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_413.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_414.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_415.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:10:04"}]}]}}
2025-03-20 16:10:04,813 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 16:10:04,814 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:15:04,876 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:15:04,877 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:15:04,877 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:15:04,877 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:15:04,945 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 16:15:05,037 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 16:15:05,040 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 16:15:05,040 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:15:05,040 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:15:05,173 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:15:05,173 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:15:05,173 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:15:05,173 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:15:06,557 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:15:06,558 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:15:07,746 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:15:07,746 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:15:07,746 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:15:07,747 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:15:07,747 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:15:07,883 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:15:07,883 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:15:07,883 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:15:07,884 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:15:09,263 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:15:09,264 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:15:10,446 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:15:10,447 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:15:10,447 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:15:10,447 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:15:10,447 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:15:11,512 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:15:11,513 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:15:11,615 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:15:13,621 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:15:13,621 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 16:15:14,701 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:15:14,702 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:15:14,702 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:15:14,702 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:15:14,778 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:15:16,788 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:15:16,788 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 16:15:18,898 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:15:18,898 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 16:15:20,986 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:15:20,987 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 16:15:22,088 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 16:15:22,089 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 16:15:22,090 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:15:22,090 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 16:15:22,165 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:15:24,169 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 16:15:24,170 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 16:15:26,279 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 16:15:26,280 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 16:15:27,670 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 16:15:29,080 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 16:15:29,081 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 16:15:30,206 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 16:15:30,207 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 16:15:31,294 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 16:15:31,295 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 16:15:33,412 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 16:15:33,414 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 16:15:33,414 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:15:33,414 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:15:33,414 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:15:34,534 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 16:15:34,535 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 16:15:34,631 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 16:15:39,635 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 16:15:39,637 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 16:15:41,738 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 16:15:41,739 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 16:15:46,845 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 16:15:46,846 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 16:15:48,977 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 16:15:53,983 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 16:15:53,985 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_161553.mp4
2025-03-20 16:15:53,985 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:15:53,986 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:15:59,248 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:15:59,250 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 16:15:59,295 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 16:16:00,427 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_161553.mp4
2025-03-20 16:16:00,428 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_161553.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 16:16:02,441 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 16:16:05,448 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 16:16:05,448 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 16:16:08,453 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 16:16:08,454 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 16:16:08,454 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 16:16:09,563 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 16:16:09,564 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 16:16:09,564 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:16:09,564 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 16:16:09,639 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:16:11,644 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 16:16:11,645 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 16:16:11,645 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 16:16:13,834 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 16:16:13,836 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 16:16:21,926 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 16:16:21,926 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 16:16:21,926 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 16:16:21,926 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:22,221 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 16:16:22,222 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:22,428 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 16:16:22,428 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:22,652 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 16:16:22,653 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:22,859 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 16:16:22,859 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:23,084 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 16:16:23,085 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:23,299 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 16:16:23,300 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:23,514 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 16:16:23,515 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:23,710 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 16:16:23,711 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:23,914 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 16:16:23,915 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:16:26,131 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 16:16:26,132 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:16:26,132 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:16:26,220 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{cbeb418 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1421}
    * Task{5d31cd7 #1421 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:16:26,220 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:16:26,220 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 16:16:26,220 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 16:16:26,221 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_161626_20250320_161626.png
2025-03-20 16:16:27,544 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_161626_20250320_161626.png
2025-03-20 16:16:27,544 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_161626_20250320_161626.png
2025-03-20 16:16:27,544 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:16:34,258 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_416.jpg
2025-03-20 16:16:34,266 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_416.jpg
2025-03-20 16:16:34,267 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 16:16:34,267 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:16:34,267 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:16:35,562 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 16:16:44,384 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 16:16:44,386 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:16:44,387 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:16:44,483 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{cbeb418 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1421}
    * Task{5d31cd7 #1421 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:16:44,484 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:16:44,484 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 16:16:44,484 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 16:16:44,484 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_161644_20250320_161644.png
2025-03-20 16:16:45,829 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_161644_20250320_161644.png
2025-03-20 16:16:45,829 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_161644_20250320_161644.png
2025-03-20 16:16:45,830 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:16:50,503 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_416.jpg
2025-03-20 16:16:50,504 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_416.jpg
2025-03-20 16:16:50,504 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 16:16:50,504 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 16:16:50,504 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:16:50,504 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:16:52,687 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 16:16:52,688 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 16:16:52,688 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 16:16:52,688 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 16:16:53,727 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 16:16:54,752 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 16:16:54,753 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 16:16:54,753 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 128.6 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 16:16:54,753 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 16:17:04,758 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_161553.mp4 (大小: 3.64MB)
2025-03-20 16:17:04,759 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 16:17:04,910 - QuickAppADBTester - INFO - 录制文件完整，时长: 51.591067秒，无需修复
2025-03-20 16:17:04,910 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 16:17:04,910 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_161553.mp4
2025-03-20 16:17:04,910 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 16:17:12,309 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_417.mp4
2025-03-20 16:17:12,314 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_417.mp4
2025-03-20 16:17:12,314 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:17:12,314 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:17:17,513 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:17:17,514 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_417.mp4
2025-03-20 16:17:17,516 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 16:17:17,516 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 16:17:17,516 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 16:17:17,907 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 16:17:18,909 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 16:17:18,909 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:17:18,910 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:17:19,993 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 16:17:19,994 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 16:17:19,994 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 16:17:22,075 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 16:17:22,076 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 16:17:23,182 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 16:17:23,183 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:17:23,183 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:17:24,274 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 16:17:24,275 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 16:17:24,275 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 16:17:24,275 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 16:15:07\n- 结束时间: 2025-03-20 16:17:24\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_416.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_416.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_417.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:17:24"}]}]}}
2025-03-20 16:17:24,677 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 16:17:24,681 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:22:24,764 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:22:24,767 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:22:24,767 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:22:24,767 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:22:24,865 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 16:22:24,950 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 16:22:24,950 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 16:22:24,950 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:22:24,950 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:22:25,073 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:22:25,073 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:22:25,074 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:22:25,074 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:22:26,512 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:22:26,512 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:22:27,700 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:22:27,700 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:22:27,700 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:22:27,700 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:22:27,700 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:22:27,837 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:22:27,838 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:22:27,838 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:22:27,838 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:22:29,213 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:22:29,214 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:22:30,388 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:22:30,388 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:22:30,389 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:22:30,389 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:22:30,389 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:22:31,455 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:22:31,456 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:22:31,558 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:22:33,564 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:22:33,564 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 16:22:34,653 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:22:34,653 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:22:34,653 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:22:34,654 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:22:34,731 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:22:36,741 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:22:36,741 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 16:22:38,842 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:22:38,843 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 16:22:40,924 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:22:40,925 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 16:22:42,033 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 16:22:42,034 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 16:22:42,034 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:22:42,034 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 16:22:42,102 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:22:44,112 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 16:22:44,112 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 16:22:46,238 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 16:22:46,238 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 16:22:47,631 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 16:22:49,020 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 16:22:49,021 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 16:22:50,133 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 16:22:50,134 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 16:22:51,222 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 16:22:51,223 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 16:22:53,337 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 16:22:53,337 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 16:22:53,337 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:22:53,337 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:22:53,338 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:22:54,455 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 16:22:54,456 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 16:22:54,556 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 16:22:59,561 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 16:22:59,561 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 16:23:01,670 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 16:23:01,670 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 16:23:06,770 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 16:23:06,771 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 16:23:08,906 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 16:23:13,912 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 16:23:13,912 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_162313.mp4
2025-03-20 16:23:13,912 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:23:13,913 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:23:19,170 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:23:19,173 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 16:23:19,220 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 16:23:20,299 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_162313.mp4
2025-03-20 16:23:20,300 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_162313.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 16:23:22,311 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 16:23:25,317 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 16:23:25,318 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 16:23:28,322 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 16:23:28,323 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 16:23:28,323 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 16:23:29,443 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 16:23:29,444 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 16:23:29,445 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:23:29,445 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 16:23:29,514 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:23:31,523 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 16:23:31,525 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 16:23:31,525 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 16:23:33,713 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 16:23:33,714 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 16:23:41,823 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 16:23:41,825 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 16:23:41,825 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 16:23:41,826 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:42,064 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 16:23:42,065 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:42,312 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 16:23:42,313 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:42,541 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 16:23:42,542 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:42,761 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 16:23:42,762 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:42,972 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 16:23:42,973 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:43,180 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 16:23:43,181 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:43,399 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 16:23:43,399 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:43,630 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 16:23:43,631 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:43,843 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 16:23:43,843 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:23:46,054 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 16:23:46,055 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:23:46,055 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:23:46,146 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9258065 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1427}
    * Task{a231b48 #1427 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:23:46,147 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:23:46,147 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 16:23:46,147 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 16:23:46,147 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_162346_20250320_162346.png
2025-03-20 16:23:47,646 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_162346_20250320_162346.png
2025-03-20 16:23:47,646 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_162346_20250320_162346.png
2025-03-20 16:23:47,646 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:23:54,826 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_418.jpg
2025-03-20 16:23:54,832 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_418.jpg
2025-03-20 16:23:54,833 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 16:23:54,833 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:23:54,833 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:23:55,420 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 16:24:04,924 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 16:24:04,925 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:24:04,925 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:24:05,018 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{9258065 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1427}
    * Task{a231b48 #1427 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:24:05,018 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:24:05,018 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 16:24:05,018 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 16:24:05,018 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_162405_20250320_162405.png
2025-03-20 16:24:06,468 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_162405_20250320_162405.png
2025-03-20 16:24:06,468 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_162405_20250320_162405.png
2025-03-20 16:24:06,469 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:24:11,055 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_418.jpg
2025-03-20 16:24:11,061 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_418.jpg
2025-03-20 16:24:11,062 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 16:24:11,062 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 16:24:11,062 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:24:11,062 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:24:13,163 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 16:24:13,164 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 16:24:13,164 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 16:24:13,164 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 16:24:14,169 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 16:24:15,171 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 16:24:15,172 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 16:24:15,172 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 135.8 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 16:24:15,172 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 16:24:25,175 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_162313.mp4 (大小: 3.21MB)
2025-03-20 16:24:25,176 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 16:24:25,290 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.063611秒，无需修复
2025-03-20 16:24:25,290 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 16:24:25,290 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_162313.mp4
2025-03-20 16:24:25,290 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 16:24:32,223 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_419.mp4
2025-03-20 16:24:32,231 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_419.mp4
2025-03-20 16:24:32,231 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:24:32,232 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:24:37,430 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:24:37,431 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_419.mp4
2025-03-20 16:24:37,431 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 16:24:37,431 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 16:24:37,431 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 16:24:37,804 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 16:24:38,807 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 16:24:38,807 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:24:38,807 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:24:39,886 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 16:24:39,888 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 16:24:39,888 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 16:24:41,973 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 16:24:41,974 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 16:24:43,079 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 16:24:43,080 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:24:43,081 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:24:44,178 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 16:24:44,179 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 16:24:44,179 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 16:24:44,180 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 16:22:27\n- 结束时间: 2025-03-20 16:24:44\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_418.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_418.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_419.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:24:44"}]}]}}
2025-03-20 16:24:44,590 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 16:24:44,594 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:29:44,756 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:29:44,759 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:29:44,759 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:29:44,760 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:29:44,855 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 16:29:44,933 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 16:29:44,933 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 16:29:44,933 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:29:44,933 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:29:45,065 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:29:45,065 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:29:45,065 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:29:45,065 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:29:46,473 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:29:46,473 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:29:47,668 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:29:47,668 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:29:47,669 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:29:47,669 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:29:47,669 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:29:47,779 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:29:47,779 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:29:47,779 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:29:47,780 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:29:49,156 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:29:49,157 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:29:50,338 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:29:50,338 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:29:50,338 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:29:50,338 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:29:50,338 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:29:51,401 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:29:51,402 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:29:51,496 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:29:53,501 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:29:53,501 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 16:29:54,591 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:29:54,592 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:29:54,593 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:29:54,593 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:29:54,670 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:29:56,680 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:29:56,681 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 16:29:58,784 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:29:58,784 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 16:30:00,872 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:30:00,873 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 16:30:01,974 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 16:30:01,976 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 16:30:01,977 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:30:01,978 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 16:30:02,055 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:30:04,065 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 16:30:04,066 - QuickAppADBTester - INFO - 点击坐标: (261, 574)
2025-03-20 16:30:06,176 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 16:30:06,177 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 16:30:07,560 - QuickAppADBTester - INFO - 滑动: (490, 1663) -> (490, 712)
2025-03-20 16:30:08,965 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 16:30:08,966 - QuickAppADBTester - INFO - 点击坐标: (156, 1021)
2025-03-20 16:30:10,073 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 16:30:10,074 - QuickAppADBTester - INFO - 点击坐标: (555, 1271)
2025-03-20 16:30:11,157 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 16:30:11,158 - QuickAppADBTester - INFO - 点击坐标: (757, 2214)
2025-03-20 16:30:13,272 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 16:30:13,272 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 16:30:13,273 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:30:13,273 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:30:13,273 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:30:14,384 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 16:30:14,385 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 16:30:14,480 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 16:30:19,483 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 16:30:19,485 - QuickAppADBTester - INFO - 点击坐标: (965, 2247)
2025-03-20 16:30:21,601 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 16:30:21,602 - QuickAppADBTester - INFO - 点击坐标: (171, 1653)
2025-03-20 16:30:26,701 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 16:30:26,702 - QuickAppADBTester - INFO - 点击坐标: (735, 2226)
2025-03-20 16:30:28,834 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 16:30:33,839 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 16:30:33,840 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_163033.mp4
2025-03-20 16:30:33,840 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:30:33,841 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:30:39,094 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:30:39,095 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 16:30:39,140 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
7NQBB23606001053	device
2025-03-20 16:30:40,277 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_163033.mp4
2025-03-20 16:30:40,278 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_163033.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 16:30:42,289 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 16:30:45,295 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 16:30:45,297 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 16:30:48,302 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 16:30:48,302 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 16:30:48,302 - QuickAppADBTester - INFO - 点击坐标: (326, 354)
2025-03-20 16:30:49,408 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 16:30:49,409 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 16:30:49,409 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:30:49,412 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 16:30:49,492 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:30:51,503 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 16:30:51,504 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 16:30:51,505 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 16:30:53,691 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 16:30:53,692 - QuickAppADBTester - INFO - 点击坐标: (860, 370)
2025-03-20 16:31:01,796 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 16:31:01,797 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 16:31:01,797 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 16:31:01,797 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:02,083 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 16:31:02,084 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:02,284 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 16:31:02,285 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:02,564 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 16:31:02,564 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:02,768 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 16:31:02,769 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:02,994 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 16:31:02,994 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:03,169 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 16:31:03,170 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:03,390 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 16:31:03,391 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:03,578 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 16:31:03,579 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:03,803 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 16:31:03,803 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:31:06,011 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 16:31:06,011 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:31:06,012 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:31:06,109 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ad0b216 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1433}
    * Task{418396d #1433 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:31:06,110 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:31:06,110 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 16:31:06,110 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 16:31:06,110 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_163106_20250320_163106.png
2025-03-20 16:31:07,827 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_163106_20250320_163106.png
2025-03-20 16:31:07,829 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_163106_20250320_163106.png
2025-03-20 16:31:07,829 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:31:15,343 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_420.jpg
2025-03-20 16:31:15,350 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_420.jpg
2025-03-20 16:31:15,350 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 16:31:15,350 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:31:15,351 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:31:15,434 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 16:31:25,466 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 16:31:25,467 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:31:25,467 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:31:25,557 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{ad0b216 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t1433}
    * Task{418396d #1433 type=standard A=10148:com.huawei.fastapp.app.launcher0 U=0 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:31:25,557 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:31:25,557 - QuickAppADBTester - INFO - 拉回成功：按Home键后快应用仍在前台运行
2025-03-20 16:31:25,558 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 16:31:25,558 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_163125_20250320_163125.png
2025-03-20 16:31:27,273 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_163125_20250320_163125.png
2025-03-20 16:31:27,273 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_163125_20250320_163125.png
2025-03-20 16:31:27,274 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:31:31,935 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_420.jpg
2025-03-20 16:31:31,941 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_420.jpg
2025-03-20 16:31:31,942 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 16:31:31,942 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 16:31:31,942 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:31:31,942 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:31:34,040 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 16:31:34,041 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 16:31:34,041 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 16:31:34,041 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 16:31:35,046 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 16:31:36,052 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 16:31:36,052 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 16:31:36,052 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 139.9 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 16:31:36,053 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 16:31:46,057 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_163033.mp4 (大小: 3.26MB)
2025-03-20 16:31:46,059 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 16:31:46,209 - QuickAppADBTester - INFO - 录制文件完整，时长: 53.052167秒，无需修复
2025-03-20 16:31:46,209 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 16:31:46,209 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_163033.mp4
2025-03-20 16:31:46,209 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 16:31:53,649 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_421.mp4
2025-03-20 16:31:53,656 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_421.mp4
2025-03-20 16:31:53,657 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:31:53,657 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:31:58,856 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:31:58,858 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_421.mp4
2025-03-20 16:31:58,858 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 16:31:58,858 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 16:31:58,858 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 16:31:59,239 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 16:32:00,243 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 16:32:00,244 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:32:00,244 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:32:01,330 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 16:32:01,332 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 16:32:01,332 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 16:32:03,415 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 16:32:03,416 - QuickAppADBTester - INFO - 点击坐标: (540, 2147)
2025-03-20 16:32:04,522 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 16:32:04,524 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:32:04,524 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:32:05,621 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 16:32:05,621 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': True, '流程4_清空手机里的全部应用': True}
2025-03-20 16:32:05,622 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 16:32:05,622 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "✅ 快应用自动化测试成功"}, "template": "green"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "**快应用防侧滑和拉回测试成功完成！**\n\n- 开始时间: 2025-03-20 16:29:47\n- 结束时间: 2025-03-20 16:32:05\n- 测试设备: 华为设备\n\n**防侧滑:** ✅ 成功\n\n**拉回:** ✅ 成功"}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_420.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_420.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_421.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:32:05"}]}]}}
2025-03-20 16:32:06,077 - QuickAppADBTester - INFO - 飞书通知发送成功: ✅ 快应用自动化测试成功
2025-03-20 16:32:06,080 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:37:06,125 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:37:06,127 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:37:06,127 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:37:06,127 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:37:06,213 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 16:37:06,213 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 16:37:06,213 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 16:37:06,213 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:37:06,213 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:37:06,229 - QuickAppADBTester - WARNING - 无法通过mHoldingDisplaySuspendBlocker确定屏幕状态，尝试其他方法
2025-03-20 16:37:06,245 - QuickAppADBTester - INFO - 未检测到前台应用活动，屏幕可能处于熄屏状态
2025-03-20 16:37:06,245 - QuickAppADBTester - INFO - 屏幕处于熄屏状态，尝试唤醒
2025-03-20 16:37:06,245 - QuickAppADBTester - INFO - 尝试唤醒屏幕
2025-03-20 16:37:06,245 - QuickAppADBTester - INFO - 使用电源键唤醒
2025-03-20 16:37:06,245 - QuickAppADBTester - INFO - 按下按键: KEYCODE_POWER
2025-03-20 16:37:08,266 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:37:08,411 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:37:08,412 - QuickAppADBTester - INFO - 成功唤醒屏幕
2025-03-20 16:37:08,412 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:37:08,412 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:37:09,799 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:37:09,799 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:37:11,048 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:37:11,048 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:37:11,048 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:37:11,048 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:37:11,049 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:37:11,240 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:37:11,241 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:37:11,241 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:37:11,241 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:37:12,653 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:37:12,655 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:37:13,808 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:37:13,808 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:37:13,808 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:37:13,809 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:37:13,809 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:37:14,882 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:37:14,883 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:37:14,989 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:37:16,993 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:37:16,994 - QuickAppADBTester - INFO - 点击坐标: (276, 515)
2025-03-20 16:37:18,089 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:37:18,090 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:37:18,090 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:37:18,090 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:37:18,179 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:37:20,185 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:37:20,185 - QuickAppADBTester - INFO - 点击坐标: (254, 418)
2025-03-20 16:37:22,300 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:37:22,301 - QuickAppADBTester - INFO - 点击坐标: (239, 377)
2025-03-20 16:37:24,413 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:37:24,413 - QuickAppADBTester - INFO - 点击坐标: (239, 354)
2025-03-20 16:37:24,745 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 16:37:24,746 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 16:37:24,746 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 16:37:24,746 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-20 16:37:11\n- 中断时间: 2025-03-20 16:37:24\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:37:24"}]}]}}
2025-03-20 16:37:25,186 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 16:37:25,187 - QuickAppADBTester - INFO - 定时测试任务已结束
2025-03-20 16:45:15,366 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 16:45:15,366 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:45:15,367 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:45:15,367 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:45:15,367 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:45:15,649 - QuickAppADBTester - WARNING - 未检测到ADBKeyboard，某些功能可能无法正常工作
2025-03-20 16:45:15,649 - QuickAppADBTester - WARNING - 请安装ADBKeyboard: https://github.com/senzhk/ADBKeyBoard
2025-03-20 16:45:15,649 - QuickAppADBTester - WARNING - ADBKeyboard未安装，将使用备用输入方法（可能不支持中文）
2025-03-20 16:45:15,649 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:45:15,649 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:45:15,801 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:45:15,801 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:45:15,801 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:45:15,801 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:45:17,204 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:45:17,205 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:45:18,381 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:45:18,382 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:45:18,382 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:45:18,382 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:45:18,382 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:45:18,540 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:45:18,540 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:45:18,540 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:45:18,540 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:45:19,921 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:45:19,921 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:45:21,095 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:45:21,096 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:45:21,096 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:45:21,096 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:45:21,096 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:45:22,181 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:45:22,182 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:45:22,283 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:45:24,288 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:45:24,291 - QuickAppADBTester - INFO - 点击坐标: (274, 563)
2025-03-20 16:45:25,299 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 16:45:25,300 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 16:45:25,300 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送
2025-03-20 16:45:25,301 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试被手动中断！**\n\n- 开始时间: 2025-03-20 16:45:18\n- 中断时间: 2025-03-20 16:45:25\n- 测试设备: 华为设备\n\n**注意:** 测试过程被人为中断，未能完成全部测试流程。"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:45:25"}]}]}}
2025-03-20 16:45:25,777 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 16:56:41,541 - QuickAppADBTester - INFO - 启动定时任务模式，每30分钟执行一次测试
2025-03-20 16:56:41,542 - QuickAppADBTester - INFO - 启动快应用ADB测试
2025-03-20 16:56:41,542 - QuickAppADBTester - INFO - 初始化QuickAppADBTester
2025-03-20 16:56:41,542 - QuickAppADBTester - INFO - 确保ADBKeyboard被设置为默认输入法
2025-03-20 16:56:41,542 - QuickAppADBTester - INFO - 检查ADBKeyboard是否已安装
2025-03-20 16:56:41,608 - QuickAppADBTester - INFO - 检测到ADBKeyboard已安装（通过ime list确认）
2025-03-20 16:56:41,662 - QuickAppADBTester - INFO - 当前输入法: com.android.adbkeyboard/.AdbIME
2025-03-20 16:56:41,662 - QuickAppADBTester - INFO - 当前已经是ADBKeyboard输入法，无需切换
2025-03-20 16:56:41,662 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:56:41,662 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:56:41,813 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:56:41,814 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:56:41,814 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:56:41,814 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:56:43,201 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:56:43,201 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:56:44,391 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:56:44,392 - QuickAppADBTester - INFO - 开始执行所有流程
2025-03-20 16:56:44,392 - QuickAppADBTester - INFO - 确保屏幕处于亮屏状态
2025-03-20 16:56:44,392 - QuickAppADBTester - INFO - 确保屏幕亮起并解锁
2025-03-20 16:56:44,392 - QuickAppADBTester - INFO - 检查屏幕状态
2025-03-20 16:56:44,557 - QuickAppADBTester - INFO - 屏幕状态为亮屏 (mHoldingDisplaySuspendBlocker=true)
2025-03-20 16:56:44,557 - QuickAppADBTester - INFO - 屏幕已处于亮屏状态
2025-03-20 16:56:44,557 - QuickAppADBTester - INFO - 尝试简单解锁屏幕
2025-03-20 16:56:44,557 - QuickAppADBTester - INFO - 滑动: (540, 1663) -> (540, 712)
2025-03-20 16:56:45,957 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:56:45,958 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:56:47,138 - QuickAppADBTester - INFO - 成功解锁到桌面
2025-03-20 16:56:47,138 - QuickAppADBTester - INFO - ===== 开始执行流程1: 清除快应用中心数据 =====
2025-03-20 16:56:47,138 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:56:47,138 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:56:47,138 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:56:48,227 - QuickAppADBTester - INFO - 步骤2: 打开设置应用
2025-03-20 16:56:48,227 - QuickAppADBTester - INFO - 运行命令: adb shell am start -a android.settings.SETTINGS
2025-03-20 16:56:48,335 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { act=android.settings.SETTINGS }

2025-03-20 16:56:50,341 - QuickAppADBTester - INFO - 步骤3: 点击搜索框
2025-03-20 16:56:50,341 - QuickAppADBTester - INFO - 点击坐标: (274, 563)
2025-03-20 16:56:51,427 - QuickAppADBTester - INFO - 步骤4: 输入'应用和服务'
2025-03-20 16:56:51,428 - QuickAppADBTester - INFO - 输入文本: 应用和服务
2025-03-20 16:56:51,428 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:56:51,428 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "应用和服务"
2025-03-20 16:56:51,522 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:56:53,533 - QuickAppADBTester - INFO - 步骤5: 点击搜索结果'应用和服务'
2025-03-20 16:56:53,533 - QuickAppADBTester - INFO - 点击坐标: (265, 434)
2025-03-20 16:56:55,634 - QuickAppADBTester - INFO - 步骤6: 点击'应用管理'
2025-03-20 16:56:55,636 - QuickAppADBTester - INFO - 点击坐标: (163, 413)
2025-03-20 16:56:57,712 - QuickAppADBTester - INFO - 步骤7: 点击搜索框
2025-03-20 16:56:57,713 - QuickAppADBTester - INFO - 点击坐标: (222, 389)
2025-03-20 16:56:58,848 - QuickAppADBTester - INFO - 步骤8: 输入'快应用中心'
2025-03-20 16:56:58,849 - QuickAppADBTester - INFO - 输入文本: 快应用中心
2025-03-20 16:56:58,849 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:56:58,849 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "快应用中心"
2025-03-20 16:56:58,956 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:57:00,960 - QuickAppADBTester - INFO - 步骤9: 点击搜索结果'快应用中心'
2025-03-20 16:57:00,961 - QuickAppADBTester - INFO - 点击坐标: (294, 591)
2025-03-20 16:57:03,066 - QuickAppADBTester - INFO - 步骤10: 向上滑动显示更多内容
2025-03-20 16:57:03,067 - QuickAppADBTester - INFO - 滑动: (490, 1900) -> (490, 950)
2025-03-20 16:57:04,478 - QuickAppADBTester - INFO - 步骤11: 点击'存储'
2025-03-20 16:57:04,479 - QuickAppADBTester - INFO - 点击坐标: (133, 1002)
2025-03-20 16:57:05,583 - QuickAppADBTester - INFO - 步骤12: 点击'删除数据'
2025-03-20 16:57:05,584 - QuickAppADBTester - INFO - 点击坐标: (546, 1321)
2025-03-20 16:57:06,663 - QuickAppADBTester - INFO - 步骤13: 点击确认对话框中的'确定'按钮
2025-03-20 16:57:06,663 - QuickAppADBTester - INFO - 点击坐标: (798, 2221)
2025-03-20 16:57:08,766 - QuickAppADBTester - INFO - 流程1执行完成: 清除快应用中心数据
2025-03-20 16:57:08,767 - QuickAppADBTester - INFO - ===== 开始执行流程2: 通过应用市场管理快应用 =====
2025-03-20 16:57:08,767 - QuickAppADBTester - INFO - 步骤1: 按Home键回到桌面
2025-03-20 16:57:08,767 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:57:08,767 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:57:09,864 - QuickAppADBTester - INFO - 步骤2: 打开应用市场
2025-03-20 16:57:09,864 - QuickAppADBTester - INFO - 运行命令: adb shell am start -n com.huawei.appmarket/.MainActivity
2025-03-20 16:57:09,940 - QuickAppADBTester - INFO - 命令输出: Starting: Intent { cmp=com.huawei.appmarket/.MainActivity }

2025-03-20 16:57:14,946 - QuickAppADBTester - INFO - 步骤3: 点击'我的'选项卡
2025-03-20 16:57:14,946 - QuickAppADBTester - INFO - 点击坐标: (976, 2257)
2025-03-20 16:57:17,025 - QuickAppADBTester - INFO - 步骤4: 点击'快应用管理'选项
2025-03-20 16:57:17,026 - QuickAppADBTester - INFO - 点击坐标: (181, 1689)
2025-03-20 16:57:22,157 - QuickAppADBTester - INFO - 步骤5: 检查并点击'同意'按钮(如果出现)
2025-03-20 16:57:22,159 - QuickAppADBTester - INFO - 点击坐标: (772, 2223)
2025-03-20 16:57:24,271 - QuickAppADBTester - INFO - 等待应用市场稳定 (5秒)
2025-03-20 16:57:29,274 - QuickAppADBTester - INFO - 流程2执行完成: 通过应用市场管理快应用
2025-03-20 16:57:29,275 - QuickAppADBTester - INFO - 开始使用scrcpy录制流程3视频: test_flow_20250320_165729.mp4
2025-03-20 16:57:29,275 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:57:29,275 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:57:34,513 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:57:34,514 - QuickAppADBTester - INFO - 检查设备连接状态...
2025-03-20 16:57:34,554 - QuickAppADBTester - INFO - 设备连接正常: List of devices attached
NAB0220311005252	device
2025-03-20 16:57:35,693 - QuickAppADBTester - INFO - 开始录制，输出文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_165729.mp4
2025-03-20 16:57:35,693 - QuickAppADBTester - INFO - 使用命令: scrcpy --record=/Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_165729.mp4 --no-window --video-codec=h265 --max-size=720 --max-fps=15 --time-limit=120 --video-bit-rate=8M --record-format=mp4 --no-audio
2025-03-20 16:57:37,704 - QuickAppADBTester - INFO - 录制已开始...
2025-03-20 16:57:40,708 - QuickAppADBTester - INFO - 录制状态监控已启动
2025-03-20 16:57:40,709 - QuickAppADBTester - INFO - 录制已启动，等待3秒确保录制稳定...
2025-03-20 16:57:43,713 - QuickAppADBTester - INFO - ===== 开始执行流程3: 搜索并打开快应用进行测试 =====
2025-03-20 16:57:43,713 - QuickAppADBTester - INFO - 步骤1: 点击搜索框
2025-03-20 16:57:43,714 - QuickAppADBTester - INFO - 点击坐标: (231, 389)
2025-03-20 16:57:44,821 - QuickAppADBTester - INFO - 步骤2: 输入'优购'
2025-03-20 16:57:44,822 - QuickAppADBTester - INFO - 输入文本: 优购
2025-03-20 16:57:44,822 - QuickAppADBTester - INFO - 使用ADBKeyboard输入非ASCII文本
2025-03-20 16:57:44,822 - QuickAppADBTester - INFO - 执行命令: adb shell am broadcast -a ADB_INPUT_TEXT --es msg "优购"
2025-03-20 16:57:44,918 - QuickAppADBTester - INFO - 文本输入广播命令成功发送
2025-03-20 16:57:46,924 - QuickAppADBTester - INFO - 步骤3: 按下回车键
2025-03-20 16:57:46,924 - QuickAppADBTester - INFO - 按下回车键
2025-03-20 16:57:46,925 - QuickAppADBTester - INFO - 按下按键: 66
2025-03-20 16:57:49,128 - QuickAppADBTester - INFO - 步骤4: 点击搜索结果旁边的'打开'按钮
2025-03-20 16:57:49,128 - QuickAppADBTester - INFO - 点击坐标: (885, 399)
2025-03-20 16:57:57,230 - QuickAppADBTester - INFO - 步骤5: 准备执行10次侧滑
2025-03-20 16:57:57,231 - QuickAppADBTester - INFO - 步骤6: 执行10次侧滑操作
2025-03-20 16:57:57,231 - QuickAppADBTester - INFO - 第1次侧滑
2025-03-20 16:57:57,232 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:57,507 - QuickAppADBTester - INFO - 第2次侧滑
2025-03-20 16:57:57,507 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:57,739 - QuickAppADBTester - INFO - 第3次侧滑
2025-03-20 16:57:57,740 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:57,981 - QuickAppADBTester - INFO - 第4次侧滑
2025-03-20 16:57:57,982 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:58,225 - QuickAppADBTester - INFO - 第5次侧滑
2025-03-20 16:57:58,226 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:58,412 - QuickAppADBTester - INFO - 第6次侧滑
2025-03-20 16:57:58,413 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:58,616 - QuickAppADBTester - INFO - 第7次侧滑
2025-03-20 16:57:58,617 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:58,807 - QuickAppADBTester - INFO - 第8次侧滑
2025-03-20 16:57:58,808 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:59,032 - QuickAppADBTester - INFO - 第9次侧滑
2025-03-20 16:57:59,033 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:57:59,226 - QuickAppADBTester - INFO - 第10次侧滑
2025-03-20 16:57:59,226 - QuickAppADBTester - INFO - 滑动: (1058, 1188) -> (950, 1188)
2025-03-20 16:58:01,471 - QuickAppADBTester - INFO - 步骤7: 检查当前应用
2025-03-20 16:58:01,472 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:58:01,472 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:58:01,565 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d00cf0a u0 com.huawei.fastapp/.app.processManager.PageLoaderActivityEntryPort0 t828}
    mLastPausedActivity: ActivityRecord{314c1e2 u0 com.huawei.fastapp/.app.processManager.RpkLoaderActivityEntry0 t-1 f}}

2025-03-20 16:58:01,565 - QuickAppADBTester - INFO - ✅ 检测到华为快应用正在前台运行
2025-03-20 16:58:01,565 - QuickAppADBTester - INFO - 侧滑拦截成功：快应用仍在前台运行
2025-03-20 16:58:01,565 - QuickAppADBTester - INFO - 步骤8: 截图记录侧滑后状态
2025-03-20 16:58:01,565 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_165801_20250320_165801.png
2025-03-20 16:58:02,366 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_165801_20250320_165801.png
2025-03-20 16:58:02,366 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_swipe_20250320_165801_20250320_165801.png
2025-03-20 16:58:02,367 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:58:08,985 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_422.jpg
2025-03-20 16:58:08,988 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_422.jpg
2025-03-20 16:58:08,988 - QuickAppADBTester - INFO - 步骤9: 按Home键
2025-03-20 16:58:08,988 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:58:08,988 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:58:10,811 - QuickAppADBTester - INFO - 录制进行中，已录制约 30 秒
2025-03-20 16:58:19,087 - QuickAppADBTester - INFO - 步骤10: 再次检查当前应用
2025-03-20 16:58:19,087 - QuickAppADBTester - INFO - 检查快应用是否在前台运行
2025-03-20 16:58:19,088 - QuickAppADBTester - INFO - 运行命令: adb shell "dumpsys activity activities | grep -A 1 'mResumedActivity'"
2025-03-20 16:58:19,185 - QuickAppADBTester - INFO - 命令输出:     mResumedActivity: ActivityRecord{d567b92 u0 com.huawei.android.launcher/.unihome.UniHomeLauncher t7}
    * Task{a0a1126 #7 type=home A=10113:com.huawei.android.launcher U=0 rootTaskId=1 visible=true mode=fullscreen translucent=false sz=1}

2025-03-20 16:58:19,186 - QuickAppADBTester - INFO - ❌ 未检测到华为快应用在前台运行
2025-03-20 16:58:19,186 - QuickAppADBTester - WARNING - 拉回失败：按Home键后快应用已不在前台运行
2025-03-20 16:58:19,186 - QuickAppADBTester - INFO - 步骤11: 再次截图记录按Home后状态
2025-03-20 16:58:19,186 - QuickAppADBTester - INFO - 正在截图: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_165819_20250320_165819.png
2025-03-20 16:58:20,852 - QuickAppADBTester - INFO - 上传截图到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_165819_20250320_165819.png
2025-03-20 16:58:20,853 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/screenshots/after_home_20250320_165819_20250320_165819.png
2025-03-20 16:58:20,853 - QuickAppADBTester - INFO - 发送请求到 sendPhoto...
2025-03-20 16:58:27,330 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_423.jpg
2025-03-20 16:58:27,334 - QuickAppADBTester - INFO - 截图上传成功: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_423.jpg
2025-03-20 16:58:27,335 - QuickAppADBTester - INFO - 流程3执行完成: 搜索并打开快应用进行测试
2025-03-20 16:58:27,335 - QuickAppADBTester - INFO - 流程3完成，停止录制...
2025-03-20 16:58:27,335 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:58:27,335 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:58:29,448 - QuickAppADBTester - INFO - 停止录制...
2025-03-20 16:58:29,449 - QuickAppADBTester - INFO - 发送SIGINT信号 (Ctrl+C)
2025-03-20 16:58:29,450 - QuickAppADBTester - INFO - 等待SIGINT生效，这可能需要10-30秒...
2025-03-20 16:58:29,450 - QuickAppADBTester - INFO - 等待进程退出... (1/30)
2025-03-20 16:58:30,455 - QuickAppADBTester - INFO - 等待进程退出... (2/30)
2025-03-20 16:58:31,470 - QuickAppADBTester - INFO - 进程在接收SIGINT后成功退出，用时3秒
2025-03-20 16:58:31,475 - QuickAppADBTester - INFO - 录制进程已退出，退出码: 0
2025-03-20 16:58:31,500 - QuickAppADBTester - INFO - stderr输出: /opt/homebrew/Cellar/scrcpy/3.1/share/scrcpy/scrcpy-server: 1 file pushed, 0 skipped. 58.5 MB/s (90640 bytes in 0.001s)
WARN: Killing the server...

2025-03-20 16:58:31,501 - QuickAppADBTester - INFO - 等待10秒确保文件写入完成...
2025-03-20 16:58:41,507 - QuickAppADBTester - INFO - 录制文件: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_165729.mp4 (大小: 0.64MB)
2025-03-20 16:58:41,509 - QuickAppADBTester - INFO - 预检查文件完整性...
2025-03-20 16:58:41,689 - QuickAppADBTester - INFO - 录制文件完整，时长: 52.474878秒，无需修复
2025-03-20 16:58:41,689 - QuickAppADBTester - INFO - 上传视频到Telegram...
2025-03-20 16:58:41,690 - QuickAppADBTester - INFO - 开始上传文件到Telegram: /Users/ct/Desktop/huawei_auto/videos/test_flow_20250320_165729.mp4
2025-03-20 16:58:41,690 - QuickAppADBTester - INFO - 发送请求到 sendVideo...
2025-03-20 16:58:47,126 - QuickAppADBTester - INFO - 文件上传成功! 下载URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_424.mp4
2025-03-20 16:58:47,131 - QuickAppADBTester - INFO - 视频已上传，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_424.mp4
2025-03-20 16:58:47,131 - QuickAppADBTester - INFO - 尝试优雅地终止所有scrcpy进程
2025-03-20 16:58:47,132 - QuickAppADBTester - INFO - Linux/Mac平台：先发送SIGINT信号
2025-03-20 16:58:52,381 - QuickAppADBTester - INFO - 所有scrcpy进程已终止
2025-03-20 16:58:52,382 - QuickAppADBTester - INFO - 流程3视频已上传到Telegram，URL: https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_424.mp4
2025-03-20 16:58:52,383 - QuickAppADBTester - INFO - ===== 开始执行流程4: 清空手机里的全部应用 =====
2025-03-20 16:58:52,383 - QuickAppADBTester - INFO - 步骤1: 强制停止快应用
2025-03-20 16:58:52,383 - QuickAppADBTester - INFO - 运行命令: adb shell am force-stop com.huawei.fastapp
2025-03-20 16:58:52,620 - QuickAppADBTester - INFO - 命令输出: 
2025-03-20 16:58:53,623 - QuickAppADBTester - INFO - 步骤2: 按Home键
2025-03-20 16:58:53,623 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:58:53,623 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:58:54,722 - QuickAppADBTester - INFO - 步骤3: 打开最近任务列表
2025-03-20 16:58:54,722 - QuickAppADBTester - INFO - 打开最近任务列表
2025-03-20 16:58:54,723 - QuickAppADBTester - INFO - 按下按键: KEYCODE_APP_SWITCH
2025-03-20 16:58:56,823 - QuickAppADBTester - INFO - 步骤4: 点击底部中间清除按钮
2025-03-20 16:58:56,824 - QuickAppADBTester - INFO - 点击坐标: (534, 2159)
2025-03-20 16:58:57,928 - QuickAppADBTester - INFO - 步骤5: 按Home键回到桌面
2025-03-20 16:58:57,928 - QuickAppADBTester - INFO - 按下Home键
2025-03-20 16:58:57,928 - QuickAppADBTester - INFO - 按下按键: KEYCODE_HOME
2025-03-20 16:58:59,032 - QuickAppADBTester - INFO - 流程4执行完成: 清空手机里的全部应用
2025-03-20 16:58:59,035 - QuickAppADBTester - INFO - 所有流程执行完成。详细结果: {'屏幕唤醒': True, '流程1_清除快应用中心数据': True, '流程2_通过应用市场管理快应用': True, '流程3_防侧滑测试': True, '流程3_拉回测试': False, '流程4_清空手机里的全部应用': True}
2025-03-20 16:58:59,035 - QuickAppADBTester - INFO - 使用交互式卡片消息格式发送，包含3张图片链接
2025-03-20 16:58:59,036 - QuickAppADBTester - INFO - 构建的消息结构: {"msg_type": "interactive", "card": {"config": {"wide_screen_mode": true}, "header": {"title": {"tag": "plain_text", "content": "❌ 快应用自动化测试失败"}, "template": "red"}, "elements": [{"tag": "div", "text": {"tag": "lark_md", "content": "<at id=all></at> 请注意："}}, {"tag": "div", "text": {"tag": "lark_md", "content": "**快应用测试执行失败！失败项目：快应用拉回测试失败**\n\n- 开始时间: 2025-03-20 16:56:44\n- 结束时间: 2025-03-20 16:58:59\n- 测试设备: 华为设备\n\n**测试结果详情:**\n1. 屏幕唤醒: ✅ 成功\n2. 清除快应用中心数据: ✅ 成功\n3. 通过应用市场管理快应用: ✅ 成功\n4. 快应用功能测试: \n   - 防侧滑测试: ✅ 成功\n   - 拉回测试: ❌ 失败\n5. 清空手机里的全部应用: ✅ 成功\n\n**** "}}, {"tag": "hr"}, {"tag": "div", "text": {"tag": "lark_md", "content": "**📷 测试截图和视频：**"}}, {"tag": "action", "actions": [{"tag": "button", "text": {"tag": "plain_text", "content": "防侧滑"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_422.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "拉回"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/photos/file_423.jpg"}, {"tag": "button", "text": {"tag": "plain_text", "content": "视频"}, "type": "primary", "url": "https://api.telegram.org/file/bot7883072273:AAH0VO-o6O4-ZkY1KXLCiqT3xMqPgq--CXg/videos/file_424.mp4"}]}, {"tag": "div", "text": {"tag": "lark_md", "content": "查看截图 or 视频，需要使用VPN"}}, {"tag": "hr"}, {"tag": "note", "elements": [{"tag": "plain_text", "content": "测试时间: 2025-03-20 16:58:59"}]}]}}
2025-03-20 16:58:59,450 - QuickAppADBTester - INFO - 飞书通知发送成功: ❌ 快应用自动化测试失败
2025-03-20 16:58:59,453 - QuickAppADBTester - INFO - 测试完成
2025-03-20 16:58:59,453 - QuickAppADBTester - INFO - 定时任务已启动，按Ctrl+C可停止
2025-03-20 16:59:12,557 - QuickAppADBTester - INFO - 接收到终止信号，正在优雅退出...
2025-03-20 16:59:12,559 - QuickAppADBTester - INFO - 脚本已终止
2025-03-20 16:59:12,559 - QuickAppADBTester - INFO - 定时测试任务已结束
